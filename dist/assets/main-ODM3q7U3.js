function gx(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Kh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qh={exports:{}},eo={},Zh={exports:{}},Z={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hi=Symbol.for("react.element"),xx=Symbol.for("react.portal"),yx=Symbol.for("react.fragment"),vx=Symbol.for("react.strict_mode"),wx=Symbol.for("react.profiler"),bx=Symbol.for("react.provider"),kx=Symbol.for("react.context"),Sx=Symbol.for("react.forward_ref"),jx=Symbol.for("react.suspense"),Nx=Symbol.for("react.memo"),Cx=Symbol.for("react.lazy"),bd=Symbol.iterator;function Tx(t){return t===null||typeof t!="object"?null:(t=bd&&t[bd]||t["@@iterator"],typeof t=="function"?t:null)}var Jh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ef=Object.assign,tf={};function Kr(t,e,n){this.props=t,this.context=e,this.refs=tf,this.updater=n||Jh}Kr.prototype.isReactComponent={};Kr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Kr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nf(){}nf.prototype=Kr.prototype;function Lc(t,e,n){this.props=t,this.context=e,this.refs=tf,this.updater=n||Jh}var _c=Lc.prototype=new nf;_c.constructor=Lc;ef(_c,Kr.prototype);_c.isPureReactComponent=!0;var kd=Array.isArray,rf=Object.prototype.hasOwnProperty,Ic={current:null},sf={key:!0,ref:!0,__self:!0,__source:!0};function af(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)rf.call(e,r)&&!sf.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:hi,type:t,key:i,ref:o,props:s,_owner:Ic.current}}function Mx(t,e){return{$$typeof:hi,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zc(t){return typeof t=="object"&&t!==null&&t.$$typeof===hi}function Ex(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Sd=/\/+/g;function Go(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ex(""+t.key):e.toString(36)}function fa(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case hi:case xx:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Go(o,0):r,kd(s)?(n="",t!=null&&(n=t.replace(Sd,"$&/")+"/"),fa(s,e,n,"",function(u){return u})):s!=null&&(zc(s)&&(s=Mx(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Sd,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",kd(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Go(i,l);o+=fa(i,e,n,c,s)}else if(c=Tx(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Go(i,l++),o+=fa(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Yi(t,e,n){if(t==null)return t;var r=[],s=0;return fa(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Px(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ge={current:null},ma={transition:null},Lx={ReactCurrentDispatcher:Ge,ReactCurrentBatchConfig:ma,ReactCurrentOwner:Ic};function of(){throw Error("act(...) is not supported in production builds of React.")}Z.Children={map:Yi,forEach:function(t,e,n){Yi(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Yi(t,function(){e++}),e},toArray:function(t){return Yi(t,function(e){return e})||[]},only:function(t){if(!zc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Z.Component=Kr;Z.Fragment=yx;Z.Profiler=wx;Z.PureComponent=Lc;Z.StrictMode=vx;Z.Suspense=jx;Z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lx;Z.act=of;Z.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ef({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ic.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)rf.call(e,c)&&!sf.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:hi,type:t.type,key:s,ref:i,props:r,_owner:o}};Z.createContext=function(t){return t={$$typeof:kx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bx,_context:t},t.Consumer=t};Z.createElement=af;Z.createFactory=function(t){var e=af.bind(null,t);return e.type=t,e};Z.createRef=function(){return{current:null}};Z.forwardRef=function(t){return{$$typeof:Sx,render:t}};Z.isValidElement=zc;Z.lazy=function(t){return{$$typeof:Cx,_payload:{_status:-1,_result:t},_init:Px}};Z.memo=function(t,e){return{$$typeof:Nx,type:t,compare:e===void 0?null:e}};Z.startTransition=function(t){var e=ma.transition;ma.transition={};try{t()}finally{ma.transition=e}};Z.unstable_act=of;Z.useCallback=function(t,e){return Ge.current.useCallback(t,e)};Z.useContext=function(t){return Ge.current.useContext(t)};Z.useDebugValue=function(){};Z.useDeferredValue=function(t){return Ge.current.useDeferredValue(t)};Z.useEffect=function(t,e){return Ge.current.useEffect(t,e)};Z.useId=function(){return Ge.current.useId()};Z.useImperativeHandle=function(t,e,n){return Ge.current.useImperativeHandle(t,e,n)};Z.useInsertionEffect=function(t,e){return Ge.current.useInsertionEffect(t,e)};Z.useLayoutEffect=function(t,e){return Ge.current.useLayoutEffect(t,e)};Z.useMemo=function(t,e){return Ge.current.useMemo(t,e)};Z.useReducer=function(t,e,n){return Ge.current.useReducer(t,e,n)};Z.useRef=function(t){return Ge.current.useRef(t)};Z.useState=function(t){return Ge.current.useState(t)};Z.useSyncExternalStore=function(t,e,n){return Ge.current.useSyncExternalStore(t,e,n)};Z.useTransition=function(){return Ge.current.useTransition()};Z.version="18.3.1";Zh.exports=Z;var m=Zh.exports;const xe=Kh(m),_x=gx({__proto__:null,default:xe},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ix=m,zx=Symbol.for("react.element"),Ax=Symbol.for("react.fragment"),Dx=Object.prototype.hasOwnProperty,Rx=Ix.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ox={key:!0,ref:!0,__self:!0,__source:!0};function lf(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Dx.call(e,r)&&!Ox.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:zx,type:t,key:i,ref:o,props:s,_owner:Rx.current}}eo.Fragment=Ax;eo.jsx=lf;eo.jsxs=lf;Qh.exports=eo;var a=Qh.exports,Pl={},cf={exports:{}},pt={},uf={exports:{}},df={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,W){var B=z.length;z.push(W);e:for(;0<B;){var te=B-1>>>1,ne=z[te];if(0<s(ne,W))z[te]=W,z[B]=ne,B=te;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var W=z[0],B=z.pop();if(B!==W){z[0]=B;e:for(var te=0,ne=z.length,ue=ne>>>1;te<ue;){var xt=2*(te+1)-1,Jr=z[xt],Qe=xt+1,tr=z[Qe];if(0>s(Jr,B))Qe<ne&&0>s(tr,Jr)?(z[te]=tr,z[Qe]=B,te=Qe):(z[te]=Jr,z[xt]=B,te=xt);else if(Qe<ne&&0>s(tr,B))z[te]=tr,z[Qe]=B,te=Qe;else break e}}return W}function s(z,W){var B=z.sortIndex-W.sortIndex;return B!==0?B:z.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,p=3,b=!1,v=!1,S=!1,j=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(z){for(var W=n(u);W!==null;){if(W.callback===null)r(u);else if(W.startTime<=z)r(u),W.sortIndex=W.expirationTime,e(c,W);else break;W=n(u)}}function k(z){if(S=!1,y(z),!v)if(n(c)!==null)v=!0,Se(C);else{var W=n(u);W!==null&&Ke(k,W.startTime-z)}}function C(z,W){v=!1,S&&(S=!1,x(E),E=-1),b=!0;var B=p;try{for(y(W),f=n(c);f!==null&&(!(f.expirationTime>W)||z&&!G());){var te=f.callback;if(typeof te=="function"){f.callback=null,p=f.priorityLevel;var ne=te(f.expirationTime<=W);W=t.unstable_now(),typeof ne=="function"?f.callback=ne:f===n(c)&&r(c),y(W)}else r(c);f=n(c)}if(f!==null)var ue=!0;else{var xt=n(u);xt!==null&&Ke(k,xt.startTime-W),ue=!1}return ue}finally{f=null,p=B,b=!1}}var M=!1,P=null,E=-1,$=5,D=-1;function G(){return!(t.unstable_now()-D<$)}function q(){if(P!==null){var z=t.unstable_now();D=z;var W=!0;try{W=P(!0,z)}finally{W?se():(M=!1,P=null)}}else M=!1}var se;if(typeof g=="function")se=function(){g(q)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,oe=X.port2;X.port1.onmessage=q,se=function(){oe.postMessage(null)}}else se=function(){j(q,0)};function Se(z){P=z,M||(M=!0,se())}function Ke(z,W){E=j(function(){z(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){v||b||(v=!0,Se(C))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(z){switch(p){case 1:case 2:case 3:var W=3;break;default:W=p}var B=p;p=W;try{return z()}finally{p=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,W){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var B=p;p=z;try{return W()}finally{p=B}},t.unstable_scheduleCallback=function(z,W,B){var te=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?te+B:te):B=te,z){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=B+ne,z={id:h++,callback:W,priorityLevel:z,startTime:B,expirationTime:ne,sortIndex:-1},B>te?(z.sortIndex=B,e(u,z),n(c)===null&&z===n(u)&&(S?(x(E),E=-1):S=!0,Ke(k,B-te))):(z.sortIndex=ne,e(c,z),v||b||(v=!0,Se(C))),z},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(z){var W=p;return function(){var B=p;p=W;try{return z.apply(this,arguments)}finally{p=B}}}})(df);uf.exports=df;var $x=uf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fx=m,mt=$x;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hf=new Set,Gs={};function Zn(t,e){Yr(t,e),Yr(t+"Capture",e)}function Yr(t,e){for(Gs[t]=e,t=0;t<e.length;t++)hf.add(e[t])}var Zt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ll=Object.prototype.hasOwnProperty,Hx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jd={},Nd={};function Wx(t){return Ll.call(Nd,t)?!0:Ll.call(jd,t)?!1:Hx.test(t)?Nd[t]=!0:(jd[t]=!0,!1)}function Yx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Bx(t,e,n,r){if(e===null||typeof e>"u"||Yx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qe(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Oe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Oe[t]=new qe(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Oe[e]=new qe(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Oe[t]=new qe(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Oe[t]=new qe(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Oe[t]=new qe(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Oe[t]=new qe(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Oe[t]=new qe(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Oe[t]=new qe(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Oe[t]=new qe(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ac=/[\-:]([a-z])/g;function Dc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ac,Dc);Oe[e]=new qe(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ac,Dc);Oe[e]=new qe(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ac,Dc);Oe[e]=new qe(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Oe[t]=new qe(t,1,!1,t.toLowerCase(),null,!1,!1)});Oe.xlinkHref=new qe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Oe[t]=new qe(t,1,!1,t.toLowerCase(),null,!0,!0)});function Rc(t,e,n,r){var s=Oe.hasOwnProperty(e)?Oe[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bx(e,n,s,r)&&(n=null),r||s===null?Wx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var nn=Fx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bi=Symbol.for("react.element"),Nr=Symbol.for("react.portal"),Cr=Symbol.for("react.fragment"),Oc=Symbol.for("react.strict_mode"),_l=Symbol.for("react.profiler"),ff=Symbol.for("react.provider"),mf=Symbol.for("react.context"),$c=Symbol.for("react.forward_ref"),Il=Symbol.for("react.suspense"),zl=Symbol.for("react.suspense_list"),Fc=Symbol.for("react.memo"),cn=Symbol.for("react.lazy"),pf=Symbol.for("react.offscreen"),Cd=Symbol.iterator;function ks(t){return t===null||typeof t!="object"?null:(t=Cd&&t[Cd]||t["@@iterator"],typeof t=="function"?t:null)}var we=Object.assign,qo;function zs(t){if(qo===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qo=e&&e[1]||""}return`
`+qo+t}var Ko=!1;function Qo(t,e){if(!t||Ko)return"";Ko=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ko=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?zs(t):""}function Xx(t){switch(t.tag){case 5:return zs(t.type);case 16:return zs("Lazy");case 13:return zs("Suspense");case 19:return zs("SuspenseList");case 0:case 2:case 15:return t=Qo(t.type,!1),t;case 11:return t=Qo(t.type.render,!1),t;case 1:return t=Qo(t.type,!0),t;default:return""}}function Al(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Cr:return"Fragment";case Nr:return"Portal";case _l:return"Profiler";case Oc:return"StrictMode";case Il:return"Suspense";case zl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mf:return(t.displayName||"Context")+".Consumer";case ff:return(t._context.displayName||"Context")+".Provider";case $c:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fc:return e=t.displayName||null,e!==null?e:Al(t.type)||"Memo";case cn:e=t._payload,t=t._init;try{return Al(t(e))}catch{}}return null}function Ux(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Al(e);case 8:return e===Oc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gf(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Vx(t){var e=gf(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Xi(t){t._valueTracker||(t._valueTracker=Vx(t))}function xf(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=gf(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ea(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dl(t,e){var n=e.checked;return we({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Td(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Sn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yf(t,e){e=e.checked,e!=null&&Rc(t,"checked",e,!1)}function Rl(t,e){yf(t,e);var n=Sn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ol(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ol(t,e.type,Sn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Md(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ol(t,e,n){(e!=="number"||Ea(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var As=Array.isArray;function Rr(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Sn(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function $l(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return we({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ed(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(As(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Sn(n)}}function vf(t,e){var n=Sn(e.value),r=Sn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Pd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fl(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ui,bf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ui=Ui||document.createElement("div"),Ui.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ui.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qs(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Os={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gx=["Webkit","ms","Moz","O"];Object.keys(Os).forEach(function(t){Gx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Os[e]=Os[t]})});function kf(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Os.hasOwnProperty(t)&&Os[t]?(""+e).trim():e+"px"}function Sf(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=kf(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var qx=we({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hl(t,e){if(e){if(qx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Wl(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yl=null;function Hc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bl=null,Or=null,$r=null;function Ld(t){if(t=pi(t)){if(typeof Bl!="function")throw Error(L(280));var e=t.stateNode;e&&(e=io(e),Bl(t.stateNode,t.type,e))}}function jf(t){Or?$r?$r.push(t):$r=[t]:Or=t}function Nf(){if(Or){var t=Or,e=$r;if($r=Or=null,Ld(t),e)for(t=0;t<e.length;t++)Ld(e[t])}}function Cf(t,e){return t(e)}function Tf(){}var Zo=!1;function Mf(t,e,n){if(Zo)return t(e,n);Zo=!0;try{return Cf(t,e,n)}finally{Zo=!1,(Or!==null||$r!==null)&&(Tf(),Nf())}}function Ks(t,e){var n=t.stateNode;if(n===null)return null;var r=io(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var Xl=!1;if(Zt)try{var Ss={};Object.defineProperty(Ss,"passive",{get:function(){Xl=!0}}),window.addEventListener("test",Ss,Ss),window.removeEventListener("test",Ss,Ss)}catch{Xl=!1}function Kx(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var $s=!1,Pa=null,La=!1,Ul=null,Qx={onError:function(t){$s=!0,Pa=t}};function Zx(t,e,n,r,s,i,o,l,c){$s=!1,Pa=null,Kx.apply(Qx,arguments)}function Jx(t,e,n,r,s,i,o,l,c){if(Zx.apply(this,arguments),$s){if($s){var u=Pa;$s=!1,Pa=null}else throw Error(L(198));La||(La=!0,Ul=u)}}function Jn(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ef(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _d(t){if(Jn(t)!==t)throw Error(L(188))}function ey(t){var e=t.alternate;if(!e){if(e=Jn(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return _d(s),t;if(i===r)return _d(s),e;i=i.sibling}throw Error(L(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function Pf(t){return t=ey(t),t!==null?Lf(t):null}function Lf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Lf(t);if(e!==null)return e;t=t.sibling}return null}var _f=mt.unstable_scheduleCallback,Id=mt.unstable_cancelCallback,ty=mt.unstable_shouldYield,ny=mt.unstable_requestPaint,Ce=mt.unstable_now,ry=mt.unstable_getCurrentPriorityLevel,Wc=mt.unstable_ImmediatePriority,If=mt.unstable_UserBlockingPriority,_a=mt.unstable_NormalPriority,sy=mt.unstable_LowPriority,zf=mt.unstable_IdlePriority,to=null,Ot=null;function iy(t){if(Ot&&typeof Ot.onCommitFiberRoot=="function")try{Ot.onCommitFiberRoot(to,t,void 0,(t.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:ly,ay=Math.log,oy=Math.LN2;function ly(t){return t>>>=0,t===0?32:31-(ay(t)/oy|0)|0}var Vi=64,Gi=4194304;function Ds(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ia(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Ds(l):(i&=o,i!==0&&(r=Ds(i)))}else o=n&~s,o!==0?r=Ds(o):i!==0&&(r=Ds(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pt(e),s=1<<n,r|=t[n],e&=~s;return r}function cy(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uy(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Pt(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=cy(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Vl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Af(){var t=Vi;return Vi<<=1,!(Vi&4194240)&&(Vi=64),t}function Jo(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fi(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pt(e),t[e]=n}function dy(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Pt(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Yc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pt(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ce=0;function Df(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Rf,Bc,Of,$f,Ff,Gl=!1,qi=[],pn=null,gn=null,xn=null,Qs=new Map,Zs=new Map,dn=[],hy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zd(t,e){switch(t){case"focusin":case"focusout":pn=null;break;case"dragenter":case"dragleave":gn=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":Qs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zs.delete(e.pointerId)}}function js(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=pi(e),e!==null&&Bc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function fy(t,e,n,r,s){switch(e){case"focusin":return pn=js(pn,t,e,n,r,s),!0;case"dragenter":return gn=js(gn,t,e,n,r,s),!0;case"mouseover":return xn=js(xn,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Qs.set(i,js(Qs.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Zs.set(i,js(Zs.get(i)||null,t,e,n,r,s)),!0}return!1}function Hf(t){var e=On(t.target);if(e!==null){var n=Jn(e);if(n!==null){if(e=n.tag,e===13){if(e=Ef(n),e!==null){t.blockedOn=e,Ff(t.priority,function(){Of(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ql(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Yl=r,n.target.dispatchEvent(r),Yl=null}else return e=pi(n),e!==null&&Bc(e),t.blockedOn=n,!1;e.shift()}return!0}function Ad(t,e,n){pa(t)&&n.delete(e)}function my(){Gl=!1,pn!==null&&pa(pn)&&(pn=null),gn!==null&&pa(gn)&&(gn=null),xn!==null&&pa(xn)&&(xn=null),Qs.forEach(Ad),Zs.forEach(Ad)}function Ns(t,e){t.blockedOn===e&&(t.blockedOn=null,Gl||(Gl=!0,mt.unstable_scheduleCallback(mt.unstable_NormalPriority,my)))}function Js(t){function e(s){return Ns(s,t)}if(0<qi.length){Ns(qi[0],t);for(var n=1;n<qi.length;n++){var r=qi[n];r.blockedOn===t&&(r.blockedOn=null)}}for(pn!==null&&Ns(pn,t),gn!==null&&Ns(gn,t),xn!==null&&Ns(xn,t),Qs.forEach(e),Zs.forEach(e),n=0;n<dn.length;n++)r=dn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<dn.length&&(n=dn[0],n.blockedOn===null);)Hf(n),n.blockedOn===null&&dn.shift()}var Fr=nn.ReactCurrentBatchConfig,za=!0;function py(t,e,n,r){var s=ce,i=Fr.transition;Fr.transition=null;try{ce=1,Xc(t,e,n,r)}finally{ce=s,Fr.transition=i}}function gy(t,e,n,r){var s=ce,i=Fr.transition;Fr.transition=null;try{ce=4,Xc(t,e,n,r)}finally{ce=s,Fr.transition=i}}function Xc(t,e,n,r){if(za){var s=ql(t,e,n,r);if(s===null)cl(t,e,r,Aa,n),zd(t,r);else if(fy(s,t,e,n,r))r.stopPropagation();else if(zd(t,r),e&4&&-1<hy.indexOf(t)){for(;s!==null;){var i=pi(s);if(i!==null&&Rf(i),i=ql(t,e,n,r),i===null&&cl(t,e,r,Aa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else cl(t,e,r,null,n)}}var Aa=null;function ql(t,e,n,r){if(Aa=null,t=Hc(r),t=On(t),t!==null)if(e=Jn(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ef(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Aa=t,null}function Wf(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ry()){case Wc:return 1;case If:return 4;case _a:case sy:return 16;case zf:return 536870912;default:return 16}default:return 16}}var fn=null,Uc=null,ga=null;function Yf(){if(ga)return ga;var t,e=Uc,n=e.length,r,s="value"in fn?fn.value:fn.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ga=s.slice(t,1<r?1-r:void 0)}function xa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ki(){return!0}function Dd(){return!1}function gt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ki:Dd,this.isPropagationStopped=Dd,this}return we(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ki)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ki)},persist:function(){},isPersistent:Ki}),e}var Qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vc=gt(Qr),mi=we({},Qr,{view:0,detail:0}),xy=gt(mi),el,tl,Cs,no=we({},mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Cs&&(Cs&&t.type==="mousemove"?(el=t.screenX-Cs.screenX,tl=t.screenY-Cs.screenY):tl=el=0,Cs=t),el)},movementY:function(t){return"movementY"in t?t.movementY:tl}}),Rd=gt(no),yy=we({},no,{dataTransfer:0}),vy=gt(yy),wy=we({},mi,{relatedTarget:0}),nl=gt(wy),by=we({},Qr,{animationName:0,elapsedTime:0,pseudoElement:0}),ky=gt(by),Sy=we({},Qr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jy=gt(Sy),Ny=we({},Qr,{data:0}),Od=gt(Ny),Cy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ty={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},My={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ey(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=My[t])?!!e[t]:!1}function Gc(){return Ey}var Py=we({},mi,{key:function(t){if(t.key){var e=Cy[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ty[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gc,charCode:function(t){return t.type==="keypress"?xa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ly=gt(Py),_y=we({},no,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$d=gt(_y),Iy=we({},mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gc}),zy=gt(Iy),Ay=we({},Qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dy=gt(Ay),Ry=we({},no,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Oy=gt(Ry),$y=[9,13,27,32],qc=Zt&&"CompositionEvent"in window,Fs=null;Zt&&"documentMode"in document&&(Fs=document.documentMode);var Fy=Zt&&"TextEvent"in window&&!Fs,Bf=Zt&&(!qc||Fs&&8<Fs&&11>=Fs),Fd=" ",Hd=!1;function Xf(t,e){switch(t){case"keyup":return $y.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uf(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Tr=!1;function Hy(t,e){switch(t){case"compositionend":return Uf(e);case"keypress":return e.which!==32?null:(Hd=!0,Fd);case"textInput":return t=e.data,t===Fd&&Hd?null:t;default:return null}}function Wy(t,e){if(Tr)return t==="compositionend"||!qc&&Xf(t,e)?(t=Yf(),ga=Uc=fn=null,Tr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bf&&e.locale!=="ko"?null:e.data;default:return null}}var Yy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Yy[t.type]:e==="textarea"}function Vf(t,e,n,r){jf(r),e=Da(e,"onChange"),0<e.length&&(n=new Vc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Hs=null,ei=null;function By(t){sm(t,0)}function ro(t){var e=Pr(t);if(xf(e))return t}function Xy(t,e){if(t==="change")return e}var Gf=!1;if(Zt){var rl;if(Zt){var sl="oninput"in document;if(!sl){var Yd=document.createElement("div");Yd.setAttribute("oninput","return;"),sl=typeof Yd.oninput=="function"}rl=sl}else rl=!1;Gf=rl&&(!document.documentMode||9<document.documentMode)}function Bd(){Hs&&(Hs.detachEvent("onpropertychange",qf),ei=Hs=null)}function qf(t){if(t.propertyName==="value"&&ro(ei)){var e=[];Vf(e,ei,t,Hc(t)),Mf(By,e)}}function Uy(t,e,n){t==="focusin"?(Bd(),Hs=e,ei=n,Hs.attachEvent("onpropertychange",qf)):t==="focusout"&&Bd()}function Vy(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ro(ei)}function Gy(t,e){if(t==="click")return ro(e)}function qy(t,e){if(t==="input"||t==="change")return ro(e)}function Ky(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var _t=typeof Object.is=="function"?Object.is:Ky;function ti(t,e){if(_t(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ll.call(e,s)||!_t(t[s],e[s]))return!1}return!0}function Xd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ud(t,e){var n=Xd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Xd(n)}}function Kf(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Kf(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Qf(){for(var t=window,e=Ea();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ea(t.document)}return e}function Kc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Qy(t){var e=Qf(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Kf(n.ownerDocument.documentElement,n)){if(r!==null&&Kc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Ud(n,i);var o=Ud(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Zy=Zt&&"documentMode"in document&&11>=document.documentMode,Mr=null,Kl=null,Ws=null,Ql=!1;function Vd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ql||Mr==null||Mr!==Ea(r)||(r=Mr,"selectionStart"in r&&Kc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ws&&ti(Ws,r)||(Ws=r,r=Da(Kl,"onSelect"),0<r.length&&(e=new Vc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mr)))}function Qi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Er={animationend:Qi("Animation","AnimationEnd"),animationiteration:Qi("Animation","AnimationIteration"),animationstart:Qi("Animation","AnimationStart"),transitionend:Qi("Transition","TransitionEnd")},il={},Zf={};Zt&&(Zf=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);function so(t){if(il[t])return il[t];if(!Er[t])return t;var e=Er[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Zf)return il[t]=e[n];return t}var Jf=so("animationend"),em=so("animationiteration"),tm=so("animationstart"),nm=so("transitionend"),rm=new Map,Gd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nn(t,e){rm.set(t,e),Zn(e,[t])}for(var al=0;al<Gd.length;al++){var ol=Gd[al],Jy=ol.toLowerCase(),ev=ol[0].toUpperCase()+ol.slice(1);Nn(Jy,"on"+ev)}Nn(Jf,"onAnimationEnd");Nn(em,"onAnimationIteration");Nn(tm,"onAnimationStart");Nn("dblclick","onDoubleClick");Nn("focusin","onFocus");Nn("focusout","onBlur");Nn(nm,"onTransitionEnd");Yr("onMouseEnter",["mouseout","mouseover"]);Yr("onMouseLeave",["mouseout","mouseover"]);Yr("onPointerEnter",["pointerout","pointerover"]);Yr("onPointerLeave",["pointerout","pointerover"]);Zn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rs));function qd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Jx(r,e,void 0,t),t.currentTarget=null}function sm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;qd(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;qd(s,l,u),i=c}}}if(La)throw t=Ul,La=!1,Ul=null,t}function me(t,e){var n=e[nc];n===void 0&&(n=e[nc]=new Set);var r=t+"__bubble";n.has(r)||(im(e,t,2,!1),n.add(r))}function ll(t,e,n){var r=0;e&&(r|=4),im(n,t,r,e)}var Zi="_reactListening"+Math.random().toString(36).slice(2);function ni(t){if(!t[Zi]){t[Zi]=!0,hf.forEach(function(n){n!=="selectionchange"&&(tv.has(n)||ll(n,!1,t),ll(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zi]||(e[Zi]=!0,ll("selectionchange",!1,e))}}function im(t,e,n,r){switch(Wf(e)){case 1:var s=py;break;case 4:s=gy;break;default:s=Xc}n=s.bind(null,e,n,t),s=void 0,!Xl||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function cl(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=On(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Mf(function(){var u=i,h=Hc(n),f=[];e:{var p=rm.get(t);if(p!==void 0){var b=Vc,v=t;switch(t){case"keypress":if(xa(n)===0)break e;case"keydown":case"keyup":b=Ly;break;case"focusin":v="focus",b=nl;break;case"focusout":v="blur",b=nl;break;case"beforeblur":case"afterblur":b=nl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=Rd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=vy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=zy;break;case Jf:case em:case tm:b=ky;break;case nm:b=Dy;break;case"scroll":b=xy;break;case"wheel":b=Oy;break;case"copy":case"cut":case"paste":b=jy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=$d}var S=(e&4)!==0,j=!S&&t==="scroll",x=S?p!==null?p+"Capture":null:p;S=[];for(var g=u,y;g!==null;){y=g;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,x!==null&&(k=Ks(g,x),k!=null&&S.push(ri(g,k,y)))),j)break;g=g.return}0<S.length&&(p=new b(p,v,null,n,h),f.push({event:p,listeners:S}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",b=t==="mouseout"||t==="pointerout",p&&n!==Yl&&(v=n.relatedTarget||n.fromElement)&&(On(v)||v[Jt]))break e;if((b||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,b?(v=n.relatedTarget||n.toElement,b=u,v=v?On(v):null,v!==null&&(j=Jn(v),v!==j||v.tag!==5&&v.tag!==6)&&(v=null)):(b=null,v=u),b!==v)){if(S=Rd,k="onMouseLeave",x="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(S=$d,k="onPointerLeave",x="onPointerEnter",g="pointer"),j=b==null?p:Pr(b),y=v==null?p:Pr(v),p=new S(k,g+"leave",b,n,h),p.target=j,p.relatedTarget=y,k=null,On(h)===u&&(S=new S(x,g+"enter",v,n,h),S.target=y,S.relatedTarget=j,k=S),j=k,b&&v)t:{for(S=b,x=v,g=0,y=S;y;y=yr(y))g++;for(y=0,k=x;k;k=yr(k))y++;for(;0<g-y;)S=yr(S),g--;for(;0<y-g;)x=yr(x),y--;for(;g--;){if(S===x||x!==null&&S===x.alternate)break t;S=yr(S),x=yr(x)}S=null}else S=null;b!==null&&Kd(f,p,b,S,!1),v!==null&&j!==null&&Kd(f,j,v,S,!0)}}e:{if(p=u?Pr(u):window,b=p.nodeName&&p.nodeName.toLowerCase(),b==="select"||b==="input"&&p.type==="file")var C=Xy;else if(Wd(p))if(Gf)C=qy;else{C=Vy;var M=Uy}else(b=p.nodeName)&&b.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=Gy);if(C&&(C=C(t,u))){Vf(f,C,n,h);break e}M&&M(t,p,u),t==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&Ol(p,"number",p.value)}switch(M=u?Pr(u):window,t){case"focusin":(Wd(M)||M.contentEditable==="true")&&(Mr=M,Kl=u,Ws=null);break;case"focusout":Ws=Kl=Mr=null;break;case"mousedown":Ql=!0;break;case"contextmenu":case"mouseup":case"dragend":Ql=!1,Vd(f,n,h);break;case"selectionchange":if(Zy)break;case"keydown":case"keyup":Vd(f,n,h)}var P;if(qc)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Tr?Xf(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Bf&&n.locale!=="ko"&&(Tr||E!=="onCompositionStart"?E==="onCompositionEnd"&&Tr&&(P=Yf()):(fn=h,Uc="value"in fn?fn.value:fn.textContent,Tr=!0)),M=Da(u,E),0<M.length&&(E=new Od(E,t,null,n,h),f.push({event:E,listeners:M}),P?E.data=P:(P=Uf(n),P!==null&&(E.data=P)))),(P=Fy?Hy(t,n):Wy(t,n))&&(u=Da(u,"onBeforeInput"),0<u.length&&(h=new Od("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=P))}sm(f,e)})}function ri(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Da(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ks(t,n),i!=null&&r.unshift(ri(t,i,s)),i=Ks(t,e),i!=null&&r.push(ri(t,i,s))),t=t.return}return r}function yr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Kd(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Ks(n,i),c!=null&&o.unshift(ri(n,c,l))):s||(c=Ks(n,i),c!=null&&o.push(ri(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var nv=/\r\n?/g,rv=/\u0000|\uFFFD/g;function Qd(t){return(typeof t=="string"?t:""+t).replace(nv,`
`).replace(rv,"")}function Ji(t,e,n){if(e=Qd(e),Qd(t)!==e&&n)throw Error(L(425))}function Ra(){}var Zl=null,Jl=null;function ec(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tc=typeof setTimeout=="function"?setTimeout:void 0,sv=typeof clearTimeout=="function"?clearTimeout:void 0,Zd=typeof Promise=="function"?Promise:void 0,iv=typeof queueMicrotask=="function"?queueMicrotask:typeof Zd<"u"?function(t){return Zd.resolve(null).then(t).catch(av)}:tc;function av(t){setTimeout(function(){throw t})}function ul(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Js(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Js(e)}function yn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Jd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Zr=Math.random().toString(36).slice(2),Rt="__reactFiber$"+Zr,si="__reactProps$"+Zr,Jt="__reactContainer$"+Zr,nc="__reactEvents$"+Zr,ov="__reactListeners$"+Zr,lv="__reactHandles$"+Zr;function On(t){var e=t[Rt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Jt]||n[Rt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Jd(t);t!==null;){if(n=t[Rt])return n;t=Jd(t)}return e}t=n,n=t.parentNode}return null}function pi(t){return t=t[Rt]||t[Jt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Pr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function io(t){return t[si]||null}var rc=[],Lr=-1;function Cn(t){return{current:t}}function pe(t){0>Lr||(t.current=rc[Lr],rc[Lr]=null,Lr--)}function de(t,e){Lr++,rc[Lr]=t.current,t.current=e}var jn={},We=Cn(jn),st=Cn(!1),Bn=jn;function Br(t,e){var n=t.type.contextTypes;if(!n)return jn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function it(t){return t=t.childContextTypes,t!=null}function Oa(){pe(st),pe(We)}function eh(t,e,n){if(We.current!==jn)throw Error(L(168));de(We,e),de(st,n)}function am(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(L(108,Ux(t)||"Unknown",s));return we({},n,r)}function $a(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||jn,Bn=We.current,de(We,t),de(st,st.current),!0}function th(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=am(t,e,Bn),r.__reactInternalMemoizedMergedChildContext=t,pe(st),pe(We),de(We,t)):pe(st),de(st,n)}var Gt=null,ao=!1,dl=!1;function om(t){Gt===null?Gt=[t]:Gt.push(t)}function cv(t){ao=!0,om(t)}function Tn(){if(!dl&&Gt!==null){dl=!0;var t=0,e=ce;try{var n=Gt;for(ce=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gt=null,ao=!1}catch(s){throw Gt!==null&&(Gt=Gt.slice(t+1)),_f(Wc,Tn),s}finally{ce=e,dl=!1}}return null}var _r=[],Ir=0,Fa=null,Ha=0,yt=[],vt=0,Xn=null,qt=1,Kt="";function An(t,e){_r[Ir++]=Ha,_r[Ir++]=Fa,Fa=t,Ha=e}function lm(t,e,n){yt[vt++]=qt,yt[vt++]=Kt,yt[vt++]=Xn,Xn=t;var r=qt;t=Kt;var s=32-Pt(r)-1;r&=~(1<<s),n+=1;var i=32-Pt(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,qt=1<<32-Pt(e)+s|n<<s|r,Kt=i+t}else qt=1<<i|n<<s|r,Kt=t}function Qc(t){t.return!==null&&(An(t,1),lm(t,1,0))}function Zc(t){for(;t===Fa;)Fa=_r[--Ir],_r[Ir]=null,Ha=_r[--Ir],_r[Ir]=null;for(;t===Xn;)Xn=yt[--vt],yt[vt]=null,Kt=yt[--vt],yt[vt]=null,qt=yt[--vt],yt[vt]=null}var ft=null,ht=null,ge=!1,Et=null;function cm(t,e){var n=wt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nh(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ft=t,ht=yn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ft=t,ht=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xn!==null?{id:qt,overflow:Kt}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ft=t,ht=null,!0):!1;default:return!1}}function sc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ic(t){if(ge){var e=ht;if(e){var n=e;if(!nh(t,e)){if(sc(t))throw Error(L(418));e=yn(n.nextSibling);var r=ft;e&&nh(t,e)?cm(r,n):(t.flags=t.flags&-4097|2,ge=!1,ft=t)}}else{if(sc(t))throw Error(L(418));t.flags=t.flags&-4097|2,ge=!1,ft=t}}}function rh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ft=t}function ea(t){if(t!==ft)return!1;if(!ge)return rh(t),ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ec(t.type,t.memoizedProps)),e&&(e=ht)){if(sc(t))throw um(),Error(L(418));for(;e;)cm(t,e),e=yn(e.nextSibling)}if(rh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ht=yn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ht=null}}else ht=ft?yn(t.stateNode.nextSibling):null;return!0}function um(){for(var t=ht;t;)t=yn(t.nextSibling)}function Xr(){ht=ft=null,ge=!1}function Jc(t){Et===null?Et=[t]:Et.push(t)}var uv=nn.ReactCurrentBatchConfig;function Ts(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function ta(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sh(t){var e=t._init;return e(t._payload)}function dm(t){function e(x,g){if(t){var y=x.deletions;y===null?(x.deletions=[g],x.flags|=16):y.push(g)}}function n(x,g){if(!t)return null;for(;g!==null;)e(x,g),g=g.sibling;return null}function r(x,g){for(x=new Map;g!==null;)g.key!==null?x.set(g.key,g):x.set(g.index,g),g=g.sibling;return x}function s(x,g){return x=kn(x,g),x.index=0,x.sibling=null,x}function i(x,g,y){return x.index=y,t?(y=x.alternate,y!==null?(y=y.index,y<g?(x.flags|=2,g):y):(x.flags|=2,g)):(x.flags|=1048576,g)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,g,y,k){return g===null||g.tag!==6?(g=yl(y,x.mode,k),g.return=x,g):(g=s(g,y),g.return=x,g)}function c(x,g,y,k){var C=y.type;return C===Cr?h(x,g,y.props.children,k,y.key):g!==null&&(g.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===cn&&sh(C)===g.type)?(k=s(g,y.props),k.ref=Ts(x,g,y),k.return=x,k):(k=ja(y.type,y.key,y.props,null,x.mode,k),k.ref=Ts(x,g,y),k.return=x,k)}function u(x,g,y,k){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=vl(y,x.mode,k),g.return=x,g):(g=s(g,y.children||[]),g.return=x,g)}function h(x,g,y,k,C){return g===null||g.tag!==7?(g=Yn(y,x.mode,k,C),g.return=x,g):(g=s(g,y),g.return=x,g)}function f(x,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=yl(""+g,x.mode,y),g.return=x,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Bi:return y=ja(g.type,g.key,g.props,null,x.mode,y),y.ref=Ts(x,null,g),y.return=x,y;case Nr:return g=vl(g,x.mode,y),g.return=x,g;case cn:var k=g._init;return f(x,k(g._payload),y)}if(As(g)||ks(g))return g=Yn(g,x.mode,y,null),g.return=x,g;ta(x,g)}return null}function p(x,g,y,k){var C=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return C!==null?null:l(x,g,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Bi:return y.key===C?c(x,g,y,k):null;case Nr:return y.key===C?u(x,g,y,k):null;case cn:return C=y._init,p(x,g,C(y._payload),k)}if(As(y)||ks(y))return C!==null?null:h(x,g,y,k,null);ta(x,y)}return null}function b(x,g,y,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return x=x.get(y)||null,l(g,x,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Bi:return x=x.get(k.key===null?y:k.key)||null,c(g,x,k,C);case Nr:return x=x.get(k.key===null?y:k.key)||null,u(g,x,k,C);case cn:var M=k._init;return b(x,g,y,M(k._payload),C)}if(As(k)||ks(k))return x=x.get(y)||null,h(g,x,k,C,null);ta(g,k)}return null}function v(x,g,y,k){for(var C=null,M=null,P=g,E=g=0,$=null;P!==null&&E<y.length;E++){P.index>E?($=P,P=null):$=P.sibling;var D=p(x,P,y[E],k);if(D===null){P===null&&(P=$);break}t&&P&&D.alternate===null&&e(x,P),g=i(D,g,E),M===null?C=D:M.sibling=D,M=D,P=$}if(E===y.length)return n(x,P),ge&&An(x,E),C;if(P===null){for(;E<y.length;E++)P=f(x,y[E],k),P!==null&&(g=i(P,g,E),M===null?C=P:M.sibling=P,M=P);return ge&&An(x,E),C}for(P=r(x,P);E<y.length;E++)$=b(P,x,E,y[E],k),$!==null&&(t&&$.alternate!==null&&P.delete($.key===null?E:$.key),g=i($,g,E),M===null?C=$:M.sibling=$,M=$);return t&&P.forEach(function(G){return e(x,G)}),ge&&An(x,E),C}function S(x,g,y,k){var C=ks(y);if(typeof C!="function")throw Error(L(150));if(y=C.call(y),y==null)throw Error(L(151));for(var M=C=null,P=g,E=g=0,$=null,D=y.next();P!==null&&!D.done;E++,D=y.next()){P.index>E?($=P,P=null):$=P.sibling;var G=p(x,P,D.value,k);if(G===null){P===null&&(P=$);break}t&&P&&G.alternate===null&&e(x,P),g=i(G,g,E),M===null?C=G:M.sibling=G,M=G,P=$}if(D.done)return n(x,P),ge&&An(x,E),C;if(P===null){for(;!D.done;E++,D=y.next())D=f(x,D.value,k),D!==null&&(g=i(D,g,E),M===null?C=D:M.sibling=D,M=D);return ge&&An(x,E),C}for(P=r(x,P);!D.done;E++,D=y.next())D=b(P,x,E,D.value,k),D!==null&&(t&&D.alternate!==null&&P.delete(D.key===null?E:D.key),g=i(D,g,E),M===null?C=D:M.sibling=D,M=D);return t&&P.forEach(function(q){return e(x,q)}),ge&&An(x,E),C}function j(x,g,y,k){if(typeof y=="object"&&y!==null&&y.type===Cr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Bi:e:{for(var C=y.key,M=g;M!==null;){if(M.key===C){if(C=y.type,C===Cr){if(M.tag===7){n(x,M.sibling),g=s(M,y.props.children),g.return=x,x=g;break e}}else if(M.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===cn&&sh(C)===M.type){n(x,M.sibling),g=s(M,y.props),g.ref=Ts(x,M,y),g.return=x,x=g;break e}n(x,M);break}else e(x,M);M=M.sibling}y.type===Cr?(g=Yn(y.props.children,x.mode,k,y.key),g.return=x,x=g):(k=ja(y.type,y.key,y.props,null,x.mode,k),k.ref=Ts(x,g,y),k.return=x,x=k)}return o(x);case Nr:e:{for(M=y.key;g!==null;){if(g.key===M)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(x,g.sibling),g=s(g,y.children||[]),g.return=x,x=g;break e}else{n(x,g);break}else e(x,g);g=g.sibling}g=vl(y,x.mode,k),g.return=x,x=g}return o(x);case cn:return M=y._init,j(x,g,M(y._payload),k)}if(As(y))return v(x,g,y,k);if(ks(y))return S(x,g,y,k);ta(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(x,g.sibling),g=s(g,y),g.return=x,x=g):(n(x,g),g=yl(y,x.mode,k),g.return=x,x=g),o(x)):n(x,g)}return j}var Ur=dm(!0),hm=dm(!1),Wa=Cn(null),Ya=null,zr=null,eu=null;function tu(){eu=zr=Ya=null}function nu(t){var e=Wa.current;pe(Wa),t._currentValue=e}function ac(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Hr(t,e){Ya=t,eu=zr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rt=!0),t.firstContext=null)}function kt(t){var e=t._currentValue;if(eu!==t)if(t={context:t,memoizedValue:e,next:null},zr===null){if(Ya===null)throw Error(L(308));zr=t,Ya.dependencies={lanes:0,firstContext:t}}else zr=zr.next=t;return e}var $n=null;function ru(t){$n===null?$n=[t]:$n.push(t)}function fm(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,ru(e)):(n.next=s.next,s.next=n),e.interleaved=n,en(t,r)}function en(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var un=!1;function su(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function vn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,en(t,n)}return s=r.interleaved,s===null?(e.next=e,ru(r)):(e.next=s.next,s.next=e),r.interleaved=e,en(t,n)}function ya(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yc(t,n)}}function ih(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ba(t,e,n,r){var s=t.updateQueue;un=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,h=u=c=null,l=i;do{var p=l.lane,b=l.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:b,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,S=l;switch(p=e,b=n,S.tag){case 1:if(v=S.payload,typeof v=="function"){f=v.call(b,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=S.payload,p=typeof v=="function"?v.call(b,f,p):v,p==null)break e;f=we({},f,p);break e;case 2:un=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else b={eventTime:b,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=b,c=f):h=h.next=b,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Vn|=o,t.lanes=o,t.memoizedState=f}}function ah(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(L(191,s));s.call(r)}}}var gi={},$t=Cn(gi),ii=Cn(gi),ai=Cn(gi);function Fn(t){if(t===gi)throw Error(L(174));return t}function iu(t,e){switch(de(ai,e),de(ii,t),de($t,gi),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fl(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fl(e,t)}pe($t),de($t,e)}function Vr(){pe($t),pe(ii),pe(ai)}function pm(t){Fn(ai.current);var e=Fn($t.current),n=Fl(e,t.type);e!==n&&(de(ii,t),de($t,n))}function au(t){ii.current===t&&(pe($t),pe(ii))}var ye=Cn(0);function Xa(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hl=[];function ou(){for(var t=0;t<hl.length;t++)hl[t]._workInProgressVersionPrimary=null;hl.length=0}var va=nn.ReactCurrentDispatcher,fl=nn.ReactCurrentBatchConfig,Un=0,ve=null,Pe=null,_e=null,Ua=!1,Ys=!1,oi=0,dv=0;function $e(){throw Error(L(321))}function lu(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!_t(t[n],e[n]))return!1;return!0}function cu(t,e,n,r,s,i){if(Un=i,ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,va.current=t===null||t.memoizedState===null?pv:gv,t=n(r,s),Ys){i=0;do{if(Ys=!1,oi=0,25<=i)throw Error(L(301));i+=1,_e=Pe=null,e.updateQueue=null,va.current=xv,t=n(r,s)}while(Ys)}if(va.current=Va,e=Pe!==null&&Pe.next!==null,Un=0,_e=Pe=ve=null,Ua=!1,e)throw Error(L(300));return t}function uu(){var t=oi!==0;return oi=0,t}function Dt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _e===null?ve.memoizedState=_e=t:_e=_e.next=t,_e}function St(){if(Pe===null){var t=ve.alternate;t=t!==null?t.memoizedState:null}else t=Pe.next;var e=_e===null?ve.memoizedState:_e.next;if(e!==null)_e=e,Pe=t;else{if(t===null)throw Error(L(310));Pe=t,t={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},_e===null?ve.memoizedState=_e=t:_e=_e.next=t}return _e}function li(t,e){return typeof e=="function"?e(t):e}function ml(t){var e=St(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=Pe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var h=u.lane;if((Un&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=r):c=c.next=f,ve.lanes|=h,Vn|=h}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,_t(r,e.memoizedState)||(rt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ve.lanes|=i,Vn|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function pl(t){var e=St(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);_t(i,e.memoizedState)||(rt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function gm(){}function xm(t,e){var n=ve,r=St(),s=e(),i=!_t(r.memoizedState,s);if(i&&(r.memoizedState=s,rt=!0),r=r.queue,du(wm.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||_e!==null&&_e.memoizedState.tag&1){if(n.flags|=2048,ci(9,vm.bind(null,n,r,s,e),void 0,null),Ie===null)throw Error(L(349));Un&30||ym(n,e,s)}return s}function ym(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function vm(t,e,n,r){e.value=n,e.getSnapshot=r,bm(e)&&km(t)}function wm(t,e,n){return n(function(){bm(e)&&km(t)})}function bm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!_t(t,n)}catch{return!0}}function km(t){var e=en(t,1);e!==null&&Lt(e,t,1,-1)}function oh(t){var e=Dt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:t},e.queue=t,t=t.dispatch=mv.bind(null,ve,t),[e.memoizedState,t]}function ci(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Sm(){return St().memoizedState}function wa(t,e,n,r){var s=Dt();ve.flags|=t,s.memoizedState=ci(1|e,n,void 0,r===void 0?null:r)}function oo(t,e,n,r){var s=St();r=r===void 0?null:r;var i=void 0;if(Pe!==null){var o=Pe.memoizedState;if(i=o.destroy,r!==null&&lu(r,o.deps)){s.memoizedState=ci(e,n,i,r);return}}ve.flags|=t,s.memoizedState=ci(1|e,n,i,r)}function lh(t,e){return wa(8390656,8,t,e)}function du(t,e){return oo(2048,8,t,e)}function jm(t,e){return oo(4,2,t,e)}function Nm(t,e){return oo(4,4,t,e)}function Cm(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Tm(t,e,n){return n=n!=null?n.concat([t]):null,oo(4,4,Cm.bind(null,e,t),n)}function hu(){}function Mm(t,e){var n=St();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lu(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Em(t,e){var n=St();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lu(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Pm(t,e,n){return Un&21?(_t(n,e)||(n=Af(),ve.lanes|=n,Vn|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rt=!0),t.memoizedState=n)}function hv(t,e){var n=ce;ce=n!==0&&4>n?n:4,t(!0);var r=fl.transition;fl.transition={};try{t(!1),e()}finally{ce=n,fl.transition=r}}function Lm(){return St().memoizedState}function fv(t,e,n){var r=bn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_m(t))Im(e,n);else if(n=fm(t,e,n,r),n!==null){var s=Ve();Lt(n,t,r,s),zm(n,e,r)}}function mv(t,e,n){var r=bn(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_m(t))Im(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,_t(l,o)){var c=e.interleaved;c===null?(s.next=s,ru(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=fm(t,e,s,r),n!==null&&(s=Ve(),Lt(n,t,r,s),zm(n,e,r))}}function _m(t){var e=t.alternate;return t===ve||e!==null&&e===ve}function Im(t,e){Ys=Ua=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zm(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yc(t,n)}}var Va={readContext:kt,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useInsertionEffect:$e,useLayoutEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useDeferredValue:$e,useTransition:$e,useMutableSource:$e,useSyncExternalStore:$e,useId:$e,unstable_isNewReconciler:!1},pv={readContext:kt,useCallback:function(t,e){return Dt().memoizedState=[t,e===void 0?null:e],t},useContext:kt,useEffect:lh,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wa(4194308,4,Cm.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wa(4194308,4,t,e)},useInsertionEffect:function(t,e){return wa(4,2,t,e)},useMemo:function(t,e){var n=Dt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Dt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=fv.bind(null,ve,t),[r.memoizedState,t]},useRef:function(t){var e=Dt();return t={current:t},e.memoizedState=t},useState:oh,useDebugValue:hu,useDeferredValue:function(t){return Dt().memoizedState=t},useTransition:function(){var t=oh(!1),e=t[0];return t=hv.bind(null,t[1]),Dt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ve,s=Dt();if(ge){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),Ie===null)throw Error(L(349));Un&30||ym(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,lh(wm.bind(null,r,i,t),[t]),r.flags|=2048,ci(9,vm.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Dt(),e=Ie.identifierPrefix;if(ge){var n=Kt,r=qt;n=(r&~(1<<32-Pt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=oi++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=dv++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gv={readContext:kt,useCallback:Mm,useContext:kt,useEffect:du,useImperativeHandle:Tm,useInsertionEffect:jm,useLayoutEffect:Nm,useMemo:Em,useReducer:ml,useRef:Sm,useState:function(){return ml(li)},useDebugValue:hu,useDeferredValue:function(t){var e=St();return Pm(e,Pe.memoizedState,t)},useTransition:function(){var t=ml(li)[0],e=St().memoizedState;return[t,e]},useMutableSource:gm,useSyncExternalStore:xm,useId:Lm,unstable_isNewReconciler:!1},xv={readContext:kt,useCallback:Mm,useContext:kt,useEffect:du,useImperativeHandle:Tm,useInsertionEffect:jm,useLayoutEffect:Nm,useMemo:Em,useReducer:pl,useRef:Sm,useState:function(){return pl(li)},useDebugValue:hu,useDeferredValue:function(t){var e=St();return Pe===null?e.memoizedState=t:Pm(e,Pe.memoizedState,t)},useTransition:function(){var t=pl(li)[0],e=St().memoizedState;return[t,e]},useMutableSource:gm,useSyncExternalStore:xm,useId:Lm,unstable_isNewReconciler:!1};function Tt(t,e){if(t&&t.defaultProps){e=we({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function oc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:we({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var lo={isMounted:function(t){return(t=t._reactInternals)?Jn(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ve(),s=bn(t),i=Qt(r,s);i.payload=e,n!=null&&(i.callback=n),e=vn(t,i,s),e!==null&&(Lt(e,t,s,r),ya(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ve(),s=bn(t),i=Qt(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=vn(t,i,s),e!==null&&(Lt(e,t,s,r),ya(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ve(),r=bn(t),s=Qt(n,r);s.tag=2,e!=null&&(s.callback=e),e=vn(t,s,r),e!==null&&(Lt(e,t,r,n),ya(e,t,r))}};function ch(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!ti(n,r)||!ti(s,i):!0}function Am(t,e,n){var r=!1,s=jn,i=e.contextType;return typeof i=="object"&&i!==null?i=kt(i):(s=it(e)?Bn:We.current,r=e.contextTypes,i=(r=r!=null)?Br(t,s):jn),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=lo,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function uh(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&lo.enqueueReplaceState(e,e.state,null)}function lc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},su(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=kt(i):(i=it(e)?Bn:We.current,s.context=Br(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(oc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&lo.enqueueReplaceState(s,s.state,null),Ba(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Gr(t,e){try{var n="",r=e;do n+=Xx(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function gl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function cc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var yv=typeof WeakMap=="function"?WeakMap:Map;function Dm(t,e,n){n=Qt(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){qa||(qa=!0,vc=r),cc(t,e)},n}function Rm(t,e,n){n=Qt(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){cc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){cc(t,e),typeof r!="function"&&(wn===null?wn=new Set([this]):wn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dh(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new yv;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=_v.bind(null,t,e,n),e.then(t,t))}function hh(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fh(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qt(-1,1),e.tag=2,vn(n,e,1))),n.lanes|=1),t)}var vv=nn.ReactCurrentOwner,rt=!1;function Ue(t,e,n,r){e.child=t===null?hm(e,null,n,r):Ur(e,t.child,n,r)}function mh(t,e,n,r,s){n=n.render;var i=e.ref;return Hr(e,s),r=cu(t,e,n,r,i,s),n=uu(),t!==null&&!rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tn(t,e,s)):(ge&&n&&Qc(e),e.flags|=1,Ue(t,e,r,s),e.child)}function ph(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!wu(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Om(t,e,i,r,s)):(t=ja(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ti,n(o,r)&&t.ref===e.ref)return tn(t,e,s)}return e.flags|=1,t=kn(i,r),t.ref=e.ref,t.return=e,e.child=t}function Om(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(ti(i,r)&&t.ref===e.ref)if(rt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(rt=!0);else return e.lanes=t.lanes,tn(t,e,s)}return uc(t,e,n,r,s)}function $m(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},de(Dr,ut),ut|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,de(Dr,ut),ut|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,de(Dr,ut),ut|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,de(Dr,ut),ut|=r;return Ue(t,e,s,n),e.child}function Fm(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function uc(t,e,n,r,s){var i=it(n)?Bn:We.current;return i=Br(e,i),Hr(e,s),n=cu(t,e,n,r,i,s),r=uu(),t!==null&&!rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tn(t,e,s)):(ge&&r&&Qc(e),e.flags|=1,Ue(t,e,n,s),e.child)}function gh(t,e,n,r,s){if(it(n)){var i=!0;$a(e)}else i=!1;if(Hr(e,s),e.stateNode===null)ba(t,e),Am(e,n,r),lc(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=kt(u):(u=it(n)?Bn:We.current,u=Br(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&uh(e,o,r,u),un=!1;var p=e.memoizedState;o.state=p,Ba(e,r,o,s),c=e.memoizedState,l!==r||p!==c||st.current||un?(typeof h=="function"&&(oc(e,n,h,r),c=e.memoizedState),(l=un||ch(e,n,l,r,p,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,mm(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Tt(e.type,l),o.props=u,f=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=kt(c):(c=it(n)?Bn:We.current,c=Br(e,c));var b=n.getDerivedStateFromProps;(h=typeof b=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&uh(e,o,r,c),un=!1,p=e.memoizedState,o.state=p,Ba(e,r,o,s);var v=e.memoizedState;l!==f||p!==v||st.current||un?(typeof b=="function"&&(oc(e,n,b,r),v=e.memoizedState),(u=un||ch(e,n,u,r,p,v,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return dc(t,e,n,r,i,s)}function dc(t,e,n,r,s,i){Fm(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&th(e,n,!1),tn(t,e,i);r=e.stateNode,vv.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ur(e,t.child,null,i),e.child=Ur(e,null,l,i)):Ue(t,e,l,i),e.memoizedState=r.state,s&&th(e,n,!0),e.child}function Hm(t){var e=t.stateNode;e.pendingContext?eh(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eh(t,e.context,!1),iu(t,e.containerInfo)}function xh(t,e,n,r,s){return Xr(),Jc(s),e.flags|=256,Ue(t,e,n,r),e.child}var hc={dehydrated:null,treeContext:null,retryLane:0};function fc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Wm(t,e,n){var r=e.pendingProps,s=ye.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),de(ye,s&1),t===null)return ic(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ho(o,r,0,null),t=Yn(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=fc(n),e.memoizedState=hc,t):fu(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return wv(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=kn(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=kn(l,i):(i=Yn(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?fc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=hc,r}return i=t.child,t=i.sibling,r=kn(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function fu(t,e){return e=ho({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function na(t,e,n,r){return r!==null&&Jc(r),Ur(e,t.child,null,n),t=fu(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function wv(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=gl(Error(L(422))),na(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=ho({mode:"visible",children:r.children},s,0,null),i=Yn(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ur(e,t.child,null,o),e.child.memoizedState=fc(o),e.memoizedState=hc,i);if(!(e.mode&1))return na(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(L(419)),r=gl(i,r,void 0),na(t,e,o,r)}if(l=(o&t.childLanes)!==0,rt||l){if(r=Ie,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,en(t,s),Lt(r,t,s,-1))}return vu(),r=gl(Error(L(421))),na(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Iv.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,ht=yn(s.nextSibling),ft=e,ge=!0,Et=null,t!==null&&(yt[vt++]=qt,yt[vt++]=Kt,yt[vt++]=Xn,qt=t.id,Kt=t.overflow,Xn=e),e=fu(e,r.children),e.flags|=4096,e)}function yh(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ac(t.return,e,n)}function xl(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Ym(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ue(t,e,r.children,n),r=ye.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yh(t,n,e);else if(t.tag===19)yh(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(de(ye,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Xa(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),xl(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Xa(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}xl(e,!0,n,null,i);break;case"together":xl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ba(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function tn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Vn|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=kn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=kn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function bv(t,e,n){switch(e.tag){case 3:Hm(e),Xr();break;case 5:pm(e);break;case 1:it(e.type)&&$a(e);break;case 4:iu(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;de(Wa,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(de(ye,ye.current&1),e.flags|=128,null):n&e.child.childLanes?Wm(t,e,n):(de(ye,ye.current&1),t=tn(t,e,n),t!==null?t.sibling:null);de(ye,ye.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Ym(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),de(ye,ye.current),r)break;return null;case 22:case 23:return e.lanes=0,$m(t,e,n)}return tn(t,e,n)}var Bm,mc,Xm,Um;Bm=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};mc=function(){};Xm=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Fn($t.current);var i=null;switch(n){case"input":s=Dl(t,s),r=Dl(t,r),i=[];break;case"select":s=we({},s,{value:void 0}),r=we({},r,{value:void 0}),i=[];break;case"textarea":s=$l(t,s),r=$l(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ra)}Hl(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Gs.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Gs.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&me("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};Um=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ms(t,e){if(!ge)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Fe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function kv(t,e,n){var r=e.pendingProps;switch(Zc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fe(e),null;case 1:return it(e.type)&&Oa(),Fe(e),null;case 3:return r=e.stateNode,Vr(),pe(st),pe(We),ou(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ea(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Et!==null&&(kc(Et),Et=null))),mc(t,e),Fe(e),null;case 5:au(e);var s=Fn(ai.current);if(n=e.type,t!==null&&e.stateNode!=null)Xm(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return Fe(e),null}if(t=Fn($t.current),ea(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Rt]=e,r[si]=i,t=(e.mode&1)!==0,n){case"dialog":me("cancel",r),me("close",r);break;case"iframe":case"object":case"embed":me("load",r);break;case"video":case"audio":for(s=0;s<Rs.length;s++)me(Rs[s],r);break;case"source":me("error",r);break;case"img":case"image":case"link":me("error",r),me("load",r);break;case"details":me("toggle",r);break;case"input":Td(r,i),me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},me("invalid",r);break;case"textarea":Ed(r,i),me("invalid",r)}Hl(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ji(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ji(r.textContent,l,t),s=["children",""+l]):Gs.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&me("scroll",r)}switch(n){case"input":Xi(r),Md(r,i,!0);break;case"textarea":Xi(r),Pd(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ra)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wf(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Rt]=e,t[si]=r,Bm(t,e,!1,!1),e.stateNode=t;e:{switch(o=Wl(n,r),n){case"dialog":me("cancel",t),me("close",t),s=r;break;case"iframe":case"object":case"embed":me("load",t),s=r;break;case"video":case"audio":for(s=0;s<Rs.length;s++)me(Rs[s],t);s=r;break;case"source":me("error",t),s=r;break;case"img":case"image":case"link":me("error",t),me("load",t),s=r;break;case"details":me("toggle",t),s=r;break;case"input":Td(t,r),s=Dl(t,r),me("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=we({},r,{value:void 0}),me("invalid",t);break;case"textarea":Ed(t,r),s=$l(t,r),me("invalid",t);break;default:s=r}Hl(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Sf(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&bf(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&qs(t,c):typeof c=="number"&&qs(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Gs.hasOwnProperty(i)?c!=null&&i==="onScroll"&&me("scroll",t):c!=null&&Rc(t,i,c,o))}switch(n){case"input":Xi(t),Md(t,r,!1);break;case"textarea":Xi(t),Pd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Sn(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Rr(t,!!r.multiple,i,!1):r.defaultValue!=null&&Rr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ra)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fe(e),null;case 6:if(t&&e.stateNode!=null)Um(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=Fn(ai.current),Fn($t.current),ea(e)){if(r=e.stateNode,n=e.memoizedProps,r[Rt]=e,(i=r.nodeValue!==n)&&(t=ft,t!==null))switch(t.tag){case 3:Ji(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ji(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Rt]=e,e.stateNode=r}return Fe(e),null;case 13:if(pe(ye),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ge&&ht!==null&&e.mode&1&&!(e.flags&128))um(),Xr(),e.flags|=98560,i=!1;else if(i=ea(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(L(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(L(317));i[Rt]=e}else Xr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fe(e),i=!1}else Et!==null&&(kc(Et),Et=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ye.current&1?Le===0&&(Le=3):vu())),e.updateQueue!==null&&(e.flags|=4),Fe(e),null);case 4:return Vr(),mc(t,e),t===null&&ni(e.stateNode.containerInfo),Fe(e),null;case 10:return nu(e.type._context),Fe(e),null;case 17:return it(e.type)&&Oa(),Fe(e),null;case 19:if(pe(ye),i=e.memoizedState,i===null)return Fe(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ms(i,!1);else{if(Le!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Xa(t),o!==null){for(e.flags|=128,Ms(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return de(ye,ye.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ce()>qr&&(e.flags|=128,r=!0,Ms(i,!1),e.lanes=4194304)}else{if(!r)if(t=Xa(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ms(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ge)return Fe(e),null}else 2*Ce()-i.renderingStartTime>qr&&n!==1073741824&&(e.flags|=128,r=!0,Ms(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ce(),e.sibling=null,n=ye.current,de(ye,r?n&1|2:n&1),e):(Fe(e),null);case 22:case 23:return yu(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ut&1073741824&&(Fe(e),e.subtreeFlags&6&&(e.flags|=8192)):Fe(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function Sv(t,e){switch(Zc(e),e.tag){case 1:return it(e.type)&&Oa(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vr(),pe(st),pe(We),ou(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return au(e),null;case 13:if(pe(ye),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Xr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pe(ye),null;case 4:return Vr(),null;case 10:return nu(e.type._context),null;case 22:case 23:return yu(),null;case 24:return null;default:return null}}var ra=!1,He=!1,jv=typeof WeakSet=="function"?WeakSet:Set,O=null;function Ar(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ke(t,e,r)}else n.current=null}function pc(t,e,n){try{n()}catch(r){ke(t,e,r)}}var vh=!1;function Nv(t,e){if(Zl=za,t=Qf(),Kc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=t,p=null;t:for(;;){for(var b;f!==n||s!==0&&f.nodeType!==3||(l=o+s),f!==i||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(b=f.firstChild)!==null;)p=f,f=b;for(;;){if(f===t)break t;if(p===n&&++u===s&&(l=o),p===i&&++h===r&&(c=o),(b=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=b}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jl={focusedElem:t,selectionRange:n},za=!1,O=e;O!==null;)if(e=O,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,O=t;else for(;O!==null;){e=O;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var S=v.memoizedProps,j=v.memoizedState,x=e.stateNode,g=x.getSnapshotBeforeUpdate(e.elementType===e.type?S:Tt(e.type,S),j);x.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(k){ke(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,O=t;break}O=e.return}return v=vh,vh=!1,v}function Bs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&pc(e,n,i)}s=s.next}while(s!==r)}}function co(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Vm(t){var e=t.alternate;e!==null&&(t.alternate=null,Vm(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rt],delete e[si],delete e[nc],delete e[ov],delete e[lv])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Gm(t){return t.tag===5||t.tag===3||t.tag===4}function wh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gm(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ra));else if(r!==4&&(t=t.child,t!==null))for(xc(t,e,n),t=t.sibling;t!==null;)xc(t,e,n),t=t.sibling}function yc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(yc(t,e,n),t=t.sibling;t!==null;)yc(t,e,n),t=t.sibling}var De=null,Mt=!1;function on(t,e,n){for(n=n.child;n!==null;)qm(t,e,n),n=n.sibling}function qm(t,e,n){if(Ot&&typeof Ot.onCommitFiberUnmount=="function")try{Ot.onCommitFiberUnmount(to,n)}catch{}switch(n.tag){case 5:He||Ar(n,e);case 6:var r=De,s=Mt;De=null,on(t,e,n),De=r,Mt=s,De!==null&&(Mt?(t=De,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):De.removeChild(n.stateNode));break;case 18:De!==null&&(Mt?(t=De,n=n.stateNode,t.nodeType===8?ul(t.parentNode,n):t.nodeType===1&&ul(t,n),Js(t)):ul(De,n.stateNode));break;case 4:r=De,s=Mt,De=n.stateNode.containerInfo,Mt=!0,on(t,e,n),De=r,Mt=s;break;case 0:case 11:case 14:case 15:if(!He&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&pc(n,e,o),s=s.next}while(s!==r)}on(t,e,n);break;case 1:if(!He&&(Ar(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ke(n,e,l)}on(t,e,n);break;case 21:on(t,e,n);break;case 22:n.mode&1?(He=(r=He)||n.memoizedState!==null,on(t,e,n),He=r):on(t,e,n);break;default:on(t,e,n)}}function bh(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new jv),e.forEach(function(r){var s=zv.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Nt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:De=l.stateNode,Mt=!1;break e;case 3:De=l.stateNode.containerInfo,Mt=!0;break e;case 4:De=l.stateNode.containerInfo,Mt=!0;break e}l=l.return}if(De===null)throw Error(L(160));qm(i,o,s),De=null,Mt=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){ke(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Km(e,t),e=e.sibling}function Km(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Nt(e,t),At(t),r&4){try{Bs(3,t,t.return),co(3,t)}catch(S){ke(t,t.return,S)}try{Bs(5,t,t.return)}catch(S){ke(t,t.return,S)}}break;case 1:Nt(e,t),At(t),r&512&&n!==null&&Ar(n,n.return);break;case 5:if(Nt(e,t),At(t),r&512&&n!==null&&Ar(n,n.return),t.flags&32){var s=t.stateNode;try{qs(s,"")}catch(S){ke(t,t.return,S)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&yf(s,i),Wl(l,o);var u=Wl(l,i);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?Sf(s,f):h==="dangerouslySetInnerHTML"?bf(s,f):h==="children"?qs(s,f):Rc(s,h,f,u)}switch(l){case"input":Rl(s,i);break;case"textarea":vf(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var b=i.value;b!=null?Rr(s,!!i.multiple,b,!1):p!==!!i.multiple&&(i.defaultValue!=null?Rr(s,!!i.multiple,i.defaultValue,!0):Rr(s,!!i.multiple,i.multiple?[]:"",!1))}s[si]=i}catch(S){ke(t,t.return,S)}}break;case 6:if(Nt(e,t),At(t),r&4){if(t.stateNode===null)throw Error(L(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(S){ke(t,t.return,S)}}break;case 3:if(Nt(e,t),At(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Js(e.containerInfo)}catch(S){ke(t,t.return,S)}break;case 4:Nt(e,t),At(t);break;case 13:Nt(e,t),At(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(gu=Ce())),r&4&&bh(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(He=(u=He)||h,Nt(e,t),He=u):Nt(e,t),At(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(O=t,h=t.child;h!==null;){for(f=O=h;O!==null;){switch(p=O,b=p.child,p.tag){case 0:case 11:case 14:case 15:Bs(4,p,p.return);break;case 1:Ar(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(S){ke(r,n,S)}}break;case 5:Ar(p,p.return);break;case 22:if(p.memoizedState!==null){Sh(f);continue}}b!==null?(b.return=p,O=b):Sh(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=kf("display",o))}catch(S){ke(t,t.return,S)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(S){ke(t,t.return,S)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Nt(e,t),At(t),r&4&&bh(t);break;case 21:break;default:Nt(e,t),At(t)}}function At(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Gm(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(qs(s,""),r.flags&=-33);var i=wh(t);yc(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=wh(t);xc(t,l,o);break;default:throw Error(L(161))}}catch(c){ke(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Cv(t,e,n){O=t,Qm(t)}function Qm(t,e,n){for(var r=(t.mode&1)!==0;O!==null;){var s=O,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ra;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||He;l=ra;var u=He;if(ra=o,(He=c)&&!u)for(O=s;O!==null;)o=O,c=o.child,o.tag===22&&o.memoizedState!==null?jh(s):c!==null?(c.return=o,O=c):jh(s);for(;i!==null;)O=i,Qm(i),i=i.sibling;O=s,ra=l,He=u}kh(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,O=i):kh(t)}}function kh(t){for(;O!==null;){var e=O;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:He||co(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!He)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Tt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ah(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ah(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Js(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}He||e.flags&512&&gc(e)}catch(p){ke(e,e.return,p)}}if(e===t){O=null;break}if(n=e.sibling,n!==null){n.return=e.return,O=n;break}O=e.return}}function Sh(t){for(;O!==null;){var e=O;if(e===t){O=null;break}var n=e.sibling;if(n!==null){n.return=e.return,O=n;break}O=e.return}}function jh(t){for(;O!==null;){var e=O;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{co(4,e)}catch(c){ke(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ke(e,s,c)}}var i=e.return;try{gc(e)}catch(c){ke(e,i,c)}break;case 5:var o=e.return;try{gc(e)}catch(c){ke(e,o,c)}}}catch(c){ke(e,e.return,c)}if(e===t){O=null;break}var l=e.sibling;if(l!==null){l.return=e.return,O=l;break}O=e.return}}var Tv=Math.ceil,Ga=nn.ReactCurrentDispatcher,mu=nn.ReactCurrentOwner,bt=nn.ReactCurrentBatchConfig,re=0,Ie=null,Me=null,Re=0,ut=0,Dr=Cn(0),Le=0,ui=null,Vn=0,uo=0,pu=0,Xs=null,nt=null,gu=0,qr=1/0,Vt=null,qa=!1,vc=null,wn=null,sa=!1,mn=null,Ka=0,Us=0,wc=null,ka=-1,Sa=0;function Ve(){return re&6?Ce():ka!==-1?ka:ka=Ce()}function bn(t){return t.mode&1?re&2&&Re!==0?Re&-Re:uv.transition!==null?(Sa===0&&(Sa=Af()),Sa):(t=ce,t!==0||(t=window.event,t=t===void 0?16:Wf(t.type)),t):1}function Lt(t,e,n,r){if(50<Us)throw Us=0,wc=null,Error(L(185));fi(t,n,r),(!(re&2)||t!==Ie)&&(t===Ie&&(!(re&2)&&(uo|=n),Le===4&&hn(t,Re)),at(t,r),n===1&&re===0&&!(e.mode&1)&&(qr=Ce()+500,ao&&Tn()))}function at(t,e){var n=t.callbackNode;uy(t,e);var r=Ia(t,t===Ie?Re:0);if(r===0)n!==null&&Id(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Id(n),e===1)t.tag===0?cv(Nh.bind(null,t)):om(Nh.bind(null,t)),iv(function(){!(re&6)&&Tn()}),n=null;else{switch(Df(r)){case 1:n=Wc;break;case 4:n=If;break;case 16:n=_a;break;case 536870912:n=zf;break;default:n=_a}n=ip(n,Zm.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Zm(t,e){if(ka=-1,Sa=0,re&6)throw Error(L(327));var n=t.callbackNode;if(Wr()&&t.callbackNode!==n)return null;var r=Ia(t,t===Ie?Re:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Qa(t,r);else{e=r;var s=re;re|=2;var i=ep();(Ie!==t||Re!==e)&&(Vt=null,qr=Ce()+500,Wn(t,e));do try{Pv();break}catch(l){Jm(t,l)}while(!0);tu(),Ga.current=i,re=s,Me!==null?e=0:(Ie=null,Re=0,e=Le)}if(e!==0){if(e===2&&(s=Vl(t),s!==0&&(r=s,e=bc(t,s))),e===1)throw n=ui,Wn(t,0),hn(t,r),at(t,Ce()),n;if(e===6)hn(t,r);else{if(s=t.current.alternate,!(r&30)&&!Mv(s)&&(e=Qa(t,r),e===2&&(i=Vl(t),i!==0&&(r=i,e=bc(t,i))),e===1))throw n=ui,Wn(t,0),hn(t,r),at(t,Ce()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:Dn(t,nt,Vt);break;case 3:if(hn(t,r),(r&130023424)===r&&(e=gu+500-Ce(),10<e)){if(Ia(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ve(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=tc(Dn.bind(null,t,nt,Vt),e);break}Dn(t,nt,Vt);break;case 4:if(hn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Pt(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ce()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tv(r/1960))-r,10<r){t.timeoutHandle=tc(Dn.bind(null,t,nt,Vt),r);break}Dn(t,nt,Vt);break;case 5:Dn(t,nt,Vt);break;default:throw Error(L(329))}}}return at(t,Ce()),t.callbackNode===n?Zm.bind(null,t):null}function bc(t,e){var n=Xs;return t.current.memoizedState.isDehydrated&&(Wn(t,e).flags|=256),t=Qa(t,e),t!==2&&(e=nt,nt=n,e!==null&&kc(e)),t}function kc(t){nt===null?nt=t:nt.push.apply(nt,t)}function Mv(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!_t(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function hn(t,e){for(e&=~pu,e&=~uo,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pt(e),r=1<<n;t[n]=-1,e&=~r}}function Nh(t){if(re&6)throw Error(L(327));Wr();var e=Ia(t,0);if(!(e&1))return at(t,Ce()),null;var n=Qa(t,e);if(t.tag!==0&&n===2){var r=Vl(t);r!==0&&(e=r,n=bc(t,r))}if(n===1)throw n=ui,Wn(t,0),hn(t,e),at(t,Ce()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Dn(t,nt,Vt),at(t,Ce()),null}function xu(t,e){var n=re;re|=1;try{return t(e)}finally{re=n,re===0&&(qr=Ce()+500,ao&&Tn())}}function Gn(t){mn!==null&&mn.tag===0&&!(re&6)&&Wr();var e=re;re|=1;var n=bt.transition,r=ce;try{if(bt.transition=null,ce=1,t)return t()}finally{ce=r,bt.transition=n,re=e,!(re&6)&&Tn()}}function yu(){ut=Dr.current,pe(Dr)}function Wn(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,sv(n)),Me!==null)for(n=Me.return;n!==null;){var r=n;switch(Zc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Oa();break;case 3:Vr(),pe(st),pe(We),ou();break;case 5:au(r);break;case 4:Vr();break;case 13:pe(ye);break;case 19:pe(ye);break;case 10:nu(r.type._context);break;case 22:case 23:yu()}n=n.return}if(Ie=t,Me=t=kn(t.current,null),Re=ut=e,Le=0,ui=null,pu=uo=Vn=0,nt=Xs=null,$n!==null){for(e=0;e<$n.length;e++)if(n=$n[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}$n=null}return t}function Jm(t,e){do{var n=Me;try{if(tu(),va.current=Va,Ua){for(var r=ve.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ua=!1}if(Un=0,_e=Pe=ve=null,Ys=!1,oi=0,mu.current=null,n===null||n.return===null){Le=1,ui=e,Me=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Re,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var b=hh(o);if(b!==null){b.flags&=-257,fh(b,o,l,i,e),b.mode&1&&dh(i,u,e),e=b,c=u;var v=e.updateQueue;if(v===null){var S=new Set;S.add(c),e.updateQueue=S}else v.add(c);break e}else{if(!(e&1)){dh(i,u,e),vu();break e}c=Error(L(426))}}else if(ge&&l.mode&1){var j=hh(o);if(j!==null){!(j.flags&65536)&&(j.flags|=256),fh(j,o,l,i,e),Jc(Gr(c,l));break e}}i=c=Gr(c,l),Le!==4&&(Le=2),Xs===null?Xs=[i]:Xs.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=Dm(i,c,e);ih(i,x);break e;case 1:l=c;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(wn===null||!wn.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=Rm(i,l,e);ih(i,k);break e}}i=i.return}while(i!==null)}np(n)}catch(C){e=C,Me===n&&n!==null&&(Me=n=n.return);continue}break}while(!0)}function ep(){var t=Ga.current;return Ga.current=Va,t===null?Va:t}function vu(){(Le===0||Le===3||Le===2)&&(Le=4),Ie===null||!(Vn&268435455)&&!(uo&268435455)||hn(Ie,Re)}function Qa(t,e){var n=re;re|=2;var r=ep();(Ie!==t||Re!==e)&&(Vt=null,Wn(t,e));do try{Ev();break}catch(s){Jm(t,s)}while(!0);if(tu(),re=n,Ga.current=r,Me!==null)throw Error(L(261));return Ie=null,Re=0,Le}function Ev(){for(;Me!==null;)tp(Me)}function Pv(){for(;Me!==null&&!ty();)tp(Me)}function tp(t){var e=sp(t.alternate,t,ut);t.memoizedProps=t.pendingProps,e===null?np(t):Me=e,mu.current=null}function np(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Sv(n,e),n!==null){n.flags&=32767,Me=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Le=6,Me=null;return}}else if(n=kv(n,e,ut),n!==null){Me=n;return}if(e=e.sibling,e!==null){Me=e;return}Me=e=t}while(e!==null);Le===0&&(Le=5)}function Dn(t,e,n){var r=ce,s=bt.transition;try{bt.transition=null,ce=1,Lv(t,e,n,r)}finally{bt.transition=s,ce=r}return null}function Lv(t,e,n,r){do Wr();while(mn!==null);if(re&6)throw Error(L(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(dy(t,i),t===Ie&&(Me=Ie=null,Re=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||sa||(sa=!0,ip(_a,function(){return Wr(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=bt.transition,bt.transition=null;var o=ce;ce=1;var l=re;re|=4,mu.current=null,Nv(t,n),Km(n,t),Qy(Jl),za=!!Zl,Jl=Zl=null,t.current=n,Cv(n),ny(),re=l,ce=o,bt.transition=i}else t.current=n;if(sa&&(sa=!1,mn=t,Ka=s),i=t.pendingLanes,i===0&&(wn=null),iy(n.stateNode),at(t,Ce()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qa)throw qa=!1,t=vc,vc=null,t;return Ka&1&&t.tag!==0&&Wr(),i=t.pendingLanes,i&1?t===wc?Us++:(Us=0,wc=t):Us=0,Tn(),null}function Wr(){if(mn!==null){var t=Df(Ka),e=bt.transition,n=ce;try{if(bt.transition=null,ce=16>t?16:t,mn===null)var r=!1;else{if(t=mn,mn=null,Ka=0,re&6)throw Error(L(331));var s=re;for(re|=4,O=t.current;O!==null;){var i=O,o=i.child;if(O.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(O=u;O!==null;){var h=O;switch(h.tag){case 0:case 11:case 15:Bs(8,h,i)}var f=h.child;if(f!==null)f.return=h,O=f;else for(;O!==null;){h=O;var p=h.sibling,b=h.return;if(Vm(h),h===u){O=null;break}if(p!==null){p.return=b,O=p;break}O=b}}}var v=i.alternate;if(v!==null){var S=v.child;if(S!==null){v.child=null;do{var j=S.sibling;S.sibling=null,S=j}while(S!==null)}}O=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,O=o;else e:for(;O!==null;){if(i=O,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Bs(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,O=x;break e}O=i.return}}var g=t.current;for(O=g;O!==null;){o=O;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,O=y;else e:for(o=g;O!==null;){if(l=O,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:co(9,l)}}catch(C){ke(l,l.return,C)}if(l===o){O=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,O=k;break e}O=l.return}}if(re=s,Tn(),Ot&&typeof Ot.onPostCommitFiberRoot=="function")try{Ot.onPostCommitFiberRoot(to,t)}catch{}r=!0}return r}finally{ce=n,bt.transition=e}}return!1}function Ch(t,e,n){e=Gr(n,e),e=Dm(t,e,1),t=vn(t,e,1),e=Ve(),t!==null&&(fi(t,1,e),at(t,e))}function ke(t,e,n){if(t.tag===3)Ch(t,t,n);else for(;e!==null;){if(e.tag===3){Ch(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(wn===null||!wn.has(r))){t=Gr(n,t),t=Rm(e,t,1),e=vn(e,t,1),t=Ve(),e!==null&&(fi(e,1,t),at(e,t));break}}e=e.return}}function _v(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ve(),t.pingedLanes|=t.suspendedLanes&n,Ie===t&&(Re&n)===n&&(Le===4||Le===3&&(Re&130023424)===Re&&500>Ce()-gu?Wn(t,0):pu|=n),at(t,e)}function rp(t,e){e===0&&(t.mode&1?(e=Gi,Gi<<=1,!(Gi&130023424)&&(Gi=4194304)):e=1);var n=Ve();t=en(t,e),t!==null&&(fi(t,e,n),at(t,n))}function Iv(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),rp(t,n)}function zv(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),rp(t,n)}var sp;sp=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||st.current)rt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rt=!1,bv(t,e,n);rt=!!(t.flags&131072)}else rt=!1,ge&&e.flags&1048576&&lm(e,Ha,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ba(t,e),t=e.pendingProps;var s=Br(e,We.current);Hr(e,n),s=cu(null,e,r,t,s,n);var i=uu();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,it(r)?(i=!0,$a(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,su(e),s.updater=lo,e.stateNode=s,s._reactInternals=e,lc(e,r,t,n),e=dc(null,e,r,!0,i,n)):(e.tag=0,ge&&i&&Qc(e),Ue(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ba(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Dv(r),t=Tt(r,t),s){case 0:e=uc(null,e,r,t,n);break e;case 1:e=gh(null,e,r,t,n);break e;case 11:e=mh(null,e,r,t,n);break e;case 14:e=ph(null,e,r,Tt(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tt(r,s),uc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tt(r,s),gh(t,e,r,s,n);case 3:e:{if(Hm(e),t===null)throw Error(L(387));r=e.pendingProps,i=e.memoizedState,s=i.element,mm(t,e),Ba(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Gr(Error(L(423)),e),e=xh(t,e,r,n,s);break e}else if(r!==s){s=Gr(Error(L(424)),e),e=xh(t,e,r,n,s);break e}else for(ht=yn(e.stateNode.containerInfo.firstChild),ft=e,ge=!0,Et=null,n=hm(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xr(),r===s){e=tn(t,e,n);break e}Ue(t,e,r,n)}e=e.child}return e;case 5:return pm(e),t===null&&ic(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,ec(r,s)?o=null:i!==null&&ec(r,i)&&(e.flags|=32),Fm(t,e),Ue(t,e,o,n),e.child;case 6:return t===null&&ic(e),null;case 13:return Wm(t,e,n);case 4:return iu(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ur(e,null,r,n):Ue(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tt(r,s),mh(t,e,r,s,n);case 7:return Ue(t,e,e.pendingProps,n),e.child;case 8:return Ue(t,e,e.pendingProps.children,n),e.child;case 12:return Ue(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,de(Wa,r._currentValue),r._currentValue=o,i!==null)if(_t(i.value,o)){if(i.children===s.children&&!st.current){e=tn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Qt(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ac(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(L(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ac(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ue(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Hr(e,n),s=kt(s),r=r(s),e.flags|=1,Ue(t,e,r,n),e.child;case 14:return r=e.type,s=Tt(r,e.pendingProps),s=Tt(r.type,s),ph(t,e,r,s,n);case 15:return Om(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tt(r,s),ba(t,e),e.tag=1,it(r)?(t=!0,$a(e)):t=!1,Hr(e,n),Am(e,r,s),lc(e,r,s,n),dc(null,e,r,!0,t,n);case 19:return Ym(t,e,n);case 22:return $m(t,e,n)}throw Error(L(156,e.tag))};function ip(t,e){return _f(t,e)}function Av(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wt(t,e,n,r){return new Av(t,e,n,r)}function wu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Dv(t){if(typeof t=="function")return wu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$c)return 11;if(t===Fc)return 14}return 2}function kn(t,e){var n=t.alternate;return n===null?(n=wt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ja(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")wu(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Cr:return Yn(n.children,s,i,e);case Oc:o=8,s|=8;break;case _l:return t=wt(12,n,e,s|2),t.elementType=_l,t.lanes=i,t;case Il:return t=wt(13,n,e,s),t.elementType=Il,t.lanes=i,t;case zl:return t=wt(19,n,e,s),t.elementType=zl,t.lanes=i,t;case pf:return ho(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ff:o=10;break e;case mf:o=9;break e;case $c:o=11;break e;case Fc:o=14;break e;case cn:o=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=wt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Yn(t,e,n,r){return t=wt(7,t,r,e),t.lanes=n,t}function ho(t,e,n,r){return t=wt(22,t,r,e),t.elementType=pf,t.lanes=n,t.stateNode={isHidden:!1},t}function yl(t,e,n){return t=wt(6,t,null,e),t.lanes=n,t}function vl(t,e,n){return e=wt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Rv(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jo(0),this.expirationTimes=Jo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jo(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function bu(t,e,n,r,s,i,o,l,c){return t=new Rv(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=wt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},su(i),t}function Ov(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function ap(t){if(!t)return jn;t=t._reactInternals;e:{if(Jn(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(it(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(it(n))return am(t,n,e)}return e}function op(t,e,n,r,s,i,o,l,c){return t=bu(n,r,!0,t,s,i,o,l,c),t.context=ap(null),n=t.current,r=Ve(),s=bn(n),i=Qt(r,s),i.callback=e??null,vn(n,i,s),t.current.lanes=s,fi(t,s,r),at(t,r),t}function fo(t,e,n,r){var s=e.current,i=Ve(),o=bn(s);return n=ap(n),e.context===null?e.context=n:e.pendingContext=n,e=Qt(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=vn(s,e,o),t!==null&&(Lt(t,s,o,i),ya(t,s,o)),o}function Za(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Th(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ku(t,e){Th(t,e),(t=t.alternate)&&Th(t,e)}function $v(){return null}var lp=typeof reportError=="function"?reportError:function(t){console.error(t)};function Su(t){this._internalRoot=t}mo.prototype.render=Su.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));fo(t,e,null,null)};mo.prototype.unmount=Su.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Gn(function(){fo(null,t,null,null)}),e[Jt]=null}};function mo(t){this._internalRoot=t}mo.prototype.unstable_scheduleHydration=function(t){if(t){var e=$f();t={blockedOn:null,target:t,priority:e};for(var n=0;n<dn.length&&e!==0&&e<dn[n].priority;n++);dn.splice(n,0,t),n===0&&Hf(t)}};function ju(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function po(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Mh(){}function Fv(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Za(o);i.call(u)}}var o=op(e,r,t,0,null,!1,!1,"",Mh);return t._reactRootContainer=o,t[Jt]=o.current,ni(t.nodeType===8?t.parentNode:t),Gn(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Za(c);l.call(u)}}var c=bu(t,0,!1,null,null,!1,!1,"",Mh);return t._reactRootContainer=c,t[Jt]=c.current,ni(t.nodeType===8?t.parentNode:t),Gn(function(){fo(e,c,n,r)}),c}function go(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Za(o);l.call(c)}}fo(e,o,t,s)}else o=Fv(n,e,t,s,r);return Za(o)}Rf=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ds(e.pendingLanes);n!==0&&(Yc(e,n|1),at(e,Ce()),!(re&6)&&(qr=Ce()+500,Tn()))}break;case 13:Gn(function(){var r=en(t,1);if(r!==null){var s=Ve();Lt(r,t,1,s)}}),ku(t,1)}};Bc=function(t){if(t.tag===13){var e=en(t,134217728);if(e!==null){var n=Ve();Lt(e,t,134217728,n)}ku(t,134217728)}};Of=function(t){if(t.tag===13){var e=bn(t),n=en(t,e);if(n!==null){var r=Ve();Lt(n,t,e,r)}ku(t,e)}};$f=function(){return ce};Ff=function(t,e){var n=ce;try{return ce=t,e()}finally{ce=n}};Bl=function(t,e,n){switch(e){case"input":if(Rl(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=io(r);if(!s)throw Error(L(90));xf(r),Rl(r,s)}}}break;case"textarea":vf(t,n);break;case"select":e=n.value,e!=null&&Rr(t,!!n.multiple,e,!1)}};Cf=xu;Tf=Gn;var Hv={usingClientEntryPoint:!1,Events:[pi,Pr,io,jf,Nf,xu]},Es={findFiberByHostInstance:On,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Wv={bundleType:Es.bundleType,version:Es.version,rendererPackageName:Es.rendererPackageName,rendererConfig:Es.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Pf(t),t===null?null:t.stateNode},findFiberByHostInstance:Es.findFiberByHostInstance||$v,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ia=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ia.isDisabled&&ia.supportsFiber)try{to=ia.inject(Wv),Ot=ia}catch{}}pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hv;pt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ju(e))throw Error(L(200));return Ov(t,e,null,n)};pt.createRoot=function(t,e){if(!ju(t))throw Error(L(299));var n=!1,r="",s=lp;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=bu(t,1,!1,null,null,n,!1,r,s),t[Jt]=e.current,ni(t.nodeType===8?t.parentNode:t),new Su(e)};pt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=Pf(e),t=t===null?null:t.stateNode,t};pt.flushSync=function(t){return Gn(t)};pt.hydrate=function(t,e,n){if(!po(e))throw Error(L(200));return go(null,t,e,!0,n)};pt.hydrateRoot=function(t,e,n){if(!ju(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=lp;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=op(e,null,t,1,n??null,s,!1,i,o),t[Jt]=e.current,ni(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new mo(e)};pt.render=function(t,e,n){if(!po(e))throw Error(L(200));return go(null,t,e,!1,n)};pt.unmountComponentAtNode=function(t){if(!po(t))throw Error(L(40));return t._reactRootContainer?(Gn(function(){go(null,null,t,!1,function(){t._reactRootContainer=null,t[Jt]=null})}),!0):!1};pt.unstable_batchedUpdates=xu;pt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!po(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return go(t,e,n,!1,r)};pt.version="18.3.1-next-f1338f8080-20240426";function cp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cp)}catch(t){console.error(t)}}cp(),cf.exports=pt;var qn=cf.exports;const Yv=Kh(qn);var Eh=qn;Pl.createRoot=Eh.createRoot,Pl.hydrateRoot=Eh.hydrateRoot;function Ph(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function up(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Ph(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Ph(t[s],null)}}}}function Kn(...t){return m.useCallback(up(...t),t)}function Ja(t){const e=Xv(t),n=m.forwardRef((r,s)=>{const{children:i,...o}=r,l=m.Children.toArray(i),c=l.find(Vv);if(c){const u=c.props.children,h=l.map(f=>f===c?m.Children.count(u)>1?m.Children.only(null):m.isValidElement(u)?u.props.children:null:f);return a.jsx(e,{...o,ref:s,children:m.isValidElement(u)?m.cloneElement(u,void 0,h):null})}return a.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Bv=Ja("Slot");function Xv(t){const e=m.forwardRef((n,r)=>{const{children:s,...i}=n;if(m.isValidElement(s)){const o=qv(s),l=Gv(i,s.props);return s.type!==m.Fragment&&(l.ref=r?up(r,o):o),m.cloneElement(s,l)}return m.Children.count(s)>1?m.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Uv=Symbol("radix.slottable");function Vv(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Uv}function Gv(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function qv(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function dp(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=dp(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function hp(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=dp(t))&&(r&&(r+=" "),r+=e);return r}const Lh=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,_h=hp,fp=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return _h(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const h=n==null?void 0:n[u],f=i==null?void 0:i[u];if(h===null)return null;const p=Lh(h)||Lh(f);return s[u][p]}),l=n&&Object.entries(n).reduce((u,h)=>{let[f,p]=h;return p===void 0||(u[f]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,h)=>{let{class:f,className:p,...b}=h;return Object.entries(b).every(v=>{let[S,j]=v;return Array.isArray(j)?j.includes({...i,...l}[S]):{...i,...l}[S]===j})?[...u,f,p]:u},[]);return _h(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};function Kv(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=mp(e))&&(r&&(r+=" "),r+=n);return r}function mp(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=mp(t[r]))&&(n&&(n+=" "),n+=e);return n}var Nu="-";function Qv(t){var e=Jv(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(l){var c=l.split(Nu);return c[0]===""&&c.length!==1&&c.shift(),pp(c,e)||Zv(l)}function o(l,c){var u=n[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function pp(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?pp(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join(Nu);return(o=e.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:o.classGroupId}}var Ih=/^\[(.+)\]$/;function Zv(t){if(Ih.test(t)){var e=Ih.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function Jv(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=t0(Object.entries(t.classGroups),n);return s.forEach(function(i){var o=i[0],l=i[1];Sc(l,r,o,e)}),r}function Sc(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:zh(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(e0(s)){Sc(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];Sc(c,zh(e,l),n,r)})})}function zh(t,e){var n=t;return e.split(Nu).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function e0(t){return t.isThemeGetter}function t0(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[e+c,u]})):o});return[r,i]}):t}function n0(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(o){var l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set:function(o,l){n.has(o)?n.set(o,l):s(o,l)}}}var gp="!";function r0(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(o){for(var l=[],c=0,u=0,h,f=0;f<o.length;f++){var p=o[f];if(c===0){if(p===r&&(n||o.slice(f,f+s)===e)){l.push(o.slice(u,f)),u=f+s;continue}if(p==="/"){h=f;continue}}p==="["?c++:p==="]"&&c--}var b=l.length===0?o:o.substring(u),v=b.startsWith(gp),S=v?b.substring(1):b,j=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:v,baseClassName:S,maybePostfixModifierPosition:j}}}function s0(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function i0(t){return{cache:n0(t.cacheSize),splitModifiers:r0(t),...Qv(t)}}var a0=/\s+/;function o0(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(a0).map(function(o){var l=n(o),c=l.modifiers,u=l.hasImportantModifier,h=l.baseClassName,f=l.maybePostfixModifierPosition,p=r(f?h.substring(0,f):h),b=!!f;if(!p){if(!f)return{isTailwindClass:!1,originalClassName:o};if(p=r(h),!p)return{isTailwindClass:!1,originalClassName:o};b=!1}var v=s0(c).join(":"),S=u?v+gp:v;return{isTailwindClass:!0,modifierId:S,classGroupId:p,originalClassName:o,hasPostfixModifier:b}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,h=l+c;return i.has(h)?!1:(i.add(h),s(c,u).forEach(function(f){return i.add(l+f)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function l0(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,o=l;function l(u){var h=e[0],f=e.slice(1),p=f.reduce(function(b,v){return v(b)},h());return r=i0(p),s=r.cache.get,i=r.cache.set,o=c,c(u)}function c(u){var h=s(u);if(h)return h;var f=o0(u,r);return i(u,f),f}return function(){return o(Kv.apply(null,arguments))}}function fe(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var xp=/^\[(?:([a-z-]+):)?(.+)\]$/i,c0=/^\d+\/\d+$/,u0=new Set(["px","full","screen"]),d0=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,h0=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,f0=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Ct(t){return Hn(t)||u0.has(t)||c0.test(t)||jc(t)}function jc(t){return er(t,"length",v0)}function m0(t){return er(t,"size",yp)}function p0(t){return er(t,"position",yp)}function g0(t){return er(t,"url",w0)}function aa(t){return er(t,"number",Hn)}function Hn(t){return!Number.isNaN(Number(t))}function x0(t){return t.endsWith("%")&&Hn(t.slice(0,-1))}function Ps(t){return Ah(t)||er(t,"number",Ah)}function ee(t){return xp.test(t)}function Ls(){return!0}function ln(t){return d0.test(t)}function y0(t){return er(t,"",b0)}function er(t,e,n){var r=xp.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function v0(t){return h0.test(t)}function yp(){return!1}function w0(t){return t.startsWith("url(")}function Ah(t){return Number.isInteger(Number(t))}function b0(t){return f0.test(t)}function k0(){var t=fe("colors"),e=fe("spacing"),n=fe("blur"),r=fe("brightness"),s=fe("borderColor"),i=fe("borderRadius"),o=fe("borderSpacing"),l=fe("borderWidth"),c=fe("contrast"),u=fe("grayscale"),h=fe("hueRotate"),f=fe("invert"),p=fe("gap"),b=fe("gradientColorStops"),v=fe("gradientColorStopPositions"),S=fe("inset"),j=fe("margin"),x=fe("opacity"),g=fe("padding"),y=fe("saturate"),k=fe("scale"),C=fe("sepia"),M=fe("skew"),P=fe("space"),E=fe("translate"),$=function(){return["auto","contain","none"]},D=function(){return["auto","hidden","clip","visible","scroll"]},G=function(){return["auto",ee,e]},q=function(){return[ee,e]},se=function(){return["",Ct]},X=function(){return["auto",Hn,ee]},oe=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},Se=function(){return["solid","dashed","dotted","double","none"]},Ke=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},z=function(){return["start","end","center","between","around","evenly","stretch"]},W=function(){return["","0",ee]},B=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},te=function(){return[Hn,aa]},ne=function(){return[Hn,ee]};return{cacheSize:500,theme:{colors:[Ls],spacing:[Ct],blur:["none","",ln,ee],brightness:te(),borderColor:[t],borderRadius:["none","","full",ln,ee],borderSpacing:q(),borderWidth:se(),contrast:te(),grayscale:W(),hueRotate:ne(),invert:W(),gap:q(),gradientColorStops:[t],gradientColorStopPositions:[x0,jc],inset:G(),margin:G(),opacity:te(),padding:q(),saturate:te(),scale:te(),sepia:W(),skew:ne(),space:q(),translate:q()},classGroups:{aspect:[{aspect:["auto","square","video",ee]}],container:["container"],columns:[{columns:[ln]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(oe(),[ee])}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:$()}],"overscroll-x":[{"overscroll-x":$()}],"overscroll-y":[{"overscroll-y":$()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ps]}],basis:[{basis:G()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ee]}],grow:[{grow:W()}],shrink:[{shrink:W()}],order:[{order:["first","last","none",Ps]}],"grid-cols":[{"grid-cols":[Ls]}],"col-start-end":[{col:["auto",{span:["full",Ps]},ee]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[Ls]}],"row-start-end":[{row:["auto",{span:[Ps]},ee]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ee]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ee]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal"].concat(z())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(z(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(z(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[j]}],mx:[{mx:[j]}],my:[{my:[j]}],ms:[{ms:[j]}],me:[{me:[j]}],mt:[{mt:[j]}],mr:[{mr:[j]}],mb:[{mb:[j]}],ml:[{ml:[j]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",ee,e]}],"min-w":[{"min-w":["min","max","fit",ee,Ct]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[ln]},ln,ee]}],h:[{h:[ee,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",ee,Ct]}],"max-h":[{"max-h":[ee,e,"min","max","fit"]}],"font-size":[{text:["base",ln,jc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",aa]}],"font-family":[{font:[Ls]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ee]}],"line-clamp":[{"line-clamp":["none",Hn,aa]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ee,Ct]}],"list-image":[{"list-image":["none",ee]}],"list-style-type":[{list:["none","disc","decimal",ee]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(Se(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Ct]}],"underline-offset":[{"underline-offset":["auto",ee,Ct]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:q()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ee]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ee]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(oe(),[p0])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",m0]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},g0]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[b]}],"gradient-via":[{via:[b]}],"gradient-to":[{to:[b]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[].concat(Se(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:Se()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(Se())}],"outline-offset":[{"outline-offset":[ee,Ct]}],"outline-w":[{outline:[Ct]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:se()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Ct]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",ln,y0]}],"shadow-color":[{shadow:[Ls]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":Ke()}],"bg-blend":[{"bg-blend":Ke()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",ln,ee]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[f]}],saturate:[{saturate:[y]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ee]}],duration:[{duration:ne()}],ease:[{ease:["linear","in","out","in-out",ee]}],delay:[{delay:ne()}],animate:[{animate:["none","spin","ping","pulse","bounce",ee]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Ps,ee]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ee]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ee]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":q()}],"scroll-mx":[{"scroll-mx":q()}],"scroll-my":[{"scroll-my":q()}],"scroll-ms":[{"scroll-ms":q()}],"scroll-me":[{"scroll-me":q()}],"scroll-mt":[{"scroll-mt":q()}],"scroll-mr":[{"scroll-mr":q()}],"scroll-mb":[{"scroll-mb":q()}],"scroll-ml":[{"scroll-ml":q()}],"scroll-p":[{"scroll-p":q()}],"scroll-px":[{"scroll-px":q()}],"scroll-py":[{"scroll-py":q()}],"scroll-ps":[{"scroll-ps":q()}],"scroll-pe":[{"scroll-pe":q()}],"scroll-pt":[{"scroll-pt":q()}],"scroll-pr":[{"scroll-pr":q()}],"scroll-pb":[{"scroll-pb":q()}],"scroll-pl":[{"scroll-pl":q()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ee]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ct,aa]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var S0=l0(k0);function ot(...t){return S0(hp(t))}const j0=fp("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),I=m.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Bv:"button";return a.jsx(o,{className:ot(j0({variant:e,size:n,className:t})),ref:i,...s})});I.displayName="Button";function N0({className:t,variant:e="default",...n}){const r={default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input text-foreground"};return a.jsx("div",{className:ot("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",r[e],t),...n})}const Q=({content:t,side:e="top",className:n="",children:r,offsetY:s=8})=>{const i=`tooltip-${xe.useId()}`,o=xe.isValidElement(r)?xe.cloneElement(r,{"aria-describedby":i}):a.jsx("span",{tabIndex:0,"aria-describedby":i,className:"inline-flex",children:r}),l=xe.useRef(null),c=xe.useRef(null),u=xe.useRef(null),[h,f]=xe.useState(!1),[p,b]=xe.useState(null),[v,S]=xe.useState(!1),j=xe.useCallback(()=>{let k=s;if(l.current)try{const C=l.current.dataset;if(C&&C.tooltipOffset){const M=parseInt(C.tooltipOffset,10);Number.isNaN(M)||(k=M)}}catch{}return k},[s]),x=xe.useCallback(()=>{if(!l.current)return;const k=l.current.getBoundingClientRect(),C=j(),M=k.left+k.width/2,P=40;let E=k.top;e==="top"?E=k.top-P-C:e==="bottom"||e==="auto"?E=k.bottom+C:E=k.top+k.height/2,b({left:M,top:E})},[e,j]);xe.useEffect(()=>(window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)),[x]);const g=()=>{requestAnimationFrame(()=>x()),f(!0),S(!0)},y=()=>{f(!1),window.setTimeout(()=>S(!1),220)};return xe.useEffect(()=>{if(!h||!u.current||!l.current)return;const k=u.current.getBoundingClientRect(),C=l.current.getBoundingClientRect(),M=j(),P=k.width/2;let E=C.left+C.width/2;const $=8+P,D=window.innerWidth-8-P;E<$&&(E=$),E>D&&(E=D);let G=C.top-k.height-M;(e==="bottom"||e==="auto")&&(G=C.bottom+M),G=Math.max(8,Math.min(window.innerHeight-k.height-8,G)),b({left:E,top:G})},[h,e,j]),a.jsxs(a.Fragment,{children:[a.jsx("span",{ref:l,onMouseEnter:g,onFocus:g,onMouseLeave:y,onBlur:y,className:`relative inline-flex ${n}`,children:o}),typeof document<"u"&&p&&v&&qn.createPortal(a.jsxs("div",{ref:u,id:i,role:"tooltip",className:`custom-tooltip ${h?"visible":"fade-out"}`,style:{left:p.left,top:p.top,transform:"translateX(-50%)"},children:[a.jsx("span",{ref:c,className:"inline-block text-xs px-3 py-1.5 rounded-md shadow-md max-w-[18rem] break-words",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t}),a.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 mt-[-6px] w-2 h-2 rotate-45 bg-black","aria-hidden":!0})]}),document.body)]})},F=m.forwardRef(({className:t,type:e,...n},r)=>a.jsx("input",{type:e,className:ot("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));F.displayName="Input";function wr({open:t,onOpenChange:e,children:n}){return t?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"fixed inset-0 bg-black/80",onClick:()=>e(!1)}),a.jsx("div",{className:"relative z-50",children:n})]}):null}function br({className:t,children:e,...n}){return a.jsx("div",{className:ot("bg-background border border-border rounded-lg p-6 w-full max-w-lg mx-auto shadow-lg",t),...n,children:e})}function kr({className:t,children:e,...n}){return a.jsx("div",{className:ot("flex flex-col space-y-1.5 text-center sm:text-left",t),...n,children:e})}function Sr({className:t,children:e,...n}){return a.jsx("h3",{className:ot("text-lg font-semibold leading-none tracking-tight",t),...n,children:e})}function jr({className:t,children:e,...n}){return a.jsx("p",{className:ot("text-sm text-muted-foreground",t),...n,children:e})}function _s({className:t,children:e,...n}){return a.jsx("div",{className:ot("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n,children:e})}/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),T0=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),Dh=t=>{const e=T0(t);return e.charAt(0).toUpperCase()+e.slice(1)},vp=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),M0=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=m.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...l},c)=>m.createElement("svg",{ref:c,...E0,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:vp("lucide",s),...!i&&!M0(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,h])=>m.createElement(u,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=(t,e)=>{const n=m.forwardRef(({className:r,...s},i)=>m.createElement(P0,{ref:i,iconNode:e,className:vp(`lucide-${C0(Dh(t))}`,`lucide-${t}`,r),...s}));return n.displayName=Dh(t),n};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=[["circle",{cx:"9",cy:"9",r:"7",key:"p2h5vp"}],["circle",{cx:"15",cy:"15",r:"7",key:"19ennj"}]],_0=Y("blend",L0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],z0=Y("box",I0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],D0=Y("check",A0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],O0=Y("chevron-left",R0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],F0=Y("chevron-right",$0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wl=Y("circle-question-mark",H0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Is=Y("circle",W0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],B0=Y("clock",Y0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],U0=Y("download",X0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],bl=Y("eraser",V0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],q0=Y("eye-off",G0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Q0=Y("eye",K0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],J0=Y("folder-open",Z0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Na=Y("folder",ew);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Nc=Y("grid-3x3",tw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],rw=Y("image",nw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Rh=Y("link-2",sw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]],aw=Y("locate",iw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ow=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Oh=Y("map-pin",ow);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lw=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],kl=Y("map",lw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],uw=Y("menu",cw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=[["path",{d:"M5 12h14",key:"1ays0h"}]],Cc=Y("minus",dw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hw=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],fw=Y("moon",hw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mw=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],pw=Y("mouse-pointer-2",mw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"7",key:"11ol66"}],["path",{d:"M12 6v4",key:"16clxf"}]],oa=Y("mouse",gw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],yw=Y("mouse-pointer",xw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],ww=Y("move",vw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=[["path",{d:"m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z",key:"irua1i"}],["path",{d:"m5 2 5 5",key:"1lls2c"}],["path",{d:"M2 13h15",key:"1hkzvu"}],["path",{d:"M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z",key:"xk76lq"}]],Sl=Y("paint-bucket",bw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v4",key:"qmzblu"}],["path",{d:"M17 2a1 1 0 0 1 1 1v9H6V3a1 1 0 0 1 1-1z",key:"ycvu00"}],["path",{d:"M6 12a1 1 0 0 0-1 1v1a2 2 0 0 0 2 2h2a1 1 0 0 1 1 1v2.9a2 2 0 1 0 4 0V17a1 1 0 0 1 1-1h2a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1",key:"iw4wnp"}]],la=Y("paintbrush-vertical",kw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],$h=Y("pen",Sw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=[["path",{d:"m12 9-8.414 8.414A2 2 0 0 0 3 18.828v1.344a2 2 0 0 1-.586 1.414A2 2 0 0 1 3.828 21h1.344a2 2 0 0 0 1.414-.586L15 12",key:"1y3wsu"}],["path",{d:"m18 9 .4.4a1 1 0 1 1-3 3l-3.8-3.8a1 1 0 1 1 3-3l.4.4 3.4-3.4a1 1 0 1 1 3 3z",key:"110lr1"}],["path",{d:"m2 22 .414-.414",key:"jhxm08"}]],Fh=Y("pipette",jw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ca=Y("plus",Nw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],Tw=Y("redo-2",Cw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ew=Y("rotate-ccw",Mw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Hh=Y("save",Pw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],Wh=Y("scan",Lw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],Iw=Y("scissors",_w);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Yh=Y("settings",zw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=[["path",{d:"M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z",key:"1bo67w"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}],["circle",{cx:"17.5",cy:"17.5",r:"3.5",key:"w3z12y"}]],Dw=Y("shapes",Aw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],jl=Y("shield",Rw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Rn=Y("square",Ow);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=[["path",{d:"M14 13V8.5C14 7 15 7 15 5a3 3 0 0 0-6 0c0 2 1 2 1 3.5V13",key:"i9gjdv"}],["path",{d:"M20 15.5a2.5 2.5 0 0 0-2.5-2.5h-11A2.5 2.5 0 0 0 4 15.5V17a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1z",key:"1vzg3v"}],["path",{d:"M5 22h14",key:"ehvnwv"}]],Fw=Y("stamp",$w);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Ww=Y("sun",Hw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],vr=Y("target",Yw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Xw=Y("trash-2",Bw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Vw=Y("triangle-alert",Uw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],qw=Y("undo-2",Gw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ca=Y("upload",Kw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Zw=Y("users",Qw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Nl=Y("wand-sparkles",Jw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e1=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Xe=Y("x",e1);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],n1=Y("zoom-in",t1);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r1=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],s1=Y("zoom-out",r1);class Cl{constructor(e){this.projectName="",this.tilesetImage=null,this.tilesetFileName=null,this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.showMinimap=!0,this.isDarkMode=!1,this.debugMode=!1,this.resizeObserver=null,this.boundResizeHandler=null,this.boundMouseDown=null,this.boundMouseMove=null,this.boundMouseUp=null,this.boundMouseLeave=null,this.boundWheel=null,this.boundContextMenu=null,this.mapWidth=20,this.mapHeight=15,this.mapName="Untitled Map",this.tileSizeX=64,this.tileSizeY=32,this.orientation="isometric",this.tileContentThreshold=10,this.objectSeparationSensitivity=.5,this.detectedTileData=new Map,this.layerTilesets=new Map,this.nextLayerTabId=1,this.layerTabs=new Map,this.layerActiveTabId=new Map,this.layerTileData=new Map,this.layerActiveGid=new Map,this.tilesets=[],this.tilesetSourcePath=null,this.tileLayers=[],this.activeLayerId=null,this.nextLayerId=1,this.collisionData=[],this.objects=[],this.selectedObject=null,this.nextObjectId=1,this.selectedObjectId=null,this.isDraggingActor=!1,this.draggingActorId=null,this.heroX=0,this.heroY=0,this.isDraggingHero=!1,this.heroLastClickTime=0,this.tool="tiles",this.currentTool="brush",this.currentSelectionTool="rectangular",this.currentShapeTool="rectangle",this.currentStampMode="select",this.activeGid=0,this.multiSelectedBrushes=new Set,this.isMouseDown=!1,this.selection={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,tiles:[]},this.isSelecting=!1,this.shapeDrawing={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,preview:[]},this.isDrawingShape=!1,this.hoverX=-1,this.hoverY=-1,this.zoom=1,this.panX=0,this.panY=0,this.isPanning=!1,this.lastPanX=0,this.lastPanY=0,this.spacePressed=!1,this.history=[],this.historyIndex=-1,this.maxHistorySize=50,this.isApplyingHistory=!1,this.hasUnsavedChanges=!1,this.autoSaveTimeout=null,this.lastSaveTimestamp=0,this.autoSaveCallback=null,this.saveStatusCallback=null,this.activeGidCallback=null,this.AUTO_SAVE_DELAY=8e3,this.IMMEDIATE_SAVE_DELAY=2e3,this.autoSaveEnabled=!0,this.sidebarTransitioning=!1,this.lastMiniMapPos=null,this.eyedropperCallback=null,this.objectsChangedCallback=null,this.stamps=new Map,this.activeStamp=null,this.stampPreview={x:0,y:0,visible:!1},this.stampCallback=null,this.heroEditCallback=null,this.mapCanvas=e,this.initializeCanvas(),this.initializeState(),this.bindEvents(),this.createDefaultLayers(),this.saveState(),this.draw()}exportSettingsTxt(e){const n=window.require?window.require("fs"):null;if(!n){console.warn("fs module not available. Cannot write settings.txt");return}const r=`#this file is necesserey to work this project run in flare. please do not remove it. -Ism
description=${this.projectName||"--> Project Name comes here."}
game=flare_studio_game
version=1.14
engine_version_min=1.13.01
`,s=n.existsSync(e)?`${e}/settings.txt`:"settings.txt";try{n.writeFileSync(s,r,"utf8"),console.log("settings.txt exported to",s)}catch(i){console.error("Failed to write settings.txt:",i)}}getTileCount(){return this.tileCount}setTileContentThreshold(e){this.tileContentThreshold=Math.max(0,Math.min(255,e))}getTileContentThreshold(){return this.tileContentThreshold}refreshTilePalette(e=!1){this.tilesetImage&&this.createTilePalette(e)}getDetectedTileInfo(){const e=[];return this.detectedTileData.forEach((n,r)=>{e.push({gid:r,width:n.width,height:n.height,sourceX:n.sourceX,sourceY:n.sourceY})}),e.sort((n,r)=>n.gid-r.gid)}getDetectedTilesForLayer(e){const n=this.layerTileData.get(e);return n?Array.from(n.entries()):[]}getCurrentLayerActiveGid(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);return e&&this.layerActiveGid.get(e.type)||0}setCurrentLayerActiveGid(e){const n=this.tileLayers.find(r=>r.id===this.activeLayerId);if(n&&(this.layerActiveGid.set(n.type,e),this.activeGid=e,this.activeGidCallback))try{this.activeGidCallback(this.activeGid)}catch(r){console.warn("activeGidCallback error",r)}}mergeBrushes(e){if(e.length<2)return;const n=e.map(f=>this.detectedTileData.get(f)).filter(f=>f!==void 0);if(n.length!==e.length)throw new Error("Some selected brushes not found");let r=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER;for(const f of n)r=Math.min(r,f.sourceX),s=Math.min(s,f.sourceY),i=Math.max(i,f.sourceX+f.width),o=Math.max(o,f.sourceY+f.height);const l={sourceX:r,sourceY:s,width:i-r,height:o-s},c=Array.from(this.detectedTileData.entries()),u=c.findIndex(([f])=>e.includes(f)),h=c.filter(([f])=>!e.includes(f));h.splice(u,0,[e[0],l]),this.detectedTileData.clear(),h.forEach(([f,p],b)=>{this.detectedTileData.set(b,p)}),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Merged ${e.length} brushes into new brush at position ${u}`)}separateBrush(e){console.log(`separateBrush called with brushId: ${e}`);const n=this.detectedTileData.get(e);if(!n)throw console.error(`Brush ${e} not found`),new Error(`Brush ${e} not found`);console.log(`Separating brush ${e} with data:`,n);const r=Array.from(this.detectedTileData.entries()),s=r.findIndex(([l])=>l===e),i=r.filter(([l])=>l!==e),o=[];if(this.tilesetImage){const l=document.createElement("canvas");l.width=n.width,l.height=n.height;const c=l.getContext("2d");if(c){c.drawImage(this.tilesetImage,n.sourceX,n.sourceY,n.width,n.height,0,0,n.width,n.height);const h=c.getImageData(0,0,n.width,n.height).data;console.log(`Analyzing brush area: ${n.width}x${n.height}`);const f=this.findVerticalGaps(h,n.width,n.height);if(console.log("Found vertical gaps:",f),f.length>0){let p=0;for(const b of f){if(b>p){const v=b-p,S=this.findObjectBoundsInRegion(h,n.width,n.height,p,0,v,n.height);S&&S.width>0&&S.height>0&&o.push({sourceX:n.sourceX+S.x,sourceY:n.sourceY+S.y,width:S.width,height:S.height})}p=b+1}if(p<n.width){const b=n.width-p,v=this.findObjectBoundsInRegion(h,n.width,n.height,p,0,b,n.height);v&&v.width>0&&v.height>0&&o.push({sourceX:n.sourceX+v.x,sourceY:n.sourceY+v.y,width:v.width,height:v.height})}}else{const p=new Array(n.width*n.height).fill(!1);for(let b=0;b<n.height;b++)for(let v=0;v<n.width;v++){const S=b*n.width+v;if(p[S]||this.isPixelTransparent(h,v,b,n.width))continue;console.log(`Starting flood fill at pixel (${v}, ${b})`);const j=this.floodFillObjectDataInRegion(h,n.width,n.height,v,b,p);j&&this.isValidObjectSize(j.bounds)?(console.log("Found valid connected component:",j),o.push({sourceX:n.sourceX+j.bounds.x,sourceY:n.sourceY+j.bounds.y,width:j.bounds.width,height:j.bounds.height})):j&&console.log("Found invalid connected component (too small):",j)}}}}if(console.log(`Found ${o.length} new brushes from separation:`,o),o.length<=1){console.log(`No separation needed - only found ${o.length} component(s)`);return}o.forEach((l,c)=>{i.splice(s+c,0,[s+c,l])}),this.detectedTileData.clear(),i.forEach(([l,c],u)=>{this.detectedTileData.set(u,c)}),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Separated brush ${e} into ${o.length} new brushes`)}removeBrush(e){if(console.log(`removeBrush called with brushId: ${e}`),console.log("detectedTileData keys before removal:",Array.from(this.detectedTileData.keys())),!this.detectedTileData.has(e))throw console.error(`Brush ${e} not found in detectedTileData`),new Error(`Brush ${e} not found`);const n=Array.from(this.detectedTileData.entries());console.log("brushArray before filtering:",n.map(([s,i])=>s));const r=n.filter(([s])=>s!==e);console.log("filteredArray after filtering:",r.map(([s,i])=>s)),this.detectedTileData.clear(),r.forEach(([s,i],o)=>{this.detectedTileData.set(o,i)}),console.log("detectedTileData keys after rebuild:",Array.from(this.detectedTileData.keys())),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Removed brush ${e}`)}reorderBrush(e,n){const r=Array.from(this.detectedTileData.entries());if(e<0||e>=r.length||n<0||n>=r.length)throw new Error("Invalid brush indices for reordering");const[s]=r.splice(e,1);r.splice(n,0,s),this.detectedTileData.clear(),r.forEach(([i,o],l)=>{this.detectedTileData.set(l,o)}),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Reordered brush from index ${e} to ${n}`)}findVerticalGaps(e,n,r){const s=[];for(let i=1;i<n-1;i++){let o=!1;for(let l=0;l<r;l++)if(!this.isPixelTransparent(e,i,l,n)){o=!0;break}if(!o){let l=!1,c=!1;for(let u=0;u<r;u++)if(!this.isPixelTransparent(e,i-1,u,n)){l=!0;break}for(let u=0;u<r;u++)if(!this.isPixelTransparent(e,i+1,u,n)){c=!0;break}l&&c&&s.push(i)}}return console.log(`Detected ${s.length} vertical gaps at columns:`,s),s}findObjectBoundsInRegion(e,n,r,s,i,o,l){let c=s+o,u=s,h=i+l,f=i,p=!1;for(let b=i;b<i+l&&b<r;b++)for(let v=s;v<s+o&&v<n;v++)this.isPixelTransparent(e,v,b,n)||(p=!0,c=Math.min(c,v),u=Math.max(u,v),h=Math.min(h,b),f=Math.max(f,b));return p?{x:c,y:h,width:u-c+1,height:f-h+1}:null}floodFillObjectDataInRegion(e,n,r,s,i,o){const l=[{x:s,y:i}];let c=s,u=s,h=i,f=i,p=0;const b=[];for(;l.length>0;){const y=l.pop(),{x:k,y:C}=y;if(k<0||k>=n||C<0||C>=r)continue;const M=C*n+k;o[M]||this.isPixelTransparent(e,k,C,n)||(o[M]=!0,p++,b.push({x:k,y:C}),c=Math.min(c,k),u=Math.max(u,k),h=Math.min(h,C),f=Math.max(f,C),l.push({x:k+1,y:C}),l.push({x:k-1,y:C}),l.push({x:k,y:C+1}),l.push({x:k,y:C-1}))}if(p===0)return null;const v=1,S=Math.max(0,c-v),j=Math.max(0,h-v),x=Math.min(n-1,u+v),g=Math.min(r-1,f+v);return{bounds:{x:S,y:j,width:x-S+1,height:g-j+1},pixels:b}}updateActiveGid(e){if(this.activeGid=e,this.activeGidCallback)try{this.activeGidCallback(this.activeGid)}catch(n){console.warn("activeGidCallback error",n)}}setActiveGidCallback(e){if(this.activeGidCallback=e,e)try{e(this.activeGid)}catch(n){console.warn("setActiveGidCallback initial callback error",n)}}initializeCanvas(){const e=this.mapCanvas.getContext("2d");if(!e)throw new Error("Unable to get canvas context");this.ctx=e,this.ctx.imageSmoothingEnabled=!1,this.cleanupCanvasObservers(),this.resizeCanvas(),this.boundResizeHandler=()=>this.resizeCanvas(),window.addEventListener("resize",this.boundResizeHandler),window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>this.resizeCanvas()),this.mapCanvas.parentElement&&this.resizeObserver.observe(this.mapCanvas.parentElement))}cleanupCanvasObservers(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.boundResizeHandler&&(window.removeEventListener("resize",this.boundResizeHandler),this.boundResizeHandler=null)}cleanupCanvasEvents(){this.boundMouseDown&&(this.mapCanvas.removeEventListener("mousedown",this.boundMouseDown),this.boundMouseDown=null),this.boundMouseMove&&(this.mapCanvas.removeEventListener("mousemove",this.boundMouseMove),this.boundMouseMove=null),this.boundMouseUp&&(this.mapCanvas.removeEventListener("mouseup",this.boundMouseUp),this.boundMouseUp=null),this.boundMouseLeave&&(this.mapCanvas.removeEventListener("mouseleave",this.boundMouseLeave),this.boundMouseLeave=null),this.boundWheel&&(this.mapCanvas.removeEventListener("wheel",this.boundWheel),this.boundWheel=null),this.boundContextMenu&&(this.mapCanvas.removeEventListener("contextmenu",this.boundContextMenu),this.boundContextMenu=null)}resizeCanvas(){const e=this.mapCanvas.parentElement;e&&requestAnimationFrame(()=>{const n=e.getBoundingClientRect(),r=Math.max(1,Math.floor(n.width)),s=Math.max(1,Math.floor(n.height));(this.mapCanvas.width!==r||this.mapCanvas.height!==s)&&(this.mapCanvas.width=r,this.mapCanvas.height=s,this.draw())})}initializeState(){this.collisionData=new Array(this.mapWidth*this.mapHeight).fill(0)}bindEvents(){this.cleanupCanvasEvents(),this.boundMouseDown=this.handleMouseDown.bind(this),this.boundMouseMove=this.handleMouseMove.bind(this),this.boundMouseUp=this.handleMouseUp.bind(this),this.boundMouseLeave=this.handleMouseLeave.bind(this),this.boundWheel=this.handleWheel.bind(this),this.boundContextMenu=e=>e.preventDefault(),this.mapCanvas.addEventListener("mousedown",this.boundMouseDown),this.mapCanvas.addEventListener("mousemove",this.boundMouseMove),this.mapCanvas.addEventListener("mouseup",this.boundMouseUp),this.mapCanvas.addEventListener("mouseleave",this.boundMouseLeave),this.mapCanvas.addEventListener("contextmenu",this.boundContextMenu),this.mapCanvas.addEventListener("wheel",this.boundWheel),document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",this.handleKeyUp.bind(this)),this.mapCanvas.tabIndex=0}createDefaultLayers(){this.tileLayers=[{id:1,name:"NPC Layer",type:"npc",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:2,name:"Enemy Layer",type:"enemy",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:3,name:"Event Layer",type:"event",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:4,name:"Collision Layer",type:"collision",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:5,name:"Object Layer",type:"object",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:6,name:"Background Layer",type:"background",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1}],this.activeLayerId=6,this.nextLayerId=7,this.sortLayersByPriority();try{this.layerTabs.clear(),this.layerActiveTabId.clear();const e=this.tileLayers.some(r=>r.type==="object"),n=this.tileLayers.some(r=>r.type==="background");if(e){const r=this.createLayerTab("object");this.setActiveLayerTab("object",r)}if(n){const r=this.createLayerTab("background");this.setActiveLayerTab("background",r)}}catch(e){console.warn("Failed to initialize default layer tabs",e)}}getDraggableActorAt(e,n){return e<0||n<0?null:this.objects.find(r=>r.x===e&&r.y===n&&this.actorUsesPlaceholder(r))||null}handleActorDrag(e,n){if(!this.isDraggingActor||this.draggingActorId===null||e<0||n<0||e>=this.mapWidth||n>=this.mapHeight)return;const r=this.objects.find(s=>s.id===this.draggingActorId);r&&(r.x===e&&r.y===n||(this.updateMapObject(r.id,{x:e,y:n}),this.draw()))}handleMouseDown(e){const n=this.mapCanvas.getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top;if(this.spacePressed)this.isPanning=!0,this.lastPanX=r,this.lastPanY=s,this.mapCanvas.style.cursor="grabbing";else{this.isMouseDown=!0;const i=this.screenToTile(r,s);if(i){if(this.isHeroAtPosition(i.x,i.y)){this.handleHeroClick(i.x,i.y,e);return}const o=this.getDraggableActorAt(i.x,i.y);if(o){this.isDraggingActor=!0,this.draggingActorId=o.id,this.selectedObject=o,this.selectedObjectId=o.id;return}this.tool==="tiles"?this.handleTileClick(i.x,i.y,e.button===2):this.tool==="selection"?this.handleSelectionStart(i.x,i.y,e.button===2):this.tool==="shape"?this.handleShapeStart(i.x,i.y,e.button===2):this.tool==="eyedropper"?this.handleEyedropper(i.x,i.y)&&(this.isMouseDown=!1):this.tool==="stamp"&&this.handleStampClick(i.x,i.y,e.button===2)}}}handleMouseMove(e){const n=this.mapCanvas.getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top;if(this.isPanning&&this.spacePressed){const i=r-this.lastPanX,o=s-this.lastPanY;this.setPan(i,o),this.lastPanX=r,this.lastPanY=s}else{const i=this.screenToTile(r,s);i&&(this.hoverX=i.x,this.hoverY=i.y,this.updateCursorForHover(),this.tool==="stamp"&&this.currentStampMode==="place"&&this.activeStamp&&(this.stampPreview.x=i.x,this.stampPreview.y=i.y,this.stampPreview.visible=!0),this.isMouseDown&&!this.spacePressed&&(this.isDraggingHero?this.setHeroPosition(i.x,i.y):this.isDraggingActor?this.handleActorDrag(i.x,i.y):this.tool==="tiles"?this.handleTileClick(i.x,i.y,!1):this.isSelecting?this.handleSelectionDrag(i.x,i.y):this.isDrawingShape&&this.handleShapeDrag(i.x,i.y)))}this.draw()}handleMouseUp(){this.isSelecting?this.handleSelectionEnd():this.isDrawingShape&&this.handleShapeEnd(),this.isDraggingHero&&(this.isDraggingHero=!1),this.isDraggingActor&&(this.isDraggingActor=!1,this.draggingActorId=null),this.isMouseDown=!1,this.isPanning=!1}handleMouseLeave(){this.hideObjectTooltip(),this.hoverX=-1,this.hoverY=-1,this.isDraggingActor=!1,this.draggingActorId=null,this.draw()}handleHeroClick(e,n,r){const s=Date.now();s-this.heroLastClickTime<300?this.openHeroEditDialog():this.isDraggingHero=!0,this.heroLastClickTime=s}openHeroEditDialog(){this.heroEditCallback?this.heroEditCallback(this.heroX,this.heroY,this.mapWidth,this.mapHeight,(e,n)=>{this.setHeroPosition(e,n)}):alert(`Hero position: (${this.heroX}, ${this.heroY}). Set up hero edit dialog in React component.`)}handleWheel(e){e.preventDefault();const n=e.deltaY>0?.9:1.1;this.setZoom(this.zoom*n)}handleKeyDown(e){if(e.code==="Space"&&(e.preventDefault(),this.spacePressed=!0,this.mapCanvas.style.cursor="grab"),e.ctrlKey||e.metaKey)switch(e.code){case"KeyZ":e.preventDefault(),e.shiftKey?this.redo():this.undo();break;case"KeyY":e.preventDefault(),this.redo();break;case"KeyA":e.preventDefault(),this.selectAll();break}switch(e.code){case"Delete":case"Backspace":e.preventDefault(),this.deleteSelection();break;case"Escape":e.preventDefault(),this.clearSelection(),this.isDrawingShape&&(this.shapeDrawing.active=!1,this.isDrawingShape=!1,this.shapeDrawing.preview=[],this.draw());break}}handleKeyUp(e){e.code==="Space"&&(e.preventDefault(),this.spacePressed=!1,this.mapCanvas.style.cursor="crosshair")}screenToTile(e,n){const r=this.screenToWorld(e,n);return this.raycastToTile(r.x,r.y)}handleStampClick(e,n,r){if(r){this.stampPreview.visible=!1,this.draw();return}this.currentStampMode==="create"?this.handleSelectionStart(e,n,r):this.currentStampMode==="place"&&this.activeStamp&&this.placeStamp(e,n)}handleTileClick(e,n,r){if(this.activeLayerId!==null){const s=this.tileLayers.find(i=>i.id===this.activeLayerId);if(s){const i=n*this.mapWidth+e,o=s.data[i];let l;const c=this.getCurrentLayerActiveGid();if(r)l=0;else switch(this.currentTool){case"brush":if(c===0&&this.multiSelectedBrushes.size===0)return;if(this.multiSelectedBrushes.size>1){this.saveState(),this.placeMultiSelectionAt(e,n),this.markAsChanged();return}l=c;break;case"eraser":l=0;break;case"bucket":if(c===0)return;o!==c&&(this.saveState(),this.bucketFill(s,e,n,c),this.markAsChanged(),this.draw());return;default:if(c===0)return;l=c;break}o!==l&&(this.saveState(),console.log(`Painting on layer: ${s.name} (ID: ${s.id}, Type: ${s.type})`),console.log(`Position: (${e}, ${n}), Index: ${i}`),console.log(`Current value: ${o}, New value: ${l}`),console.log(`Active GID for this layer: ${c}`),s.data[i]=l,(s.type==="event"||s.type==="enemy"||s.type==="npc"||s.type==="object")&&(l>0?this.createObjectFromTile(e,n,s.type,l):this.removeObjectAtPosition(e,n)),this.markAsChanged(),this.draw())}}}handleSelectionStart(e,n,r){if(r){this.clearSelection();return}const s=this.tileLayers.find(i=>i.id===this.activeLayerId);s&&(this.selection.startX=e,this.selection.startY=n,this.selection.endX=e,this.selection.endY=n,this.currentSelectionTool==="magic-wand"?(this.selectMagicWand(s,e,n),this.draw()):this.currentSelectionTool==="same-tile"?(this.selectSameTile(s,e,n),this.draw()):this.isSelecting=!0)}handleSelectionDrag(e,n){this.isSelecting&&(this.selection.endX=e,this.selection.endY=n,this.draw())}handleSelectionEnd(){if(!this.isSelecting)return;const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&(this.currentSelectionTool==="rectangular"?this.selectRectangular(e,this.selection.startX,this.selection.startY,this.selection.endX,this.selection.endY):this.currentSelectionTool==="circular"&&this.selectCircular(e,this.selection.startX,this.selection.startY,this.selection.endX,this.selection.endY),this.isSelecting=!1,this.draw())}handleShapeStart(e,n,r){if(r){this.shapeDrawing.active=!1,this.isDrawingShape=!1,this.draw();return}this.shapeDrawing.active=!0,this.shapeDrawing.startX=e,this.shapeDrawing.startY=n,this.shapeDrawing.endX=e,this.shapeDrawing.endY=n,this.shapeDrawing.preview=[],this.isDrawingShape=!0}handleShapeDrag(e,n){if(this.isDrawingShape){switch(this.shapeDrawing.endX=e,this.shapeDrawing.endY=n,this.currentShapeTool){case"rectangle":this.shapeDrawing.preview=this.drawRectangleShape(this.shapeDrawing.startX,this.shapeDrawing.startY,this.shapeDrawing.endX,this.shapeDrawing.endY);break;case"circle":this.shapeDrawing.preview=this.drawCircleShape(this.shapeDrawing.startX,this.shapeDrawing.startY,this.shapeDrawing.endX,this.shapeDrawing.endY);break;case"line":this.shapeDrawing.preview=this.drawLineShape(this.shapeDrawing.startX,this.shapeDrawing.startY,this.shapeDrawing.endX,this.shapeDrawing.endY);break}this.draw()}}handleShapeEnd(){if(!this.isDrawingShape)return;const e=this.tileLayers.find(r=>r.id===this.activeLayerId);if(!e)return;const n=this.getCurrentLayerActiveGid();this.shapeDrawing.preview.length>0&&n>0&&(this.saveState(),this.shapeDrawing.preview.forEach(r=>{const s=r.y*this.mapWidth+r.x;e.data[s]=n}),this.markAsChanged()),this.shapeDrawing.active=!1,this.isDrawingShape=!1,this.shapeDrawing.preview=[],this.draw()}handleEyedropper(e,n){const r=this.tileLayers.find(s=>s.id===this.activeLayerId);if(!r)return null;if(e>=0&&e<this.mapWidth&&n>=0&&n<this.mapHeight){const s=n*this.mapWidth+e,i=r.data[s];if(i>0)return this.setCurrentLayerActiveGid(i),this.updateTilePaletteSelection(),this.tool="tiles",this.currentTool="brush",this.mapCanvas.style.cursor="crosshair",this.eyedropperCallback&&this.eyedropperCallback(),i}return null}updateTilePaletteSelection(){const e=document.getElementById("activeGid");e&&(e.textContent=this.activeGid.toString()),document.querySelectorAll(".tile-palette .tile").forEach((r,s)=>{const i=r;s===this.activeGid-1?(i.classList.add("selected"),i.scrollIntoView({behavior:"smooth",block:"nearest"})):i.classList.remove("selected")})}draw(){this.ctx.clearRect(0,0,this.mapCanvas.width,this.mapCanvas.height),this.ctx.save(),this.drawGrid(),this.drawTiles(),this.hoverX>=0&&this.hoverY>=0&&this.drawHover(),this.drawSelection(),this.drawHeroPosition(),this.drawActorPlaceholders(),this.drawShapePreview(),this.ctx.restore(),this.drawMiniMap(),this.drawStampPreview(),this.drawDebugInfo()}mapToScreen(e,n){const r=(e-n)*(this.tileSizeX/2),s=(e+n)*(this.tileSizeY/2),i=this.mapCanvas.width/2+this.panX,o=100+this.panY;return{x:(r+i)*this.zoom,y:(s+o)*this.zoom}}screenToMap(e,n){const r=e/this.zoom,s=n/this.zoom,i=this.mapCanvas.width/2+this.panX,o=100+this.panY,l=r-i,c=s-o,u=l-this.tileSizeX/2,h=c-this.tileSizeY/2,f=this.tileSizeX/2,p=this.tileSizeY/2,b=(u/f+h/p)/2,v=(h/p-u/f)/2;return{x:Math.floor(b),y:Math.floor(v)}}screenToWorld(e,n){const r=e/this.zoom,s=n/this.zoom,i=this.mapCanvas.width/2+this.panX,o=100+this.panY;return{x:r-i,y:s-o}}raycastToTile(e,n){const r=[],s=this.worldToScreen(e,n);for(let i=0;i<this.mapHeight;i++)for(let o=0;o<this.mapWidth;o++)if(this.isPointInTileDiamond(e,n,o,i)){const l=this.mapToScreen(o,i),c=Math.sqrt(Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2));r.push({x:o,y:i,distance:c})}return r.length>0?(r.sort((i,o)=>i.distance-o.distance),{x:r[0].x,y:r[0].y}):null}isPointInTileDiamond(e,n,r,s){const i=this.mapToScreen(r,s),o=this.worldToScreen(e,n),l=o.x-i.x,c=o.y-i.y,u=this.tileSizeX/2*this.zoom,h=this.tileSizeY/2*this.zoom,f=.9,p=Math.abs(l/u),b=Math.abs(c/h);return p+b<=f}tileToWorld(e,n){return{x:(e-n)*(this.tileSizeX/2),y:(e+n)*(this.tileSizeY/2)}}worldToScreen(e,n){const r=this.mapCanvas.width/2+this.panX,s=100+this.panY;return{x:(e+r)*this.zoom,y:(n+s)*this.zoom}}drawDebugInfo(){if(this.debugMode){this.ctx.strokeStyle="rgba(255, 0, 0, 0.5)",this.ctx.lineWidth=1;for(let e=0;e<this.mapHeight;e++)for(let n=0;n<this.mapWidth;n++){const r=this.mapToScreen(n,e),s=this.tileSizeX/2*this.zoom,i=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.strokeStyle="rgba(0, 255, 0, 0.5)",this.ctx.lineWidth=1;const o=this.tileSizeX*this.zoom,l=this.tileSizeY*this.zoom,c=r.y+i,u=r.x-o/2,h=c-l;this.ctx.strokeRect(u,h,o,l),this.ctx.strokeStyle="rgba(255, 0, 0, 0.5)",this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.font="10px Arial",this.ctx.textAlign="center",this.ctx.fillText(`${n},${e}`,r.x,r.y)}}}toggleDebugMode(){this.debugMode=!this.debugMode,this.draw()}getDebugMode(){return this.debugMode}setZoom(e){this.zoom=Math.max(.1,Math.min(5,e)),this.draw()}getZoom(){return this.zoom}zoomIn(){this.setZoom(this.zoom*1.2)}zoomOut(){this.setZoom(this.zoom/1.2)}resetZoom(){this.zoom=1,this.panX=0,this.panY=0,this.draw()}toggleMinimap(){this.showMinimap=!this.showMinimap,this.draw()}setSidebarTransitioning(e){this.sidebarTransitioning=!!e,this.sidebarTransitioning||(this.lastMiniMapPos=null)}setPan(e,n){this.panX+=e,this.panY+=n,this.draw()}resizeCanvasToContainer(){this.resizeCanvas()}drawGrid(){this.ctx.strokeStyle=this.isDarkMode?"#666":"#999",this.ctx.lineWidth=Math.max(1,Math.min(3,2/this.zoom)),this.ctx.globalAlpha=.8;for(let e=0;e<this.mapHeight;e++)for(let n=0;n<this.mapWidth;n++){const r=this.mapToScreen(n,e),s=this.tileSizeX/2*this.zoom,i=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke()}this.ctx.globalAlpha=1}drawTiles(){const e=[...this.tileLayers].reverse();for(const n of e){if(!n.visible)continue;const r=this.layerTilesets.get(n.type);if(!r||!r.image)continue;this.ctx.globalAlpha=n.transparency||1;const s=this.layerTileData.get(n.type)||new Map;for(let i=0;i<this.mapHeight;i++)for(let o=0;o<this.mapWidth;o++){const l=i*this.mapWidth+o,c=n.data[l];c>0&&this.drawTileFromLayer(o,i,c,r,s)}}this.ctx.globalAlpha=1}drawTileFromLayer(e,n,r,s,i){if(!s.image||r<=0)return;const o=i.get(r);let l,c,u,h,f,p;if(o)l=o.sourceX,c=o.sourceY,u=o.width,h=o.height,f=o.originX,p=o.originY;else{const M=r-1;l=M%s.columns*this.tileSizeX,c=Math.floor(M/s.columns)*this.tileSizeY,u=this.tileSizeX,h=this.tileSizeY}const b=this.mapToScreen(e,n),v=u*this.zoom,S=h*this.zoom,j=this.tileSizeY/2*this.zoom,x=b.y+j,g=typeof f=="number"?f:Math.floor(u/2),y=typeof p=="number"?p:h,k=b.x-g*this.zoom,C=x-y*this.zoom;this.ctx.drawImage(s.image,l,c,u,h,k,C,v,S)}drawTile(e,n,r){if(!this.tilesetImage||r<=0)return;const s=this.detectedTileData.get(r);let i,o,l,c,u,h;if(s)i=s.sourceX,o=s.sourceY,l=s.width,c=s.height,u=s.originX,h=s.originY;else{const k=r-1;i=k%this.tilesetColumns*this.tileSizeX,o=Math.floor(k/this.tilesetColumns)*this.tileSizeY,l=this.tileSizeX,c=this.tileSizeY}const f=this.mapToScreen(e,n),p=l*this.zoom,b=c*this.zoom,v=this.tileSizeY/2*this.zoom,S=f.y+v,j=typeof u=="number"?u:Math.floor(l/2),x=typeof h=="number"?h:c,g=f.x-j*this.zoom,y=S-x*this.zoom;this.ctx.drawImage(this.tilesetImage,i,o,l,c,g,y,p,b)}drawHover(){const e=this.mapToScreen(this.hoverX,this.hoverY),n=this.tileSizeX/2*this.zoom,r=this.tileSizeY/2*this.zoom,s=this.getActiveLayer();s&&["enemy","npc","object","event","background"].includes(s.type)&&this.getObjectsAtPosition(this.hoverX,this.hoverY).length>0?(this.ctx.save(),[{color:"rgba(255, 107, 0, 0.1)",width:8},{color:"rgba(255, 107, 0, 0.2)",width:6},{color:"rgba(255, 107, 0, 0.3)",width:4},{color:"rgba(255, 107, 0, 0.5)",width:2}].forEach(c=>{this.ctx.strokeStyle=c.color,this.ctx.lineWidth=Math.max(1,Math.min(c.width,c.width/this.zoom)),this.ctx.shadowColor="#ff6b00",this.ctx.shadowBlur=Math.max(2,Math.min(10,c.width/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.strokeStyle="#ff6b00",this.ctx.lineWidth=Math.max(1,Math.min(3,3/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()):(this.ctx.strokeStyle="#007acc",this.ctx.lineWidth=Math.max(1,Math.min(3,2/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke())}drawSelection(){this.isSelecting&&(this.currentSelectionTool==="rectangular"||this.currentSelectionTool==="circular")&&(this.ctx.strokeStyle="#ff6b00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.setLineDash([5,5]),this.currentSelectionTool==="rectangular"?this.drawRectangularSelectionPreview():this.currentSelectionTool==="circular"&&this.drawCircularSelectionPreview(),this.ctx.setLineDash([])),this.selection.active&&this.selection.tiles.length>0&&(this.ctx.strokeStyle="#00ff00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.selection.tiles.forEach(e=>{const n=this.mapToScreen(e.x,e.y),r=this.tileSizeX/2*this.zoom,s=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(n.x,n.y-s),this.ctx.lineTo(n.x+r,n.y),this.ctx.lineTo(n.x,n.y+s),this.ctx.lineTo(n.x-r,n.y),this.ctx.closePath(),this.ctx.stroke()}))}drawRectangularSelectionPreview(){const e=Math.min(this.selection.startX,this.selection.endX),n=Math.max(this.selection.startX,this.selection.endX),r=Math.min(this.selection.startY,this.selection.endY),s=Math.max(this.selection.startY,this.selection.endY);for(let i=r;i<=s;i++)for(let o=e;o<=n;o++)if(o>=0&&o<this.mapWidth&&i>=0&&i<this.mapHeight){const l=this.mapToScreen(o,i),c=this.tileSizeX/2*this.zoom,u=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(l.x,l.y-u),this.ctx.lineTo(l.x+c,l.y),this.ctx.lineTo(l.x,l.y+u),this.ctx.lineTo(l.x-c,l.y),this.ctx.closePath(),this.ctx.stroke()}}drawCircularSelectionPreview(){const e=Math.sqrt(Math.pow(this.selection.endX-this.selection.startX,2)+Math.pow(this.selection.endY-this.selection.startY,2));for(let n=0;n<this.mapHeight;n++)for(let r=0;r<this.mapWidth;r++)if(Math.sqrt(Math.pow(r-this.selection.startX,2)+Math.pow(n-this.selection.startY,2))<=e){const i=this.mapToScreen(r,n),o=this.tileSizeX/2*this.zoom,l=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y-l),this.ctx.lineTo(i.x+o,i.y),this.ctx.lineTo(i.x,i.y+l),this.ctx.lineTo(i.x-o,i.y),this.ctx.closePath(),this.ctx.stroke()}}drawShapePreview(){!this.isDrawingShape||this.shapeDrawing.preview.length===0||(this.ctx.strokeStyle="#0099ff",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.setLineDash([3,3]),this.shapeDrawing.preview.forEach(e=>{const n=this.mapToScreen(e.x,e.y),r=this.tileSizeX/2*this.zoom,s=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(n.x,n.y-s),this.ctx.lineTo(n.x+r,n.y),this.ctx.lineTo(n.x,n.y+s),this.ctx.lineTo(n.x-r,n.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.setLineDash([]))}drawHeroPosition(){const e=this.mapToScreen(this.heroX,this.heroY),n=this.tileSizeX/2*this.zoom,r=this.tileSizeY/2*this.zoom;this.ctx.save(),this.hoverX===this.heroX&&this.hoverY===this.heroY&&[{color:"rgba(255, 107, 0, 0.1)",width:8},{color:"rgba(255, 107, 0, 0.2)",width:6},{color:"rgba(255, 107, 0, 0.3)",width:4},{color:"rgba(255, 107, 0, 0.5)",width:2}].forEach(o=>{this.ctx.strokeStyle=o.color,this.ctx.lineWidth=Math.max(1,Math.min(o.width,o.width/this.zoom)),this.ctx.shadowColor="#ff6b00",this.ctx.shadowBlur=Math.max(2,Math.min(10,o.width/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.fillStyle="#ff6b00",this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.fill(),this.ctx.strokeStyle="#ff8c00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke(),this.drawHeroIcon(e.x,e.y),this.ctx.restore()}drawHeroIcon(e,n){const s=Math.max(12,Math.min(20,16*this.zoom))/2;this.ctx.save(),this.ctx.fillStyle="#ffffff",this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1.5,this.ctx.beginPath(),this.ctx.arc(e,n-s*.6,s*.25,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.roundRect(e-s*.3,n-s*.2,s*.6,s*.8,s*.15),this.ctx.fill(),this.ctx.restore()}getActorLayerType(e){return e.type==="npc"||e.category==="npc"?"npc":e.type==="enemy"||e.category==="enemy"||e.category==="creature"||e.type==="creature"?e.category==="npc"?"npc":"enemy":null}getActorLayerByType(e){return this.tileLayers.find(n=>n.type===e)||null}actorUsesPlaceholder(e){const n=this.getActorLayerType(e);if(!n)return!1;const r=this.getActorLayerByType(n);if(!r)return!1;const s=e.y*this.mapWidth+e.x;return s<0||s>=r.data.length?!1:r.data[s]===0}drawActorPlaceholders(){for(const e of this.objects){if(!this.actorUsesPlaceholder(e))continue;const n=this.getActorLayerType(e);n&&this.drawActorPlaceholder(e,n)}}drawActorPlaceholder(e,n){const r=this.mapToScreen(e.x,e.y),s=this.tileSizeX/2*this.zoom,i=this.tileSizeY/2*this.zoom;this.ctx.save();const o=this.hoverX===e.x&&this.hoverY===e.y,l=this.isDraggingActor&&this.draggingActorId===e.id;(o||l)&&[{color:"rgba(255, 107, 0, 0.1)",width:8},{color:"rgba(255, 107, 0, 0.2)",width:6},{color:"rgba(255, 107, 0, 0.3)",width:4},{color:"rgba(255, 107, 0, 0.5)",width:2}].forEach(u=>{this.ctx.strokeStyle=u.color,this.ctx.lineWidth=Math.max(1,Math.min(u.width,u.width/this.zoom)),this.ctx.shadowColor="#ff6b00",this.ctx.shadowBlur=Math.max(2,Math.min(10,u.width/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.fillStyle="#ff6b00",this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.fill(),this.ctx.strokeStyle="#ff8c00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke(),this.drawActorIcon(r.x,r.y,n),this.ctx.restore()}drawActorIcon(e,n,r){const s=Math.max(10,Math.min(18,14*this.zoom)),i=r==="npc"?"N":"E";this.ctx.save(),this.ctx.fillStyle="#ffffff",this.ctx.font=`bold ${s}px "Segoe UI", sans-serif`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(i,e,n),this.ctx.restore()}drawStampPreview(){if(!(!this.stampPreview.visible||!this.activeStamp)){this.ctx.strokeStyle="#00ff00",this.ctx.fillStyle="rgba(0, 255, 0, 0.2)",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.setLineDash([3,3]);for(let e=0;e<this.activeStamp.height;e++)for(let n=0;n<this.activeStamp.width;n++){const r=this.stampPreview.x+n,s=this.stampPreview.y+e;if(r>=0&&r<this.mapWidth&&s>=0&&s<this.mapHeight){const i=this.mapToScreen(r,s),o=this.tileSizeX/2*this.zoom,l=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y-l),this.ctx.lineTo(i.x+o,i.y),this.ctx.lineTo(i.x,i.y+l),this.ctx.lineTo(i.x-o,i.y),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()}}this.ctx.setLineDash([])}}drawMiniMap(){if(!this.showMinimap)return;const e=150,n=120,r=10,s=this.mapCanvas.getBoundingClientRect(),i=window.innerWidth-e-r,o=window.innerHeight-n-r;let l=Math.floor(i-s.left),c=Math.floor(o-s.top);l=Math.max(0,Math.min(this.mapCanvas.width-e,l)),c=Math.max(0,Math.min(this.mapCanvas.height-n,c)),this.lastMiniMapPos={x:l,y:c},this.ctx.save();const u=5,h=l-u,f=c-u,p=e+u*2,b=n+u*2,v=Math.min(12,Math.floor(Math.min(p,b)/6)),S=Math.min(8,Math.floor(Math.min(e,n)/8)),j=(E,$,D,G,q)=>{const se=Math.max(0,Math.min(q,Math.min(D,G)/2));this.ctx.beginPath(),this.ctx.moveTo(E+se,$),this.ctx.lineTo(E+D-se,$),this.ctx.quadraticCurveTo(E+D,$,E+D,$+se),this.ctx.lineTo(E+D,$+G-se),this.ctx.quadraticCurveTo(E+D,$+G,E+D-se,$+G),this.ctx.lineTo(E+se,$+G),this.ctx.quadraticCurveTo(E,$+G,E,$+G-se),this.ctx.lineTo(E,$+se),this.ctx.quadraticCurveTo(E,$,E+se,$),this.ctx.closePath()};this.ctx.fillStyle=this.isDarkMode?"rgba(42, 42, 42, 0.9)":"rgba(0, 0, 0, 0.7)",j(h,f,p,b,v),this.ctx.fill(),this.ctx.fillStyle=this.isDarkMode?"#2a2a2a":"#f0f0f0",j(l,c,e,n,S),this.ctx.fill(),this.ctx.strokeStyle=this.isDarkMode?"#999":"#333",this.ctx.lineWidth=1,j(l,c,e,n,S),this.ctx.stroke();const x=Math.floor(e/this.mapWidth)||1,g=Math.floor(n/this.mapHeight)||1,y=Math.max(1,Math.min(x,g)),k=this.mapWidth*y,C=this.mapHeight*y,M=l+Math.floor((e-k)/2),P=c+Math.floor((n-C)/2);this.ctx.imageSmoothingEnabled=!1;for(let E=0;E<this.tileLayers.length;E++){const $=this.tileLayers[E];if($.visible)for(let D=0;D<this.mapHeight;D++)for(let G=0;G<this.mapWidth;G++){const q=D*this.mapWidth+G,se=$.data[q];if(se>0){const X=M+G*y,oe=P+D*y,Se=se*137.5%360;this.ctx.fillStyle=`hsl(${Se}, 55%, ${E===0?"45%":"60%"})`,this.ctx.fillRect(X,oe,y,y)}}}if(y>=3){this.ctx.strokeStyle=this.isDarkMode?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.05)",this.ctx.lineWidth=.5;for(let E=0;E<this.mapHeight;E++)for(let $=0;$<this.mapWidth;$++){const D=M+$*y+.25,G=P+E*y+.25;this.ctx.strokeRect(D,G,y-.5,y-.5)}}this.ctx.restore()}handleFileUpload(e,n){if(n==="tileset"){const r=new FileReader;r.onload=s=>{var o;const i=new Image;i.onload=()=>{this.tilesetImage=i,this.tilesetFileName=e.name;const l=Math.max(1,Math.floor(i.width/this.tileSizeX)),c=Math.max(1,Math.floor(i.height/this.tileSizeY));this.tilesetColumns=l,this.tilesetRows=c,this.tileCount=l*c,this.tilesetTileWidth=l>0?Math.round(i.width/l):this.tileSizeX,this.tilesetTileHeight=c>0?Math.round(i.height/c):this.tileSizeY,this.tilesetSpacing=0,this.tilesetMargin=0,this.tilesetSourcePath=this.extractFileSourcePath(e),this.createTilePalette(),this.draw()},i.src=(o=s.target)==null?void 0:o.result},r.readAsDataURL(e)}else if(n==="layerTileset"){const r=this.tileLayers.find(s=>s.id===this.activeLayerId);r&&this.setLayerTileset(r.type,e)}}createTilePalette(e=!1){const n=document.getElementById("tilesContainer");if(!n||!this.tilesetImage)return;n.innerHTML="";let r;if(e&&this.detectedTileData.size>0)r=Array.from(this.detectedTileData.entries()).map(([o,l])=>({index:o,sourceX:l.sourceX,sourceY:l.sourceY,width:l.width,height:l.height}));else{this.detectedTileData.clear(),r=this.detectVariableSizedTiles().map(c=>(this.detectedTileData.set(c.index,{sourceX:c.sourceX,sourceY:c.sourceY,width:c.width,height:c.height,originX:Math.floor(c.width/2),originY:c.height}),c));const l=this.tileLayers.find(c=>c.id===this.activeLayerId);if(l){const c=new Map;for(const[u,h]of this.detectedTileData.entries())c.set(u,{sourceX:h.sourceX,sourceY:h.sourceY,width:h.width,height:h.height,originX:h.originX,originY:h.originY});this.layerTileData.set(l.type,c),console.log(`Stored ${c.size} newly detected tiles for layer type: ${l.type}`)}}let s=0;const i=()=>document.getElementById("brushToolState")||document.querySelector("[data-brush-tool]");for(const o of r){const l=document.createElement("canvas");l.width=o.width,l.height=o.height,l.width=o.width,l.height=o.height,l.className="palette-tile",l.style.setProperty("--tile-width",`${o.width}px`),l.style.setProperty("--tile-height",`${o.height}px`);const c=l.getContext("2d");if(c){c.drawImage(this.tilesetImage,o.sourceX,o.sourceY,o.width,o.height,0,0,o.width,o.height);const x=Math.floor(o.width/2),g=Math.floor(o.height/2);c.strokeStyle="rgba(255,0,0,0.8)",c.lineWidth=1,c.beginPath(),c.moveTo(x-3,g),c.lineTo(x+3,g),c.moveTo(x,g-3),c.lineTo(x,g+3),c.stroke()}const u=document.createElement("div");u.className="brush-wrapper",u.style.position="relative",u.style.display="inline-block",u.style.margin="2px";const h=document.createElement("div");h.className="selection-number",h.style.position="absolute",h.style.top="2px",h.style.left="2px",h.style.background="red",h.style.color="white",h.style.borderRadius="50%",h.style.width="16px",h.style.height="16px",h.style.fontSize="10px",h.style.display="none",h.style.alignItems="center",h.style.justifyContent="center",h.style.fontWeight="bold",h.style.zIndex="10";const f=document.createElement("div");f.className="remove-overlay",f.style.position="absolute",f.style.top="0",f.style.left="0",f.style.right="0",f.style.bottom="0",f.style.background="rgba(255, 0, 0, 0.7)",f.style.display="none",f.style.alignItems="center",f.style.justifyContent="center",f.style.fontSize="24px",f.style.color="white",f.style.cursor="pointer",f.style.zIndex="10",f.textContent="✕";const p=document.createElement("div");p.className="separate-icon",p.style.position="absolute",p.style.top="50%",p.style.left="50%",p.style.transform="translate(-50%, -50%)",p.style.display="none",p.style.alignItems="center",p.style.justifyContent="center",p.style.background="none",p.style.color="white",p.style.zIndex="2",p.style.pointerEvents="none",p.style.width="24px",p.style.height="24px",p.innerHTML=`
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="6" cy="6" r="3"></circle>
          <circle cx="6" cy="18" r="3"></circle>
          <line x1="20" y1="4" x2="8.12" y2="15.88"></line>
          <line x1="14.47" y1="14.48" x2="20" y2="20"></line>
          <line x1="8.12" y1="8.12" x2="12" y2="12"></line>
        </svg>
      `;const b=document.createElement("div");b.className="merge-icon",b.style.position="absolute",b.style.top="50%",b.style.left="50%",b.style.transform="translate(-50%, -50%)",b.style.display="none",b.style.alignItems="center",b.style.justifyContent="center",b.style.background="none",b.style.color="white",b.style.zIndex="2",b.style.pointerEvents="none",b.style.width="24px",b.style.height="24px",b.innerHTML=`
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m8 6 4-4 4 4"></path>
          <path d="M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22"></path>
          <path d="m20 22-6.828-6.828A4 4 0 0 1 12 12.3"></path>
        </svg>
      `,f.addEventListener("click",x=>{x.preventDefault(),x.stopPropagation(),console.log(`Remove overlay clicked for tile index: ${o.index}`),this.handleBrushRemove(o.index)}),l.addEventListener("click",x=>{x.preventDefault();const g=i(),y=(g==null?void 0:g.getAttribute("data-brush-tool"))||"none";if(console.log(`Tile clicked! Index: ${o.index}, Current brush tool: ${y}`),y==="merge"){console.log("Handling merge tool selection (no auto-merge)"),this.handleBrushMerge(o.index,u);return}if(y==="separate"){console.log("Handling separate tool"),this.handleBrushSeparate(o.index);return}if(y==="remove"){console.log("Handling remove tool"),this.handleBrushRemove(o.index);return}if(x.ctrlKey||x.metaKey){if(this.multiSelectedBrushes.has(o.index)?this.multiSelectedBrushes.delete(o.index):this.multiSelectedBrushes.add(o.index),this.multiSelectedBrushes.size===1){const C=Array.from(this.multiSelectedBrushes.values())[0];this.setCurrentLayerActiveGid(C)}this.updateActiveTile();return}this.multiSelectedBrushes.clear(),this.setCurrentLayerActiveGid(o.index),this.updateActiveTile()}),u.draggable=!1,u.addEventListener("dragstart",x=>{const g=i();((g==null?void 0:g.getAttribute("data-brush-tool"))||"none")==="move"?(u.style.opacity="0.5",x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("text/plain",o.index.toString()),this.dispatchBrushEvent("dragstart",o.index)):x.preventDefault()}),u.addEventListener("dragend",x=>{u.style.opacity="1",this.dispatchBrushEvent("dragend",o.index)}),u.addEventListener("dragover",x=>{const g=i();((g==null?void 0:g.getAttribute("data-brush-tool"))||"none")==="move"&&(x.preventDefault(),x.dataTransfer.dropEffect="move",u.style.borderTop="3px solid #007acc")}),u.addEventListener("dragleave",x=>{u.style.borderTop=""}),u.addEventListener("drop",x=>{x.preventDefault(),u.style.borderTop="";const g=i();if(((g==null?void 0:g.getAttribute("data-brush-tool"))||"none")==="move"){const k=parseInt(x.dataTransfer.getData("text/plain")),C=o.index;k!==C&&this.dispatchBrushEvent("drop",{from:k,to:C})}});const v=()=>{const x=i(),g=(x==null?void 0:x.getAttribute("data-brush-tool"))||"none";u.classList.remove("separate-mode","merge-mode","merge-selected-first","merge-selected-second"),u.draggable=!1,u.style.cursor="",u.title="",u.setAttribute("data-tile-index",o.index.toString()),g==="move"?(u.draggable=!0,u.style.cursor="move",u.title="Drag to reorder"):g==="separate"?(u.classList.add("separate-mode"),u.style.cursor="pointer",u.title="Click to separate"):g==="merge"&&(u.classList.add("merge-mode"),u.style.cursor="pointer",u.title="Click to merge (max 2 brushes)")};v();const S=new MutationObserver(()=>{v()}),j=i();j&&S.observe(j,{attributes:!0,attributeFilter:["data-brush-tool"]}),u.addEventListener("mouseenter",()=>{const x=document.querySelector("[data-brush-tool]");((x==null?void 0:x.getAttribute("data-brush-tool"))||"none")==="remove"&&(f.style.display="flex")}),u.addEventListener("mouseleave",()=>{f.style.display="none"}),l.setAttribute("data-tile-index",o.index.toString()),l.setAttribute("data-tile-width",o.width.toString()),l.setAttribute("data-tile-height",o.height.toString()),l.setAttribute("data-source-x",o.sourceX.toString()),l.setAttribute("data-source-y",o.sourceY.toString()),l.setAttribute("data-origin-x",Math.floor(o.width/2).toString()),l.setAttribute("data-origin-y",Math.floor(o.height/2).toString()),u.appendChild(l),u.appendChild(h),u.appendChild(f),u.appendChild(p),u.appendChild(b),n.appendChild(u),s++}console.log(`Created ${s} variable-sized tiles from tileset`)}handleBrushMerge(e,n){const r=document.querySelector(".merge-selected-first"),s=document.querySelector(".merge-selected-second");if(n.classList.contains("merge-selected-first")||n.classList.contains("merge-selected-second")){n.classList.remove("merge-selected-first","merge-selected-second");return}if(!r)n.classList.add("merge-selected-first");else if(!s)n.classList.add("merge-selected-second");else return}performMerge(e,n){console.log(`Merging tiles ${e} and ${n}`);try{this.mergeBrushes([e,n]),console.log(`Successfully merged brushes ${e} and ${n}`)}catch(r){console.error("Failed to merge brushes:",r)}}handleBrushSeparate(e){this.dispatchBrushEvent("separate",e)}handleBrushRemove(e){console.log(`handleBrushRemove called with tileIndex: ${e}`),this.dispatchBrushEvent("remove",e)}dispatchBrushEvent(e,n){const r=new CustomEvent("brushAction",{detail:typeof n=="number"?{action:e,tileIndex:n}:{action:e,...n}});document.dispatchEvent(r)}detectVariableSizedTiles(){if(!this.tilesetImage)return[];const e=[],n=document.createElement("canvas");n.width=this.tilesetImage.width,n.height=this.tilesetImage.height;const r=n.getContext("2d");if(!r)return[];r.drawImage(this.tilesetImage,0,0);const i=r.getImageData(0,0,this.tilesetImage.width,this.tilesetImage.height).data,o=new Array(this.tilesetImage.width*this.tilesetImage.height).fill(!1);let l=1;const c=[];for(let u=0;u<this.tilesetImage.height;u++)for(let h=0;h<this.tilesetImage.width;h++){const f=u*this.tilesetImage.width+h;if(o[f]||this.isPixelTransparent(i,h,u,this.tilesetImage.width))continue;const p=this.floodFillObjectData(i,this.tilesetImage.width,this.tilesetImage.height,h,u,o);p&&this.isValidObjectSize(p.bounds)&&c.push(p)}for(const u of c){const h=this.intelligentObjectSplit(u);for(const f of h)e.push({index:l++,sourceX:f.x,sourceY:f.y,width:f.width,height:f.height})}return e}isPixelTransparent(e,n,r,s){const i=(r*s+n)*4+3;return e[i]<=this.tileContentThreshold}floodFillObjectData(e,n,r,s,i,o){const l=[{x:s,y:i}];let c=s,u=s,h=i,f=i,p=0;const b=[];for(;l.length>0;){const y=l.pop(),{x:k,y:C}=y;if(k<0||k>=n||C<0||C>=r)continue;const M=C*n+k;o[M]||this.isPixelTransparent(e,k,C,n)||(o[M]=!0,p++,b.push({x:k,y:C}),c=Math.min(c,k),u=Math.max(u,k),h=Math.min(h,C),f=Math.max(f,C),l.push({x:k+1,y:C}),l.push({x:k-1,y:C}),l.push({x:k,y:C+1}),l.push({x:k,y:C-1}),l.push({x:k+1,y:C+1}),l.push({x:k+1,y:C-1}),l.push({x:k-1,y:C+1}),l.push({x:k-1,y:C-1}))}if(p===0)return null;const v=1,S=Math.max(0,c-v),j=Math.max(0,h-v),x=Math.min(n-1,u+v),g=Math.min(r-1,f+v);return{bounds:{x:S,y:j,width:x-S+1,height:g-j+1},pixels:b}}intelligentObjectSplit(e){const{bounds:n,pixels:r}=e,{width:s,height:i}=n,o=r.length,l=s*i,c=o/l,u=Math.max(this.tileSizeX,this.tileSizeY),h=this.shouldSplitDirection(r,n,"horizontal",u),f=this.shouldSplitDirection(r,n,"vertical",u),p=this.isFloorPattern(n,r),b=this.isVerticalWall(n,r),v=this.isHorizontalWall(n,r);return console.log(`Object analysis: ${s}x${i}, density: ${c.toFixed(2)}, floor: ${p}, vWall: ${b}, hWall: ${v}`),p?(console.log("Detected floor/ground pattern - splitting into individual tiles"),this.splitObjectByGrid(e,"horizontal")):b?(console.log("Detected vertical wall/structure - keeping as single tile"),[n]):v?(console.log("Detected horizontal wall - keeping as single tile"),[n]):h&&s>this.tileSizeX*1.5?(console.log("Splitting horizontal arrangement into individual objects"),this.splitObjectByGrid(e,"horizontal")):f&&i>this.tileSizeY*1.5&&!this.isLikelySingleVerticalObject(n,r)?(console.log("Splitting vertical arrangement into individual objects"),this.splitObjectByGrid(e,"vertical")):c<.4&&l>u*u*2?(console.log("Splitting sparse large object"),this.splitObjectByDensity(e)):(s>this.tileSizeX*1.8||i>this.tileSizeY*1.8)&&!b&&!v&&c<.8?(console.log("Splitting large non-wall object into tile-sized pieces"),this.splitObjectByGrid(e,s>i?"horizontal":"vertical")):(console.log("Keeping as single object"),[n])}isVerticalWall(e,n){const{width:r,height:s}=e,i=s/r,o=n.length/(r*s);if(i<1.5||o<.5)return!1;const l=this.hasConsistentVerticalWidth(n,e),c=this.hasVerticalContinuity(n,e),u=s>this.tileSizeY*1.5&&r<=this.tileSizeX*1.2;return l&&c||u&&o>.6}isHorizontalWall(e,n){const{width:r,height:s}=e,i=r/s,o=n.length/(r*s);if(i<2||o<.6||s<this.tileSizeY*.7)return!1;const l=this.hasConsistentHorizontalHeight(n,e),c=this.hasHorizontalContinuity(n,e);return l&&c}isLikelySingleVerticalObject(e,n){const{width:r,height:s}=e;return n.length/(r*s)>.7?!0:this.hasVerticalContinuity(n,e)}hasConsistentVerticalWidth(e,n){const{y:r,height:s}=n,i=Math.max(1,Math.floor(s/5)),o=[];for(let h=0;h<5;h++){const f=r+h*i,p=Math.min(f+i,r+s);let b=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,S=!1;for(const j of e)j.y>=f&&j.y<p&&(b=Math.min(b,j.x),v=Math.max(v,j.x),S=!0);S&&o.push(v-b+1)}if(o.length<2)return!1;const l=o.reduce((h,f)=>h+f,0)/o.length,c=o.reduce((h,f)=>h+Math.pow(f-l,2),0)/o.length,u=Math.sqrt(c);return l>0&&u/l<.3}hasConsistentHorizontalHeight(e,n){const{x:r,width:s}=n,i=Math.max(1,Math.floor(s/5)),o=[];for(let h=0;h<5;h++){const f=r+h*i,p=Math.min(f+i,r+s);let b=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,S=!1;for(const j of e)j.x>=f&&j.x<p&&(b=Math.min(b,j.y),v=Math.max(v,j.y),S=!0);S&&o.push(v-b+1)}if(o.length<2)return!1;const l=o.reduce((h,f)=>h+f,0)/o.length,c=o.reduce((h,f)=>h+Math.pow(f-l,2),0)/o.length,u=Math.sqrt(c);return l>0&&u/l<.3}hasVerticalContinuity(e,n){const{y:r,height:s}=n,i=Math.max(1,Math.floor(s/10));let o=0,l=0;for(let c=r;c<r+s;c+=i){const u=Math.min(c+i,r+s);let h=!1;for(const f of e)if(f.y>=c&&f.y<u){h=!0;break}h&&o++,l++}return l>0&&o/l>=.7}hasHorizontalContinuity(e,n){const{x:r,width:s}=n,i=Math.max(1,Math.floor(s/10));let o=0,l=0;for(let c=r;c<r+s;c+=i){const u=Math.min(c+i,r+s);let h=!1;for(const f of e)if(f.x>=c&&f.x<u){h=!0;break}h&&o++,l++}return l>0&&o/l>=.7}isFloorPattern(e,n){const{width:r,height:s}=e,i=s<=this.tileSizeY*.6,o=r>this.tileSizeX*1.3,l=this.hasRepeatingHorizontalPattern(n,e),c=this.hasDiamondLikeShape(n,e);return i&&o||l&&o||c&&o}hasRepeatingHorizontalPattern(e,n){const{x:r,width:s}=n,i=this.tileSizeX,o=Math.floor(s/i);if(o<2)return!1;const l=[];for(let f=0;f<o;f++){const p=r+f*i,b=p+i;let v=0;for(const S of e)S.x>=p&&S.x<b&&v++;l.push(v)}const c=l.reduce((f,p)=>f+p,0)/l.length,u=l.reduce((f,p)=>f+Math.pow(p-c,2),0)/l.length,h=Math.sqrt(u);return c>0&&h/c<.5}hasDiamondLikeShape(e,n){const{y:r,height:s}=n,i=[];for(let f=0;f<s;f++){let p=0;for(const b of e)b.y===r+f&&p++;i.push(p)}if(i.length<3)return!1;const o=Math.floor(i.length*.2),l=Math.floor(i.length*.3),c=Math.floor(i.length*.7),u=(i.slice(0,o).reduce((f,p)=>f+p,0)+i.slice(-o).reduce((f,p)=>f+p,0))/(o*2||1);return i.slice(l,c).reduce((f,p)=>f+p,0)/(c-l||1)>u*1.2}shouldSplitDirection(e,n,r,s){const{x:i,y:o,width:l,height:c}=n;if(r==="horizontal"){const u=[],h=Math.max(1,Math.floor(l/(l/s)));for(let v=0;v<l;v+=h){let S=0;for(const j of e)j.x>=i+v&&j.x<i+v+h&&S++;u.push(S)}let f=0,p=0;const b=u.reduce((v,S)=>v+S,0)/u.length;for(let v=0;v<u.length;v++)u[v]<b*.3?f++:u[v]>b*.7&&p++;return p>=2&&f>=1}else{const u=[],h=Math.max(1,Math.floor(c/(c/s)));for(let v=0;v<c;v+=h){let S=0;for(const j of e)j.y>=o+v&&j.y<o+v+h&&S++;u.push(S)}let f=0,p=0;const b=u.reduce((v,S)=>v+S,0)/u.length;for(let v=0;v<u.length;v++)u[v]<b*.3?f++:u[v]>b*.7&&p++;return p>=2&&f>=1}}splitObjectByGrid(e,n){const{bounds:r}=e,s=[];if(n==="horizontal"){const i=this.tileSizeX;for(let o=r.x;o<r.x+r.width;o+=i){const l=this.findContentInRegion(e.pixels,{x:o,y:r.y,width:Math.min(i,r.x+r.width-o),height:r.height});l&&s.push(l)}}else{const i=this.tileSizeY;for(let o=r.y;o<r.y+r.height;o+=i){const l=this.findContentInRegion(e.pixels,{x:r.x,y:o,width:r.width,height:Math.min(i,r.y+r.height-o)});l&&s.push(l)}}return s.length>0?s:[r]}splitObjectByDensity(e){const{bounds:n}=e,r=Math.min(this.tileSizeX,this.tileSizeY),s=[];for(let i=n.y;i<n.y+n.height;i+=r)for(let o=n.x;o<n.x+n.width;o+=r){const l=this.findContentInRegion(e.pixels,{x:o,y:i,width:Math.min(r,n.x+n.width-o),height:Math.min(r,n.y+n.height-i)});l&&s.push(l)}return s.length>0?s:[n]}findContentInRegion(e,n){let r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,l=!1;for(const u of e)u.x>=n.x&&u.x<n.x+n.width&&u.y>=n.y&&u.y<n.y+n.height&&(r=Math.min(r,u.x),s=Math.max(s,u.x),i=Math.min(i,u.y),o=Math.max(o,u.y),l=!0);if(!l)return null;const c=1;return{x:Math.max(0,r-c),y:Math.max(0,i-c),width:s-r+1+c*2,height:o-i+1+c*2}}isValidObjectSize(e){var s,i;const r=Math.max(((s=this.tilesetImage)==null?void 0:s.width)||512,((i=this.tilesetImage)==null?void 0:i.height)||512);return e.width>=8&&e.height>=8&&e.width<=r&&e.height<=r&&e.width*e.height>=8*8}setObjectSeparationSensitivity(e){this.objectSeparationSensitivity=Math.max(0,Math.min(1,e))}getObjectSeparationSensitivity(){return this.objectSeparationSensitivity}tileHasContent(e){try{const r=e.getImageData(0,0,this.tileSizeX,this.tileSizeY).data;for(let s=3;s<r.length;s+=4)if(r[s]>this.tileContentThreshold)return!0;return!1}catch(n){return console.warn("Could not analyze tile content, assuming tile has content:",n),!0}}updateActiveTile(){const e=document.getElementById("activeGid");e&&(e.textContent=this.activeGid.toString()),document.querySelectorAll(".palette-tile").forEach(r=>{r.classList.remove("selected","multi-selected");const s=parseInt(r.getAttribute("data-tile-index")||"0");s===this.activeGid&&this.activeGid>0&&r.classList.add("selected"),this.multiSelectedBrushes.has(s)&&r.classList.add("multi-selected")})}resizeMap(e,n){this.mapWidth=e,this.mapHeight=n;for(const r of this.tileLayers){const s=new Array(e*n).fill(0);for(let i=0;i<Math.min(n,this.mapHeight);i++)for(let o=0;o<Math.min(e,this.mapWidth);o++){const l=i*this.mapWidth+o,c=i*e+o;l<r.data.length&&(s[c]=r.data[l])}r.data=s}this.draw(),this.markAsChanged(!0)}addLayer(e,n){if(this.tileLayers.find(i=>i.type===n))return!1;this.saveState();const s={id:this.nextLayerId++,name:e,type:n,data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1};return this.tileLayers.push(s),this.sortLayersByPriority(),this.activeLayerId=s.id,this.draw(),this.markAsChanged(!0),!0}sortLayersByPriority(){const e={npc:1,enemy:2,event:3,collision:4,object:5,background:6};this.tileLayers.sort((n,r)=>e[n.type]-e[r.type])}deleteLayer(e){if(this.tileLayers.length<=1)return!1;const n=this.tileLayers.findIndex(r=>r.id===e);return n!==-1?(this.saveState(),this.tileLayers.splice(n,1),this.activeLayerId===e&&(this.activeLayerId=this.tileLayers.length>0?this.tileLayers[0].id:null),this.draw(),this.markAsChanged(!0),!0):!1}setActiveLayer(e){this.activeLayerId=e;const n=this.tileLayers.find(r=>r.id===e);n&&this.updateCurrentTileset(n.type),this.draw()}toggleLayerVisibility(e){const n=this.tileLayers.find(r=>r.id===e);n&&(n.visible=!n.visible,this.draw())}setLayerTransparency(e,n){const r=this.tileLayers.find(s=>s.id===e);r&&(r.transparency=Math.max(0,Math.min(1,n)),this.draw())}setMapName(e){if(typeof e=="string"){const n=e.trim();this.mapName=n.length>0?n:"Untitled Map"}else this.mapName="Untitled Map"}getMapName(){return this.mapName}setMapSize(e,n){this.mapWidth=e,this.mapHeight=n,this.collisionData=new Array(e*n).fill(0),this.tileLayers.forEach(r=>{const s=r.data;r.data=new Array(e*n).fill(0);for(let i=0;i<Math.min(n,15);i++)for(let o=0;o<Math.min(e,20);o++){const l=i*20+o,c=i*e+o;l<s.length&&(r.data[c]=s[l])}}),this.draw()}renameLayer(e,n){const r=this.tileLayers.find(s=>s.id===e);r&&(r.name=n)}changeLayerType(e,n,r){const s=this.tileLayers.find(i=>i.id===e);return s?(s.type=n,s.name=r,this.sortLayersByPriority(),!0):!1}setLayerType(e,n){const r=this.tileLayers.find(s=>s.id===e);r&&(r.type=n,this.sortLayersByPriority())}getLayers(){return this.tileLayers}getActiveLayerId(){return this.activeLayerId}getHoverCoordinates(){return this.hoverX>=0&&this.hoverY>=0?{x:this.hoverX,y:this.hoverY}:null}getActiveLayer(){return this.activeLayerId!==null&&this.tileLayers.find(e=>e.id===this.activeLayerId)||null}setCurrentTool(e){this.currentTool=e,this.tool="tiles"}getCurrentTool(){return this.currentTool}setCurrentSelectionTool(e){this.currentSelectionTool=e,this.tool="selection"}getCurrentSelectionTool(){return this.currentSelectionTool}setCurrentShapeTool(e){this.currentShapeTool=e,this.tool="shape"}getCurrentShapeTool(){return this.currentShapeTool}setEyedropperTool(){this.tool="eyedropper",this.mapCanvas.style.cursor="crosshair"}isEyedropperActive(){return this.tool==="eyedropper"}setEyedropperCallback(e){this.eyedropperCallback=e}setObjectsChangedCallback(e){this.objectsChangedCallback=e,e&&e(this.getMapObjects())}setStampTool(){this.tool="stamp",this.mapCanvas.style.cursor="crosshair",this.stampPreview.visible=!1}isStampActive(){return this.tool==="stamp"}setCurrentStampMode(e){this.currentStampMode=e,this.stampPreview.visible=e==="place"&&this.activeStamp!==null,this.draw()}getCurrentStampMode(){return this.currentStampMode}createStampFromSelection(e){if(!this.selection.active||this.selection.tiles.length===0)return!1;let n=1/0,r=1/0,s=-1/0,i=-1/0;for(const f of this.selection.tiles)n=Math.min(n,f.x),r=Math.min(r,f.y),s=Math.max(s,f.x),i=Math.max(i,f.y);const o=s-n+1,l=i-r+1,c=[],u=this.activeLayerId||0;for(const f of this.selection.tiles)f.gid>0&&c.push({tileId:f.gid,layerId:u,x:f.x-n,y:f.y-r});const h={id:Date.now().toString(),name:e,width:o,height:l,tiles:c};return this.stamps.set(h.id,h),this.clearSelection(),this.stampCallback&&this.stampCallback(Array.from(this.stamps.values())),!0}setActiveStamp(e){e&&this.stamps.has(e)?(this.activeStamp=this.stamps.get(e),this.currentStampMode="place",this.stampPreview.visible=!0):(this.activeStamp=null,this.stampPreview.visible=!1),this.draw()}getStamps(){return Array.from(this.stamps.values())}deleteStamp(e){return this.stamps.has(e)?(this.stamps.delete(e),this.activeStamp&&this.activeStamp.id===e&&(this.activeStamp=null,this.stampPreview.visible=!1),this.stampCallback&&this.stampCallback(Array.from(this.stamps.values())),this.draw(),!0):!1}setStampCallback(e){this.stampCallback=e}setHeroEditCallback(e){this.heroEditCallback=e}placeStamp(e,n){if(this.activeStamp&&!(e<0||n<0||e+this.activeStamp.width>this.mapWidth||n+this.activeStamp.height>this.mapHeight)){for(const r of this.activeStamp.tiles){const s=e+r.x,o=(n+r.y)*this.mapWidth+s;let l=this.tileLayers.find(c=>c.id===r.layerId);!l&&this.activeLayerId!==null&&(l=this.tileLayers.find(c=>c.id===this.activeLayerId)),l&&(l.data[o]=r.tileId)}this.saveState(),this.draw()}}buildStampFromMultiSelection(){if(this.multiSelectedBrushes.size===0)return null;const e=Array.from(this.multiSelectedBrushes.values()),n=e.length,r=Math.ceil(Math.sqrt(n)),s=Math.ceil(n/r),i=[];for(let o=0;o<n;o++){const l=e[o],c=o%r,u=Math.floor(o/r);i.push({tileId:l,layerId:this.activeLayerId??0,x:c,y:u})}return{id:`multiselection-${Date.now()}`,name:"MultiSelectStamp",width:r,height:s,tiles:i}}placeMultiSelectionAt(e,n){const r=this.buildStampFromMultiSelection();if(r){for(const s of r.tiles){const i=e+s.x,o=n+s.y;if(i<0||o<0||i>=this.mapWidth||o>=this.mapHeight)continue;const l=o*this.mapWidth+i,c=this.tileLayers.find(u=>u.id===(s.layerId||this.activeLayerId));c&&(c.data[l]=s.tileId)}this.saveState(),this.draw()}}clearSelection(){this.selection.active=!1,this.selection.tiles=[],this.draw()}hasActiveSelection(){return this.selection.active&&this.selection.tiles.length>0}getSelection(){return[...this.selection.tiles]}selectAll(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);if(e){this.selection.tiles=[];for(let n=0;n<this.mapHeight;n++)for(let r=0;r<this.mapWidth;r++){const s=n*this.mapWidth+r,i=e.data[s];this.selection.tiles.push({x:r,y:n,gid:i})}this.selection.active=!0,this.draw()}}deleteSelection(){if(!this.selection.active||this.selection.tiles.length===0)return;const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&(this.saveState(),this.selection.tiles.forEach(n=>{const r=n.y*this.mapWidth+n.x;e.data[r]=0}),this.clearSelection(),this.markAsChanged(),this.draw())}fillSelection(){if(!this.selection.active||this.selection.tiles.length===0||this.activeGid===0)return;const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&(this.saveState(),this.selection.tiles.forEach(n=>{const r=n.y*this.mapWidth+n.x;e.data[r]=this.activeGid}),this.markAsChanged(),this.draw())}bucketFill(e,n,r,s){const i=e.data[r*this.mapWidth+n];if(i===s)return;const o=[{x:n,y:r}],l=new Set;for(;o.length>0;){const{x:c,y:u}=o.pop(),h=u*this.mapWidth+c;c<0||c>=this.mapWidth||u<0||u>=this.mapHeight||l.has(h)||e.data[h]===i&&(l.add(h),e.data[h]=s,o.push({x:c+1,y:u}),o.push({x:c-1,y:u}),o.push({x:c,y:u+1}),o.push({x:c,y:u-1}))}}selectRectangular(e,n,r,s,i){this.selection.tiles=[];const o=Math.min(n,s),l=Math.max(n,s),c=Math.min(r,i),u=Math.max(r,i);for(let h=c;h<=u;h++)for(let f=o;f<=l;f++)if(f>=0&&f<this.mapWidth&&h>=0&&h<this.mapHeight){const p=h*this.mapWidth+f,b=e.data[p];this.selection.tiles.push({x:f,y:h,gid:b})}this.selection.active=!0}selectMagicWand(e,n,r){const s=e.data[r*this.mapWidth+n];this.selection.tiles=[];const i=[{x:n,y:r}],o=new Set;for(;i.length>0;){const{x:l,y:c}=i.pop(),u=c*this.mapWidth+l;l<0||l>=this.mapWidth||c<0||c>=this.mapHeight||o.has(u)||e.data[u]===s&&(o.add(u),this.selection.tiles.push({x:l,y:c,gid:s}),i.push({x:l+1,y:c}),i.push({x:l-1,y:c}),i.push({x:l,y:c+1}),i.push({x:l,y:c-1}))}this.selection.active=!0}selectSameTile(e,n,r){const s=e.data[r*this.mapWidth+n];this.selection.tiles=[];for(let i=0;i<this.mapHeight;i++)for(let o=0;o<this.mapWidth;o++){const l=i*this.mapWidth+o;e.data[l]===s&&this.selection.tiles.push({x:o,y:i,gid:s})}this.selection.active=!0}selectCircular(e,n,r,s,i){this.selection.tiles=[];const o=Math.sqrt(Math.pow(s-n,2)+Math.pow(i-r,2));for(let l=0;l<this.mapHeight;l++)for(let c=0;c<this.mapWidth;c++)if(Math.sqrt(Math.pow(c-n,2)+Math.pow(l-r,2))<=o){const h=l*this.mapWidth+c,f=e.data[h];this.selection.tiles.push({x:c,y:l,gid:f})}this.selection.active=!0}drawRectangleShape(e,n,r,s){const i=[],o=Math.min(e,r),l=Math.max(e,r),c=Math.min(n,s),u=Math.max(n,s);for(let h=o;h<=l;h++)for(let f=c;f<=u;f++)(h===o||h===l||f===c||f===u)&&h>=0&&h<this.mapWidth&&f>=0&&f<this.mapHeight&&i.push({x:h,y:f});return i}drawCircleShape(e,n,r,s){const i=[],o=Math.sqrt(Math.pow(r-e,2)+Math.pow(s-n,2));for(let l=0;l<360;l+=1){const c=l*Math.PI/180,u=Math.round(e+o*Math.cos(c)),h=Math.round(n+o*Math.sin(c));u>=0&&u<this.mapWidth&&h>=0&&h<this.mapHeight&&(i.some(f=>f.x===u&&f.y===h)||i.push({x:u,y:h}))}return i}drawLineShape(e,n,r,s){const i=[],o=Math.abs(r-e),l=Math.abs(s-n),c=e<r?1:-1,u=n<s?1:-1;let h=o-l,f=e,p=n,b=!1;for(;!b;){if(f>=0&&f<this.mapWidth&&p>=0&&p<this.mapHeight&&i.push({x:f,y:p}),f===r&&p===s){b=!0;continue}const v=2*h;v>-l&&(h-=l,f+=c),v<o&&(h+=o,p+=u)}return i}normalizePath(e){return e.replace(/\\/g,"/")}extractFileSourcePath(e){const n=e.path;return n&&typeof n=="string"?this.normalizePath(n):e.name?e.name:null}setLayerTileset(e,n){const r=new Image;r.onload=()=>{const s=Math.max(1,Math.floor(r.width/this.tileSizeX)),i=Math.max(1,Math.floor(r.height/this.tileSizeY)),o=Math.max(1,s*i),l=s>0?Math.round(r.width/s):this.tileSizeX,c=i>0?Math.round(r.height/i):this.tileSizeY,u=this.extractFileSourcePath(n);this.layerTilesets.set(e,{image:r,fileName:n.name,columns:s,rows:i,count:o,tileWidth:l,tileHeight:c,spacing:0,margin:0,sourcePath:u});const h=this.tileLayers.find(f=>f.id===this.activeLayerId);h&&h.type===e&&this.updateCurrentTileset(e)},r.src=URL.createObjectURL(n)}getCurrentLayerType(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);return e?e.type:null}hasLayerTileset(e){return this.layerTilesets.has(e)}createLayerTab(e,n){const r=this.layerTabs.get(e)||[],s=this.nextLayerTabId++,i={id:s,name:n||`Tab ${r.length+1}`};return r.push(i),this.layerTabs.set(e,r),this.layerActiveTabId.has(e)||this.layerActiveTabId.set(e,s),s}getLayerTabs(e){return this.layerTabs.get(e)||[]}setActiveLayerTab(e,n){this.layerActiveTabId.set(e,n);const r=this.layerTabs.get(e);if(r){const s=r.find(i=>i.id===n);if(s&&s.tileset&&s.tileset.image){const i=s.tileset.columns??(s.tileset.image?Math.max(1,Math.floor(s.tileset.image.width/this.tileSizeX)):1),o=s.tileset.rows??(s.tileset.image?Math.max(1,Math.floor(s.tileset.image.height/this.tileSizeY)):1),l=s.tileset.count??Math.max(1,i*o),c=s.tileset.tileWidth??(s.tileset.image?Math.round(s.tileset.image.width/i):this.tileSizeX),u=s.tileset.tileHeight??(s.tileset.image?Math.round(s.tileset.image.height/o):this.tileSizeY);if(this.layerTilesets.set(e,{image:s.tileset.image,fileName:s.tileset.fileName??null,columns:i,rows:o,count:l,tileWidth:c,tileHeight:u,spacing:s.tileset.spacing??0,margin:s.tileset.margin??0,sourcePath:s.tileset.sourcePath??null}),s.detectedTiles){this.detectedTileData.clear();for(const[h,f]of s.detectedTiles.entries())this.detectedTileData.set(h,f)}this.updateCurrentTileset(e)}else this.layerTilesets.delete(e),this.updateCurrentTileset(e)}}importBrushImageToLayerTab(e,n,r){return new Promise((s,i)=>{const o=new Image;o.onload=()=>{const c=(this.layerTabs.get(e)||[]).find(j=>j.id===n);if(!c)return i(new Error("Tab not found"));c.brushes||(c.brushes=[]),c.brushes.push({image:o,fileName:r.name,width:o.width,height:o.height});const u=Math.max(1,Math.floor(o.width/this.tileSizeX)),h=Math.max(1,Math.floor(o.height/this.tileSizeY)),f=Math.max(1,u*h),p=u>0?Math.round(o.width/u):this.tileSizeX,b=h>0?Math.round(o.height/h):this.tileSizeY,v=this.extractFileSourcePath(r);c.tileset?(c.tileset.image=o,c.tileset.fileName=r.name,c.tileset.columns=u,c.tileset.rows=h,c.tileset.count=f,c.tileset.tileWidth=p,c.tileset.tileHeight=b,c.tileset.spacing=0,c.tileset.margin=0,c.tileset.sourcePath=v):c.tileset={image:o,fileName:r.name,columns:u,rows:h,count:f,tileWidth:p,tileHeight:b,spacing:0,margin:0,sourcePath:v},this.layerActiveTabId.get(e)===n&&this.setActiveLayerTab(e,n),s()},o.onerror=l=>i(new Error("Failed to load brush image")),o.src=URL.createObjectURL(r)})}removeLayerTab(e,n){const r=this.layerTabs.get(e)||[],s=r.findIndex(i=>i.id===n);if(console.info(`removeLayerTab called for layer=${e} tabId=${n} (found idx=${s})`),s!==-1){const i=r.splice(s,1);if(console.info("removeLayerTab removed:",i),this.layerTabs.set(e,r),this.layerActiveTabId.get(e)===n)if(r.length>0)try{this.setActiveLayerTab(e,r[0].id)}catch(l){console.warn("setActiveLayerTab failed during removeLayerTab fallback to direct set:",l),this.layerActiveTabId.set(e,r[0].id),this.updateCurrentTileset(e)}else this.layerActiveTabId.delete(e),this.layerTilesets.delete(e),this.updateCurrentTileset(e)}else console.warn(`removeLayerTab: tab id ${n} not found in layer ${e}. Current tabs:`,r.map(i=>i.id))}getActiveLayerTabId(e){return this.layerActiveTabId.get(e)||null}updateCurrentTileset(e){const n=this.layerTilesets.get(e);if(n){this.tilesetImage=n.image,this.tilesetFileName=n.fileName,this.tilesetColumns=n.columns,this.tilesetRows=n.rows,this.tileCount=n.count,this.tilesetTileWidth=n.tileWidth??this.tileSizeX,this.tilesetTileHeight=n.tileHeight??this.tileSizeY,this.tilesetSpacing=n.spacing??0,this.tilesetMargin=n.margin??0,this.tilesetSourcePath=n.sourcePath??this.tilesetSourcePath;const r=this.layerTileData.get(e);if(this.detectedTileData.clear(),r)for(const[i,o]of r.entries())this.detectedTileData.set(i,o);const s=this.layerActiveGid.get(e)||0;this.updateActiveGid(s),this.createTilePalette()}else this.tilesetImage=null,this.tilesetFileName=null,this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.detectedTileData.clear(),this.updateActiveGid(0),this.clearTilePalette()}clearTilePalette(){const e=document.getElementById("tilesContainer");e&&(e.innerHTML="")}clearLayer(){if(this.activeLayerId!==null){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&e.data.fill(0)}this.draw()}removeLayerTileset(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);if(e){const n=e.type;this.layerTilesets.delete(n),this.layerTileData.delete(n),this.tilesetImage=null,this.tilesetFileName=null,this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.detectedTileData.clear(),this.activeGid=0,this.clearTilePalette(),this.draw()}}exportFlareMap(){if(!this.tilesetImage||!this.tilesetFileName){alert("Please load a tileset first before exporting.");return}const e=this.generateFlareMapTxt(),n=this.generateFlareTilesetDef();this.downloadFile(e,"map.txt","text/plain"),this.downloadFile(n,"tileset.txt","text/plain"),console.log("Flare-compatible map exported successfully!"),console.log("📁 Files exported:"),console.log("  • map.txt (place in maps/ folder)"),console.log("  • tileset.txt (place in tilesetdefs/ folder)"),console.log("🎮 Format: Fully compatible with Flare Engine"),this.logGlobalTilesetMapping()}logGlobalTilesetMapping(){console.log("??? Global Tileset Mapping:");const e=this.collectGlobalTilesets();for(const n of e){const r=n.offset+n.count-1;console.log(`  ${n.fileName} (${n.layerType}): IDs ${n.offset}-${r} (${n.count} tiles)`)}}autoSaveExport(){if(!this.tilesetImage||!this.tilesetFileName||!this.tileLayers.some(n=>n.data.some(r=>r!==0)))return!1;try{return this.saveToLocalStorage(),!0}catch(n){return console.warn("Auto-save failed:",n),!1}}collectGlobalTilesets(){const e=[],n=new Set,r=o=>{if(!o.fileName)return;const l=`${o.fileName}:${o.sourcePath??""}`;if(n.has(l))return;const c=Math.max(1,o.columns),u=Math.max(1,o.rows),h=Math.max(1,o.count),f=Math.max(1,o.tileWidth||this.tileSizeX),p=Math.max(1,o.tileHeight||this.tileSizeY),b=o.spacing??0,v=o.margin??0;e.push({id:l||o.fileName,layerType:o.layerType,fileName:o.fileName,count:h,columns:c,rows:u,tileWidth:f,tileHeight:p,spacing:b,margin:v,sourcePath:o.sourcePath,image:o.image,offset:0}),n.add(l)};if(this.tilesetFileName&&this.tileCount>0){const o=this.tilesetColumns||(this.tilesetImage?Math.max(1,Math.floor(this.tilesetImage.width/this.tileSizeX)):1),l=this.tilesetRows||(this.tilesetImage?Math.max(1,Math.floor(this.tilesetImage.height/this.tileSizeY)):1),c=this.tilesetTileWidth??(this.tilesetImage?Math.round(this.tilesetImage.width/Math.max(o,1)):this.tileSizeX),u=this.tilesetTileHeight??(this.tilesetImage?Math.round(this.tilesetImage.height/Math.max(l,1)):this.tileSizeY),h=Math.max(1,this.tileCount);r({layerType:"main",fileName:this.tilesetFileName,count:h,columns:o,rows:l,tileWidth:c,tileHeight:u,spacing:this.tilesetSpacing??0,margin:this.tilesetMargin??0,sourcePath:this.tilesetSourcePath,image:this.tilesetImage})}for(const[o,l]of this.layerTilesets.entries()){if(!l.fileName)continue;const c=l.columns??(l.image?Math.max(1,Math.floor(l.image.width/this.tileSizeX)):1),u=l.rows??(l.image?Math.max(1,Math.floor(l.image.height/this.tileSizeY)):1),h=l.count??Math.max(1,c*u),f=l.tileWidth??(l.image?Math.round(l.image.width/Math.max(c,1)):this.tileSizeX),p=l.tileHeight??(l.image?Math.round(l.image.height/Math.max(u,1)):this.tileSizeY);r({layerType:o,fileName:l.fileName,count:h,columns:c,rows:u,tileWidth:f,tileHeight:p,spacing:l.spacing??0,margin:l.margin??0,sourcePath:l.sourcePath??null,image:l.image??null})}const s={main:0,background:1,object:2,collision:3,event:4,enemy:5,npc:6};e.sort((o,l)=>{const c=(o.fileName||"").toLowerCase(),u=(l.fileName||"").toLowerCase();if(c<u)return-1;if(c>u)return 1;const h=s[o.layerType]??99,f=s[l.layerType]??99;return h<f?-1:h>f?1:0});let i=1;for(const o of e)o.offset=i,i+=Math.max(1,o.count);return e}resolveTilesetExportPath(e,n){const r=[];if(e.id&&r.push(e.id),e.sourcePath&&r.push(e.sourcePath),e.fileName&&r.push(e.fileName),n){for(const s of r)if(s&&n[s])return this.normalizePath(n[s])}if(e.sourcePath){const s=this.normalizePath(e.sourcePath);if(/[/\\]/.test(s))return s}return e.fileName?`images/tilesets/${e.fileName}`:"tileset.png"}generateFlareMapTxt(e={}){const n=[];n.push("[header]"),n.push(`width=${this.mapWidth}`),n.push(`height=${this.mapHeight}`),n.push(`tilewidth=${this.tileSizeX}`),n.push(`tileheight=${this.tileSizeY}`),n.push("orientation=isometric"),n.push(`hero_pos=${this.heroX},${this.heroY}`),n.push("music=music/default_theme.ogg");const r=(this.mapName||"Map_Name").replace(/[<>:"/\\|?*]/g,"_").trim().replace(/\s+/g,"_").replace(/_{2,}/g,"_");n.push(`tileset=tilesetdefs/tileset_${r}.txt`);const s=e.mapName&&e.mapName.trim()||this.mapName||(this.tilesetFileName?this.tilesetFileName.replace(/\.[^/.]+$/,""):"Untitled Map");n.push(`title=${s}`),n.push("");const i=this.collectGlobalTilesets(),o=new Map;for(const h of i)h.fileName&&(o.has(h.fileName)||o.set(h.fileName,h.offset));n.push("[tilesets]");for(const h of i){if(!h.fileName)continue;const f=`images/tilesets/${h.fileName}`;n.push(`tileset=${f},${h.tileWidth},${h.tileHeight},${h.spacing},${h.margin}`)}n.push("");const l=["background","object","collision"];for(const h of l){const f=this.tileLayers.find(S=>S.type===h&&S.visible);if(!f)continue;n.push("[layer]"),n.push(`type=${f.type}`),n.push("data=");const p=this.layerTilesets.get(h),b=(p==null?void 0:p.fileName)??null,v=b?o.get(b)??0:0;for(let S=0;S<this.mapHeight;S++){const j=[];for(let x=0;x<this.mapWidth;x++){const g=S*this.mapWidth+x,y=f.data[g];let k=0;y>0&&(k=v+(y-1)),j.push(k.toString())}n.push(j.join(","))}n.push("")}const c=this.objects.filter(h=>h.type==="event");for(const h of c){n.push("[event]"),n.push(`# ${h.name}`),n.push("type=event"),n.push(`location=${h.x},${h.y},${h.width},${h.height}`),h.activate&&n.push(`activate=${h.activate}`),h.hotspot&&n.push(`hotspot=${h.hotspot}`),h.intermap&&n.push(`intermap=${h.intermap}`),h.loot&&n.push(`loot=${h.loot}`),h.soundfx&&n.push(`soundfx=${h.soundfx}`),h.mapmod&&n.push(`mapmod=${h.mapmod}`),h.repeat!==void 0&&n.push(`repeat=${h.repeat}`),h.tooltip&&n.push(`tooltip=${h.tooltip}`);for(const[f,p]of Object.entries(h.properties))n.push(`${f}=${p}`);n.push("")}const u=this.objects.filter(h=>h.type==="enemy");for(const h of u){n.push("[enemy]"),n.push("type=enemy"),n.push(`location=${h.x},${h.y},${h.width},${h.height}`),h.category&&n.push(`category=${h.category}`),h.level&&n.push(`level=${h.level}`),h.number&&n.push(`number=${h.number}`),h.wander_radius!==void 0&&n.push(`wander_radius=${h.wander_radius}`);for(const[f,p]of Object.entries(h.properties))n.push(`${f}=${p}`);n.push("")}return n.join(`
`)}generateFlareTilesetDef(e={}){const n=[],r=this.collectGlobalTilesets();if(r.length===0)return`# No tilesets found - please load tilesets before exporting
`;for(const i of r){if(!i.fileName)continue;const o=`images/tilesets/${i.fileName}`;n.push(`img=${o}`)}n.push("");const s=new Map;if(this.detectedTileData&&this.detectedTileData.size>0)for(const[i,o]of this.detectedTileData.entries())s.set(i,{sourceX:o.sourceX,sourceY:o.sourceY,width:o.width,height:o.height});for(const i of this.layerTileData.values())for(const[o,l]of i.entries())s.has(o)||s.set(o,{sourceX:l.sourceX,sourceY:l.sourceY,width:l.width,height:l.height});for(const i of r){const o=Math.max(1,i.columns),l=i.tileWidth||this.tileSizeX,c=i.tileHeight||this.tileSizeY;for(let u=0;u<i.count;u++){const h=i.offset+u,f=s.get(h)||s.get(u+1);let p,b,v,S,j,x;f?(p=f.sourceX,b=f.sourceY,v=f.width,S=f.height,j=Math.floor(v/2),x=S):(p=u%o*l,b=Math.floor(u/o)*c,v=l,S=c,j=Math.floor(v/2),x=S),n.push(`tile=${h},${p},${b},${v},${S},${j},${x}`)}}return n.join(`
`)}getTilesetExportInfo(){return this.collectGlobalTilesets().map(e=>({id:e.id,fileName:e.fileName,sourcePath:e.sourcePath,tileWidth:e.tileWidth,tileHeight:e.tileHeight,spacing:e.spacing,margin:e.margin}))}parseTilesetDefContent(e,n){if(!e)return;const r=e.split(/\r?\n/).map(i=>i.trim()).filter(Boolean),s=new Map;for(const i of r)if(!i.startsWith("#")&&!i.startsWith("img=")&&i.startsWith("tile=")){const l=i.substring(5).split(",").map(c=>c.trim());if(l.length>=5){const c=parseInt(l[0],10),u=parseInt(l[1],10),h=parseInt(l[2],10),f=parseInt(l[3],10),p=parseInt(l[4],10),b=l[5]!==void 0?parseInt(l[5],10):Math.floor(f/2),v=l[6]!==void 0?parseInt(l[6],10):p;!Number.isNaN(c)&&!Number.isNaN(u)&&!Number.isNaN(h)&&!Number.isNaN(f)&&!Number.isNaN(p)&&s.set(c,{sourceX:u,sourceY:h,width:f,height:p,originX:b,originY:v})}}if(s.size>0){this.detectedTileData.clear();for(const[o,l]of s.entries())this.detectedTileData.set(o,l);const i=n||this.getCurrentLayerType();if(i){const o=new Map;for(const[l,c]of s.entries())o.set(l,{sourceX:c.sourceX,sourceY:c.sourceY,width:c.width,height:c.height,originX:c.originX,originY:c.originY});this.layerTileData.set(i,o)}this.createTilePalette(!0),this.draw()}}parseAndExportTileset(e,n,r=64,s=32){if(!e)return;const i=Math.max(1,Math.floor(e.width/r)),o=Math.max(1,Math.floor(e.height/s)),l=[],c=this.guessFileNameFromImage(e);l.push(`img=images/tilesets/${c}`),l.push(""),this.detectedTileData.clear();const u=this.detectVariableSizedTiles();if(u.length>0){let v=1;for(const S of u){const j=S.sourceX,x=S.sourceY,g=S.width,y=S.height,k=Math.floor(g/2),C=y;this.detectedTileData.set(v,{sourceX:j,sourceY:x,width:g,height:y,originX:k,originY:C}),l.push(`tile=${v},${j},${x},${g},${y},${k},${C}`),v++}}else{let v=1;for(let S=0;S<o;S++)for(let j=0;j<i;j++){const x=j*r,g=S*s,y=r,k=s,C=Math.floor(y/2),M=k;this.detectedTileData.set(v,{sourceX:x,sourceY:g,width:y,height:k,originX:C,originY:M}),l.push(`tile=${v},${x},${g},${y},${k},${C},${M}`),v++}}const f=`tileset_${(n||"tileset").replace(/[<>:"/\\|?*]/g,"_").trim()}.txt`,p=l.join(`
`);try{const v=window.require;if(typeof v=="function"){const S=v("fs"),j=v("path");let x=null;if(e.dataset&&e.dataset.sourcePath?x=e.dataset.sourcePath:typeof e.src=="string"&&e.src.startsWith("file://")?x=e.src.replace("file://",""):this.tilesetSourcePath&&(x=this.tilesetSourcePath),x)if(j&&typeof j.dirname=="function"&&typeof j.join=="function"&&S&&typeof S.writeFileSync=="function"){const g=j.dirname(x),y=j.join(g,f);S.writeFileSync(y,p,"utf8"),console.log("Tileset defs saved to",y)}else this.downloadFile(p,f,"text/plain");else this.downloadFile(p,f,"text/plain")}else this.downloadFile(p,f,"text/plain")}catch(v){console.warn("Could not write tilesetdefs to disk, falling back to download:",v),this.downloadFile(p,f,"text/plain")}const b=this.tileLayers.find(v=>v.id===this.activeLayerId);if(b){const v=new Map;for(const[S,j]of this.detectedTileData.entries())v.set(S,{sourceX:j.sourceX,sourceY:j.sourceY,width:j.width,height:j.height,originX:j.originX,originY:j.originY});this.layerTileData.set(b.type,v)}this.createTilePalette(!0)}guessFileNameFromImage(e){try{const n=e.src||"",r=e.dataset;if(r&&typeof r.filename=="string"&&r.filename.length>0)return r.filename;const s=n.match(/[^/\\]+\.(png|jpg|jpeg|webp)$/i);return s?s[0]:`tileset_${Date.now()}.png`}catch{return`tileset_${Date.now()}.png`}}downloadFile(e,n,r){const s=new Blob([e],{type:r}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}saveState(){if(this.isApplyingHistory)return;const e={layers:this.tileLayers.map(n=>({...n,data:[...n.data]})),objects:this.objects.map(n=>({...n}))};this.history=this.history.slice(0,this.historyIndex+1),this.history.push(e),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex--),this.markAsChanged(!1)}deepCopyLayers(e){return e.map(n=>({...n,data:[...n.data]}))}deepCopyObjects(e){return e.map(n=>({...n}))}undo(){this.historyIndex>0&&(this.historyIndex--,this.applyHistoryState())}redo(){this.historyIndex<this.history.length-1&&(this.historyIndex++,this.applyHistoryState())}applyHistoryState(){if(this.historyIndex>=0&&this.historyIndex<this.history.length){this.isApplyingHistory=!0;const e=this.history[this.historyIndex];this.tileLayers=this.deepCopyLayers(e.layers),this.objects=this.deepCopyObjects(e.objects),this.notifyObjectsChanged(),this.draw(),this.isApplyingHistory=!1}}setAutoSaveCallback(e){this.autoSaveCallback=e}setSaveStatusCallback(e){this.saveStatusCallback=e}setAutoSaveEnabled(e){this.autoSaveEnabled=e,!e&&this.autoSaveTimeout&&(clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=null)}setDarkMode(e){this.isDarkMode=e,this.draw()}markAsChanged(e=!1){if(!this.autoSaveEnabled)return;this.hasUnsavedChanges=!0,this.updateSaveStatus("unsaved"),this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout);const n=e?this.IMMEDIATE_SAVE_DELAY:this.AUTO_SAVE_DELAY;this.autoSaveTimeout=window.setTimeout(()=>{this.performAutoSave()},n)}async performAutoSave(){if(this.hasUnsavedChanges)try{this.updateSaveStatus("saving"),this.autoSaveExport()?(this.autoSaveCallback&&await this.autoSaveCallback(),this.hasUnsavedChanges=!1,this.lastSaveTimestamp=Date.now(),this.updateSaveStatus("saved")):this.updateSaveStatus("saved"),this.autoSaveTimeout=null}catch(e){console.error("Auto-save failed:",e),this.updateSaveStatus("error"),this.autoSaveTimeout=window.setTimeout(()=>{this.performAutoSave()},15e3)}}saveToLocalStorage(){try{const e={timestamp:Date.now(),mapWidth:this.mapWidth,mapHeight:this.mapHeight,layers:this.tileLayers,objects:this.objects,heroX:this.heroX,heroY:this.heroY,tilesetFileName:this.tilesetFileName,tilesetImage:this.tilesetImage?this.canvasToDataURL(this.tilesetImage):null,tileSizeX:this.tileSizeX,tileSizeY:this.tileSizeY,mapName:this.mapName,detectedTileData:Array.from(this.detectedTileData.entries()),tileContentThreshold:this.tileContentThreshold,objectSeparationSensitivity:this.objectSeparationSensitivity};localStorage.setItem("tilemap_autosave_backup",JSON.stringify(e))}catch(e){console.warn("Failed to save to localStorage:",e)}}canvasToDataURL(e){const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");return r?(r.drawImage(e,0,0),n.toDataURL("image/png")):""}generateMinimapDataUrl(){try{const r=Math.max(1,Math.floor(Math.min(160/Math.max(1,this.mapWidth),120/Math.max(1,this.mapHeight)))),s=this.mapWidth*r,i=this.mapHeight*r,o=document.createElement("canvas");o.width=s,o.height=i;const l=o.getContext("2d");if(!l)return"";l.imageSmoothingEnabled=!1,l.fillStyle="#ffffff",l.fillRect(0,0,s,i);for(let c=0;c<this.tileLayers.length;c++){const u=this.tileLayers[c];if(u.visible)for(let h=0;h<this.mapHeight;h++)for(let f=0;f<this.mapWidth;f++){const p=h*this.mapWidth+f,b=u.data[p];if(b>0){const v=b*137.5%360;l.fillStyle=`hsl(${v},55%,${c===0?"45%":"60%"})`,l.fillRect(f*r,h*r,r,r)}}}return o.toDataURL("image/png")}catch(e){return console.warn("generateMinimapDataUrl failed",e),""}}loadFromLocalStorage(){try{const e=localStorage.getItem("tilemap_autosave_backup");if(!e)return!1;const n=JSON.parse(e);if(Date.now()-n.timestamp>24*60*60*1e3)return!1;this.mapWidth=n.mapWidth,this.mapHeight=n.mapHeight,this.tileLayers=n.layers;const s=this.normalizeLoadedObjects(n.objects);if(this.objects=s,this.nextObjectId=this.calculateNextObjectId(s),this.notifyObjectsChanged(),this.tilesetFileName=n.tilesetFileName,typeof n.mapName=="string"?this.setMapName(n.mapName):this.tilesetFileName?this.setMapName(this.tilesetFileName.replace(/\.[^/.]+$/,"")):this.setMapName("Untitled Map"),n.heroX!==void 0&&n.heroY!==void 0?(this.heroX=Math.max(0,Math.min(n.heroX,this.mapWidth-1)),this.heroY=Math.max(0,Math.min(n.heroY,this.mapHeight-1))):(this.heroX=0,this.heroY=0),n.tileContentThreshold!==void 0&&(this.tileContentThreshold=n.tileContentThreshold),n.objectSeparationSensitivity!==void 0&&(this.objectSeparationSensitivity=n.objectSeparationSensitivity),n.detectedTileData){this.detectedTileData.clear();for(const[i,o]of n.detectedTileData)this.detectedTileData.set(i,o)}if(n.tilesetImage){const i=new Image;i.onload=()=>{this.tilesetImage=i,this.tilesetColumns=Math.floor(i.width/this.tileSizeX),this.tilesetRows=Math.floor(i.height/this.tileSizeY),this.tileCount=this.tilesetColumns*this.tilesetRows,n.detectedTileData&&n.detectedTileData.length>0?this.createTilePalette(!0):this.createTilePalette(),this.updateActiveTile(),this.draw()},i.src=n.tilesetImage}return this.draw(),!0}catch(e){return console.error("Failed to load from localStorage:",e),!1}}clearLocalStorageBackup(){localStorage.removeItem("tilemap_autosave_backup")}async saveProjectData(e){var n;try{console.log("=== SAVE PROJECT DATA DEBUG ==="),console.log("Project path:",e),console.log("Number of layer tilesets:",this.layerTilesets.size);const r={},s=[];console.log("=== SAVING LAYER TILESETS ===");for(const[o,l]of this.layerTilesets.entries())if(l.image&&l.fileName){console.log(`Saving tileset for layer ${o}: ${l.fileName}`);const c=this.canvasToDataURL(l.image);r[l.fileName]=c,s.push({layerType:o,fileName:l.fileName,name:l.fileName.replace(/\.[^/.]+$/,""),columns:l.columns,rows:l.rows,count:l.count,tileWidth:l.tileWidth??this.tileSizeX,tileHeight:l.tileHeight??this.tileSizeY,spacing:l.spacing??0,margin:l.margin??0,sourcePath:l.sourcePath??null,detectedTiles:this.getDetectedTilesForLayer(o)}),console.log(`Saved tileset: ${l.fileName} (${c.length} bytes)`)}else console.log(`No tileset image for layer ${o}`);if(this.layerTilesets.size===0&&this.tilesetImage&&this.tilesetFileName){console.log("Saving legacy tileset:",this.tilesetFileName);const o=this.canvasToDataURL(this.tilesetImage);r[this.tilesetFileName]=o,s.push({fileName:this.tilesetFileName,name:this.tilesetFileName.replace(/\.[^/.]+$/,""),tileWidth:this.tilesetTileWidth??this.tileSizeX,tileHeight:this.tilesetTileHeight??this.tileSizeY,spacing:this.tilesetSpacing??0,margin:this.tilesetMargin??0,sourcePath:this.tilesetSourcePath,detectedTiles:Array.from(this.detectedTileData.entries())})}const i={name:this.mapName||(this.tilesetFileName?this.tilesetFileName.replace(/\.[^/.]+$/,""):"Untitled Map"),width:this.mapWidth,height:this.mapHeight,tileSize:64,layers:this.tileLayers,objects:this.objects,heroX:this.heroX,heroY:this.heroY,tilesets:s,tilesetImages:r,minimap:this.generateMinimapDataUrl(),version:"1.0",tileContentThreshold:this.tileContentThreshold,objectSeparationSensitivity:this.objectSeparationSensitivity};if(console.log("Project data prepared:",{name:i.name,tilesetCount:Object.keys(i.tilesetImages||{}).length,layerCount:(i.layers||[]).length,layerTilesetCount:s.length}),(n=window.electronAPI)!=null&&n.saveMapProject){console.log("Saving via Electron API...");const o={...i,name:i.name||"Untitled Map",width:i.width??20,height:i.height??15,tileSize:i.tileSize??32,layers:i.layers||[],objects:i.objects||[],tilesets:i.tilesets||[],tilesetImages:i.tilesetImages||{},version:i.version||"1.0"},l=await window.electronAPI.saveMapProject(e,o);return console.log("Electron save result:",l),l}else return console.log("Falling back to localStorage save..."),this.saveToLocalStorage(),!0}catch(r){return console.error("Error saving project data:",r),!1}}updateSaveStatus(e){this.saveStatusCallback&&this.saveStatusCallback(e)}getUnsavedChanges(){return this.hasUnsavedChanges}getLastSaveTime(){return this.lastSaveTimestamp}forceSave(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.performAutoSave()}notifyObjectsChanged(){this.objectsChangedCallback&&this.objectsChangedCallback(this.getMapObjects())}calculateNextObjectId(e){return e.length?e.reduce((n,r)=>Math.max(n,typeof r.id=="number"?r.id:0),0)+1:1}normalizeLoadedObjects(e){return Array.isArray(e)?e.map((n,r)=>{const s={...n,id:typeof n.id=="number"&&!Number.isNaN(n.id)?n.id:r+1,width:typeof n.width=="number"&&n.width>0?n.width:1,height:typeof n.height=="number"&&n.height>0?n.height:1,properties:n.properties||{}};return s.category==="npc"||s.type==="npc"?(s.category="npc",s.type="npc",s.wander_radius=0):(s.category==="enemy"||s.category==="creature"||s.type==="enemy")&&(s.type="enemy",s.category=s.category||"enemy"),s}):[]}addMapObject(e,n,r,s=1,i=1){const o={id:this.nextObjectId++,name:`${e}_${this.nextObjectId-1}`,type:e,x:n,y:r,width:s,height:i,properties:{}};return e==="event"?(o.activate="on_trigger",o.hotspot="location",o.tooltip="Event"):e==="enemy"&&(o.category="enemy",o.level=1,o.number=1,o.wander_radius=4),this.objects.push(o),this.saveState(),this.notifyObjectsChanged(),o}removeMapObject(e){var r;const n=this.objects.findIndex(s=>s.id===e);return n>=0?(this.objects.splice(n,1),((r=this.selectedObject)==null?void 0:r.id)===e&&(this.selectedObject=null),this.saveState(),this.notifyObjectsChanged(),!0):!1}updateMapObject(e,n){const r=this.objects.find(s=>s.id===e);return r?(Object.assign(r,n),this.saveState(),this.notifyObjectsChanged(),!0):!1}getMapObjects(){return[...this.objects]}getObjectsAtPosition(e,n){return this.objects.filter(r=>r.x===e&&r.y===n)}isHeroAtPosition(e,n){return this.heroX===e&&this.heroY===n}setHeroPosition(e,n){this.heroX=Math.max(0,Math.min(e,this.mapWidth-1)),this.heroY=Math.max(0,Math.min(n,this.mapHeight-1)),this.saveState(),this.draw()}getHeroPosition(){return{x:this.heroX,y:this.heroY}}updateCursorForHover(){if(this.isHeroAtPosition(this.hoverX,this.hoverY)){this.mapCanvas.style.cursor="move",this.showHeroTooltip();return}const e=this.getDraggableActorAt(this.hoverX,this.hoverY);if(e){const s=this.getActorLayerType(e);if(s){this.mapCanvas.style.cursor="move",this.showActorTooltip(e,s);return}}const n=this.getActiveLayer();if(n&&["enemy","npc","object","event","background"].includes(n.type)){const s=this.getObjectsAtPosition(this.hoverX,this.hoverY);if(s.length>0){this.mapCanvas.style.cursor="pointer",this.showObjectTooltip(s[0]);return}}this.spacePressed?this.mapCanvas.style.cursor=this.isPanning?"grabbing":"grab":this.mapCanvas.style.cursor="crosshair",this.hideObjectTooltip()}showObjectTooltip(e){let n=document.getElementById("object-tooltip");n||(n=document.createElement("div"),n.id="object-tooltip",n.style.position="absolute",n.style.background="rgba(0, 0, 0, 0.35)",n.style.color="white",n.style.padding="4px 6px",n.style.borderRadius="3px",n.style.fontSize="11px",n.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',n.style.lineHeight="1.2",n.style.pointerEvents="none",n.style.zIndex="1000",n.style.border="1px solid rgba(255, 107, 0, 0.8)",n.style.boxShadow="0 1px 4px rgba(0,0,0,0.3)",n.style.backdropFilter="blur(2px)",document.body.appendChild(n));const r=`
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
        <rect x="5" y="2" width="14" height="20" rx="7"/>
        <path d="M12 6v4"/>
      </svg>
    `,s=e.type==="enemy"?e.category||"enemy":e.type;n.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 2px; color: #ff6b00; font-size: 10px;">
        ${r}Double click to edit
      </div>
      <div style="font-weight: bold; margin-bottom: 1px;">${e.name||"Unnamed"}</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Type: ${s}</div>
    `;const i=this.mapCanvas.getBoundingClientRect(),o=this.mapToScreen(this.hoverX,this.hoverY);n.style.left=`${i.left+o.x+20}px`,n.style.top=`${i.top+o.y-10}px`,n.style.display="block"}showActorTooltip(e,n){let r=document.getElementById("object-tooltip");r||(r=document.createElement("div"),r.id="object-tooltip",r.style.position="absolute",r.style.background="rgba(0, 0, 0, 0.35)",r.style.color="white",r.style.padding="4px 6px",r.style.borderRadius="3px",r.style.fontSize="11px",r.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',r.style.lineHeight="1.2",r.style.pointerEvents="none",r.style.zIndex="1000",r.style.border="1px solid rgba(255, 107, 0, 0.8)",r.style.boxShadow="0 1px 4px rgba(0,0,0,0.3)",r.style.backdropFilter="blur(2px)",document.body.appendChild(r));const s=`
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
        <rect x="5" y="2" width="14" height="20" rx="7"/>
        <path d="M12 6v4"/>
      </svg>
    `,i=n==="npc"?"NPC":"Enemy",o=e.name||i;r.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 2px; color: #ff6b00; font-size: 10px;">
        ${s}Drag to move
      </div>
      <div style="font-weight: bold; margin-bottom: 1px;">${o}</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Type: ${i}</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Double click to edit</div>
    `;const l=this.mapCanvas.getBoundingClientRect(),c=this.mapToScreen(this.hoverX,this.hoverY);r.style.left=`${l.left+c.x+20}px`,r.style.top=`${l.top+c.y-10}px`,r.style.display="block"}hideObjectTooltip(){const e=document.getElementById("object-tooltip");e&&(e.style.display="none")}showHeroTooltip(){let e=document.getElementById("object-tooltip");e||(e=document.createElement("div"),e.id="object-tooltip",e.style.position="absolute",e.style.background="rgba(0, 0, 0, 0.35)",e.style.color="white",e.style.padding="4px 6px",e.style.borderRadius="3px",e.style.fontSize="11px",e.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',e.style.lineHeight="1.2",e.style.pointerEvents="none",e.style.zIndex="1000",e.style.border="1px solid rgba(255, 107, 0, 0.8)",e.style.boxShadow="0 1px 4px rgba(0,0,0,0.3)",e.style.backdropFilter="blur(2px)",document.body.appendChild(e));const n=`
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
        <rect x="5" y="2" width="14" height="20" rx="7"/>
        <path d="M12 6v4"/>
      </svg>
    `;e.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 2px; color: #ff6b00; font-size: 10px;">
        ${n}Double click to edit or drag to move
      </div>
      <div style="font-weight: bold; margin-bottom: 1px;">Hero Position</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Position: (${this.heroX}, ${this.heroY})</div>
    `;const r=this.mapCanvas.getBoundingClientRect(),s=this.mapToScreen(this.hoverX,this.hoverY);e.style.left=`${r.left+s.x+20}px`,e.style.top=`${r.top+s.y-10}px`,e.style.display="block"}createObjectFromTile(e,n,r,s){console.log(`Creating object from tile at (${e}, ${n}) for layer type: ${r}`);const i=this.objects.find(u=>u.x===e&&u.y===n);if(i){console.log(`Found existing object at (${e}, ${n}), updating instead of creating new one`);const u={name:`${r}_${e}_${n}`,type:r==="npc"?"npc":r};this.updateMapObject(i.id,u);return}let o;if(r==="event")o="event";else if(r==="enemy"||r==="npc"||r==="object")o="enemy";else{console.log(`Unsupported layer type: ${r}`);return}console.log(`Creating new ${o} object at (${e}, ${n})`);const l=this.addMapObject(o,e,n,1,1);console.log(`Created object with ID: ${l.id}`);const c={name:`${r}_${e}_${n}`,category:o==="event"?"block":r==="npc"?"npc":r==="object"?"object":"creature"};r==="npc"?c.type="npc":r==="enemy"&&(c.type="enemy"),o==="enemy"?(c.level=1,c.number=1,c.wander_radius=r==="npc"||r==="object"?0:4):(c.activate="on_trigger",c.hotspot="0,0,1,1"),this.updateMapObject(l.id,c)}removeObjectAtPosition(e,n){const r=this.objects.find(s=>s.x===e&&s.y===n);r&&this.removeMapObject(r.id)}selectObject(e){const n=this.objects.find(r=>r.id===e);return this.selectedObject=n||null,this.selectedObject}getSelectedObject(){return this.selectedObject}resetForNewProject(){this.clearLocalStorageBackup(),this.tilesetImage=null,this.tilesetFileName=null,this.mapName="Untitled Map",this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.detectedTileData.clear(),this.clearTilePalette(),this.tileLayers=[],this.activeLayerId=null,this.nextLayerId=1,this.objects=[],this.nextObjectId=1,this.selectedObjectId=null,this.notifyObjectsChanged(),this.heroX=0,this.heroY=0,this.isDraggingHero=!1,this.layerTilesets.clear(),this.tilesets=[],this.collisionData=[],this.selection={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,tiles:[]},this.isSelecting=!1,this.shapeDrawing={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,preview:[]},this.isDrawingShape=!1,this.stamps.clear(),this.activeStamp=null,this.stampPreview={x:0,y:0,visible:!1},this.hasUnsavedChanges=!1,this.lastSaveTimestamp=0,this.autoSaveTimeout&&(clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=null),this.createDefaultLayers(),this.history=[],this.historyIndex=-1,this.saveState(),this.ctx.clearRect(0,0,this.mapCanvas.width,this.mapCanvas.height),this.draw()}loadProjectData(e){try{if(this.setMapName(typeof e.name=="string"?e.name:"Untitled Map"),console.log("=== LOADING PROJECT DATA IN EDITOR ==="),console.log("Project data:",{hasLayers:!!(e.layers&&e.layers.length>0),layerCount:e.layers?e.layers.length:0,hasObjects:!!(e.objects&&e.objects.length>0),objectCount:e.objects?e.objects.length:0,width:e.width,height:e.height,hasTilesets:!!(e.tilesets&&e.tilesets.length>0),tilesetCount:e.tilesets?e.tilesets.length:0}),e.tileContentThreshold!==void 0&&(this.tileContentThreshold=e.tileContentThreshold),e.objectSeparationSensitivity!==void 0&&(this.objectSeparationSensitivity=e.objectSeparationSensitivity),this.layerTilesets.clear(),e.tilesets&&Array.isArray(e.tilesets)){console.log("Loading tilesets:",e.tilesets.length);let r=0;const s=e.tilesets.length;for(const i of e.tilesets)if(i.fileName&&e.tilesetImages&&e.tilesetImages[i.fileName]){const o=e.tilesetImages[i.fileName],l=new Image;l.onload=()=>{console.log(`Tileset ${i.fileName} loaded for layer: ${i.layerType||"legacy"}`);const c=i.columns||Math.max(1,Math.floor(l.width/this.tileSizeX)),u=i.rows||Math.max(1,Math.floor(l.height/this.tileSizeY)),h=i.count||Math.max(1,c*u),f=i.tileWidth||Math.round(l.width/Math.max(c,1)),p=i.tileHeight||Math.round(l.height/Math.max(u,1)),b={image:l,fileName:i.fileName,columns:c,rows:u,count:h,tileWidth:f,tileHeight:p,spacing:i.spacing??0,margin:i.margin??0,sourcePath:i.sourcePath??null};if(i.layerType)this.layerTilesets.set(i.layerType,b),console.log(`Set tileset for layer type ${i.layerType}`);else{this.tilesetImage=l,this.tilesetFileName=i.fileName,this.tilesetColumns=b.columns,this.tilesetRows=b.rows,this.tileCount=b.count,this.tilesetTileWidth=b.tileWidth,this.tilesetTileHeight=b.tileHeight,this.tilesetSpacing=b.spacing??0,this.tilesetMargin=b.margin??0,this.tilesetSourcePath=b.sourcePath??this.tilesetSourcePath;const v=this.tileLayers.find(S=>S.id===this.activeLayerId);v&&!this.layerTilesets.has(v.type)&&(this.layerTilesets.set(v.type,b),console.log(`Assigned legacy tileset to active layer: ${v.type}`))}if(i.detectedTiles&&Array.isArray(i.detectedTiles))if(console.log(`Restoring ${i.detectedTiles.length} detected tiles for ${i.layerType||"legacy"}`),i.layerType){const v=new Map;for(const[S,j]of i.detectedTiles){const x=j;v.set(S,{sourceX:x.sourceX,sourceY:x.sourceY,width:x.width,height:x.height,originX:x.originX,originY:x.originY})}this.layerTileData.set(i.layerType,v),console.log(`Stored ${v.size} tiles for layer type: ${i.layerType}`)}else{this.detectedTileData.clear();for(const[S,j]of i.detectedTiles){const x=j;this.detectedTileData.set(S,{sourceX:x.sourceX,sourceY:x.sourceY,width:x.width,height:x.height,originX:x.originX,originY:x.originY})}const v=this.tileLayers.find(S=>S.id===this.activeLayerId);if(v){const S=new Map;for(const[j,x]of i.detectedTiles){const g=x;S.set(j,{sourceX:g.sourceX,sourceY:g.sourceY,width:g.width,height:g.height,originX:g.originX,originY:g.originY})}this.layerTileData.set(v.type,S)}}if(r++,r===s){console.log("All tilesets loaded, updating UI for active layer");const v=this.tileLayers.find(S=>S.id===this.activeLayerId);v&&this.updateCurrentTileset(v.type)}},l.src=o}else if(r++,r===s){console.log("All tilesets processed, updating UI for active layer");const o=this.tileLayers.find(l=>l.id===this.activeLayerId);o&&this.updateCurrentTileset(o.type)}}if(e.detectedTileData&&Array.isArray(e.detectedTileData)){this.detectedTileData.clear();for(const[r,s]of e.detectedTileData)this.detectedTileData.set(r,s)}e.layers&&e.layers.length>0?(console.log("Loading layers:",e.layers.length),this.tileLayers=[...e.layers],this.tileLayers.length>0&&(!this.activeLayerId||!this.tileLayers.find(r=>r.id===this.activeLayerId))&&(this.activeLayerId=this.tileLayers[0].id,console.log("Set active layer to:",this.activeLayerId))):(console.log("No layers found in project data, creating default layers"),this.createDefaultLayers());const n=this.normalizeLoadedObjects(e.objects);console.log("Loading objects:",n.length),this.objects=n,this.nextObjectId=this.calculateNextObjectId(n),this.notifyObjectsChanged(),e.width&&e.height&&(console.log("Setting map dimensions:",e.width,"x",e.height),this.mapWidth=e.width,this.mapHeight=e.height),e.heroX!==void 0&&e.heroY!==void 0?(console.log("Loading hero position:",e.heroX,",",e.heroY),this.heroX=Math.max(0,Math.min(e.heroX,this.mapWidth-1)),this.heroY=Math.max(0,Math.min(e.heroY,this.mapHeight-1))):(console.log("No hero position found, defaulting to (0,0)"),this.heroX=0,this.heroY=0),console.log("Project data loaded successfully"),this.draw()}catch(n){console.error("Error loading project data:",n)}}async loadTilesetFromDataURL(e,n){return new Promise((r,s)=>{console.log("Loading tileset from dataURL:",n,"Length:",e.length);const i=new Image;i.onload=()=>{console.log("Tileset image loaded successfully:",i.width,"x",i.height),this.tilesetImage=i,this.tilesetFileName=n,this.tilesetColumns=Math.floor(i.width/this.tileSizeX),this.tilesetRows=Math.floor(i.height/this.tileSizeY),this.tileCount=this.tilesetColumns*this.tilesetRows,console.log("Tileset properties:",{columns:this.tilesetColumns,rows:this.tilesetRows,tileCount:this.tileCount});const o=this.tileLayers.find(c=>c.id===this.activeLayerId);if(o){console.log("Setting tileset for active layer type:",o.type),this.layerTilesets.set(o.type,{image:i,fileName:n,columns:this.tilesetColumns,rows:this.tilesetRows,count:this.tileCount});const c=this.layerTileData.has(o.type);if(console.log(`Layer ${o.type} has existing tile data:`,c),!c)this.detectedTileData.clear();else{const u=this.layerTileData.get(o.type);if(this.detectedTileData.clear(),u)for(const[h,f]of u.entries())this.detectedTileData.set(h,f)}}else console.log("No active layer found, storing as global tileset");const l=o?this.layerTileData.has(o.type):!1;this.createTilePalette(l),console.log("Tile detection completed, detected tiles:",this.detectedTileData.size),this.draw(),console.log("Tileset loaded and palette created"),r()},i.onerror=o=>{console.error("Failed to load tileset image:",o),s(new Error("Failed to load tileset from data URL"))},i.src=e})}debugLayerData(){console.log("=== LAYER DATA DEBUG ===");for(const e of this.tileLayers){const n=e.data.filter(s=>s>0).length,r=this.layerTilesets.get(e.type);console.log(`Layer ${e.name} (${e.type}): ${n} painted tiles, has tileset: ${!!(r!=null&&r.image)}`)}}redraw(){this.draw()}getMapWidth(){return this.mapWidth}getMapHeight(){return this.mapHeight}updateCanvas(e){console.log("TileMapEditor: Updating canvas reference and rebinding events"),this.cleanupCanvasObservers(),this.cleanupCanvasEvents(),this.mapCanvas=e,this.initializeCanvas(),this.bindEvents(),this.refreshTilePalette(!0),this.draw(),console.log("TileMapEditor: Canvas update complete - events rebound")}}const i1=1,a1=1e6;let Tl=0;function o1(){return Tl=(Tl+1)%Number.MAX_SAFE_INTEGER,Tl.toString()}const Ml=new Map,Bh=t=>{if(Ml.has(t))return;const e=setTimeout(()=>{Ml.delete(t),Vs({type:"REMOVE_TOAST",toastId:t})},a1);Ml.set(t,e)},l1=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,i1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?Bh(n):t.toasts.forEach(r=>{Bh(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},Ta=[];let Ma={toasts:[]};function Vs(t){Ma=l1(Ma,t),Ta.forEach(e=>{e(Ma)})}function c1({...t}){const e=o1(),n=s=>Vs({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>Vs({type:"DISMISS_TOAST",toastId:e});return Vs({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:n}}function wp(){const[t,e]=m.useState(Ma);return m.useEffect(()=>(Ta.push(e),()=>{const n=Ta.indexOf(e);n>-1&&Ta.splice(n,1)}),[t]),{...t,toast:c1,dismiss:n=>Vs({type:"DISMISS_TOAST",toastId:n})}}function dt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function bp(t,e=[]){let n=[];function r(i,o){const l=m.createContext(o),c=n.length;n=[...n,o];const u=f=>{var x;const{scope:p,children:b,...v}=f,S=((x=p==null?void 0:p[t])==null?void 0:x[c])||l,j=m.useMemo(()=>v,Object.values(v));return a.jsx(S.Provider,{value:j,children:b})};u.displayName=i+"Provider";function h(f,p){var S;const b=((S=p==null?void 0:p[t])==null?void 0:S[c])||l,v=m.useContext(b);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[u,h]}const s=()=>{const i=n.map(o=>m.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return m.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,u1(s,...e)]}function u1(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const f=c(i)[`__scope${u}`];return{...l,...f}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function d1(t){const e=t+"CollectionProvider",[n,r]=bp(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=S=>{const{scope:j,children:x}=S,g=xe.useRef(null),y=xe.useRef(new Map).current;return a.jsx(s,{scope:j,itemMap:y,collectionRef:g,children:x})};o.displayName=e;const l=t+"CollectionSlot",c=Ja(l),u=xe.forwardRef((S,j)=>{const{scope:x,children:g}=S,y=i(l,x),k=Kn(j,y.collectionRef);return a.jsx(c,{ref:k,children:g})});u.displayName=l;const h=t+"CollectionItemSlot",f="data-radix-collection-item",p=Ja(h),b=xe.forwardRef((S,j)=>{const{scope:x,children:g,...y}=S,k=xe.useRef(null),C=Kn(j,k),M=i(h,x);return xe.useEffect(()=>(M.itemMap.set(k,{ref:k,...y}),()=>void M.itemMap.delete(k))),a.jsx(p,{[f]:"",ref:C,children:g})});b.displayName=h;function v(S){const j=i(t+"CollectionConsumer",S);return xe.useCallback(()=>{const g=j.collectionRef.current;if(!g)return[];const y=Array.from(g.querySelectorAll(`[${f}]`));return Array.from(j.itemMap.values()).sort((M,P)=>y.indexOf(M.ref.current)-y.indexOf(P.ref.current))},[j.collectionRef,j.itemMap])}return[{Provider:o,Slot:u,ItemSlot:b},v,r]}var h1=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ft=h1.reduce((t,e)=>{const n=Ja(`Primitive.${e}`),r=m.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function kp(t,e){t&&qn.flushSync(()=>t.dispatchEvent(e))}function Qn(t){const e=m.useRef(t);return m.useEffect(()=>{e.current=t}),m.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function f1(t,e=globalThis==null?void 0:globalThis.document){const n=Qn(t);m.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var m1="DismissableLayer",Tc="dismissableLayer.update",p1="dismissableLayer.pointerDownOutside",g1="dismissableLayer.focusOutside",Xh,Sp=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),jp=m.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,u=m.useContext(Sp),[h,f]=m.useState(null),p=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,b]=m.useState({}),v=Kn(e,P=>f(P)),S=Array.from(u.layers),[j]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),x=S.indexOf(j),g=h?S.indexOf(h):-1,y=u.layersWithOutsidePointerEventsDisabled.size>0,k=g>=x,C=y1(P=>{const E=P.target,$=[...u.branches].some(D=>D.contains(E));!k||$||(s==null||s(P),o==null||o(P),P.defaultPrevented||l==null||l())},p),M=v1(P=>{const E=P.target;[...u.branches].some(D=>D.contains(E))||(i==null||i(P),o==null||o(P),P.defaultPrevented||l==null||l())},p);return f1(P=>{g===u.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&l&&(P.preventDefault(),l()))},p),m.useEffect(()=>{if(h)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Xh=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),Uh(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=Xh)}},[h,p,n,u]),m.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),Uh())},[h,u]),m.useEffect(()=>{const P=()=>b({});return document.addEventListener(Tc,P),()=>document.removeEventListener(Tc,P)},[]),a.jsx(Ft.div,{...c,ref:v,style:{pointerEvents:y?k?"auto":"none":void 0,...t.style},onFocusCapture:dt(t.onFocusCapture,M.onFocusCapture),onBlurCapture:dt(t.onBlurCapture,M.onBlurCapture),onPointerDownCapture:dt(t.onPointerDownCapture,C.onPointerDownCapture)})});jp.displayName=m1;var x1="DismissableLayerBranch",Np=m.forwardRef((t,e)=>{const n=m.useContext(Sp),r=m.useRef(null),s=Kn(e,r);return m.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Ft.div,{...t,ref:s})});Np.displayName=x1;function y1(t,e=globalThis==null?void 0:globalThis.document){const n=Qn(t),r=m.useRef(!1),s=m.useRef(()=>{});return m.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){Cp(p1,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function v1(t,e=globalThis==null?void 0:globalThis.document){const n=Qn(t),r=m.useRef(!1);return m.useEffect(()=>{const s=i=>{i.target&&!r.current&&Cp(g1,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Uh(){const t=new CustomEvent(Tc);document.dispatchEvent(t)}function Cp(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?kp(s,i):s.dispatchEvent(i)}var w1=jp,b1=Np,di=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},k1="Portal",Tp=m.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[s,i]=m.useState(!1);di(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?Yv.createPortal(a.jsx(Ft.div,{...r,ref:e}),o):null});Tp.displayName=k1;function S1(t,e){return m.useReducer((n,r)=>e[n][r]??n,t)}var Mp=t=>{const{present:e,children:n}=t,r=j1(e),s=typeof n=="function"?n({present:r.isPresent}):m.Children.only(n),i=Kn(r.ref,N1(s));return typeof n=="function"||r.isPresent?m.cloneElement(s,{ref:i}):null};Mp.displayName="Presence";function j1(t){const[e,n]=m.useState(),r=m.useRef(null),s=m.useRef(t),i=m.useRef("none"),o=t?"mounted":"unmounted",[l,c]=S1(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const u=ua(r.current);i.current=l==="mounted"?u:"none"},[l]),di(()=>{const u=r.current,h=s.current;if(h!==t){const p=i.current,b=ua(u);t?c("MOUNT"):b==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(h&&p!==b?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),di(()=>{if(e){let u;const h=e.ownerDocument.defaultView??window,f=b=>{const S=ua(r.current).includes(CSS.escape(b.animationName));if(b.target===e&&S&&(c("ANIMATION_END"),!s.current)){const j=e.style.animationFillMode;e.style.animationFillMode="forwards",u=h.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=j)})}},p=b=>{b.target===e&&(i.current=ua(r.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{h.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:m.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function ua(t){return(t==null?void 0:t.animationName)||"none"}function N1(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var C1=_x[" useInsertionEffect ".trim().toString()]||di;function T1({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=M1({defaultProp:e,onChange:n}),l=t!==void 0,c=l?t:s;{const h=m.useRef(t!==void 0);m.useEffect(()=>{const f=h.current;f!==l&&console.warn(`${r} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=l},[l,r])}const u=m.useCallback(h=>{var f;if(l){const p=E1(h)?h(t):h;p!==t&&((f=o.current)==null||f.call(o,p))}else i(h)},[l,t,i,o]);return[c,u]}function M1({defaultProp:t,onChange:e}){const[n,r]=m.useState(t),s=m.useRef(n),i=m.useRef(e);return C1(()=>{i.current=e},[e]),m.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function E1(t){return typeof t=="function"}var P1=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),L1="VisuallyHidden",Cu=m.forwardRef((t,e)=>a.jsx(Ft.span,{...t,ref:e,style:{...P1,...t.style}}));Cu.displayName=L1;var Tu="ToastProvider",[Mu,_1,I1]=d1("Toast"),[Ep,db]=bp("Toast",[I1]),[z1,xo]=Ep(Tu),Pp=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[l,c]=m.useState(null),[u,h]=m.useState(0),f=m.useRef(!1),p=m.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Tu}\`. Expected non-empty \`string\`.`),a.jsx(Mu.Provider,{scope:e,children:a.jsx(z1,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:m.useCallback(()=>h(b=>b+1),[]),onToastRemove:m.useCallback(()=>h(b=>b-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:p,children:o})})};Pp.displayName=Tu;var Lp="ToastViewport",A1=["F8"],Mc="toast.viewportPause",Ec="toast.viewportResume",_p=m.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=A1,label:s="Notifications ({hotkey})",...i}=t,o=xo(Lp,n),l=_1(n),c=m.useRef(null),u=m.useRef(null),h=m.useRef(null),f=m.useRef(null),p=Kn(e,f,o.onViewportChange),b=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=o.toastCount>0;m.useEffect(()=>{const j=x=>{var y;r.length!==0&&r.every(k=>x[k]||x.code===k)&&((y=f.current)==null||y.focus())};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[r]),m.useEffect(()=>{const j=c.current,x=f.current;if(v&&j&&x){const g=()=>{if(!o.isClosePausedRef.current){const M=new CustomEvent(Mc);x.dispatchEvent(M),o.isClosePausedRef.current=!0}},y=()=>{if(o.isClosePausedRef.current){const M=new CustomEvent(Ec);x.dispatchEvent(M),o.isClosePausedRef.current=!1}},k=M=>{!j.contains(M.relatedTarget)&&y()},C=()=>{j.contains(document.activeElement)||y()};return j.addEventListener("focusin",g),j.addEventListener("focusout",k),j.addEventListener("pointermove",g),j.addEventListener("pointerleave",C),window.addEventListener("blur",g),window.addEventListener("focus",y),()=>{j.removeEventListener("focusin",g),j.removeEventListener("focusout",k),j.removeEventListener("pointermove",g),j.removeEventListener("pointerleave",C),window.removeEventListener("blur",g),window.removeEventListener("focus",y)}}},[v,o.isClosePausedRef]);const S=m.useCallback(({tabbingDirection:j})=>{const g=l().map(y=>{const k=y.ref.current,C=[k,...G1(k)];return j==="forwards"?C:C.reverse()});return(j==="forwards"?g.reverse():g).flat()},[l]);return m.useEffect(()=>{const j=f.current;if(j){const x=g=>{var C,M,P;const y=g.altKey||g.ctrlKey||g.metaKey;if(g.key==="Tab"&&!y){const E=document.activeElement,$=g.shiftKey;if(g.target===j&&$){(C=u.current)==null||C.focus();return}const q=S({tabbingDirection:$?"backwards":"forwards"}),se=q.findIndex(X=>X===E);El(q.slice(se+1))?g.preventDefault():$?(M=u.current)==null||M.focus():(P=h.current)==null||P.focus()}};return j.addEventListener("keydown",x),()=>j.removeEventListener("keydown",x)}},[l,S]),a.jsxs(b1,{ref:c,role:"region","aria-label":s.replace("{hotkey}",b),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&a.jsx(Pc,{ref:u,onFocusFromOutsideViewport:()=>{const j=S({tabbingDirection:"forwards"});El(j)}}),a.jsx(Mu.Slot,{scope:n,children:a.jsx(Ft.ol,{tabIndex:-1,...i,ref:p})}),v&&a.jsx(Pc,{ref:h,onFocusFromOutsideViewport:()=>{const j=S({tabbingDirection:"backwards"});El(j)}})]})});_p.displayName=Lp;var Ip="ToastFocusProxy",Pc=m.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=xo(Ip,n);return a.jsx(Cu,{tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});Pc.displayName=Ip;var xi="Toast",D1="toast.swipeStart",R1="toast.swipeMove",O1="toast.swipeCancel",$1="toast.swipeEnd",zp=m.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[l,c]=T1({prop:r,defaultProp:s??!0,onChange:i,caller:xi});return a.jsx(Mp,{present:n||l,children:a.jsx(W1,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:Qn(t.onPause),onResume:Qn(t.onResume),onSwipeStart:dt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:dt(t.onSwipeMove,u=>{const{x:h,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:dt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:dt(t.onSwipeEnd,u=>{const{x:h,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});zp.displayName=xi;var[F1,H1]=Ep(xi,{onClose(){}}),W1=m.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:h,onSwipeMove:f,onSwipeCancel:p,onSwipeEnd:b,...v}=t,S=xo(xi,n),[j,x]=m.useState(null),g=Kn(e,X=>x(X)),y=m.useRef(null),k=m.useRef(null),C=s||S.duration,M=m.useRef(0),P=m.useRef(C),E=m.useRef(0),{onToastAdd:$,onToastRemove:D}=S,G=Qn(()=>{var oe;(j==null?void 0:j.contains(document.activeElement))&&((oe=S.viewport)==null||oe.focus()),o()}),q=m.useCallback(X=>{!X||X===1/0||(window.clearTimeout(E.current),M.current=new Date().getTime(),E.current=window.setTimeout(G,X))},[G]);m.useEffect(()=>{const X=S.viewport;if(X){const oe=()=>{q(P.current),u==null||u()},Se=()=>{const Ke=new Date().getTime()-M.current;P.current=P.current-Ke,window.clearTimeout(E.current),c==null||c()};return X.addEventListener(Mc,Se),X.addEventListener(Ec,oe),()=>{X.removeEventListener(Mc,Se),X.removeEventListener(Ec,oe)}}},[S.viewport,C,c,u,q]),m.useEffect(()=>{i&&!S.isClosePausedRef.current&&q(C)},[i,C,S.isClosePausedRef,q]),m.useEffect(()=>($(),()=>D()),[$,D]);const se=m.useMemo(()=>j?Hp(j):null,[j]);return S.viewport?a.jsxs(a.Fragment,{children:[se&&a.jsx(Y1,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:se}),a.jsx(F1,{scope:n,onClose:G,children:qn.createPortal(a.jsx(Mu.ItemSlot,{scope:n,children:a.jsx(w1,{asChild:!0,onEscapeKeyDown:dt(l,()=>{S.isFocusedToastEscapeKeyDownRef.current||G(),S.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Ft.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":S.swipeDirection,...v,ref:g,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:dt(t.onKeyDown,X=>{X.key==="Escape"&&(l==null||l(X.nativeEvent),X.nativeEvent.defaultPrevented||(S.isFocusedToastEscapeKeyDownRef.current=!0,G()))}),onPointerDown:dt(t.onPointerDown,X=>{X.button===0&&(y.current={x:X.clientX,y:X.clientY})}),onPointerMove:dt(t.onPointerMove,X=>{if(!y.current)return;const oe=X.clientX-y.current.x,Se=X.clientY-y.current.y,Ke=!!k.current,z=["left","right"].includes(S.swipeDirection),W=["left","up"].includes(S.swipeDirection)?Math.min:Math.max,B=z?W(0,oe):0,te=z?0:W(0,Se),ne=X.pointerType==="touch"?10:2,ue={x:B,y:te},xt={originalEvent:X,delta:ue};Ke?(k.current=ue,da(R1,f,xt,{discrete:!1})):Vh(ue,S.swipeDirection,ne)?(k.current=ue,da(D1,h,xt,{discrete:!1}),X.target.setPointerCapture(X.pointerId)):(Math.abs(oe)>ne||Math.abs(Se)>ne)&&(y.current=null)}),onPointerUp:dt(t.onPointerUp,X=>{const oe=k.current,Se=X.target;if(Se.hasPointerCapture(X.pointerId)&&Se.releasePointerCapture(X.pointerId),k.current=null,y.current=null,oe){const Ke=X.currentTarget,z={originalEvent:X,delta:oe};Vh(oe,S.swipeDirection,S.swipeThreshold)?da($1,b,z,{discrete:!0}):da(O1,p,z,{discrete:!0}),Ke.addEventListener("click",W=>W.preventDefault(),{once:!0})}})})})}),S.viewport)})]}):null}),Y1=t=>{const{__scopeToast:e,children:n,...r}=t,s=xo(xi,e),[i,o]=m.useState(!1),[l,c]=m.useState(!1);return U1(()=>o(!0)),m.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(Tp,{asChild:!0,children:a.jsx(Cu,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},B1="ToastTitle",Ap=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Ft.div,{...r,ref:e})});Ap.displayName=B1;var X1="ToastDescription",Dp=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Ft.div,{...r,ref:e})});Dp.displayName=X1;var Rp="ToastAction",Op=m.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?a.jsx(Fp,{altText:n,asChild:!0,children:a.jsx(Eu,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${Rp}\`. Expected non-empty \`string\`.`),null)});Op.displayName=Rp;var $p="ToastClose",Eu=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=H1($p,n);return a.jsx(Fp,{asChild:!0,children:a.jsx(Ft.button,{type:"button",...r,ref:e,onClick:dt(t.onClick,s.onClose)})})});Eu.displayName=$p;var Fp=m.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return a.jsx(Ft.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function Hp(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),V1(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...Hp(r))}}),e}function da(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?kp(s,i):s.dispatchEvent(i)}var Vh=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function U1(t=()=>{}){const e=Qn(t);di(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function V1(t){return t.nodeType===t.ELEMENT_NODE}function G1(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function El(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var q1=Pp,Wp=_p,Yp=zp,Bp=Ap,Xp=Dp,Up=Op,Vp=Eu;const K1=q1,Gp=m.forwardRef(({className:t,...e},n)=>a.jsx(Wp,{ref:n,className:ot("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));Gp.displayName=Wp.displayName;const Q1=fp("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),qp=m.forwardRef(({className:t,variant:e,...n},r)=>a.jsx(Yp,{ref:r,className:ot(Q1({variant:e}),t),...n}));qp.displayName=Yp.displayName;const Z1=m.forwardRef(({className:t,...e},n)=>a.jsx(Up,{ref:n,className:ot("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));Z1.displayName=Up.displayName;const Kp=m.forwardRef(({className:t,...e},n)=>a.jsx(Vp,{ref:n,className:ot("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:a.jsx(Xe,{className:"h-4 w-4"})}));Kp.displayName=Vp.displayName;const Qp=m.forwardRef(({className:t,...e},n)=>a.jsx(Bp,{ref:n,className:ot("text-sm font-semibold",t),...e}));Qp.displayName=Bp.displayName;const Zp=m.forwardRef(({className:t,...e},n)=>a.jsx(Xp,{ref:n,className:ot("text-sm opacity-90",t),...e}));Zp.displayName=Xp.displayName;function J1(){const{toasts:t}=wp();return a.jsxs(K1,{children:[t.map(function({id:e,title:n,description:r,action:s,...i}){return a.jsxs(qp,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(Qp,{children:n}),r&&a.jsx(Zp,{children:r})]}),s,a.jsx(Kp,{})]},e)}),a.jsx(Gp,{})]})}var eb={};const tb=({onCreateNewMap:t,onOpenMap:e,isDarkMode:n})=>{const[r,s]=m.useState(!1),[i,o]=m.useState([]),[l,c]=m.useState({}),[u,h]=m.useState({name:"ProjectName",width:20,height:15,tileSize:64,location:"",isStartingMap:!1});m.useEffect(()=>{(async()=>{const k=localStorage.getItem("recentMaps");if(!k)return;let C=JSON.parse(k);const M=window.electronAPI;if(M&&typeof M.checkProjectExists=="function")try{const E=(await Promise.all(C.map(async $=>{try{return await M.checkProjectExists($.path)?$:null}catch{return $}}))).filter(Boolean);C=E,E.length!==JSON.parse(k).length&&localStorage.setItem("recentMaps",JSON.stringify(E))}catch(P){console.warn("Prune recent maps failed:",P)}o(C)})()},[]),m.useEffect(()=>{if(!i||i.length===0)return;const y=async k=>{const C=k;if(C.thumbnailDataUrl){c(M=>({...M,[k.id]:C.thumbnailDataUrl}));return}try{const M=window.electronAPI;if(M&&typeof M.getProjectThumbnail=="function"){const P=await M.getProjectThumbnail(k.path);if(P){c(E=>({...E,[k.id]:P}));return}}if(!(M&&typeof M.getProjectThumbnail=="function")){c(P=>({...P,[k.id]:null}));return}}catch(M){console.error("Failed to load thumbnail for",k.path,M)}c(M=>({...M,[k.id]:null}))};return i.forEach(k=>{y(k)}),()=>{Object.values(l).forEach(k=>{k&&k.startsWith("blob:")&&URL.revokeObjectURL(k)})}},[i]);const f=y=>{localStorage.setItem("recentMaps",JSON.stringify(y)),o(y)},p=async()=>{var y;try{if((y=window.electronAPI)!=null&&y.selectDirectory){const k=await window.electronAPI.selectDirectory();k&&h({...u,location:k})}else if("showDirectoryPicker"in window){const k=await window.showDirectoryPicker();h({...u,location:k.name})}else{const k="C:\\Users\\"+(navigator.userAgent.includes("Windows")&&eb.USERNAME||"User")+"\\Documents\\TileMaps";h({...u,location:k})}}catch(k){console.error("Error selecting directory:",k)}},b=async()=>{var k;if(!u.location){alert("Please select a location for your map project");return}const y=u.name.trim().toLowerCase();if(i.some(C=>C.name.trim().toLowerCase()===y)){alert("There can't be maps that have the same name. Please type another name.");return}try{const C=`${u.location}\\${u.name}`;if((k=window.electronAPI)!=null&&k.createMapProject){if(await window.electronAPI.createMapProject(u)){const E=[{id:Date.now().toString(),name:u.name,lastModified:"Just now",path:C},...i.slice(0,9)];f(E),t(u,C)}}else console.log("Creating map project:",u),t(u)}catch(C){console.error("Error creating map project:",C),alert("Error creating map project. Please try again.")}},v=y=>{e(y.path)},S=async()=>{var y;try{if((y=window.electronAPI)!=null&&y.selectDirectory){const k=await window.electronAPI.selectDirectory();k&&e(k)}else alert("Open Map Project functionality requires the desktop app")}catch(k){console.error("Error opening map project:",k)}},j=()=>{var y;(y=window.electronAPI)!=null&&y.minimize?window.electronAPI.minimize():console.log("Minimize clicked - Electron API not available")},x=()=>{var y;(y=window.electronAPI)!=null&&y.maximize?window.electronAPI.maximize():console.log("Maximize clicked - Electron API not available")},g=()=>{var y;(y=window.electronAPI)!=null&&y.close?window.electronAPI.close():console.log("Close clicked - Electron API not available")};return r?a.jsxs("div",{className:`min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-neutral-900 dark:to-neutral-800 flex flex-col ${n?"dark":""}`,children:[a.jsxs("div",{className:"bg-gray-100 dark:bg-neutral-900 text-orange-600 dark:text-orange-400 flex justify-between items-center px-4 py-1 select-none drag-region border-b border-gray-200 dark:border-neutral-700",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:"/flare-ico.png",alt:"Flare Studio Logo",className:"w-6 h-6"}),a.jsx("span",{className:"text-sm font-semibold",children:"Flare Studio"})]}),a.jsxs("div",{className:"flex no-drag",children:[a.jsx(Q,{content:"Minimize",children:a.jsx("button",{onClick:j,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:a.jsx(Cc,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Maximize",children:a.jsx("button",{onClick:x,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:a.jsx(Rn,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Close",children:a.jsx("button",{onClick:g,className:"text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:a.jsx(Xe,{className:"w-4 h-4"})})})]})]}),a.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xl p-8 w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"inline-flex items-center justify-center",children:a.jsx("img",{src:"/flare-logo.png",alt:"Flare Logo",className:"w-40 h-40 object-contain"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Create a New Flare Project"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Name"}),a.jsx(F,{value:u.name,onChange:y=>h({...u,name:y.target.value}),placeholder:"Enter map name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Location"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(F,{value:u.location,onChange:y=>h({...u,location:y.target.value}),placeholder:"Select folder for your project",readOnly:!0}),a.jsx(I,{type:"button",variant:"outline",onClick:p,children:a.jsx(Na,{className:"w-4 h-4"})})]})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6",children:[a.jsx(I,{variant:"outline",onClick:()=>s(!1),className:"flex-1",children:"Back"}),a.jsx(I,{onClick:b,className:"flex-1",children:"Confirm"})]})]})})]}):a.jsxs("div",{className:`h-screen overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100 dark:from-neutral-900 dark:to-neutral-800 flex flex-col ${n?"dark":""}`,children:[a.jsxs("div",{className:"bg-gray-100 dark:bg-neutral-900 text-orange-600 dark:text-orange-400 flex justify-between items-center px-4 py-1 select-none drag-region border-b border-gray-200 dark:border-neutral-700",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("img",{src:"/flare-ico.png",alt:"Flare Studio Logo",className:"w-4 h-6"}),a.jsx("span",{className:"text-sm font-semibold",children:"Flare Studio"})]}),a.jsxs("div",{className:"flex no-drag",children:[a.jsx(Q,{content:"Minimize",children:a.jsx("button",{onClick:j,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:a.jsx(Cc,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Maximize",children:a.jsx("button",{onClick:x,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:a.jsx(Rn,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Close",children:a.jsx("button",{onClick:g,className:"text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:a.jsx(Xe,{className:"w-4 h-4"})})})]})]}),a.jsxs("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[a.jsxs("div",{className:"w-80 bg-white dark:bg-neutral-900 border-r border-slate-200 dark:border-neutral-700 p-6 flex flex-col h-full",children:[a.jsx("div",{className:"mb-4 flex items-center justify-between",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Projects"})}),a.jsxs("div",{className:"flex-1 min-h-0 h-full",children:[a.jsx("div",{className:"space-y-2 overflow-y-auto minimal-scroll px-1 py-1 h-full",children:i.map(y=>a.jsx("div",{className:"p-3 rounded-lg border border-slate-200 dark:border-neutral-700 hover:bg-slate-50 dark:hover:bg-neutral-800 cursor-pointer transition-colors",onClick:()=>v(y),children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-20 h-20 bg-orange-100 dark:bg-orange-900 rounded overflow-hidden flex items-center justify-center",children:l[y.id]?a.jsx("img",{src:l[y.id]||"",alt:`${y.name} thumbnail`,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx(Nc,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:y.name}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.lastModified})]})]})},y.id))}),i.length===0&&a.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:[a.jsx(Nc,{className:"w-20 h-20 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),a.jsx("p",{children:"No recent project"}),a.jsx("p",{className:"text-sm",children:"Create your first projet to get started"})]})]})]}),a.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:a.jsxs("div",{className:"text-center max-w-md",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-50 h-20",children:a.jsx("img",{src:"/flare-logo.png",alt:"Flare Logo",className:"w-100 h-100 object-contain"})}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-lg",children:"Flare Studio is an unofficial, community-made editor inspired by the Flare engine. It is not affiliated with the official Flare developers."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(I,{onClick:()=>s(!0),className:"w-full h-12 text-lg",size:"lg",children:[a.jsx(Ca,{className:"w-5 h-5 mr-2"}),"Create New Projet"]}),a.jsxs(I,{variant:"outline",onClick:S,className:"w-full h-12 text-lg",size:"lg",children:[a.jsx(J0,{className:"w-5 h-5 mr-2"}),"Open Existing Project"]})]})]})})]})]})};function nb({open:t,onConfirm:e,onCancel:n}){return a.jsx(wr,{open:t,onOpenChange:n,children:a.jsxs(br,{className:"max-w-md bg-red-50 dark:bg-red-900 border-red-400 dark:border-red-700 animate-shake",children:[a.jsxs(kr,{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Vw,{className:"w-8 h-8 text-red-600 dark:text-red-400 animate-pulse"}),a.jsx(Sr,{className:"text-red-700 dark:text-red-300 text-xl font-bold",children:"Danger: Overwrite Export"})]}),a.jsxs(jr,{className:"text-red-700 dark:text-red-300 font-semibold text-base",children:["Older export detected inside project folder.",a.jsx("br",{}),a.jsxs("span",{className:"font-bold",children:["This process will ",a.jsx("span",{className:"underline",children:"replace your older files"}),"."]})]})]}),a.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[a.jsx(I,{variant:"destructive",className:"w-full text-lg font-bold py-3 animate-pulse",onClick:e,children:"Yes, Overwrite Old Export"}),a.jsx(I,{variant:"outline",className:"w-full text-lg font-bold py-3",onClick:n,children:"Cancel"})]})]})})}const rb={xp:{type:"int",min:0},xp_scaling:{type:"filename"},defeat_status:{type:"string"},convert_status:{type:"string"},first_defeat_loot:{type:"int",min:1},animations:{type:"filename"},loot:{type:"list"},loot_count:{type:"intPair",min:0},threat_range:{type:"floatPair",min:0},flee_range:{type:"float",min:0},chance_pursue:{type:"float",min:0},chance_flee:{type:"float",min:0},waypoint_pause:{type:"duration"},turn_delay:{type:"duration"},combat_style:{type:"predefined",options:["default","aggressive","passive"]},power:{type:"list"},passive_powers:{type:"list"},quest_loot:{type:"list"},flee_duration:{type:"duration"},flee_cooldown:{type:"duration"},humanoid:{type:"bool"},lifeform:{type:"bool"},flying:{type:"bool"},intangible:{type:"bool"}},Jp=new Set(["N","NE","E","SE","S","SW","W","NW"]),sb=new Set(["true","false","1","0"]),eg=new Set(["","untitled map","map name","untitled_map"]),ib=t=>t.replace(/[<>:"/|?*]/g,"_").trim().replace(/\s+/g,"_").replace(/_{2,}/g,"_")||"Untitled_Map",ha=(t,e)=>{if(!t)return null;const n=(e??"").trim();return!n||eg.has(n.toLowerCase())?null:`maps/${ib(n)}.txt`},Gh=t=>["# this file is automatically loaded when a New Game starts.","# it's a dummy map to send the player to the actual starting point.","","[header]","width=1","height=1","hero_pos=0,0","","[event]","type=event","location=0,0,1,1","activate=on_load",`intermap=${t??""}`,""].join(`
`),qh=t=>{if(!t)return null;const e=t.match(/^\s*intermap\s*=\s*(.*)$/m);if(!e)return null;const n=e[1].trim();return n||null};function ab(t,e,n){switch(n.type){case"int":{const r=Number.parseInt(e,10);return Number.isNaN(r)?`${t} must be an integer.`:n.min!==void 0&&r<n.min?`${t} must be greater than or equal to ${n.min}.`:n.max!==void 0&&r>n.max?`${t} must be less than or equal to ${n.max}.`:null}case"float":{const r=Number.parseFloat(e);return Number.isNaN(r)?`${t} must be a number.`:n.min!==void 0&&r<n.min?`${t} must be greater than or equal to ${n.min}.`:n.max!==void 0&&r>n.max?`${t} must be less than or equal to ${n.max}.`:null}case"bool":return sb.has(e.toLowerCase())?null:`${t} must be true or false.`;case"filename":return e?null:`${t} cannot be empty.`;case"duration":return/^\d+(ms|s)?$/i.test(e)?null:`${t} must be a duration such as 200ms or 2s.`;case"intPair":{const r=e.split(",").map(s=>s.trim()).filter(Boolean);if(r.length===0||r.length>2)return`${t} must contain one or two comma-separated integers.`;for(const s of r){if(!/^-?\d+$/.test(s))return`${t} must contain valid integers.`;const i=Number.parseInt(s,10);if(n.min!==void 0&&i<n.min)return`${t} values must be greater than or equal to ${n.min}.`;if(n.max!==void 0&&i>n.max)return`${t} values must be less than or equal to ${n.max}.`}return null}case"floatPair":{const r=e.split(",").map(s=>s.trim()).filter(Boolean);if(r.length===0||r.length>2)return`${t} must contain one or two comma-separated numbers.`;for(const s of r){const i=Number.parseFloat(s);if(Number.isNaN(i))return`${t} must contain valid numbers.`;if(n.min!==void 0&&i<n.min)return`${t} values must be greater than or equal to ${n.min}.`;if(n.max!==void 0&&i>n.max)return`${t} values must be less than or equal to ${n.max}.`}return null}case"direction":{const r=e.toUpperCase();if(Jp.has(r))return null;const s=Number.parseInt(e,10);return!Number.isNaN(s)&&s>=0&&s<=7?null:`${t} must be a direction (N, NE, ... , NW) or a number between 0 and 7.`}case"point":{const r=e.split(",").map(s=>s.trim());return r.length!==2||!r.every(s=>/^-?\d+$/.test(s))?`${t} must be two comma-separated integers.`:null}case"predefined":return n.options&&!n.options.includes(e)?`${t} must be one of: ${n.options.join(", ")}.`:null;case"list":case"string":default:return null}}const ob={};function lb(t){const e=t.type==="enemy"?rb:t.type==="npc"?ob:{},n={},r=[],s=t.properties||{};for(const[i,o]of Object.entries(s)){const c=(o??"").toString().trim(),u=e[i];if(u){const h=ab(i,c,u);h&&r.push(h),u.type==="bool"?n[i]=c.toLowerCase():u.type==="direction"&&Jp.has(c.toUpperCase())?n[i]=c.toUpperCase():n[i]=c}else n[i]=c}return{errors:r,sanitized:n}}function cb(){const[t,e]=m.useState(!0),[n,r]=m.useState(null),s=m.useRef(null),[i,o]=m.useState(0),[l,c]=m.useState(0),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[b,v]=m.useState(20),[S,j]=m.useState(15),[x,g]=m.useState("Untitled Map"),[y,k]=m.useState(null),[C,M]=m.useState([]),[P,E]=m.useState(!1),[$,D]=m.useState("(none)"),[G,q]=m.useState(!0),[se,X]=m.useState(!0),[oe,Se]=m.useState(!1),[Ke,z]=m.useState(!1),[W,B]=m.useState([]),[te,ne]=m.useState(null),[ue,xt]=m.useState(!1),[Jr,Qe]=m.useState(!1),[tr,Pu]=m.useState(!1),[tg,Lu]=m.useState(!1),[yi,_u]=m.useState("engine"),[Iu,ng]=m.useState(!0),[rg,es]=m.useState(0),[vi,ts]=m.useState(!0),wi=m.useRef(null),yo=m.useRef(null),[Mn,ns]=m.useState(!0),bi=m.useRef(null),zu=m.useRef(null),[ki,Au]=m.useState(!0),vo=m.useRef(null),sg=m.useRef(null),[jt,rs]=m.useState(null),It=m.useCallback(()=>{wi.current!==null&&(window.clearTimeout(wi.current),wi.current=null)},[]),nr=m.useCallback(()=>{It(),wi.current=window.setTimeout(()=>{ts(!1)},500)},[It]),Si=m.useCallback(()=>{ts(!0),nr()},[nr]),ig=m.useCallback(()=>{It(),ts(!0)},[It]),ag=m.useCallback(()=>{var w;const d=typeof document<"u"?document.activeElement:null;d&&((w=yo.current)!=null&&w.contains(d))||nr()},[nr,yo]),og=m.useCallback(()=>{It(),ts(!0)},[It]),lg=m.useCallback(d=>{const w=d.relatedTarget;d.currentTarget.contains(w)||nr()},[nr]),zt=m.useCallback(()=>{bi.current!==null&&(window.clearTimeout(bi.current),bi.current=null)},[]),rr=m.useCallback(()=>{zt(),bi.current=window.setTimeout(()=>{ns(!1)},500)},[zt]),sr=m.useCallback(()=>{ns(!0),rr()},[rr]),cg=m.useCallback(()=>{zt(),ns(!0)},[zt]),ug=m.useCallback(()=>{var w;const d=typeof document<"u"?document.activeElement:null;d&&((w=zu.current)!=null&&w.contains(d))||rr()},[rr]),dg=m.useCallback(()=>{zt(),ns(!0)},[zt]),hg=m.useCallback(d=>{const w=d.relatedTarget;d.currentTarget.contains(w)||rr()},[rr]),ir=m.useCallback(()=>{vo.current!==null&&(window.clearTimeout(vo.current),vo.current=null)},[]),Du=m.useCallback(()=>{ir()},[ir]),ss=m.useCallback(()=>{Au(!0),Du()},[Du]),fg=m.useCallback(d=>{sg.current=d},[]),mg=m.useCallback(d=>{Lo.current=d,zu.current=d},[]),En=m.useCallback(d=>{pg(d),sr()},[sr]),ji=m.useCallback(d=>{bo(w=>w===d?"none":d),ss()},[ss]),ar=m.useMemo(()=>{var d;return typeof window<"u"&&!!((d=window.electronAPI)!=null&&d.selectTilesetFile)},[]),[je,pg]=m.useState("brush"),[gg,Ni]=m.useState(!1),[xg,Ci]=m.useState(!1),[yg,Ti]=m.useState(!1),[Pn,is]=m.useState("brush"),[Ln,Mi]=m.useState("rectangular"),[or,wo]=m.useState("rectangle"),[Ze,bo]=m.useState("none"),[vg,as]=m.useState(!1),[Ei,ko]=m.useState(null),[Ru,Pi]=m.useState([]),[os,So]=m.useState(null),[lr,ls]=m.useState("select"),[ub,jo]=m.useState(!1),[cs,Ou]=m.useState(""),[wg,Li]=m.useState(!1),[Ht,us]=m.useState(null),[bg,$u]=m.useState(null),No=xe.useRef(null),[Te,ds]=m.useState("Untitled Map"),[cr,kg]=m.useState(!1),[ie,Fu]=m.useState(null),[hs,Wt]=m.useState(null),Hu=m.useRef(Te),Wu=m.useCallback(async(d,w)=>{var A;const T=ha(d,w??Te);if(!ie||!((A=window.electronAPI)!=null&&A.updateSpawnFile)){Wt(T);return}const _=Gh(T);try{await window.electronAPI.updateSpawnFile(ie,_)&&Wt(T)}catch(V){console.error("Failed to update spawn file:",V)}},[Te,ie]),rn=m.useCallback((d,w)=>{kg(d),(w==null?void 0:w.propagate)!==!1&&Wu(d,w==null?void 0:w.mapNameOverride)},[Wu]),[Je,Sg]=m.useState(()=>{const d=localStorage.getItem("isDarkMode");return d?JSON.parse(d):!1}),[ur,jg]=m.useState(()=>{const d=localStorage.getItem("showSidebarToggle");return d?JSON.parse(d):!0});m.useEffect(()=>{try{localStorage.setItem("showSidebarToggle",JSON.stringify(ur))}catch{}},[ur]);const[_i,Co]=m.useState("saved"),[fs,Ng]=m.useState(!0),[Cg,Yu]=m.useState(0),[To,Bu]=m.useState(!1),[dr,Mo]=m.useState(!1);m.useEffect(()=>{let d=!1;return(async()=>{var N;if(!ie||!((N=window.electronAPI)!=null&&N.readSpawnFile)){d||Wt(null);return}try{const T=await window.electronAPI.readSpawnFile(ie);d||Wt(qh(T))}catch(T){console.warn("Failed to read spawn file:",T),d||Wt(null)}})(),()=>{d=!0}},[ie]),m.useEffect(()=>{const d=Hu.current;if(d===Te||(Hu.current=Te,!cr))return;const w=ha(!0,d),N=ha(!0,Te);w!==N&&rn(!0,{mapNameOverride:Te})},[Te,cr,rn]),m.useEffect(()=>{n&&n.setMapName(Te)},[n,Te]);const[Xu,Uu]=m.useState(!1),[Vu,Gu]=m.useState(!1),[Tg,_n]=m.useState(0),[Mg,qu]=m.useState(!1),[hr,Ku]=m.useState(!1),[fr,ms]=m.useState(null),In=m.useRef(null),[Eg,Ii]=m.useState(!1),[K,Ye]=m.useState(null),[Qu,ps]=m.useState([]),[Eo,mr]=m.useState([]),[le,Po]=m.useState(null),[Zu,sn]=m.useState(null),[Pg,zi]=m.useState(!1),[Ee,gs]=m.useState(null),Yt=m.useRef(null),Bt=m.useRef(null),Xt=m.useRef(null),Lo=m.useRef(null),[lt,Ai]=m.useState(null),[Lg,Di]=m.useState(0),[_o,Ri]=m.useState(!1),{toast:be}=wp(),[Ju,xs]=m.useState([]),[pr,an]=m.useState(!1),Io=m.useRef(null),[zo,ed]=m.useState(null),Ao=m.useRef(null),td=m.useRef(null),[Do,nd]=m.useState(null),[Oi,$i]=m.useState(!1);m.useEffect(()=>{if(!pr)return;const d=()=>{const w=Io.current;if(!w)return ed(null);const N=w.getBoundingClientRect();ed({left:N.left,top:N.top-8})};return d(),window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}},[pr]),m.useEffect(()=>{if(!Oi)return;const d=()=>{const w=Ao.current;if(!w)return nd(null);const N=w.getBoundingClientRect();nd({left:N.right+8,top:N.top})};return d(),window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}},[Oi]),m.useEffect(()=>{if(!pr)return;const d=N=>{N.key==="Escape"&&(an(!1),$i(!1))},w=N=>{const T=Ao.current,_=td.current,A=Io.current,V=N.target;T&&(T.contains(V)||_&&_.contains(V)||A&&A.contains(V)||(an(!1),$i(!1)))};return window.addEventListener("keydown",d),window.addEventListener("mousedown",w),()=>{window.removeEventListener("keydown",d),window.removeEventListener("mousedown",w)}},[pr]);const ze=m.useCallback(()=>{mr(n?n.getMapObjects():[])},[n]);m.useEffect(()=>()=>{},[be]),m.useEffect(()=>{Je?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),n&&n.setDarkMode(Je),localStorage.setItem("isDarkMode",JSON.stringify(Je))},[Je,n]),m.useEffect(()=>{if(!n)return;const d=w=>{D(w>0?w.toString():"(none)")};return n.setActiveGidCallback(d),()=>{n.setActiveGidCallback(null)}},[n]);const gr=m.useCallback(d=>{d.setAutoSaveCallback(async()=>{try{window.electronAPI&&ie&&await d.saveProjectData(ie)}catch(w){console.warn("Auto-save to disk failed:",w)}Yu(Date.now())}),d.setSaveStatusCallback(w=>{Co(w),Mo(w==="unsaved"||w==="error")}),d.setAutoSaveEnabled(fs),d.setEyedropperCallback(()=>{En("brush"),is("brush")}),d.setStampCallback(w=>{Pi(w)}),d.setObjectsChangedCallback(w=>{mr(w)}),d.setHeroEditCallback((w,N,T,_,A)=>{gs({currentX:w,currentY:N,mapWidth:T,mapHeight:_,onConfirm:A}),zi(!0)})},[fs,ie,En]);m.useEffect(()=>()=>{It()},[It]),m.useEffect(()=>{!t&&u&&Si()},[t,u,Si]),m.useEffect(()=>{(t||!u)&&(ts(!0),It())},[t,u,It]),m.useEffect(()=>()=>{ir()},[ir]),m.useEffect(()=>{!t&&u&&ss()},[t,u,ss]),m.useEffect(()=>{(t||!u)&&(Au(!0),ir())},[t,u,ir]),m.useEffect(()=>()=>{zt()},[zt]),m.useEffect(()=>{!t&&u&&sr()},[t,u,sr]),m.useEffect(()=>{(t||!u)&&(ns(!0),zt())},[t,u,zt]),m.useEffect(()=>{if(s.current&&!t&&!n&&!Xu&&!jt){const d=new Cl(s.current);d.setDarkMode(Je),gr(d),d.resetForNewProject(),u&&i>0&&l>0?d.setMapSize(i,l):d.setMapSize(0,0),r(d)}},[t,n,gr,Xu,Je,jt,u,i,l]),m.useEffect(()=>{if(!n)return;const d=()=>{const T=n.getHoverCoordinates();Ai(T)};let w;const N=()=>{d(),w=requestAnimationFrame(N)};return N(),()=>{w&&cancelAnimationFrame(w)}},[n]),m.useEffect(()=>{if(n&&je==="brush"){const w={brush:"brush",bucket:"bucket",eraser:"eraser"}[Pn]||"brush";n.setCurrentTool(w)}else if(n&&je==="selection"){const w={rectangular:"rectangular","magic-wand":"magic-wand","same-tile":"same-tile",circular:"circular"}[Ln]||"rectangular";n.setCurrentSelectionTool(w)}else if(n&&je==="shape"){const w={rectangle:"rectangle",circle:"circle",line:"line"}[or]||"rectangle";n.setCurrentShapeTool(w)}else n&&je==="eyedropper"?n.setEyedropperTool():n&&je==="stamp"&&n.setStampTool()},[n,je,Pn,Ln,or]),m.useEffect(()=>{!n||je!=="stamp"||n.setCurrentStampMode(lr)},[n,je,lr]),m.useEffect(()=>{!n||je!=="stamp"||n.setActiveStamp(os)},[n,je,os]),m.useEffect(()=>{if(!n)return;const w=setInterval(()=>{const N=n.getSelection(),T=n.hasActiveSelection();Di(N.length),Ri(T)},100);return()=>clearInterval(w)},[n]);const ct=m.useCallback(()=>{if(n){const d=n.getLayers();B([...d]);const w=n.getActiveLayerId();ne(w),ze()}},[n,ze]);m.useEffect(()=>{n&&ct()},[n,ct]),m.useEffect(()=>{ze()},[ze]),m.useEffect(()=>{const d=w=>{ue&&xt(!1)};return ue&&document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[ue]);const Be=m.useCallback((d,w)=>{if(Lo.current){const N=Lo.current.getBoundingClientRect();let T=window.innerWidth/2;if(s&&s.current){const A=s.current.getBoundingClientRect();T=A.left+A.width/2}const _=Math.max(8,N.top-60);ms({content:d,x:T,y:_,visible:!0,fadeOut:!1})}else{const N=w.getBoundingClientRect(),T=N.left+N.width/2,_=N.top-10;ms({content:d,x:T,y:_,visible:!0,fadeOut:!1})}In.current&&clearTimeout(In.current),In.current=setTimeout(()=>{ms(N=>N?{...N,fadeOut:!0}:null),setTimeout(()=>{ms(null)},300)},1e3)},[]),et=m.useCallback(()=>{In.current&&clearTimeout(In.current),ms(null)},[]);m.useEffect(()=>()=>{In.current&&clearTimeout(In.current),Yt.current&&clearTimeout(Yt.current),Bt.current&&clearTimeout(Bt.current),Xt.current&&clearTimeout(Xt.current)},[]);const rd=m.useCallback(()=>{Yt.current&&clearTimeout(Yt.current),Bt.current&&clearTimeout(Bt.current),Xt.current&&clearTimeout(Xt.current),Ci(!1),Ti(!1),jo(!1),Ni(!0)},[]),sd=m.useCallback(()=>{Yt.current=setTimeout(()=>{Ni(!1)},1e3)},[]),id=m.useCallback(()=>{Yt.current&&clearTimeout(Yt.current),Bt.current&&clearTimeout(Bt.current),Xt.current&&clearTimeout(Xt.current),Ni(!1),Ti(!1),jo(!1),Ci(!0)},[]),ad=m.useCallback(()=>{Bt.current=setTimeout(()=>{Ci(!1)},1e3)},[]),od=m.useCallback(()=>{Yt.current&&clearTimeout(Yt.current),Bt.current&&clearTimeout(Bt.current),Xt.current&&clearTimeout(Xt.current),Ni(!1),Ci(!1),Ti(!0)},[]),ld=m.useCallback(()=>{Xt.current=setTimeout(()=>{Ti(!1)},1e3)},[]),cd=m.useCallback(()=>{if(!n||!cs.trim())return;n.createStampFromSelection(cs.trim())&&(Ou(""),jo(!1),ls("select"))},[n,cs]),_g=m.useCallback(d=>{So(d),ls("place")},[]),Ig=m.useCallback(d=>{n&&(n.deleteStamp(d),os===d&&(So(null),ls("select")))},[n,os]),zg=()=>{switch(Pn){case"bucket":return a.jsx(Sl,{className:"w-4 h-4"});case"eraser":return a.jsx(bl,{className:"w-4 h-4"});default:return a.jsx(la,{className:"w-4 h-4"})}},Ag=()=>{switch(Ln){case"magic-wand":return a.jsx(Nl,{className:"w-4 h-4"});case"same-tile":return a.jsx(vr,{className:"w-4 h-4"});case"circular":return a.jsx(Is,{className:"w-4 h-4"});default:return a.jsx(yw,{className:"w-4 h-4"})}},Dg=()=>{switch(or){case"circle":return a.jsx(Is,{className:"w-4 h-4"});case"line":return a.jsx($h,{className:"w-4 h-4"});default:return a.jsx(Dw,{className:"w-4 h-4"})}},ud=m.useCallback(d=>{ko(d),as(!0)},[]),Rg=m.useCallback(()=>{if(!(!n||Ei===null)){try{n.separateBrush(Ei),console.log(`Separated brush with ID: ${Ei}`)}catch(d){console.error("Failed to separate brush:",d)}as(!1),ko(null),bo("none")}},[n,Ei]),dd=m.useCallback(d=>{n&&(console.log(`handleRemoveBrush called with brushId: ${d}`),us({type:"removeBrush",payload:d}))},[n]),hd=m.useCallback((d,w)=>{if(n)try{const N=n.getDetectedTileInfo(),T=N.findIndex(A=>A.gid===d),_=N.findIndex(A=>A.gid===w);T!==-1&&_!==-1&&(n.reorderBrush(T,_),console.log(`Reordered brush ${d} to position of ${w}`))}catch(N){console.error("Failed to reorder brush:",N)}},[n]),Ro=m.useCallback(d=>{if(!n)return;ps([]);const w=n.getMapObjects().find(N=>N.id===d);w&&(Ye(w),Ii(!0))},[n]),fd=m.useCallback(d=>{n&&(n.updateMapObject(d.id,d),Ye(null),Ii(!1),ze(),ps([]))},[n,ze]),Og=m.useCallback(d=>{const w=(lt==null?void 0:lt.x)??0,N=(lt==null?void 0:lt.y)??0;Po({type:d,name:"",x:w.toString(),y:N.toString(),tilesetPath:""}),sn(null)},[lt]),xr=m.useCallback((d,w)=>{Po(N=>N&&{...N,[d]:w}),sn(null)},[]),md=m.useCallback(async()=>{var d;if(!(typeof window>"u"||!((d=window.electronAPI)!=null&&d.selectTilesetFile)))try{const w=await window.electronAPI.selectTilesetFile();w&&xr("tilesetPath",w)}catch(w){console.error("Failed to select tileset file for actor:",w)}},[xr]),Fi=m.useCallback(()=>{Po(null),sn(null)},[]),$g=m.useCallback(d=>{n&&(n.removeMapObject(d),ze())},[n,ze]),Fg=m.useCallback(()=>{if(!n||!le)return;const d=parseInt(le.x,10),w=parseInt(le.y,10);if(!le.name.trim()){sn("Name is required.");return}if(Number.isNaN(d)||Number.isNaN(w)){sn("Position must be whole numbers.");return}if(d<0||d>=n.getMapWidth()||w<0||w>=n.getMapHeight()){sn("Position is outside of the map bounds.");return}if(!le.tilesetPath.trim()){sn("Tileset location is required.");return}const N=le.tilesetPath.trim(),T=le.name.trim();if(n.getObjectsAtPosition(d,w).find(V=>V.type===le.type)){sn(`There is already a ${le.type==="npc"?"NPC":"enemy"} at that position.`);return}const A=n.addMapObject("enemy",d,w,1,1);n.updateMapObject(A.id,{name:T,x:d,y:w,type:le.type,category:le.type==="npc"?"npc":"enemy",wander_radius:le.type==="npc"?0:A.wander_radius,properties:{...A.properties||{},tilesetPath:N}}),ze(),Fi()},[le,n,Fi,ze]),pd=m.useCallback(()=>{Ii(!1),Ye(null),ps([])},[]),Hg=m.useCallback(()=>{if(!K)return;const{errors:d,sanitized:w}=lb(K);if(d.length>0){ps(d);return}ps([]),fd({...K,properties:w})},[K,fd]),R=m.useCallback((d,w)=>{Ye(N=>{if(!N)return N;const T={...N.properties||{}};return w===null||w===""?delete T[d]:T[d]=w,{...N,properties:T}})},[]),Oo=m.useCallback((d,w)=>{Ye(N=>{if(!N)return N;const T={...N.properties||{}};return T[d]=w?"true":"false",{...N,properties:T}})},[]),H=m.useCallback((d,w="")=>!K||!K.properties?w:K.properties[d]??w,[K]),gd=m.useCallback(async()=>{var d;if(!(typeof window>"u"||!((d=window.electronAPI)!=null&&d.selectTilesetFile)))try{const w=await window.electronAPI.selectTilesetFile();w&&R("tilesetPath",w)}catch(w){console.error("Failed to select tileset for editing object:",w)}},[R]),Wg=m.useCallback((d,w)=>{Ee!=null&&Ee.onConfirm&&Ee.onConfirm(d,w),zi(!1),gs(null)},[Ee]),Yg=m.useCallback(()=>{zi(!1),gs(null)},[]);m.useEffect(()=>{if(!n||!s.current)return;const d=N=>{console.log("Double-click detected on canvas");const T=n.getActiveLayer();if(console.log("Active layer:",T),!T){console.log("No active layer found");return}if(!["enemy","npc","object","event","background"].includes(T.type)){console.log(`Layer type '${T.type}' is not interactive, skipping double-click`);return}const A=n.getHoverCoordinates();if(console.log("Hover coordinates:",A),A){const V=n.getMapObjects(),U=n.getObjectsAtPosition(A.x,A.y);console.log("All objects:",V.length),console.log("Objects at hover position:",U);const ae=V.find(he=>he.x===A.x&&he.y===A.y);console.log("Object at position (find method):",ae),ae?(console.log(`Opening edit dialog for object ID: ${ae.id}`),Ro(ae.id)):console.log("No object found at hover position")}},w=s.current;return w.addEventListener("dblclick",d),()=>{w.removeEventListener("dblclick",d)}},[n,Ro]),m.useEffect(()=>{console.log(`Brush tool changed to: ${Ze}`);const d=document.querySelector("[data-brush-tool]");if(d)d.setAttribute("data-brush-tool",Ze),console.log(`Updated existing data-brush-tool attribute to: ${Ze}`);else{const w=document.createElement("div");w.setAttribute("data-brush-tool",Ze),w.style.display="none",document.body.appendChild(w),console.log(`Created new data-brush-tool element with value: ${Ze}`)}},[Ze]),m.useEffect(()=>{const d=w=>{const{action:N,tileIndex:T}=w.detail;switch(N){case"separate":ud(T);break;case"remove":dd(T);break;case"drop":w.detail.from&&w.detail.to&&hd(w.detail.from,w.detail.to);break}};return document.addEventListener("brushAction",d),()=>{document.removeEventListener("brushAction",d)}},[ud,dd,hd]);const Bg=m.useCallback(async(d,w)=>{try{w.name&&(d.projectName=w.name),console.log("=== LOAD PROJECT DATA DEBUG ==="),console.log("Map config received:",{name:w.name,tilesets:w.tilesets?w.tilesets.length:0,tilesetImages:w.tilesetImages?Object.keys(w.tilesetImages).length:0,layers:w.layers?w.layers.length:0}),console.log("Map config full structure:",w),console.log("Creating layers from config...");const N=w.layers||[];console.log("Layers from config:",N);for(const T of N)if(console.log("Processing layer:",T),d.addLayer(T.name,T.type)){console.log(`Created layer: ${T.type} - ${T.name}`);const A=d.getLayers().find(V=>V.type===T.type);A&&T.data&&Array.isArray(T.data)&&(console.log(`Setting data for layer ${A.id} with ${T.data.length} tiles`),A.data=T.data)}else console.log(`Failed to create layer: ${T.type} - ${T.name}`);return console.log("=== CALLING EDITOR loadProjectData ==="),d.loadProjectData(w),console.log("Project data loading completed"),!0}catch(N){return console.error("Error loading project data:",N),!1}},[]);m.useEffect(()=>{jt&&s.current&&!t&&(console.log("Canvas available and map config pending, creating editor..."),(async()=>{var w;try{console.log("Creating new editor with pending config...");const N=new Cl(s.current);jt.name?N.setMapName(jt.name):N.setMapName("Untitled Map"),console.log("Clearing local storage backup..."),N.clearLocalStorageBackup(),console.log("Setting map size..."),N.setMapSize(jt.width??20,jt.height??15),console.log("Loading project data...");const T=await Bg(N,jt);if(console.log("Project data loading result:",T),console.log("=== EDITOR STATE AFTER loadProjectData ==="),console.log("Tile count after loadProjectData:",N.getTileCount()),console.log("Active layer after loadProjectData:",N.getActiveLayerId()),console.log("Layers after loadProjectData:",N.getLayers().map(_=>({id:_.id,name:_.name,type:_.type}))),(w=window.electronAPI)!=null&&w.discoverTilesetImages&&ie){console.log("Calling discoverTilesetImages for path:",ie);const _=await window.electronAPI.discoverTilesetImages(ie),A=(_==null?void 0:_.tilesetImages)||{},V=Object.keys(A),U=Array.isArray(jt.tilesets)&&jt.tilesets.some(ae=>!!(ae!=null&&ae.layerType));if(console.log("Has per-layer tilesets in project:",U),console.log("Available discovered images:",V),!U&&V.length>0){console.log("No per-layer tilesets found, using fallback assignment");const ae=Ae=>(Ae||"").toLowerCase().replace(/\.[^/.]+$/,"").replace(/[^a-z0-9]+/g," ").trim(),he=N.getActiveLayerId(),Ne=N.getLayers();let tt=!1;for(const Ae of Ne){const ws=[ae(Ae.type),ae(Ae.name)];let Ut=null;for(const bs of V){const Vo=ae(bs);if(ws.includes(Vo)){Ut=bs;break}}if(!Ut){const bs=V.find(Vo=>{const px=ae(Vo);return ws.some(wd=>wd&&px.includes(wd))});bs&&(Ut=bs)}!Ut&&V.length===1&&(Ut=V[0]),Ut?(console.log(`Assigning tileset '${Ut}' to layer ${Ae.id} (${Ae.type})`),N.setActiveLayer(Ae.id),await N.loadTilesetFromDataURL(A[Ut],Ut),tt=!0):console.log(`No matching tileset found for layer ${Ae.id} (${Ae.type})`)}he!==null&&N.setActiveLayer(he),tt&&N.forceSave()}else console.log("Per-layer tilesets already loaded, skipping fallback assignment")}console.log("Setting up autosave and updating UI..."),N.setDarkMode(Je),gr(N),r(N),h(!0),p(!1),setTimeout(()=>{ct();const _=N.getActiveLayerId(),A=N.getLayers().find(V=>V.id===_);console.log("Final UI update - checking active layer:",_,A==null?void 0:A.type),N.redraw()},150),rs(null)}catch(N){if(console.error("Failed to create editor with pending config:",N),rs(null),h(!1),typeof be=="function"){const T=N instanceof Error?N.message:"An error occurred while loading the project.";be({title:"Failed to open project",description:T,variant:"destructive"})}}})())},[jt,t,ie,gr,ct]);const Xg=(d,w)=>{var T;const N=(T=d.target.files)==null?void 0:T[0];N&&(n!=null&&n.handleFileUpload)&&n.handleFileUpload(N,w)},Ug=d=>{n&&(n.setActiveLayer(d),ne(d))},Vg=d=>{if(n){n.toggleLayerVisibility(d);const w=n.getLayers();B([...w])}},Gg=(d,w)=>{if(n){const N=W.find(T=>T.id===d);if(N){const T=N.transparency||0,_=Math.max(0,Math.min(1,T+w));n.setLayerTransparency(d,_),ct()}}},qg=()=>{n!=null&&n.resizeMap&&n.resizeMap(i,l)},Kg=()=>{n!=null&&n.zoomIn&&n.zoomIn()},Qg=()=>{n!=null&&n.zoomOut&&n.zoomOut()},Zg=()=>{n!=null&&n.resetZoom&&n.resetZoom()},Jg=m.useCallback(d=>{const w=d.trim().toLowerCase();if(!w)return!1;const N=new Set;C.forEach(T=>{T&&N.add(T)}),Te.trim()&&N.add(Te.trim().toLowerCase());try{const T=localStorage.getItem("recentMaps");if(T){const _=JSON.parse(T);Array.isArray(_)&&_.forEach(A=>{if(A&&typeof A.name=="string"){const V=A.name.trim().toLowerCase();V&&N.add(V)}})}}catch(T){console.warn("Failed to read recent map names for duplicate check:",T)}return N.has(w)},[Te,C]),$o=m.useCallback(()=>{v(i>0?i:20),j(l>0?l:15),E(cr),k(null),p(!0)},[i,l,cr]),Fo=m.useRef(!1);m.useEffect(()=>{f&&!Fo.current&&(g("Map Name"),Fo.current=!0),f||(Fo.current=!1)},[f,Te]);const ex=async()=>{if(hr)return;const d=Math.max(1,Math.floor(b)||0),w=Math.max(1,Math.floor(S)||0),N=x.trim(),T=N||"Untitled Map";if(Jg(T)){k("There can't be maps that have the same name. Please type another name.");return}k(null),Ku(!0);try{M(A=>{const V=T.trim().toLowerCase();return!V||A.includes(V)?A:[...A,V]}),B([]),ne(null),Pi([]),So(null),mr([]),Ai(null),bo("none"),as(!1),ko(null),Co("saved"),Mo(!1);let _=n;!_&&s.current&&(_=new Cl(s.current),_.setDarkMode(Je),gr(_)),_&&(_.projectName=T,_.resetForNewProject(),_.setMapName(T),_.setMapSize(d,w),_.setDarkMode(Je),n||r(_),ct(),ze()),o(d),c(w),h(!0),Si(),sr(),ds(T),rn(P,{mapNameOverride:T}),E(P),Ri(!1),Di(0),k(null),p(!1)}finally{Ku(!1)}},Ho=m.useCallback(()=>{n!=null&&n.undo&&(n.undo(),ct(),ze())},[n,ct,ze]),Wo=m.useCallback(()=>{n!=null&&n.redo&&(n.redo(),ct(),ze())},[n,ct,ze]),[tx,Yo]=m.useState(!1),[Bo,Xo]=m.useState(null),xd=m.useCallback(async d=>{var _,A,V,U,ae;if(!((_=window.electronAPI)!=null&&_.resolvePathRelative)||!ie)return!1;const w=d.replace(/[<>:"/\\|?*]/g,"_").trim().replace(/\s+/g,"_").replace(/_{2,}/g,"_")||"Map_Name",N=`${ie}/maps/${w}.txt`,T=`${ie}/tilesetdefs/tileset_${w}.txt`;try{const he=await((V=(A=window.electronAPI).fileExists)==null?void 0:V.call(A,N)),Ne=await((ae=(U=window.electronAPI).fileExists)==null?void 0:ae.call(U,T));return!!he||!!Ne}catch{return!1}},[ie]),ys=m.useCallback(async({silent:d=!1,forceOverwrite:w=!1}={})=>{var V,U;if(!n||!ie)return be({title:"Export Failed",description:"No project loaded or editor not initialized.",variant:"destructive"}),!1;const N=Te.trim();if(!N||eg.has(N.toLowerCase()))return d||be({title:"Export Skipped",description:"Please create and name your map before exporting.",variant:"destructive"}),!1;if(!hs)return d||be({title:"Export Failed",description:"No starting map selected.",variant:"destructive"}),!1;d||(Gu(!0),_n(0));const T=Gh(hs),_=n.getTilesetExportInfo();let A;if(_.length>0){const ae={};for(const he of _){const Ne=[he.id];he.sourcePath&&Ne.push(he.sourcePath),he.fileName&&Ne.push(he.fileName);let tt=he.sourcePath??null;if(ie&&he.sourcePath&&((V=window.electronAPI)!=null&&V.resolvePathRelative))try{const Ae=await window.electronAPI.resolvePathRelative(ie,he.sourcePath);Ae&&Ae.trim()&&(tt=Ae)}catch(Ae){console.warn("Failed to resolve tileset path relative to project:",Ae)}if(!tt&&he.fileName&&(tt=he.fileName),tt){const Ae=tt.replace(/\\/g,"/");for(const ws of Ne)ws&&(ae[ws]=Ae)}}Object.keys(ae).length>0&&(A=ae)}try{if(!w&&!d&&await xd(Te))return Xo(()=>()=>ys({silent:d,forceOverwrite:!0})),Yo(!0),!1;d||_n(25);const ae=n.generateFlareMapTxt({pathOverrides:A,mapName:Te});d||_n(50);const he=n.generateFlareTilesetDef({pathOverrides:A});if(d||_n(75),(U=window.electronAPI)!=null&&U.saveExportFiles){if(!await window.electronAPI.saveExportFiles(ie,Te,ae,he,{spawn:{enabled:!0,content:T,filename:"spawn.txt"}}))throw new Error("Failed to save export files");d||(_n(100),setTimeout(()=>{qu(!0)},1500))}else n.exportFlareMap(),console.warn("Spawn file creation skipped: Electron API unavailable."),d||_n(100);return!0}catch(ae){return console.error("Export failed:",ae),be({title:"Export Failed",description:"An error occurred while exporting the map.",variant:"destructive"}),!1}finally{d||setTimeout(()=>{Gu(!1),_n(0)},1e3)}},[n,ie,Te,hs,be,xd]),nx=m.useCallback(async()=>{await ys()},[ys]),rx=m.useCallback(()=>{Yo(!1),Bo&&(Bo(),Xo(null))},[Bo]),sx=m.useCallback(()=>{Yo(!1),Xo(null)},[]),zn=m.useCallback(async()=>{if(n){Bu(!0);try{if(window.electronAPI&&ie){const d=await n.saveProjectData(ie);await new Promise(w=>setTimeout(w,300)),d&&Yu(Date.now())}else n.forceSave(),await new Promise(d=>setTimeout(d,500))}catch(d){console.error("Save error:",d)}finally{Bu(!1)}}},[n,ie]),ix=m.useCallback(async()=>{var d;if(!ie||!((d=window.electronAPI)!=null&&d.listMaps)){xs([]);return}try{const w=await window.electronAPI.listMaps(ie);xs([...w])}catch(w){console.warn("Failed to list maps:",w),xs([])}},[ie]),ax=m.useCallback(async d=>{if(ie)try{if(!await ys({silent:!0})){be({title:"Export failed",description:"Failed to export current map before opening a new one.",variant:"destructive"});return}await zn();const N=await window.electronAPI.readMapFile(ie,d);if(!N){be({title:"Open failed",description:`Failed to read map file ${d}`,variant:"destructive"});return}n&&typeof n.loadFlareMapTxt=="function"?(n.loadFlareMapTxt(N),n.setMapName(d.replace(/\.txt$/i,"")),ct(),ze(),h(!0),ds(d.replace(/\.txt$/i,"")),be({title:"Map opened",description:`Opened ${d}`})):be({title:"Map loaded (raw)",description:"Map content loaded but no parser available in the editor. Implement loadFlareMapTxt to parse it."})}catch(w){console.error("Open map error:",w),be({title:"Open failed",description:"An unexpected error occurred while opening the map.",variant:"destructive"})}},[ie,ys,zn,n,ct,ze,be]),ox=()=>{n!=null&&n.toggleMinimap&&n.toggleMinimap(),q(!G)},lx=(d,w)=>{localStorage.removeItem("tilemap_autosave_backup"),Fu(w??null),rn(!!d.isStartingMap,{propagate:!1}),g("Map Name"),E(!!d.isStartingMap),o(0),c(0),v(d.width),j(d.height),h(!1),B([]),ne(null),Pi([]),mr([]),Ai(null),Ri(!1),Di(0),rs(null),r(null),k(null),p(!1),e(!1)},Hi=m.useCallback(async d=>{var w,N,T,_;console.log("=== HANDLE OPEN MAP CALLED ===",d),console.log("Project path details:",{path:d,timestamp:new Date().toISOString()});try{Uu(!0),Fu(d);let A=hs;if((w=window.electronAPI)!=null&&w.readSpawnFile)try{const U=await window.electronAPI.readSpawnFile(d);A=qh(U),Wt(A)}catch(U){console.warn("Failed to read spawn file:",U),A=null,Wt(null)}else A=null,Wt(null);let V=[];if((N=window.electronAPI)!=null&&N.listMaps)try{V=[...await window.electronAPI.listMaps(d)]}catch(U){console.warn("Failed to list maps:",U),V=[]}if(V.length===0){xs([]),h(!1),r(null),rs(null),ds(""),g(U=>typeof U=="string"&&U.trim()?U:"Map Name"),rn(!1),E(!1),o(0),c(0),ne(null),B([]),Pi([]),mr([]),Ai(null),M([]),Ri(!1),Di(0),Mo(!1),Co("saved"),k(null),v(U=>typeof U=="number"&&U>0?U:20),j(U=>typeof U=="number"&&U>0?U:15),e(!1),p(!0);return}if(xs([...V]),(T=window.electronAPI)!=null&&T.openMapProject){const U=await window.electronAPI.openMapProject(d);if(U){const ae=(_=U.name)!=null&&_.trim()?U.name.trim():"Untitled Map",he=!!U.isStartingMap;ds(ae),g(ae);const Ne=ha(!0,ae),tt=A?Ne===A:he;rn(tt,{propagate:!1}),E(tt),tt&&Ne&&A!==Ne&&(Wt(Ne),A=Ne),o(U.width??20),c(U.height??15),h(!0),Si(),sr(),e(!1),p(!1),n&&r(null),rs(U)}}else console.log("Opening map project:",d)}catch(A){console.error("Error opening map project:",A)}finally{Uu(!1)}},[n,gr,ct,hs,rn]);m.useEffect(()=>{window.electronAPI&&(window.electronAPI.onMenuSaveMap(async()=>{await zn()}),window.electronAPI.onMenuOpenMap(async()=>{const d=await window.electronAPI.selectDirectory();d&&await Hi(d)}),window.electronAPI.onMenuNewMap(()=>{e(!0),h(!1),r(null),o(0),c(0),p(!1)}),window.electronAPI.onMenuUndo(()=>{Ho()}),window.electronAPI.onMenuRedo(()=>{Wo()}))},[zn,Hi,Ho,Wo]),m.useEffect(()=>{window.electronAPI&&(window.electronAPI.onBeforeClose(async()=>{await window.electronAPI.confirmClose(dr)}),window.electronAPI.onSaveAndClose(async()=>{try{await zn(),window.electronAPI.closeAfterSave()}catch(d){console.error("Failed to save before close:",d),window.electronAPI.closeAfterSave()}}))},[dr,zn]),m.useEffect(()=>{const d=w=>{if(dr)return w.preventDefault(),w.returnValue="",""};return window.addEventListener("beforeunload",d),()=>{window.removeEventListener("beforeunload",d)}},[dr]);const cx=()=>{var d;(d=window.electronAPI)!=null&&d.minimize?window.electronAPI.minimize():console.log("Minimize clicked - Electron API not available")},ux=()=>{var d;(d=window.electronAPI)!=null&&d.maximize?window.electronAPI.maximize():console.log("Maximize clicked - Electron API not available")},dx=()=>{var d;(d=window.electronAPI)!=null&&d.close?window.electronAPI.close():console.log("Close clicked - Electron API not available")},hx=()=>{n&&n.fillSelection()},fx=()=>{n&&n.clearSelection()},mx=()=>{n&&n.deleteSelection()},J=m.useMemo(()=>W.find(d=>d.id===te)??null,[W,te]),vs=(J==null?void 0:J.type)==="npc",Wi=(J==null?void 0:J.type)==="enemy",yd=m.useMemo(()=>vs?Eo.filter(d=>d.type==="npc"):Wi?Eo.filter(d=>d.type==="enemy"):[],[Eo,vs,Wi]),[Uo,vd]=m.useState("map");return a.jsx(a.Fragment,{children:t?a.jsx(tb,{onCreateNewMap:lx,onOpenMap:Hi,isDarkMode:Je}):a.jsxs("div",{className:"h-screen bg-background text-foreground flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"bg-gray-100 dark:bg-neutral-900 text-orange-600 dark:text-orange-400 flex justify-between items-center px-4 py-1 select-none drag-region border-b border-gray-200 dark:border-neutral-700",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("img",{src:"/flare-ico.png",alt:"Flare Studio Logo",className:"w-4 h-6"}),a.jsx("span",{className:"text-sm font-semibold text-orange-600 dark:text-orange-400",children:"Flare Studio"})]}),a.jsx("div",{className:"text-sm font-medium"}),a.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[_i==="saving"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-orange-600",children:"Saving..."})]}),_i==="saved"&&Cg>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-green-600",children:"Saved"})]}),_i==="error"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),a.jsx("span",{className:"text-red-600",children:"Save Error"})]}),_i==="unsaved"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),a.jsx("span",{className:"text-yellow-600",children:"Unsaved"})]})]})]}),a.jsxs("div",{className:"flex no-drag",children:[a.jsx(Q,{content:"Minimize",children:a.jsx("button",{onClick:cx,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded transition-colors",children:a.jsx(Cc,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Maximize",children:a.jsx("button",{onClick:ux,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded transition-colors",children:a.jsx(Rn,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Close",children:a.jsx("button",{onClick:dx,className:"text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded transition-colors",children:a.jsx(Xe,{className:"w-4 h-4"})})})]})]}),ur&&a.jsx("button",{onClick:()=>{if(z(!0),n&&typeof n.setSidebarTransitioning=="function")try{n.setSidebarTransitioning(!0)}catch{}Se(d=>!d),window.setTimeout(()=>{if(z(!1),n&&typeof n.setSidebarTransitioning=="function")try{n.setSidebarTransitioning(!1)}catch{}},380)},"aria-label":oe?"Show sidebar":"Hide sidebar",style:{left:oe?0:224},className:"no-drag no-press-shift press-fill-effect fixed top-1/2 transform -translate-y-1/2 z-50 bg-white/90 dark:bg-neutral-900/90 border border-border rounded-l-md p-1 shadow-md hover:bg-white dark:hover:bg-neutral-800",children:oe?a.jsx(F0,{className:"w-4 h-4"}):a.jsx(O0,{className:"w-4 h-4"})}),a.jsxs("main",{className:"flex flex-1 min-h-0",children:[a.jsxs("aside",{className:"relative border-r border-border bg-muted/30 p-2 overflow-visible flex flex-col transition-all duration-200 ease-in-out app-sidebar "+(oe?"sidebar-collapsed":""),"aria-hidden":oe,children:[a.jsxs("div",{className:"sidebar-inner flex flex-col h-full",children:[a.jsxs("section",{className:"flex flex-col flex-1",children:[(()=>{const d=(J==null?void 0:J.type)==="event";return vs||Wi||d?a.jsx(a.Fragment,{children:(vs||Wi)&&a.jsx("div",{className:"flex-1 min-h-0",children:yd.length===0?a.jsx("div",{className:"h-full border border-dashed border-border rounded-md flex items-center justify-center text-sm text-muted-foreground px-4 text-center",children:vs?"No NPCs added yet. Use the Add control to place your first NPC.":"No enemies added yet. Use the Add control to place an enemy."}):a.jsx("div",{className:"space-y-2 overflow-y-auto pr-1",children:yd.map(w=>{var N;return a.jsx("div",{className:"border border-border rounded-md px-3 py-2 bg-background/50 hover:bg-background transition-colors cursor-pointer",onClick:()=>Ro(w.id),children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("div",{className:"font-medium text-foreground",title:w.name||`${w.type==="npc"?"NPC":"Enemy"} #${w.id}`,children:[a.jsx("span",{className:oe?"sr-only":"",children:w.name||`${w.type==="npc"?"NPC":"Enemy"} #${w.id}`}),!w.name&&oe&&a.jsxs("span",{className:"text-xs text-muted-foreground",children:["#",w.id]})]}),a.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a.jsx(Oh,{className:"w-3 h-3"}),a.jsxs("span",{className:oe?"sr-only":"",children:["(",w.x,", ",w.y,")"]})]}),((N=w.properties)==null?void 0:N.tilesetPath)&&a.jsx("div",{className:"text-xs text-muted-foreground break-all",children:w.properties.tilesetPath})]}),a.jsx(Q,{content:"Remove",children:a.jsx(I,{variant:"ghost",size:"sm",className:"w-6 h-6 p-0 text-red-500 hover:text-red-600",onClick:T=>{T.stopPropagation(),$g(w.id)},children:a.jsx(Xe,{className:"w-3 h-3"})})})]})},w.id)})})})}):null})(),a.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden p-0 m-0",children:[(()=>{const d=J==null?void 0:J.type;return d==="background"||d==="object"?a.jsx("div",{className:"flex items-center gap-2 px-2 pb-2",children:a.jsx("div",{className:`flex-1 flex items-center gap-1 overflow-x-auto tabs-scroll ${(()=>{try{const N=n&&d?n.getLayerTabs?n.getLayerTabs(d):[]:[];return N&&N.length>7?"tabs-limited":""}catch{return""}})()}`,onWheel:N=>{const T=N.currentTarget;T.scrollWidth>T.clientWidth&&(N.preventDefault(),T.scrollLeft+=N.deltaY)},children:n?(n.getLayerTabs?n.getLayerTabs(d):[]).map((N,T)=>a.jsx("button",{className:`w-5 h-5 flex items-center justify-center rounded-full text-white text-xs font-medium transition-colors shadow-sm ${n&&n.getCurrentLayerType()===d&&n.getActiveLayerTabId&&n.getActiveLayerTabId(d)===N.id?"opacity-100 scale-100 ring-2 ring-offset-1":"opacity-90 scale-95"}`,onClick:()=>{if(n){n.setActiveLayerTab(d,N.id);try{n.refreshTilePalette(!0)}catch{}es(_=>_+1)}},style:{background:n&&n.getActiveLayerTabId&&n.getActiveLayerTabId(d)===N.id?"#ea580c":"#f97316"},children:T+1},N.id)):a.jsx("div",{className:"text-xs text-muted-foreground",children:"No tabs"})})},rg):null})(),a.jsxs("div",{className:"relative flex-1 min-h-0 overflow-auto flex flex-col",children:[a.jsx("div",{id:"tilesContainer",className:"tile-palette flex flex-col flex-1 min-h-0 overflow-y-auto p-0 m-0 justify-start pb-12",onWheel:d=>{const w=d.currentTarget;w.scrollWidth>w.clientWidth&&(d.preventDefault(),w.scrollLeft+=d.deltaY)}}),a.jsx("div",{"data-brush-tool":Ze,className:"hidden"})]})]}),a.jsxs("div",{className:"sticky bottom-0 z-10 bg-transparent py-2",children:[a.jsx("div",{className:"text-xs text-muted-foreground"}),a.jsx("div",{className:"w-full flex justify-center",children:a.jsxs("div",{ref:fg,className:"flex items-center transition-all duration-300 ease-in-out gap-1 transform -translate-x-1 mt-2 mb-2",children:[a.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1",children:[((J==null?void 0:J.type)==="background"||(J==null?void 0:J.type)==="object")&&a.jsx(Q,{content:"Add tab",side:"bottom",children:a.jsx(I,{variant:"outline",size:"sm",className:"text-xs px-1 py-1 h-6",onClick:()=>{if(!n||!J)return;const d=n.getLayerTabs?n.getLayerTabs(J.type):[];if(d&&d.length>=8){be({title:"Maximum tabs reached",description:"You can have up to 8 tabs per layer.",variant:"destructive"});return}const w=n.createLayerTab(J.type);n.setActiveLayerTab(J.type,w),es(N=>N+1)},children:"+"})}),(()=>{const d=(J==null?void 0:J.type)==="npc",w=(J==null?void 0:J.type)==="enemy",N=(J==null?void 0:J.type)==="event",_=d||w||N?`Add ${N?"Event":d?"NPC":"Enemy"}`:"Import a PNG tileset or brush for the active layer tab";return d||w||N?a.jsx(Q,{content:_,side:"bottom",children:a.jsx(I,{variant:"default",size:"sm","aria-label":_,className:"relative z-20 text-xs px-1 py-1 h-6 shadow-sm bg-orange-500 hover:bg-orange-600 text-white border-orange-500",onClick:A=>{A.stopPropagation(),A.preventDefault(),d||w?Og(d?"npc":"enemy"):be({title:"Not implemented",description:"Create Event will be implemented later."})},role:"button",children:a.jsx(ca,{className:"w-3 h-3 text-white"})})}):a.jsx(Q,{content:_,side:"bottom",children:a.jsxs(I,{variant:"default",size:"sm","aria-label":_,className:"relative text-xs px-1 py-1 h-6 shadow-sm bg-orange-500 hover:bg-orange-600 text-white border-orange-500",children:[a.jsx(ca,{className:"w-3 h-3 text-white"}),a.jsx("input",{type:"file",accept:"image/png",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:async A=>{var ae;if(!n||!J)return;const V=(ae=A.target.files)==null?void 0:ae[0];if(!V)return;const U=J.type;if(U==="background"||U==="object"){const he=n.getLayerTabs?n.getLayerTabs(U):[];let Ne=n.getActiveLayerTabId?n.getActiveLayerTabId(U):null;if(typeof Ne!="number"||Ne===null){if(he&&he.length>=8){be({title:"Maximum tabs reached",description:"You can have up to 8 tabs per layer.",variant:"destructive"});return}Ne=n.createLayerTab(U),n.setActiveLayerTab(U,Ne)}await n.importBrushImageToLayerTab(U,Ne,V),n.refreshTilePalette(!0),es(tt=>tt+1)}else Xg(A,"layerTileset")}})]})})})()]}),a.jsx("div",{className:"flex-shrink-0 overflow-visible transition-all duration-300 ease-out opacity-100 scale-100 max-w-[2.5rem] w-auto",children:a.jsx(Q,{content:"Move/Reorder brushes",children:a.jsx(I,{variant:Ze==="move"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>ji("move"),children:a.jsx(Wh,{className:"w-3 h-3"})})})}),a.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${ki||Ze==="merge"?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:a.jsx(Q,{content:"Merge brushes",children:a.jsx(I,{variant:Ze==="merge"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>ji("merge"),children:a.jsx(Rh,{className:"w-3 h-3"})})})}),a.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${ki||Ze==="separate"?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:a.jsx(Q,{content:"Separate brushes",children:a.jsx(I,{variant:Ze==="separate"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>ji("separate"),children:a.jsx(Iw,{className:"w-3 h-3"})})})}),a.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${ki||Ze==="remove"?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:a.jsx(Q,{content:"Remove brushes",children:a.jsx(I,{variant:Ze==="remove"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>ji("remove"),children:a.jsx(Xw,{className:"w-3 h-3"})})})}),a.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${ki?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:a.jsx(Q,{content:"Delete tileset tab",children:a.jsx(I,{variant:"outline",size:"sm",className:"text-xs px-1 py-1 h-6 border-red-500 hover:border-red-600 hover:bg-red-50 shadow-sm",onClick:()=>{if(ss(),!n){be({title:"No editor",description:"Editor is not initialized yet.",variant:"destructive"});return}const d=J==null?void 0:J.type;if(!d){be({title:"No active layer",description:"Please select a layer first.",variant:"destructive"});return}const w=n.getActiveLayerTabId?n.getActiveLayerTabId(d):null;if(typeof w!="number"||w===null){be({title:"No tab selected",description:"There is no active tileset tab to delete for this layer.",variant:"destructive"});return}const N={layerType:d,tabId:w};No.current=N,$u(N),us({type:"removeTab",payload:N})},children:a.jsx(Xe,{className:"w-3 h-3 text-red-500"})})})})]})})]})]}),a.jsx("section",{className:"mb-0 flex-shrink-0 flex flex-col justify-center h-40",onMouseEnter:()=>Pu(!0),onMouseLeave:()=>Pu(!1),tabIndex:0,children:a.jsx("div",{className:"mb-2 w-full flex flex-col justify-center h-full",children:a.jsx("div",{className:"h-48 overflow-hidden flex flex-col justify-center w-full",children:a.jsx("div",{className:"space-y-0.5 h-full overflow-y-auto flex flex-col justify-center w-full",children:W.map(d=>{const w=te===d.id,N=tr||w;return a.jsx("div",{className:`block w-full max-w-xs px-2 py-1 rounded transition-all text-xs transform-gpu ${w?"bg-orange-50 dark:bg-orange-900/20 border-orange-400":"bg-transparent border-transparent"}`,style:{opacity:N?1:.65,transform:N?"scaleY(1) translateY(0)":"scaleY(0.98) translateY(0)",transformOrigin:"top",pointerEvents:N?"auto":"none",transition:"transform 400ms cubic-bezier(.2,.9,.2,1), opacity 400ms ease, box-shadow 300ms ease",boxShadow:w?"0 6px 12px rgba(15,23,42,0.06)":"none",zIndex:w?30:10},children:a.jsx("div",{className:"cursor-pointer w-full flex items-center",onClick:()=>Ug(d.id),children:a.jsxs("div",{className:`flex items-center gap-2 w-full ${w?"opacity-100":"opacity-80"}`,children:[a.jsx(Q,{content:d.visible?"Hide layer":"Show layer",children:a.jsx(I,{variant:"ghost",size:"sm",onClick:T=>{T.stopPropagation(),Vg(d.id)},className:"w-4 h-4 p-0 hover:bg-gray-200 dark:hover:bg-gray-700",children:d.visible?a.jsx(Q0,{className:"w-2.5 h-2.5"}):a.jsx(q0,{className:"w-2.5 h-2.5 text-gray-400 dark:text-gray-500"})})}),a.jsx(I,{variant:"ghost",size:"sm",className:"w-4 h-4 p-0 hover:bg-gray-200 dark:hover:bg-gray-700",onMouseEnter:T=>{const _=Math.round((d.transparency||0)*100);Be(a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(oa,{className:"w-3 h-3"}),"Transparency (",_,"%)"]}),T.currentTarget)},onMouseLeave:et,onWheel:T=>{T.preventDefault();const _=T.deltaY>0?.1:-.1;Gg(d.id,_);const A=d.transparency||0,V=Math.max(0,Math.min(1,A+_)),U=Math.round(V*100);Be(a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(oa,{className:"w-3 h-3"}),"Transparency (",U,"%)"]}),T.currentTarget)},children:a.jsx(_0,{className:"w-2.5 h-2.5"})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Q,{content:d.name,children:a.jsx("span",{className:"text-xs font-medium truncate flex items-center gap-2",children:(()=>{switch((d.type||"").toLowerCase()){case"background":case"bg":return a.jsx(rw,{className:"w-4 h-4"});case"collision":case"collision layer":return a.jsx(Nc,{className:"w-4 h-4"});case"objects":case"object":return a.jsx(z0,{className:"w-4 h-4"});case"npc":return a.jsx(Zw,{className:"w-4 h-4"});case"enemy":return a.jsx(aw,{className:"w-4 h-4"});case"event":return a.jsx(B0,{className:"w-4 h-4"});default:return a.jsx(kl,{className:"w-4 h-4"})}})()})}),a.jsx("span",{className:oe?"sr-only text-xs font-medium":"text-xs font-medium truncate",title:d.name,children:d.name})]})]})})},d.id)})})})})})]}),a.jsxs("section",{className:"flex-shrink-0 mt-auto mb-2",children:[a.jsx("div",{className:"w-full h-1.5 mb-2",children:Vu?a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-full overflow-hidden",children:a.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 h-full transition-all duration-1000 ease-out rounded-full",style:{width:`${Tg}%`}})}):a.jsx("div",{className:"w-full h-full"})}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsxs("div",{children:[a.jsx(I,{ref:Io,size:"sm",className:"w-7 h-7 p-0 shadow-sm",onClick:async()=>{pr||await ix(),an(d=>!d)},disabled:Vu||hr,children:a.jsx(uw,{className:"w-3 h-3"})}),pr&&zo&&qn.createPortal(a.jsx("div",{ref:Ao,style:{left:zo.left,top:zo.top,position:"absolute",transform:"translateY(-100%)"},className:"w-56 bg-background border border-border rounded shadow-lg z-[9999]",children:a.jsx("div",{className:"max-h-60 overflow-y-auto minimal-scroll",children:ie?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative",children:[a.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center justify-between gap-2",onClick:()=>$i(d=>!d),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Na,{className:"w-3 h-3"}),a.jsx("span",{children:"Open map"})]}),a.jsx("svg",{className:`w-3 h-3 transition-transform ${Oi?"transform rotate-90":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Oi&&Do&&qn.createPortal(a.jsx("div",{ref:td,style:{left:Do.left,top:Do.top,position:"absolute"},className:"w-48 bg-background border border-border rounded shadow-md z-[10000] max-h-60 overflow-y-auto minimal-scroll",children:Ju.length===0?a.jsx("div",{className:"p-2 text-xs text-muted-foreground",children:"No maps found"}):Ju.map(d=>a.jsx("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs",onClick:()=>{an(!1),$i(!1),ax(d)},children:d},d))}),document.body)]}),a.jsx("div",{className:"border-t border-border"}),a.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:async()=>{an(!1),await nx()},children:[a.jsx(U0,{className:"w-3 h-3"}),a.jsx("span",{children:"Export map"})]}),a.jsx("div",{className:"border-t border-border"}),a.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:()=>{an(!1),$o()},children:[a.jsx(Ca,{className:"w-3 h-3"}),a.jsx("span",{children:"Create new map"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:async()=>{var d;if(an(!1),(d=window.electronAPI)!=null&&d.selectDirectory)try{const w=await window.electronAPI.selectDirectory();w&&await Hi(w)}catch(w){console.error("Failed to select directory:",w),be({title:"Open failed",description:"Unable to open project directory.",variant:"destructive"})}else be({title:"Open unavailable",description:"Open project requires the desktop app.",variant:"destructive"})},children:[a.jsx(Na,{className:"w-3 h-3"}),a.jsx("span",{children:"Open project..."})]}),a.jsx("div",{className:"border-t border-border"}),a.jsx("div",{className:"p-2 text-xs",children:"No project is currently open. Open a project to list maps and enable Export."}),a.jsx("div",{className:"border-t border-border"}),a.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:()=>{an(!1),$o()},children:[a.jsx(Ca,{className:"w-3 h-3"}),a.jsx("span",{children:"Create new map"})]})]})})}),document.body)]}),a.jsx(Q,{content:dr?"Save changes":"All changes saved",children:a.jsx(I,{onClick:zn,className:`w-7 h-7 p-0 shadow-sm transition-colors ${To?"bg-blue-500 hover:bg-blue-600":dr?"bg-orange-500 hover:bg-orange-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,disabled:To||hr,size:"sm",children:To?a.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx(Hh,{className:"w-3 h-3"})})}),a.jsx(Q,{content:"Map Settings",children:a.jsx(I,{onClick:()=>Qe(!0),className:"w-7 h-7 p-0 shadow-sm",variant:"outline",size:"sm",children:a.jsx(Yh,{className:"w-3 h-3"})})})]})]})]}),Jr&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Settings"}),a.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Qe(!1),className:"w-8 h-8 p-0",children:a.jsx(Xe,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex border-b mb-4",children:[a.jsx("button",{className:`flex-1 py-2 text-sm font-medium border-b-2 transition-colors ${Uo==="map"?"border-orange-500 text-orange-600":"border-transparent text-gray-500"}`,onClick:()=>vd("map"),children:"Current Map Settings"}),a.jsx("button",{className:`flex-1 py-2 text-sm font-medium border-b-2 transition-colors ${Uo==="other"?"border-orange-500 text-orange-600":"border-transparent text-gray-500"}`,onClick:()=>vd("other"),children:"Other Options"})]}),Uo==="map"?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Map Name"}),a.jsx(F,{type:"text",value:Te,onChange:d=>ds(d.target.value),placeholder:"Enter map name",className:"w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Map Width"}),a.jsx(F,{type:"number",value:i,onChange:d=>o(Number(d.target.value)),min:"1",max:"100",className:"w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Map Height"}),a.jsx(F,{type:"number",value:l,onChange:d=>c(Number(d.target.value)),min:"1",max:"100",className:"w-full"})]}),a.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border px-3 py-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{htmlFor:"starting-map-checkbox",className:"text-sm font-medium text-muted-foreground",children:"Starting Map"}),a.jsx(Q,{content:"If this map is the map that players will start the game then mark this option",children:a.jsx(wl,{className:"h-4 w-4 text-muted-foreground","aria-hidden":!0})})]}),a.jsx("input",{id:"starting-map-checkbox",type:"checkbox",className:"h-4 w-4 rounded border border-border accent-orange-500",checked:cr,onChange:d=>rn(d.target.checked),"aria-checked":cr,"aria-label":"Set this map as the starting map"})]}),a.jsxs("div",{className:"flex gap-2 mt-6",children:[a.jsx(I,{variant:"outline",onClick:()=>Qe(!1),className:"flex-1",children:"Cancel"}),a.jsx(I,{onClick:()=>{qg(),Qe(!1)},className:"flex-1",children:"Apply Changes"})]})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Theme (Experimental)"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Light Mode"}),a.jsxs("button",{onClick:()=>Sg(!Je),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${Je?"bg-orange-600":"bg-gray-200"}`,children:[a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${Je?"translate-x-6":"translate-x-1"}`}),a.jsx("span",{className:"sr-only",children:"Toggle dark mode"})]}),a.jsxs("span",{className:"text-sm flex items-center gap-1",children:[Je?a.jsx(fw,{className:"w-4 h-4"}):a.jsx(Ww,{className:"w-4 h-4"}),"Dark Mode"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Debug Mode"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Disabled"}),a.jsxs("button",{onClick:()=>{n&&n.toggleDebugMode()},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${n!=null&&n.getDebugMode()?"bg-orange-600":"bg-gray-200"}`,children:[a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n!=null&&n.getDebugMode()?"translate-x-6":"translate-x-1"}`}),a.jsx("span",{className:"sr-only",children:"Toggle debug mode"})]}),a.jsxs("span",{className:"text-sm flex items-center gap-1",children:[a.jsx(vr,{className:"w-4 h-4"}),"Debug Tiles"]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shows tile boundaries and coordinates for debugging"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Auto-Save"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Disabled"}),a.jsxs("button",{onClick:()=>{const d=!fs;Ng(d),n&&n.setAutoSaveEnabled(d)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${fs?"bg-orange-600":"bg-gray-200"}`,children:[a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${fs?"translate-x-6":"translate-x-1"}`}),a.jsx("span",{className:"sr-only",children:"Toggle auto-save"})]}),a.jsx("span",{className:"text-sm",children:"Enabled"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Automatically saves your work every 8 seconds"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Active GID Indicator"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Show"}),a.jsxs("button",{onClick:()=>{X(!se)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${se?"bg-orange-600":"bg-gray-200"}`,children:[a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${se?"translate-x-6":"translate-x-1"}`}),a.jsx("span",{className:"sr-only",children:"Toggle Active GID Indicator"})]}),a.jsx("span",{className:"text-sm",children:se?"Shown":"Hidden"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Toggle whether the Active GID badge is visible next to the hover coordinates."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sidebar Collapse Button"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Show toggle"}),a.jsxs("button",{onClick:()=>jg(d=>!d),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${ur?"bg-orange-600":"bg-gray-200"}`,children:[a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${ur?"translate-x-6":"translate-x-1"}`}),a.jsx("span",{className:"sr-only",children:"Toggle sidebar collapse button"})]}),a.jsx("span",{className:"text-sm",children:ur?"Shown":"Hidden"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Show or hide the left-edge sidebar collapse/expand toggle."})]}),a.jsxs("div",{className:"flex gap-2 mt-6",children:[a.jsx(I,{variant:"outline",onClick:()=>Qe(!1),className:"flex-1",children:"Close"}),a.jsxs(I,{onClick:()=>{Lu(!0),Qe(!1)},className:"flex-1 flex items-center justify-center gap-2",children:[a.jsx(wl,{className:"w-4 h-4"}),a.jsx("span",{children:"Help & Docs"})]})]})]})]})}),wg&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-80",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Clear Layer"}),a.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Li(!1),className:"w-8 h-8 p-0",children:a.jsx(Xe,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"text-sm text-foreground mb-4",children:"Are you sure you want to clear all tiles from the current layer? This action cannot be undone."}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(I,{variant:"outline",onClick:()=>Li(!1),children:"Cancel"}),a.jsx(I,{onClick:()=>{n&&n.clearLayer(),is("brush"),Li(!1)},children:"Clear"})]})]})}),Ht&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-80",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Confirm"}),a.jsx(I,{variant:"ghost",size:"sm",onClick:()=>us(null),className:"w-8 h-8 p-0",children:a.jsx(Xe,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"text-sm text-foreground mb-4",children:[Ht.type==="removeBrush"&&"Are you sure you want to remove this brush?",Ht.type==="removeTileset"&&"Are you sure you want to remove the tileset for this layer? This will clear the tileset but keep any placed tiles.",Ht.type==="removeTab"&&"Are you sure you want to remove this tileset tab?"]}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx(I,{variant:"outline",onClick:()=>us(null),children:"Cancel"}),a.jsx(I,{onClick:()=>{try{if(Ht.type==="removeBrush"){const d=Ht.payload;n&&n.removeBrush(d)}else if(Ht.type==="removeTileset")n&&n.removeLayerTileset();else if(Ht.type==="removeTab"){const d=bg??No.current??Ht.payload;if(n&&d&&d.layerType){const w=n.getActiveLayerTabId?n.getActiveLayerTabId(d.layerType):null,N=typeof w=="number"&&w!==null?w:d.tabId;if(console.info("Confirm removeTab: requested=",d,"liveActive=",w,"using=",N),typeof N=="number"){n.removeLayerTab(d.layerType,N),es(T=>T+1);try{n.refreshTilePalette(!0)}catch(T){console.warn("refreshTilePalette failed",T)}try{const T=n.getActiveLayerTabId?n.getActiveLayerTabId(d.layerType):null;if(typeof T=="number"){n.setActiveLayerTab(d.layerType,T),es(_=>_+1);try{n.refreshTilePalette(!0)}catch(_){console.warn("refreshTilePalette failed",_)}}}catch(T){console.warn("Post-remove setActiveLayerTab safeguard failed",T)}}else console.warn("Confirm removeTab: no finalTabId available, aborting",d)}$u(null),No.current=null}}catch(d){console.error("Confirm action failed:",d)}finally{us(null)}},children:"Confirm"})]})]})}),tg&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-background border border-border rounded-lg p-0 w-[800px] max-h-[80vh] overflow-y-auto help-modal relative",children:[a.jsxs("div",{className:"sticky top-0 z-20 bg-background/95 backdrop-blur-sm border-b border-border py-3 px-4 rounded-t-lg",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Help & Documentation"}),a.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Lu(!1),className:"w-8 h-8 p-0 rounded-full","aria-label":"Close Help",children:a.jsx(Xe,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex space-x-1 mt-3 bg-gray-100 dark:bg-neutral-800 rounded-lg p-1",children:[a.jsxs("button",{onClick:()=>_u("engine"),className:`px-3 py-2 rounded-md text-sm font-medium transition-all ${yi==="engine"?"bg-white dark:bg-neutral-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[a.jsx(vr,{className:"w-4 h-4 inline mr-2"}),"Engine"]}),a.jsxs("button",{onClick:()=>_u("collisions"),className:`px-3 py-2 rounded-md text-sm font-medium transition-all ${yi==="collisions"?"bg-white dark:bg-neutral-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[a.jsx(jl,{className:"w-4 h-4 inline mr-2"}),"Collisions"]})]})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[yi==="engine"&&a.jsxs(a.Fragment,{children:[a.jsxs("section",{children:[a.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[a.jsx(vr,{className:"w-5 h-5 text-orange-500"}),"Getting Started"]}),a.jsxs("div",{className:"space-y-2 text-gray-700 dark:text-gray-400",children:[a.jsx("p",{children:"Welcome to the Isometric Tile Map Editor! This tool allows you to create beautiful isometric tile-based maps."}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4 text-gray-700 dark:text-gray-400",children:[a.jsx("li",{children:"Start by creating a new map or loading an existing one"}),a.jsx("li",{children:"Import tilesets to begin designing"}),a.jsx("li",{children:"Use layers to organize different elements of your map"}),a.jsx("li",{children:"Export your finished map for use in your projects"})]})]})]}),a.jsxs("section",{children:[a.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[a.jsx(kl,{className:"w-5 h-5 text-orange-500"}),"Map Management"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:"Layers help organize your map content. Each layer can have its own tileset and transparency."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Hh,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Save/Export"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Save your map as JSON or export as PNG image"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(ca,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Load Map"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Load previously saved JSON map files"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Yh,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Map Settings"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Configure map dimensions, tile size, and other properties"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Rh,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Lock/Unlock"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Prevent accidental edits to completed layers"})]})]})]})]})]}),a.jsxs("section",{children:[a.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[a.jsx(la,{className:"w-5 h-5 text-orange-500"}),"Drawing Tools"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(la,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Brush Tool"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Paint individual tiles by clicking"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Sl,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Bucket Fill"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Fill connected areas with the same tile"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(bl,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Eraser"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Remove tiles from the map"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Fh,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Eyedropper"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Select a tile from the map to use as brush"})]})]})]})]}),a.jsxs("section",{children:[a.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[a.jsx(Rn,{className:"w-5 h-5 text-orange-500"}),"Tileset Management"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:"Each layer can have its own tileset. Import PNG images to use as tilesets."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(ca,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Import Tileset"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Click the upload button for each layer to import a tileset image"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Xe,{className:"w-4 h-4 mt-1 text-orange-500"}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Remove Tileset"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Use the red X button to remove a tileset from a layer"})]})]})]})]})]}),a.jsxs("section",{children:[a.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2",children:[a.jsx(vr,{className:"w-5 h-5 text-orange-500"}),"Keyboard Shortcuts"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 bg-gray-50 dark:bg-neutral-900 p-4 rounded-lg",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Ctrl+Z"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Undo"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Ctrl+Y"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Redo"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Ctrl+S"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Save Map"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Mouse Wheel"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Zoom"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Middle Click + Drag"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Pan"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Hover + Wheel"}),a.jsx("span",{className:"text-sm text-gray-400",children:"Layer Transparency"})]})]})]})]}),a.jsxs("section",{children:[a.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2",children:[a.jsx(Nl,{className:"w-5 h-5 text-orange-500"}),"Tips & Best Practices"]}),a.jsx("div",{className:"space-y-2 text-gray-700 dark:text-gray-400",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4 text-gray-700 dark:text-gray-400",children:[a.jsx("li",{children:"Use separate layers for different map elements (background, objects, decorations)"}),a.jsx("li",{children:"Name your layers descriptively for better organization"}),a.jsx("li",{children:"Lock completed layers to prevent accidental changes"}),a.jsx("li",{children:"Adjust layer transparency to see underlying elements while editing"}),a.jsx("li",{children:"Use the eyedropper tool to quickly select tiles from existing map areas"}),a.jsx("li",{children:"Save frequently to avoid losing work"}),a.jsx("li",{children:"Test your map export to ensure it looks correct in your target application"})]})})]})]}),yi==="collisions"&&a.jsx(a.Fragment,{children:a.jsxs("section",{children:[a.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[a.jsx(jl,{className:"w-5 h-5 text-orange-500"}),"Summary of Collision Values for Flare"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:"Collision values in Flare Engine determine how entities interact with map tiles. Each value has specific behavior that affects movement and visibility."}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse border border-gray-300 dark:border-gray-600",children:[a.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left font-semibold text-gray-800 dark:text-gray-100",children:"Value"}),a.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left font-semibold text-gray-800 dark:text-gray-100",children:"Type"}),a.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left font-semibold text-gray-800 dark:text-gray-100",children:"Behavior"})]})}),a.jsxs("tbody",{className:"text-gray-700 dark:text-gray-300",children:[a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-red-50 dark:bg-red-900/20",children:"1"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-red-600 dark:text-red-400",children:"Red Block"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Impassable wall, visible on minimap"})]}),a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-red-50 dark:bg-red-900/20",children:"2"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-red-600 dark:text-red-400",children:"Dithered Red"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Still blocks entities, minimap shows dithered tile"})]}),a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-blue-50 dark:bg-blue-900/20",children:"3"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-blue-600 dark:text-blue-400",children:"Pit (Blue)"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Ground entities blocked; air can pass"})]}),a.jsxs("tr",{children:[a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-blue-50 dark:bg-blue-900/20",children:"4"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-blue-600 dark:text-blue-400",children:"Dithered Pit"}),a.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Same as 3, but minimap shows dithered"})]})]})]})}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[a.jsxs("h5",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2 flex items-center gap-2",children:[a.jsx(jl,{className:"w-4 h-4"}),"Usage Guidelines"]}),a.jsxs("ul",{className:"text-blue-700 dark:text-blue-300 text-sm space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Value 1 (Red Block):"})," Use for walls, buildings, and solid obstacles that should be clearly visible on the minimap"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Value 2 (Dithered Red):"})," Use for partial barriers or decorative walls that still block movement"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Value 3 (Pit):"})," Use for water, lava, or ground hazards that flying entities can cross"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Value 4 (Dithered Pit):"})," Use for shallow water or transitional pit areas"]})]})]}),a.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-lg border border-amber-200 dark:border-amber-800",children:[a.jsx("h5",{className:"font-medium text-amber-800 dark:text-amber-200 mb-2",children:"⚠️ Important Notes"}),a.jsxs("ul",{className:"text-amber-700 dark:text-amber-300 text-sm space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:["Collision values are set in the ",a.jsx("strong",{children:"Collision Layer"})," of your map"]}),a.jsx("li",{children:"Each tile position can only have one collision value"}),a.jsx("li",{children:"Collision affects AI pathfinding and player movement"}),a.jsx("li",{children:"Minimap visualization helps players understand map layout"})]})]})]})]})}),a.jsx("div",{className:"pt-4 border-t border-gray-200 text-center",children:a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Flare Studio | GUI for Flare Engine by ism."})})]})]})}),a.jsxs("section",{className:"flex-1 min-w-0 flex flex-col relative",children:[a.jsx("div",{ref:yo,className:"absolute top-2 right-2 z-10",onMouseEnter:ig,onMouseLeave:ag,onFocus:og,onBlur:lg,tabIndex:vi?-1:0,"aria-label":"Map controls",children:a.jsxs("div",{className:`flex items-center bg-white/90 dark:bg-neutral-900/90 border border-border rounded-full shadow-lg transition-all duration-300 ease-in-out ${vi?"px-2 py-1":"px-1 py-1"}`,children:[a.jsxs("div",{className:`flex items-center gap-1 overflow-hidden transition-all duration-300 ease-out ${vi?"opacity-100 scale-100 max-w-[420px]":"opacity-0 scale-95 max-w-0 pointer-events-none"}`,children:[a.jsx(Q,{content:"Undo (Ctrl+Z)",side:"bottom",children:a.jsx(I,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Ho,children:a.jsx(qw,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Redo (Ctrl+Y)",side:"bottom",children:a.jsx(I,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Wo,children:a.jsx(Tw,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Zoom In",side:"bottom",children:a.jsx(I,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Kg,children:a.jsx(n1,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Zoom Out",side:"bottom",children:a.jsx(I,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Qg,children:a.jsx(s1,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Reset View",side:"bottom",children:a.jsx(I,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Zg,children:a.jsx(Ew,{className:"w-4 h-4"})})}),a.jsx(Q,{content:"Toggle Minimap",side:"bottom",children:a.jsx(I,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:ox,children:a.jsx(kl,{className:"w-4 h-4"})})})]}),a.jsx("div",{className:`flex items-center justify-center w-8 h-8 transition-all duration-300 ease-out ${vi?"opacity-50 scale-90":"opacity-100 scale-100"}`,"aria-hidden":!0,children:a.jsx(Wh,{className:"w-4 h-4 text-muted-foreground"})})]})}),a.jsxs("div",{className:"bg-gray-100 flex-1 min-h-0 flex items-center justify-center overflow-hidden relative",children:[a.jsxs("div",{className:`absolute top-4 left-4 z-20 p-3 bg-white/90 dark:bg-neutral-900/90 backdrop-blur-sm rounded-lg border border-border shadow-lg transition-opacity duration-300 ${Iu?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,"aria-hidden":!Iu,children:[a.jsx(I,{variant:"ghost",size:"sm",className:"absolute top-1 right-1 w-6 h-6 p-0",onClick:()=>ng(!1),children:a.jsx(Xe,{className:"w-3 h-3"})}),a.jsxs("div",{className:"space-y-2 pr-6",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[a.jsx(pw,{className:"w-4 h-4"}),a.jsx("span",{children:"Left Click to Paint"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[a.jsx(oa,{className:"w-4 h-4"}),a.jsx("span",{children:"Right Click to Delete"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[a.jsx(ww,{className:"w-4 h-4"}),a.jsx("span",{children:"Spacebar + Mouse to Pan"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[a.jsxs("div",{className:"relative",children:[a.jsx(oa,{className:"w-4 h-4"}),a.jsx(Is,{className:"w-2 h-2 absolute top-1 left-1.5 opacity-60"})]}),a.jsx("span",{children:"Mouse Wheel to Zoom In-Out"})]})]})]}),a.jsx("canvas",{ref:s,id:"mapCanvas",className:`tile-canvas w-full h-full max-w-full max-h-full canvas-fade ${Ke?"during-sidebar-transition":""}`}),a.jsx("div",{className:`absolute inset-0 flex items-center justify-center transition-opacity duration-200 ${u?"opacity-0 pointer-events-none":"opacity-100 pointer-events-auto bg-background/80 backdrop-blur-sm"}`,"aria-hidden":u,children:a.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 rounded-full border-2 border-orange-500/80 bg-background/95 shadow-lg backdrop-blur-sm transition-opacity duration-200 ${u?"opacity-0":"opacity-100"}`,children:[a.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Create a map"}),a.jsx(I,{size:"sm",variant:"default",className:"w-9 h-9 p-0 rounded-full bg-orange-500 text-white shadow-sm transition-all duration-150 hover:bg-orange-600 hover:shadow-md hover:-translate-y-0.5 focus-visible:ring-2 focus-visible:ring-orange-500 focus-visible:ring-offset-2",onClick:$o,disabled:hr,children:a.jsx(Ca,{className:"w-4 h-4"})})]})}),a.jsxs("div",{className:`absolute bottom-4 left-4 z-10 p-2 rounded-md text-xs font-mono flex items-center gap-2 transition-opacity duration-200 ${lt?"opacity-100 pointer-events-auto bg-white/90 dark:bg-neutral-900/90 border border-gray-200 dark:border-neutral-600 text-gray-800 dark:text-white shadow-sm":"opacity-0 pointer-events-none"}`,"aria-hidden":!lt,children:[a.jsx(Oh,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),a.jsx("span",{children:lt?`${lt.x}, ${lt.y}`:""}),a.jsx("div",{className:`ml-2 transition-opacity duration-200 ${lt&&se?"opacity-100":"opacity-0 pointer-events-none"}`,children:a.jsx(Q,{content:"Active GID number of selected tilebrush",children:a.jsx(N0,{variant:"secondary",className:"text-xs px-2 py-1 bg-black/80 text-white border-gray-600 hover:bg-black/90",children:a.jsx("span",{id:"activeGid",children:$})})})})]}),a.jsxs("div",{className:`absolute bottom-4 left-32 z-10 p-2 rounded-md text-xs flex items-center gap-3 transition-opacity duration-200 ${_o?"opacity-100 pointer-events-auto bg-orange-600/90 border border-orange-500 text-white":"opacity-0 pointer-events-none"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[a.jsx(Rn,{className:"w-4 h-4 text-orange-200"}),a.jsx("span",{children:_o?`${Lg} tiles selected`:""})]}),a.jsxs("div",{className:`flex items-center gap-1 ${_o?"":"pointer-events-none"}`,children:[a.jsx(Q,{content:"Fill selection with active tile",children:a.jsx(I,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs text-white hover:bg-orange-500/50",onClick:hx,children:"Fill"})}),a.jsx(Q,{content:"Delete selected tiles (DEL)",children:a.jsx(I,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs text-white hover:bg-orange-500/50",onClick:mx,children:"Delete"})}),a.jsx(Q,{content:"Clear selection (ESC)",children:a.jsx(I,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs text-white hover:bg-orange-500/50",onClick:fx,children:"Clear"})})]})]}),a.jsx("div",{ref:mg,className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-30",onMouseEnter:cg,onMouseLeave:ug,onFocus:dg,onBlur:hg,tabIndex:Mn?-1:0,"aria-label":"Tool selection",children:a.jsxs("div",{className:`flex items-center bg-white/90 dark:bg-neutral-900/90 border border-border rounded-full shadow-md transition-all duration-300 ease-in-out ${Mn?"gap-1 px-2 py-1":"gap-0 px-1 py-1"}`,children:[a.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${Mn||je==="brush"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[a.jsx(I,{variant:je==="brush"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>En("brush"),onMouseEnter:d=>{rd(),Be("Brush Tool",d.currentTarget)},onMouseLeave:()=>{sd(),et()},children:zg()}),gg&&a.jsxs("div",{className:"absolute bottom-full left-0 mb-1 bg-white dark:bg-neutral-900 border border-border rounded shadow-lg p-1 flex gap-1 min-w-max z-50",onMouseEnter:rd,onMouseLeave:sd,children:[a.jsx(I,{variant:Pn==="brush"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>is("brush"),onMouseEnter:d=>Be("Brush Tool",d.currentTarget),onMouseLeave:et,children:a.jsx(la,{className:"w-3 h-3"})}),a.jsx(I,{variant:Pn==="bucket"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>is("bucket"),onMouseEnter:d=>Be("Bucket Fill",d.currentTarget),onMouseLeave:et,children:a.jsx(Sl,{className:"w-3 h-3"})}),a.jsx(I,{variant:Pn==="eraser"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>is("eraser"),onMouseEnter:d=>Be("Eraser",d.currentTarget),onMouseLeave:et,children:a.jsx(bl,{className:"w-3 h-3"})}),a.jsx(I,{variant:Pn==="clear"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button border-red-500 hover:border-red-600 hover:bg-red-50",onClick:()=>Li(!0),onMouseEnter:d=>Be("Clear Layer",d.currentTarget),onMouseLeave:et,children:a.jsx(Xe,{className:"w-3 h-3 text-red-500"})})]})]}),a.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${Mn||je==="selection"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[a.jsx(I,{variant:je==="selection"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>En("selection"),onMouseEnter:d=>{id(),Be("Selection Tool",d.currentTarget)},onMouseLeave:()=>{ad(),et()},children:Ag()}),xg&&a.jsxs("div",{className:"absolute bottom-full left-0 mb-1 bg-white dark:bg-neutral-900 border border-border rounded shadow-lg p-1 flex gap-1 min-w-max z-50",onMouseEnter:id,onMouseLeave:ad,children:[a.jsx(I,{variant:Ln==="rectangular"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>Mi("rectangular"),onMouseEnter:d=>Be("Rectangular Selection",d.currentTarget),onMouseLeave:et,children:a.jsx(Rn,{className:"w-3 h-3"})}),a.jsx(I,{variant:Ln==="magic-wand"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>Mi("magic-wand"),onMouseEnter:d=>Be("Magic Wand",d.currentTarget),onMouseLeave:et,children:a.jsx(Nl,{className:"w-3 h-3"})}),a.jsx(I,{variant:Ln==="same-tile"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>Mi("same-tile"),onMouseEnter:d=>Be("Select Same Tile",d.currentTarget),onMouseLeave:et,children:a.jsx(vr,{className:"w-3 h-3"})}),a.jsx(I,{variant:Ln==="circular"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>Mi("circular"),onMouseEnter:d=>Be("Circular Select",d.currentTarget),onMouseLeave:et,children:a.jsx(Is,{className:"w-3 h-3"})})]})]}),a.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${Mn||je==="shape"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[a.jsx(I,{variant:je==="shape"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>En("shape"),onMouseEnter:d=>{od(),Be("Shape Tool",d.currentTarget)},onMouseLeave:()=>{ld(),et()},children:Dg()}),yg&&a.jsxs("div",{className:"absolute bottom-full left-0 mb-1 bg-white dark:bg-neutral-900 border border-border rounded shadow-lg p-1 flex gap-1 min-w-max z-50",onMouseEnter:od,onMouseLeave:ld,children:[a.jsx(Q,{content:"Rectangle Shape",children:a.jsx(I,{variant:or==="rectangle"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>wo("rectangle"),children:a.jsx(Rn,{className:"w-3 h-3"})})}),a.jsx(Q,{content:"Circle Shape",children:a.jsx(I,{variant:or==="circle"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>wo("circle"),children:a.jsx(Is,{className:"w-3 h-3"})})}),a.jsx(Q,{content:"Line Shape",children:a.jsx(I,{variant:or==="line"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>wo("line"),children:a.jsx($h,{className:"w-3 h-3"})})})]})]}),a.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${Mn||je==="stamp"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[a.jsx(I,{variant:je==="stamp"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>En("stamp"),onMouseEnter:d=>Be("Stamp Tool - Group tiles into a stamp and place them together",d.currentTarget),onMouseLeave:et,children:a.jsx(Fw,{className:"w-3 h-3"})}),je==="stamp"&&a.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg p-2 min-w-[200px] z-10",children:a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"flex gap-1",children:[a.jsx(Q,{content:"Select and place existing stamps",children:a.jsx(I,{variant:lr==="select"?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>ls("select"),children:"Select"})}),a.jsx(Q,{content:"Create stamp from selection",children:a.jsx(I,{variant:lr==="create"?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>ls("create"),children:"Create"})})]}),lr==="create"&&a.jsxs("div",{className:"border-t pt-2",children:[a.jsx("div",{className:"text-xs font-medium mb-1",children:"Create New Stamp"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",placeholder:"Stamp name",value:cs,onChange:d=>Ou(d.target.value),className:"flex-1 text-xs px-2 py-1 border rounded",onKeyDown:d=>{d.key==="Enter"&&cd()}}),a.jsx(I,{size:"sm",className:"text-xs",onClick:cd,disabled:!cs.trim(),children:"Create"})]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"First select tiles, then create stamp"})]}),lr==="select"&&a.jsxs("div",{className:"border-t pt-2 max-h-32 overflow-y-auto",children:[a.jsx("div",{className:"text-xs font-medium mb-1",children:"Available Stamps"}),Ru.length===0?a.jsx("div",{className:"text-xs text-gray-500",children:"No stamps created yet"}):a.jsx("div",{className:"flex flex-col gap-1",children:Ru.map(d=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Q,{content:`${d.name} (${d.width}x${d.height})`,children:a.jsx(I,{variant:os===d.id?"default":"ghost",size:"sm",className:"flex-1 text-xs justify-start",onClick:()=>_g(d.id),children:d.name})}),a.jsx(Q,{content:"Delete stamp",children:a.jsx(I,{variant:"ghost",size:"sm",className:"w-6 h-6 p-0 text-red-500",onClick:()=>Ig(d.id),children:a.jsx(Xe,{className:"w-3 h-3"})})})]},d.id))})]})]})})]}),a.jsx("div",{className:`flex-shrink-0 transition-all duration-300 ease-out ${Mn||je==="eyedropper"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:a.jsx(I,{variant:je==="eyedropper"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>En("eyedropper"),onMouseEnter:d=>Be("Eyedropper Tool - Pick a tile from the map to reuse",d.currentTarget),onMouseLeave:et,children:a.jsx(Fh,{className:"w-3 h-3"})})})]})})]})]})]}),a.jsx(J1,{}),a.jsx(wr,{open:vg,onOpenChange:as,children:a.jsxs(br,{children:[a.jsxs(kr,{children:[a.jsx(Sr,{children:"Separate Brush"}),a.jsx(jr,{children:"Are you sure you want to separate this brush?"})]}),a.jsxs(_s,{children:[a.jsx(I,{variant:"outline",onClick:()=>as(!1),children:"Cancel"}),a.jsx(I,{onClick:Rg,children:"Separate"})]})]})}),a.jsx(wr,{open:le!==null,onOpenChange:d=>d?void 0:Fi(),children:a.jsxs(br,{className:"max-w-md",children:[a.jsxs(kr,{children:[a.jsx(Sr,{children:(le==null?void 0:le.type)==="npc"?"Add NPC":"Add Enemy"}),a.jsxs(jr,{children:["Define the placement details for this ",(le==null?void 0:le.type)==="npc"?"NPC":"enemy","."]})]}),le&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),a.jsx(F,{value:le.name,onChange:d=>xr("name",d.target.value),placeholder:le.type==="npc"?"Village Elder":"Goblin Scout"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"X Position"}),a.jsx(F,{type:"number",value:le.x,onChange:d=>xr("x",d.target.value),min:0,max:(n==null?void 0:n.getMapWidth())??void 0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Y Position"}),a.jsx(F,{type:"number",value:le.y,onChange:d=>xr("y",d.target.value),min:0,max:(n==null?void 0:n.getMapHeight())??void 0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tileset Location"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(F,{className:"flex-1",value:le.tilesetPath,onChange:d=>xr("tilesetPath",d.target.value),placeholder:"Desktop/mytilesets/npcs/mynpc.png",readOnly:ar,onClick:ar?()=>{md()}:void 0}),a.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{md()},disabled:!ar,children:"Browse"})]})]}),Zu&&a.jsx("div",{className:"text-sm text-red-500",children:Zu})]}),a.jsxs(_s,{children:[a.jsx(I,{variant:"outline",onClick:Fi,children:"Cancel"}),a.jsx(I,{onClick:Fg,children:(le==null?void 0:le.type)==="npc"?"Add NPC":"Add Enemy"})]})]})}),a.jsx(wr,{open:Eg,onOpenChange:d=>{d?Ii(!0):pd()},children:a.jsxs(br,{className:"max-w-5xl w-full h-[90vh] flex flex-col",children:[a.jsxs(kr,{children:[a.jsx(Sr,{children:K?`Edit ${K.type}`:"Add Object"}),a.jsxs(jr,{children:["Configure ",(K==null?void 0:K.type)||"object"," properties for Flare engine compatibility."]})]}),Qu.length>0&&a.jsxs("div",{className:"mb-3 rounded-md border border-destructive/40 bg-destructive/10 p-3 text-sm text-destructive",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Please fix the following:"}),a.jsx("ul",{className:"ml-4 list-disc space-y-1",children:Qu.map((d,w)=>a.jsx("li",{children:d},`${d}-${w}`))})]}),a.jsx("div",{className:"flex-1 overflow-y-auto pr-2 minimal-scroll",children:K&&a.jsxs("div",{className:"space-y-4 pb-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),a.jsx(F,{value:K.name||"",onChange:d=>Ye({...K,name:d.target.value}),placeholder:"Object name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),a.jsx(F,{value:K.category||"",onChange:d=>Ye({...K,category:d.target.value}),placeholder:K.type==="enemy"?"creature":"block"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"X Position"}),a.jsx(F,{type:"number",value:K.x,onChange:d=>Ye({...K,x:Number(d.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Y Position"}),a.jsx(F,{type:"number",value:K.y,onChange:d=>Ye({...K,y:Number(d.target.value)})})]})]}),(K.type==="npc"||K.type==="enemy")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tileset Location"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(F,{className:"flex-1",value:H("tilesetPath",""),onChange:d=>R("tilesetPath",d.target.value),placeholder:"Desktop/mytilesets/npcs/mynpc.png",readOnly:ar,onClick:ar?()=>{gd()}:void 0}),a.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{gd()},disabled:!ar,children:"Browse"})]})]}),K.type==="enemy"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Level"}),a.jsx(F,{type:"number",value:K.level||1,onChange:d=>Ye({...K,level:Number(d.target.value)}),min:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Number"}),a.jsx(F,{type:"number",value:K.number||1,onChange:d=>Ye({...K,number:Number(d.target.value)}),min:"1"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Wander Radius"}),a.jsx(F,{type:"number",value:K.wander_radius||4,onChange:d=>Ye({...K,wander_radius:Number(d.target.value)}),min:"0"})]}),a.jsxs("div",{className:"space-y-3 border border-border rounded-md p-3 bg-muted/20",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold",children:"Enemy Specifications"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure Flare StatBlock-compatible values."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"XP"}),a.jsx(F,{type:"number",value:H("xp",""),onChange:d=>R("xp",d.target.value),min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"XP Scaling Table"}),a.jsx(F,{value:H("xp_scaling",""),onChange:d=>R("xp_scaling",d.target.value),placeholder:"tables/xp_scaling.txt"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Defeat Status"}),a.jsx(F,{value:H("defeat_status",""),onChange:d=>R("defeat_status",d.target.value),placeholder:"campaign_status_id"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Convert Status"}),a.jsx(F,{value:H("convert_status",""),onChange:d=>R("convert_status",d.target.value),placeholder:"campaign_status_id"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"First Defeat Loot"}),a.jsx(F,{value:H("first_defeat_loot",""),onChange:d=>R("first_defeat_loot",d.target.value),placeholder:"items/id.txt"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Animations Definition"}),a.jsx(F,{value:H("animations",""),onChange:d=>R("animations",d.target.value),placeholder:"animations/enemies/foo.txt"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loot Entries (one per line)"}),a.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("loot",""),onChange:d=>R("loot",d.target.value),placeholder:"item_id, chance"})]}),(()=>{const d=H("loot_count",""),[w="",N=""]=d.split(",").map(T=>T.trim());return a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loot Count Min"}),a.jsx(F,{type:"number",value:w,min:"0",onChange:T=>{const _=T.target.value;_?R("loot_count",N?`${_},${N}`:_):R("loot_count","")}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loot Count Max"}),a.jsx(F,{type:"number",value:N,min:"0",onChange:T=>{const _=T.target.value;w?R("loot_count",_?`${w},${_}`:w):R("loot_count","")}})]})]})})(),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Threat Range (engage, stop)"}),(()=>{const d=H("threat_range",""),[w="",N=""]=d.split(",").map(T=>T.trim());return a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx(F,{type:"number",value:w,onChange:T=>{const _=T.target.value;_?R("threat_range",N?`${_},${N}`:_):R("threat_range",N?`0,${N}`:"")}}),a.jsx(F,{type:"number",value:N,onChange:T=>{const _=T.target.value;w?R("threat_range",_?`${w},${_}`:w):R("threat_range","")}})]})})()]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Flee Range"}),a.jsx(F,{type:"number",value:H("flee_range",""),onChange:d=>R("flee_range",d.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chance Pursue (%)"}),a.jsx(F,{type:"number",value:H("chance_pursue",""),onChange:d=>R("chance_pursue",d.target.value),min:"0",max:"100",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chance Flee (%)"}),a.jsx(F,{type:"number",value:H("chance_flee",""),onChange:d=>R("chance_flee",d.target.value),min:"0",max:"100",step:"0.1"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Waypoint Pause"}),a.jsx(F,{value:H("waypoint_pause",""),onChange:d=>R("waypoint_pause",d.target.value),placeholder:"250ms"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Turn Delay"}),a.jsx(F,{value:H("turn_delay",""),onChange:d=>R("turn_delay",d.target.value),placeholder:"100ms"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Combat Style"}),a.jsxs("select",{className:"w-full rounded-md border border-border bg-background px-2 py-1 text-sm",value:H("combat_style",""),onChange:d=>R("combat_style",d.target.value),children:[a.jsx("option",{value:"",children:"Default"}),a.jsx("option",{value:"default",children:"default"}),a.jsx("option",{value:"aggressive",children:"aggressive"}),a.jsx("option",{value:"passive",children:"passive"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Triggered Powers (state,power,chance per line)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("power",""),onChange:d=>R("power",d.target.value),placeholder:"melee,power/melee_slash,25"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Passive Powers (one power id per line)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("passive_powers",""),onChange:d=>R("passive_powers",d.target.value),placeholder:"power_id"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Quest Loot (one per line: status,not_status,item_id)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("quest_loot",""),onChange:d=>R("quest_loot",d.target.value),placeholder:"status_required,status_block,item_id"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Flee Duration"}),a.jsx(F,{value:H("flee_duration",""),onChange:d=>R("flee_duration",d.target.value),placeholder:"1.5s"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Flee Cooldown"}),a.jsx(F,{value:H("flee_cooldown",""),onChange:d=>R("flee_cooldown",d.target.value),placeholder:"5s"})]})]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{key:"humanoid",label:"Humanoid"},{key:"lifeform",label:"Lifeform"},{key:"flying",label:"Flying"},{key:"intangible",label:"Intangible"},{key:"facing",label:"Facing"},{key:"suppress_hp",label:"Hide HP Bar"}].map(d=>a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:H(d.key,"false")==="true",onChange:w=>Oo(d.key,w.target.checked)}),d.label]},d.key))})]})]}),K.type==="npc"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-3 border border-border rounded-md p-3 bg-muted/20",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold",children:"Dialog"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure dialog tree content and metadata."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Dialog ID"}),a.jsx(F,{value:H("dialog.id",""),onChange:d=>R("dialog.id",d.target.value),placeholder:"villager_intro"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Topic"}),a.jsx(F,{value:H("dialog.topic",""),onChange:d=>R("dialog.topic",d.target.value),placeholder:"Greetings"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Group"}),a.jsx(F,{value:H("dialog.group",""),onChange:d=>R("dialog.group",d.target.value),placeholder:"main_story"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Voice File(s)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.voice",""),onChange:d=>R("dialog.voice",d.target.value),placeholder:"voice/npcs/intro.ogg"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lines (Him)"}),a.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.him",""),onChange:d=>R("dialog.him",d.target.value),placeholder:"Hello there!"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lines (Her)"}),a.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.her",""),onChange:d=>R("dialog.her",d.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lines (You)"}),a.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.you",""),onChange:d=>R("dialog.you",d.target.value),placeholder:"What brings you here?"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait (Him)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.portrait_him",""),onChange:d=>R("dialog.portrait_him",d.target.value),placeholder:"portraits/npcs/villager.png"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait (Her)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.portrait_her",""),onChange:d=>R("dialog.portrait_her",d.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait (You)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.portrait_you",""),onChange:d=>R("dialog.portrait_you",d.target.value)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Response IDs (one per line, must precede dialog text)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.response",""),onChange:d=>R("dialog.response",d.target.value)})]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{key:"dialog.allow_movement",label:"Allow Movement",defaultValue:"false"},{key:"dialog.take_a_party",label:"Take/Release Party",defaultValue:"false"},{key:"dialog.response_only",label:"Response Only",defaultValue:"false"}].map(d=>a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:H(d.key,d.defaultValue||"false")==="true",onChange:w=>Oo(d.key,w.target.checked)}),d.label]},d.key))})]}),a.jsxs("div",{className:"space-y-3 border border-border rounded-md p-3 bg-muted/20",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold",children:"NPC Details"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure appearance, behavior, and requirements."})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"NPC Name"}),a.jsx(F,{value:H("npc.name",K.name||""),onChange:d=>R("npc.name",d.target.value),placeholder:"Villager"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait"}),a.jsx(F,{value:H("npc.portrait",""),onChange:d=>R("npc.portrait",d.target.value),placeholder:"portraits/npcs/villager.png"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Definition File"}),a.jsx(F,{value:H("npc.filename",""),onChange:d=>R("npc.filename",d.target.value),placeholder:"npcs/villager.txt"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Direction"}),a.jsx(F,{value:H("npc.direction",""),onChange:d=>R("npc.direction",d.target.value),placeholder:"south"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Waypoints (x,y per line)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.waypoints",""),onChange:d=>R("npc.waypoints",d.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Wander Radius"}),a.jsx(F,{type:"number",value:H("npc.wander_radius",""),onChange:d=>R("npc.wander_radius",d.target.value),min:"0"})]})]}),a.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{key:"npc.show_on_minimap",label:"Show on Minimap",defaultValue:"true"},{key:"npc.talker",label:"Talkable",defaultValue:"true"},{key:"npc.vendor",label:"Vendor",defaultValue:"false"}].map(d=>a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:H(d.key,d.defaultValue||"false")==="true",onChange:w=>Oo(d.key,w.target.checked)}),d.label]},d.key))}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Status (one per line)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_status",""),onChange:d=>R("npc.requires_status",d.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Not Status"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_not_status",""),onChange:d=>R("npc.requires_not_status",d.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Item (one per line)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_item",""),onChange:d=>R("npc.requires_item",d.target.value),placeholder:"items/potion:2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Not Item"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_not_item",""),onChange:d=>R("npc.requires_not_item",d.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Level ≥"}),a.jsx(F,{type:"number",value:H("npc.requires_level",""),onChange:d=>R("npc.requires_level",d.target.value),min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Level <"}),a.jsx(F,{type:"number",value:H("npc.requires_not_level",""),onChange:d=>R("npc.requires_not_level",d.target.value),min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Class"}),a.jsx(F,{value:H("npc.requires_class",""),onChange:d=>R("npc.requires_class",d.target.value),placeholder:"warrior"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Currency ≥"}),a.jsx(F,{type:"number",value:H("npc.requires_currency",""),onChange:d=>R("npc.requires_currency",d.target.value),min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Currency <"}),a.jsx(F,{type:"number",value:H("npc.requires_not_currency",""),onChange:d=>R("npc.requires_not_currency",d.target.value),min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Not Class"}),a.jsx(F,{value:H("npc.requires_not_class",""),onChange:d=>R("npc.requires_not_class",d.target.value)})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"text-sm font-semibold",children:"Vendor Options"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vendor Requires Status"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.vendor_requires_status",""),onChange:d=>R("npc.vendor_requires_status",d.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vendor Requires Not Status"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.vendor_requires_not_status",""),onChange:d=>R("npc.vendor_requires_not_status",d.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Constant Stock (items per line)"}),a.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.constant_stock",""),onChange:d=>R("npc.constant_stock",d.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status Stock (status: items)"}),a.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.status_stock",""),onChange:d=>R("npc.status_stock",d.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Random Stock (loot definitions)"}),a.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.random_stock",""),onChange:d=>R("npc.random_stock",d.target.value)})]})]}),(()=>{const d=H("npc.random_stock_count",""),[w="",N=""]=d.split(",").map(T=>T.trim());return a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Random Stock Min"}),a.jsx(F,{type:"number",value:w,min:"0",onChange:T=>{const _=T.target.value;_?R("npc.random_stock_count",N?`${_},${N}`:_):R("npc.random_stock_count",N?`0,${N}`:"")}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Random Stock Max"}),a.jsx(F,{type:"number",value:N,min:"0",onChange:T=>{const _=T.target.value;w?R("npc.random_stock_count",_?`${w},${_}`:w):R("npc.random_stock_count","")}})]})]})})(),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Buy Ratio"}),a.jsx(F,{type:"number",value:H("npc.vendor_ratio_buy",""),onChange:d=>R("npc.vendor_ratio_buy",d.target.value),step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sell Ratio"}),a.jsx(F,{type:"number",value:H("npc.vendor_ratio_sell",""),onChange:d=>R("npc.vendor_ratio_sell",d.target.value),step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sell Ratio (Old)"}),a.jsx(F,{type:"number",value:H("npc.vendor_ratio_sell_old",""),onChange:d=>R("npc.vendor_ratio_sell_old",d.target.value),step:"0.01"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vox Intro (one file per line)"}),a.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.vox_intro",""),onChange:d=>R("npc.vox_intro",d.target.value)})]})]})]}),K.type==="event"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Activate"}),a.jsx(F,{value:K.activate||"on_trigger",onChange:d=>Ye({...K,activate:d.target.value}),placeholder:"on_trigger, on_load, etc."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hotspot"}),a.jsx(F,{value:K.hotspot||"0,0,1,1",onChange:d=>Ye({...K,hotspot:d.target.value}),placeholder:"x,y,width,height"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tooltip"}),a.jsx(F,{value:K.tooltip||"",onChange:d=>Ye({...K,tooltip:d.target.value}),placeholder:"Hover text"})]})]})]})}),a.jsxs(_s,{className:"mt-4 flex-shrink-0",children:[a.jsx(I,{variant:"outline",onClick:pd,children:"Cancel"}),a.jsx(I,{onClick:Hg,children:"Save"})]})]})}),a.jsx(wr,{open:f,onOpenChange:d=>{p(d),d||k(null)},children:a.jsxs(br,{className:"max-w-md",children:[a.jsxs(kr,{children:[a.jsx(Sr,{children:"Create Map"}),a.jsx(jr,{children:"Set the name, dimensions, and starting status for your new map."})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Map Name"}),a.jsx(F,{value:x,onChange:d=>{g(d.target.value),y&&k(null)},onKeyDown:d=>{d.stopPropagation()},placeholder:"Enter map name",autoFocus:!0}),y&&a.jsx("p",{className:"mt-1 text-xs text-red-500",children:y})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Width (tiles)"}),a.jsx(F,{type:"number",min:1,max:100,value:b,onChange:d=>v(Math.max(1,Number.parseInt(d.target.value,10)||0))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Height (tiles)"}),a.jsx(F,{type:"number",min:1,max:100,value:S,onChange:d=>j(Math.max(1,Number.parseInt(d.target.value,10)||0))})]})]}),a.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border px-3 py-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{htmlFor:"starting-map-checkbox",className:"text-sm font-medium text-muted-foreground",children:"Starting Map"}),a.jsx(Q,{content:"If this map is the map that players will start the game then mark this option",children:a.jsx(wl,{className:"h-4 w-4 text-muted-foreground","aria-hidden":!0})})]}),a.jsx("input",{id:"starting-map-checkbox",type:"checkbox",className:"h-4 w-4 rounded border border-border accent-orange-500",checked:P,onChange:d=>E(d.target.checked),"aria-checked":P,"aria-label":"Set this map as the starting map"})]})]}),a.jsxs(_s,{children:[a.jsx(I,{variant:"outline",onClick:()=>{p(!1),k(null)},children:"Cancel"}),a.jsx(I,{onClick:ex,disabled:hr,className:"flex items-center gap-2",children:hr?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Creating..."})]}):a.jsx("span",{children:"Create"})})]})]})}),a.jsx(wr,{open:Pg,onOpenChange:zi,children:a.jsxs(br,{className:"max-w-md",children:[a.jsxs(kr,{children:[a.jsx(Sr,{children:"Edit Hero Position"}),a.jsx(jr,{children:"Set the hero spawn position on the map."})]}),Ee&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"X Position"}),a.jsx(F,{type:"number",min:0,max:Ee.mapWidth-1,defaultValue:Ee.currentX,onChange:d=>{const w=parseInt(d.target.value);isNaN(w)||gs({...Ee,currentX:w})}}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(0 - ",Ee.mapWidth-1,")"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Y Position"}),a.jsx(F,{type:"number",min:0,max:Ee.mapHeight-1,defaultValue:Ee.currentY,onChange:d=>{const w=parseInt(d.target.value);isNaN(w)||gs({...Ee,currentY:w})}}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(0 - ",Ee.mapHeight-1,")"]})]})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Current position: (",Ee.currentX,", ",Ee.currentY,")"]})]}),a.jsxs(_s,{children:[a.jsx(I,{variant:"outline",onClick:Yg,children:"Cancel"}),a.jsx(I,{onClick:()=>Ee&&Wg(Ee.currentX,Ee.currentY),children:"Confirm"})]})]})}),a.jsx(nb,{open:tx,onConfirm:rx,onCancel:sx}),Mg&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-black rounded-lg shadow-xl p-6 max-w-md mx-4 relative",children:[a.jsx("button",{onClick:()=>qu(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-200 transition-colors",children:a.jsx(Xe,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center",children:a.jsx(D0,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Export Successful"})]}),a.jsxs("p",{className:"text-gray-300 flex items-center gap-2",children:[a.jsx("span",{className:"inline-flex items-center gap-1 font-medium text-white",children:a.jsx(Na,{className:"w-4 h-4"})}),"Project exported to project folder."]})]})}),fr&&a.jsx("div",{className:`custom-tooltip ${fr.visible?"visible":""} ${fr.fadeOut?"fade-out":""}`,style:{left:fr.x,top:fr.y},children:fr.content})]})})}Pl.createRoot(document.getElementById("root")).render(a.jsx(xe.StrictMode,{children:a.jsx(cb,{})}));
