function qg(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Ah(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Dh={exports:{}},Wo={},Rh={exports:{}},Q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ri=Symbol.for("react.element"),Kg=Symbol.for("react.portal"),Qg=Symbol.for("react.fragment"),Zg=Symbol.for("react.strict_mode"),Jg=Symbol.for("react.profiler"),ex=Symbol.for("react.provider"),tx=Symbol.for("react.context"),nx=Symbol.for("react.forward_ref"),rx=Symbol.for("react.suspense"),sx=Symbol.for("react.memo"),ix=Symbol.for("react.lazy"),ad=Symbol.iterator;function ox(t){return t===null||typeof t!="object"?null:(t=ad&&t[ad]||t["@@iterator"],typeof t=="function"?t:null)}var Oh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$h=Object.assign,Fh={};function Fr(t,e,n){this.props=t,this.context=e,this.refs=Fh,this.updater=n||Oh}Fr.prototype.isReactComponent={};Fr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Fr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Hh(){}Hh.prototype=Fr.prototype;function xc(t,e,n){this.props=t,this.context=e,this.refs=Fh,this.updater=n||Oh}var yc=xc.prototype=new Hh;yc.constructor=xc;$h(yc,Fr.prototype);yc.isPureReactComponent=!0;var cd=Array.isArray,Bh=Object.prototype.hasOwnProperty,vc={current:null},Wh={key:!0,ref:!0,__self:!0,__source:!0};function Yh(t,e,n){var r,s={},i=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(i=""+e.key),e)Bh.call(e,r)&&!Wh.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:ri,type:t,key:i,ref:l,props:s,_owner:vc.current}}function lx(t,e){return{$$typeof:ri,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function wc(t){return typeof t=="object"&&t!==null&&t.$$typeof===ri}function ax(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ud=/\/+/g;function Il(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ax(""+t.key):e.toString(36)}function to(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case ri:case Kg:l=!0}}if(l)return l=t,s=s(l),t=r===""?"."+Il(l,0):r,cd(s)?(n="",t!=null&&(n=t.replace(ud,"$&/")+"/"),to(s,e,n,"",function(u){return u})):s!=null&&(wc(s)&&(s=lx(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(ud,"$&/")+"/")+t)),e.push(s)),1;if(l=0,r=r===""?".":r+":",cd(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+Il(i,a);l+=to(i,e,n,c,s)}else if(c=ox(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+Il(i,a++),l+=to(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function _i(t,e,n){if(t==null)return t;var r=[],s=0;return to(t,r,"","",function(i){return e.call(n,i,s++)}),r}function cx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var We={current:null},no={transition:null},ux={ReactCurrentDispatcher:We,ReactCurrentBatchConfig:no,ReactCurrentOwner:vc};function Uh(){throw Error("act(...) is not supported in production builds of React.")}Q.Children={map:_i,forEach:function(t,e,n){_i(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _i(t,function(){e++}),e},toArray:function(t){return _i(t,function(e){return e})||[]},only:function(t){if(!wc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Q.Component=Fr;Q.Fragment=Qg;Q.Profiler=Jg;Q.PureComponent=xc;Q.StrictMode=Zg;Q.Suspense=rx;Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ux;Q.act=Uh;Q.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=$h({},t.props),s=t.key,i=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,l=vc.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Bh.call(e,c)&&!Wh.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:ri,type:t.type,key:s,ref:i,props:r,_owner:l}};Q.createContext=function(t){return t={$$typeof:tx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ex,_context:t},t.Consumer=t};Q.createElement=Yh;Q.createFactory=function(t){var e=Yh.bind(null,t);return e.type=t,e};Q.createRef=function(){return{current:null}};Q.forwardRef=function(t){return{$$typeof:nx,render:t}};Q.isValidElement=wc;Q.lazy=function(t){return{$$typeof:ix,_payload:{_status:-1,_result:t},_init:cx}};Q.memo=function(t,e){return{$$typeof:sx,type:t,compare:e===void 0?null:e}};Q.startTransition=function(t){var e=no.transition;no.transition={};try{t()}finally{no.transition=e}};Q.unstable_act=Uh;Q.useCallback=function(t,e){return We.current.useCallback(t,e)};Q.useContext=function(t){return We.current.useContext(t)};Q.useDebugValue=function(){};Q.useDeferredValue=function(t){return We.current.useDeferredValue(t)};Q.useEffect=function(t,e){return We.current.useEffect(t,e)};Q.useId=function(){return We.current.useId()};Q.useImperativeHandle=function(t,e,n){return We.current.useImperativeHandle(t,e,n)};Q.useInsertionEffect=function(t,e){return We.current.useInsertionEffect(t,e)};Q.useLayoutEffect=function(t,e){return We.current.useLayoutEffect(t,e)};Q.useMemo=function(t,e){return We.current.useMemo(t,e)};Q.useReducer=function(t,e,n){return We.current.useReducer(t,e,n)};Q.useRef=function(t){return We.current.useRef(t)};Q.useState=function(t){return We.current.useState(t)};Q.useSyncExternalStore=function(t,e,n){return We.current.useSyncExternalStore(t,e,n)};Q.useTransition=function(){return We.current.useTransition()};Q.version="18.3.1";Rh.exports=Q;var m=Rh.exports;const ge=Ah(m),dx=qg({__proto__:null,default:ge},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hx=m,fx=Symbol.for("react.element"),mx=Symbol.for("react.fragment"),px=Object.prototype.hasOwnProperty,gx=hx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xx={key:!0,ref:!0,__self:!0,__source:!0};function Xh(t,e,n){var r,s={},i=null,l=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)px.call(e,r)&&!xx.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:fx,type:t,key:i,ref:l,props:s,_owner:gx.current}}Wo.Fragment=mx;Wo.jsx=Xh;Wo.jsxs=Xh;Dh.exports=Wo;var o=Dh.exports,ga={},Vh={exports:{}},ut={},Gh={exports:{}},qh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_,B){var Y=_.length;_.push(B);e:for(;0<Y;){var J=Y-1>>>1,ne=_[J];if(0<s(ne,B))_[J]=B,_[Y]=ne,Y=J;else break e}}function n(_){return _.length===0?null:_[0]}function r(_){if(_.length===0)return null;var B=_[0],Y=_.pop();if(Y!==B){_[0]=Y;e:for(var J=0,ne=_.length,le=ne>>>1;J<le;){var ht=2*(J+1)-1,Wr=_[ht],Xe=ht+1,Kn=_[Xe];if(0>s(Wr,Y))Xe<ne&&0>s(Kn,Wr)?(_[J]=Kn,_[Xe]=Y,J=Xe):(_[J]=Wr,_[ht]=Y,J=ht);else if(Xe<ne&&0>s(Kn,Y))_[J]=Kn,_[Xe]=Y,J=Xe;else break e}}return B}function s(_,B){var Y=_.sortIndex-B.sortIndex;return Y!==0?Y:_.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,a=l.now();t.unstable_now=function(){return l.now()-a}}var c=[],u=[],h=1,f=null,p=3,w=!1,b=!1,j=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(_){for(var B=n(u);B!==null;){if(B.callback===null)r(u);else if(B.startTime<=_)r(u),B.sortIndex=B.expirationTime,e(c,B);else break;B=n(u)}}function v(_){if(j=!1,x(_),!b)if(n(c)!==null)b=!0,ye(N);else{var B=n(u);B!==null&&Ue(v,B.startTime-_)}}function N(_,B){b=!1,j&&(j=!1,y(E),E=-1),w=!0;var Y=p;try{for(x(B),f=n(c);f!==null&&(!(f.expirationTime>B)||_&&!X());){var J=f.callback;if(typeof J=="function"){f.callback=null,p=f.priorityLevel;var ne=J(f.expirationTime<=B);B=t.unstable_now(),typeof ne=="function"?f.callback=ne:f===n(c)&&r(c),x(B)}else r(c);f=n(c)}if(f!==null)var le=!0;else{var ht=n(u);ht!==null&&Ue(v,ht.startTime-B),le=!1}return le}finally{f=null,p=Y,w=!1}}var T=!1,P=null,E=-1,O=5,A=-1;function X(){return!(t.unstable_now()-A<O)}function V(){if(P!==null){var _=t.unstable_now();A=_;var B=!0;try{B=P(!0,_)}finally{B?te():(T=!1,P=null)}}else T=!1}var te;if(typeof g=="function")te=function(){g(V)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,re=U.port2;U.port1.onmessage=V,te=function(){re.postMessage(null)}}else te=function(){S(V,0)};function ye(_){P=_,T||(T=!0,te())}function Ue(_,B){E=S(function(){_(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){b||w||(b=!0,ye(N))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(_){switch(p){case 1:case 2:case 3:var B=3;break;default:B=p}var Y=p;p=B;try{return _()}finally{p=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,B){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var Y=p;p=_;try{return B()}finally{p=Y}},t.unstable_scheduleCallback=function(_,B,Y){var J=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?J+Y:J):Y=J,_){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=Y+ne,_={id:h++,callback:B,priorityLevel:_,startTime:Y,expirationTime:ne,sortIndex:-1},Y>J?(_.sortIndex=Y,e(u,_),n(c)===null&&_===n(u)&&(j?(y(E),E=-1):j=!0,Ue(v,Y-J))):(_.sortIndex=ne,e(c,_),b||w||(b=!0,ye(N))),_},t.unstable_shouldYield=X,t.unstable_wrapCallback=function(_){var B=p;return function(){var Y=p;p=B;try{return _.apply(this,arguments)}finally{p=Y}}}})(qh);Gh.exports=qh;var yx=Gh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vx=m,ct=yx;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kh=new Set,$s={};function Vn(t,e){zr(t,e),zr(t+"Capture",e)}function zr(t,e){for($s[t]=e,t=0;t<e.length;t++)Kh.add(e[t])}var Vt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xa=Object.prototype.hasOwnProperty,wx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dd={},hd={};function bx(t){return xa.call(hd,t)?!0:xa.call(dd,t)?!1:wx.test(t)?hd[t]=!0:(dd[t]=!0,!1)}function kx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function jx(t,e,n,r){if(e===null||typeof e>"u"||kx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ye(t,e,n,r,s,i,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=l}var ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ze[t]=new Ye(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ze[e]=new Ye(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ze[t]=new Ye(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ze[t]=new Ye(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ze[t]=new Ye(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ze[t]=new Ye(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ze[t]=new Ye(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ze[t]=new Ye(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ze[t]=new Ye(t,5,!1,t.toLowerCase(),null,!1,!1)});var bc=/[\-:]([a-z])/g;function kc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(bc,kc);ze[e]=new Ye(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(bc,kc);ze[e]=new Ye(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(bc,kc);ze[e]=new Ye(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ze[t]=new Ye(t,1,!1,t.toLowerCase(),null,!1,!1)});ze.xlinkHref=new Ye("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ze[t]=new Ye(t,1,!1,t.toLowerCase(),null,!0,!0)});function jc(t,e,n,r){var s=ze.hasOwnProperty(e)?ze[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(jx(e,n,s,r)&&(n=null),r||s===null?bx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Qt=vx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zi=Symbol.for("react.element"),pr=Symbol.for("react.portal"),gr=Symbol.for("react.fragment"),Sc=Symbol.for("react.strict_mode"),ya=Symbol.for("react.profiler"),Qh=Symbol.for("react.provider"),Zh=Symbol.for("react.context"),Nc=Symbol.for("react.forward_ref"),va=Symbol.for("react.suspense"),wa=Symbol.for("react.suspense_list"),Cc=Symbol.for("react.memo"),rn=Symbol.for("react.lazy"),Jh=Symbol.for("react.offscreen"),fd=Symbol.iterator;function as(t){return t===null||typeof t!="object"?null:(t=fd&&t[fd]||t["@@iterator"],typeof t=="function"?t:null)}var pe=Object.assign,Al;function Ns(t){if(Al===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Al=e&&e[1]||""}return`
`+Al+t}var Dl=!1;function Rl(t,e){if(!t||Dl)return"";Dl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),l=s.length-1,a=i.length-1;1<=l&&0<=a&&s[l]!==i[a];)a--;for(;1<=l&&0<=a;l--,a--)if(s[l]!==i[a]){if(l!==1||a!==1)do if(l--,a--,0>a||s[l]!==i[a]){var c=`
`+s[l].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=l&&0<=a);break}}}finally{Dl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ns(t):""}function Sx(t){switch(t.tag){case 5:return Ns(t.type);case 16:return Ns("Lazy");case 13:return Ns("Suspense");case 19:return Ns("SuspenseList");case 0:case 2:case 15:return t=Rl(t.type,!1),t;case 11:return t=Rl(t.type.render,!1),t;case 1:return t=Rl(t.type,!0),t;default:return""}}function ba(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case gr:return"Fragment";case pr:return"Portal";case ya:return"Profiler";case Sc:return"StrictMode";case va:return"Suspense";case wa:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Zh:return(t.displayName||"Context")+".Consumer";case Qh:return(t._context.displayName||"Context")+".Provider";case Nc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Cc:return e=t.displayName||null,e!==null?e:ba(t.type)||"Memo";case rn:e=t._payload,t=t._init;try{return ba(t(e))}catch{}}return null}function Nx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ba(e);case 8:return e===Sc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ef(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Cx(t){var e=ef(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ii(t){t._valueTracker||(t._valueTracker=Cx(t))}function tf(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ef(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function yo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ka(t,e){var n=e.checked;return pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function md(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=yn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function nf(t,e){e=e.checked,e!=null&&jc(t,"checked",e,!1)}function ja(t,e){nf(t,e);var n=yn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Sa(t,e.type,n):e.hasOwnProperty("defaultValue")&&Sa(t,e.type,yn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pd(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Sa(t,e,n){(e!=="number"||yo(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Cs=Array.isArray;function Tr(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yn(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Na(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function gd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(Cs(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:yn(n)}}function rf(t,e){var n=yn(e.value),r=yn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function xd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function sf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ca(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?sf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ai,of=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ai=Ai||document.createElement("div"),Ai.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ai.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fs(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tx=["Webkit","ms","Moz","O"];Object.keys(Es).forEach(function(t){Tx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Es[e]=Es[t]})});function lf(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Es.hasOwnProperty(t)&&Es[t]?(""+e).trim():e+"px"}function af(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=lf(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Mx=pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ta(t,e){if(e){if(Mx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Ma(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ea=null;function Tc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Pa=null,Mr=null,Er=null;function yd(t){if(t=oi(t)){if(typeof Pa!="function")throw Error(L(280));var e=t.stateNode;e&&(e=Go(e),Pa(t.stateNode,t.type,e))}}function cf(t){Mr?Er?Er.push(t):Er=[t]:Mr=t}function uf(){if(Mr){var t=Mr,e=Er;if(Er=Mr=null,yd(t),e)for(t=0;t<e.length;t++)yd(e[t])}}function df(t,e){return t(e)}function hf(){}var Ol=!1;function ff(t,e,n){if(Ol)return t(e,n);Ol=!0;try{return df(t,e,n)}finally{Ol=!1,(Mr!==null||Er!==null)&&(hf(),uf())}}function Hs(t,e){var n=t.stateNode;if(n===null)return null;var r=Go(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var La=!1;if(Vt)try{var cs={};Object.defineProperty(cs,"passive",{get:function(){La=!0}}),window.addEventListener("test",cs,cs),window.removeEventListener("test",cs,cs)}catch{La=!1}function Ex(t,e,n,r,s,i,l,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var Ps=!1,vo=null,wo=!1,_a=null,Px={onError:function(t){Ps=!0,vo=t}};function Lx(t,e,n,r,s,i,l,a,c){Ps=!1,vo=null,Ex.apply(Px,arguments)}function _x(t,e,n,r,s,i,l,a,c){if(Lx.apply(this,arguments),Ps){if(Ps){var u=vo;Ps=!1,vo=null}else throw Error(L(198));wo||(wo=!0,_a=u)}}function Gn(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function mf(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vd(t){if(Gn(t)!==t)throw Error(L(188))}function zx(t){var e=t.alternate;if(!e){if(e=Gn(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return vd(s),t;if(i===r)return vd(s),e;i=i.sibling}throw Error(L(188))}if(n.return!==r.return)n=s,r=i;else{for(var l=!1,a=s.child;a;){if(a===n){l=!0,n=s,r=i;break}if(a===r){l=!0,r=s,n=i;break}a=a.sibling}if(!l){for(a=i.child;a;){if(a===n){l=!0,n=i,r=s;break}if(a===r){l=!0,r=i,n=s;break}a=a.sibling}if(!l)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function pf(t){return t=zx(t),t!==null?gf(t):null}function gf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=gf(t);if(e!==null)return e;t=t.sibling}return null}var xf=ct.unstable_scheduleCallback,wd=ct.unstable_cancelCallback,Ix=ct.unstable_shouldYield,Ax=ct.unstable_requestPaint,we=ct.unstable_now,Dx=ct.unstable_getCurrentPriorityLevel,Mc=ct.unstable_ImmediatePriority,yf=ct.unstable_UserBlockingPriority,bo=ct.unstable_NormalPriority,Rx=ct.unstable_LowPriority,vf=ct.unstable_IdlePriority,Yo=null,zt=null;function Ox(t){if(zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(Yo,t,void 0,(t.current.flags&128)===128)}catch{}}var St=Math.clz32?Math.clz32:Hx,$x=Math.log,Fx=Math.LN2;function Hx(t){return t>>>=0,t===0?32:31-($x(t)/Fx|0)|0}var Di=64,Ri=4194304;function Ts(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ko(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,l=n&268435455;if(l!==0){var a=l&~s;a!==0?r=Ts(a):(i&=l,i!==0&&(r=Ts(i)))}else l=n&~s,l!==0?r=Ts(l):i!==0&&(r=Ts(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-St(e),s=1<<n,r|=t[n],e&=~s;return r}function Bx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var l=31-St(i),a=1<<l,c=s[l];c===-1?(!(a&n)||a&r)&&(s[l]=Bx(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function za(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wf(){var t=Di;return Di<<=1,!(Di&4194240)&&(Di=64),t}function $l(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function si(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-St(e),t[e]=n}function Yx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-St(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Ec(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-St(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var oe=0;function bf(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kf,Pc,jf,Sf,Nf,Ia=!1,Oi=[],un=null,dn=null,hn=null,Bs=new Map,Ws=new Map,on=[],Ux="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bd(t,e){switch(t){case"focusin":case"focusout":un=null;break;case"dragenter":case"dragleave":dn=null;break;case"mouseover":case"mouseout":hn=null;break;case"pointerover":case"pointerout":Bs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ws.delete(e.pointerId)}}function us(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=oi(e),e!==null&&Pc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Xx(t,e,n,r,s){switch(e){case"focusin":return un=us(un,t,e,n,r,s),!0;case"dragenter":return dn=us(dn,t,e,n,r,s),!0;case"mouseover":return hn=us(hn,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Bs.set(i,us(Bs.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ws.set(i,us(Ws.get(i)||null,t,e,n,r,s)),!0}return!1}function Cf(t){var e=zn(t.target);if(e!==null){var n=Gn(e);if(n!==null){if(e=n.tag,e===13){if(e=mf(n),e!==null){t.blockedOn=e,Nf(t.priority,function(){jf(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ro(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Aa(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ea=r,n.target.dispatchEvent(r),Ea=null}else return e=oi(n),e!==null&&Pc(e),t.blockedOn=n,!1;e.shift()}return!0}function kd(t,e,n){ro(t)&&n.delete(e)}function Vx(){Ia=!1,un!==null&&ro(un)&&(un=null),dn!==null&&ro(dn)&&(dn=null),hn!==null&&ro(hn)&&(hn=null),Bs.forEach(kd),Ws.forEach(kd)}function ds(t,e){t.blockedOn===e&&(t.blockedOn=null,Ia||(Ia=!0,ct.unstable_scheduleCallback(ct.unstable_NormalPriority,Vx)))}function Ys(t){function e(s){return ds(s,t)}if(0<Oi.length){ds(Oi[0],t);for(var n=1;n<Oi.length;n++){var r=Oi[n];r.blockedOn===t&&(r.blockedOn=null)}}for(un!==null&&ds(un,t),dn!==null&&ds(dn,t),hn!==null&&ds(hn,t),Bs.forEach(e),Ws.forEach(e),n=0;n<on.length;n++)r=on[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<on.length&&(n=on[0],n.blockedOn===null);)Cf(n),n.blockedOn===null&&on.shift()}var Pr=Qt.ReactCurrentBatchConfig,jo=!0;function Gx(t,e,n,r){var s=oe,i=Pr.transition;Pr.transition=null;try{oe=1,Lc(t,e,n,r)}finally{oe=s,Pr.transition=i}}function qx(t,e,n,r){var s=oe,i=Pr.transition;Pr.transition=null;try{oe=4,Lc(t,e,n,r)}finally{oe=s,Pr.transition=i}}function Lc(t,e,n,r){if(jo){var s=Aa(t,e,n,r);if(s===null)ql(t,e,r,So,n),bd(t,r);else if(Xx(s,t,e,n,r))r.stopPropagation();else if(bd(t,r),e&4&&-1<Ux.indexOf(t)){for(;s!==null;){var i=oi(s);if(i!==null&&kf(i),i=Aa(t,e,n,r),i===null&&ql(t,e,r,So,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ql(t,e,r,null,n)}}var So=null;function Aa(t,e,n,r){if(So=null,t=Tc(r),t=zn(t),t!==null)if(e=Gn(t),e===null)t=null;else if(n=e.tag,n===13){if(t=mf(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return So=t,null}function Tf(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Dx()){case Mc:return 1;case yf:return 4;case bo:case Rx:return 16;case vf:return 536870912;default:return 16}default:return 16}}var an=null,_c=null,so=null;function Mf(){if(so)return so;var t,e=_c,n=e.length,r,s="value"in an?an.value:an.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===s[i-r];r++);return so=s.slice(t,1<r?1-r:void 0)}function io(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $i(){return!0}function jd(){return!1}function dt(t){function e(n,r,s,i,l){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$i:jd,this.isPropagationStopped=jd,this}return pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$i)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$i)},persist:function(){},isPersistent:$i}),e}var Hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zc=dt(Hr),ii=pe({},Hr,{view:0,detail:0}),Kx=dt(ii),Fl,Hl,hs,Uo=pe({},ii,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ic,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hs&&(hs&&t.type==="mousemove"?(Fl=t.screenX-hs.screenX,Hl=t.screenY-hs.screenY):Hl=Fl=0,hs=t),Fl)},movementY:function(t){return"movementY"in t?t.movementY:Hl}}),Sd=dt(Uo),Qx=pe({},Uo,{dataTransfer:0}),Zx=dt(Qx),Jx=pe({},ii,{relatedTarget:0}),Bl=dt(Jx),ey=pe({},Hr,{animationName:0,elapsedTime:0,pseudoElement:0}),ty=dt(ey),ny=pe({},Hr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ry=dt(ny),sy=pe({},Hr,{data:0}),Nd=dt(sy),iy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ly={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ay(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ly[t])?!!e[t]:!1}function Ic(){return ay}var cy=pe({},ii,{key:function(t){if(t.key){var e=iy[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=io(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?oy[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ic,charCode:function(t){return t.type==="keypress"?io(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?io(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uy=dt(cy),dy=pe({},Uo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cd=dt(dy),hy=pe({},ii,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ic}),fy=dt(hy),my=pe({},Hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),py=dt(my),gy=pe({},Uo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xy=dt(gy),yy=[9,13,27,32],Ac=Vt&&"CompositionEvent"in window,Ls=null;Vt&&"documentMode"in document&&(Ls=document.documentMode);var vy=Vt&&"TextEvent"in window&&!Ls,Ef=Vt&&(!Ac||Ls&&8<Ls&&11>=Ls),Td=" ",Md=!1;function Pf(t,e){switch(t){case"keyup":return yy.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lf(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xr=!1;function wy(t,e){switch(t){case"compositionend":return Lf(e);case"keypress":return e.which!==32?null:(Md=!0,Td);case"textInput":return t=e.data,t===Td&&Md?null:t;default:return null}}function by(t,e){if(xr)return t==="compositionend"||!Ac&&Pf(t,e)?(t=Mf(),so=_c=an=null,xr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ef&&e.locale!=="ko"?null:e.data;default:return null}}var ky={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ed(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ky[t.type]:e==="textarea"}function _f(t,e,n,r){cf(r),e=No(e,"onChange"),0<e.length&&(n=new zc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var _s=null,Us=null;function jy(t){Wf(t,0)}function Xo(t){var e=wr(t);if(tf(e))return t}function Sy(t,e){if(t==="change")return e}var zf=!1;if(Vt){var Wl;if(Vt){var Yl="oninput"in document;if(!Yl){var Pd=document.createElement("div");Pd.setAttribute("oninput","return;"),Yl=typeof Pd.oninput=="function"}Wl=Yl}else Wl=!1;zf=Wl&&(!document.documentMode||9<document.documentMode)}function Ld(){_s&&(_s.detachEvent("onpropertychange",If),Us=_s=null)}function If(t){if(t.propertyName==="value"&&Xo(Us)){var e=[];_f(e,Us,t,Tc(t)),ff(jy,e)}}function Ny(t,e,n){t==="focusin"?(Ld(),_s=e,Us=n,_s.attachEvent("onpropertychange",If)):t==="focusout"&&Ld()}function Cy(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xo(Us)}function Ty(t,e){if(t==="click")return Xo(e)}function My(t,e){if(t==="input"||t==="change")return Xo(e)}function Ey(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ct=typeof Object.is=="function"?Object.is:Ey;function Xs(t,e){if(Ct(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!xa.call(e,s)||!Ct(t[s],e[s]))return!1}return!0}function _d(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zd(t,e){var n=_d(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_d(n)}}function Af(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Af(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Df(){for(var t=window,e=yo();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=yo(t.document)}return e}function Dc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Py(t){var e=Df(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Af(n.ownerDocument.documentElement,n)){if(r!==null&&Dc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=zd(n,i);var l=zd(n,r);s&&l&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ly=Vt&&"documentMode"in document&&11>=document.documentMode,yr=null,Da=null,zs=null,Ra=!1;function Id(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ra||yr==null||yr!==yo(r)||(r=yr,"selectionStart"in r&&Dc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zs&&Xs(zs,r)||(zs=r,r=No(Da,"onSelect"),0<r.length&&(e=new zc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=yr)))}function Fi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var vr={animationend:Fi("Animation","AnimationEnd"),animationiteration:Fi("Animation","AnimationIteration"),animationstart:Fi("Animation","AnimationStart"),transitionend:Fi("Transition","TransitionEnd")},Ul={},Rf={};Vt&&(Rf=document.createElement("div").style,"AnimationEvent"in window||(delete vr.animationend.animation,delete vr.animationiteration.animation,delete vr.animationstart.animation),"TransitionEvent"in window||delete vr.transitionend.transition);function Vo(t){if(Ul[t])return Ul[t];if(!vr[t])return t;var e=vr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Rf)return Ul[t]=e[n];return t}var Of=Vo("animationend"),$f=Vo("animationiteration"),Ff=Vo("animationstart"),Hf=Vo("transitionend"),Bf=new Map,Ad="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wn(t,e){Bf.set(t,e),Vn(e,[t])}for(var Xl=0;Xl<Ad.length;Xl++){var Vl=Ad[Xl],_y=Vl.toLowerCase(),zy=Vl[0].toUpperCase()+Vl.slice(1);wn(_y,"on"+zy)}wn(Of,"onAnimationEnd");wn($f,"onAnimationIteration");wn(Ff,"onAnimationStart");wn("dblclick","onDoubleClick");wn("focusin","onFocus");wn("focusout","onBlur");wn(Hf,"onTransitionEnd");zr("onMouseEnter",["mouseout","mouseover"]);zr("onMouseLeave",["mouseout","mouseover"]);zr("onPointerEnter",["pointerout","pointerover"]);zr("onPointerLeave",["pointerout","pointerover"]);Vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Iy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ms));function Dd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,_x(r,e,void 0,t),t.currentTarget=null}function Wf(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var l=r.length-1;0<=l;l--){var a=r[l],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;Dd(s,a,u),i=c}else for(l=0;l<r.length;l++){if(a=r[l],c=a.instance,u=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;Dd(s,a,u),i=c}}}if(wo)throw t=_a,wo=!1,_a=null,t}function ue(t,e){var n=e[Ba];n===void 0&&(n=e[Ba]=new Set);var r=t+"__bubble";n.has(r)||(Yf(e,t,2,!1),n.add(r))}function Gl(t,e,n){var r=0;e&&(r|=4),Yf(n,t,r,e)}var Hi="_reactListening"+Math.random().toString(36).slice(2);function Vs(t){if(!t[Hi]){t[Hi]=!0,Kh.forEach(function(n){n!=="selectionchange"&&(Iy.has(n)||Gl(n,!1,t),Gl(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hi]||(e[Hi]=!0,Gl("selectionchange",!1,e))}}function Yf(t,e,n,r){switch(Tf(e)){case 1:var s=Gx;break;case 4:s=qx;break;default:s=Lc}n=s.bind(null,e,n,t),s=void 0,!La||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ql(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;l=l.return}for(;a!==null;){if(l=zn(a),l===null)return;if(c=l.tag,c===5||c===6){r=i=l;continue e}a=a.parentNode}}r=r.return}ff(function(){var u=i,h=Tc(n),f=[];e:{var p=Bf.get(t);if(p!==void 0){var w=zc,b=t;switch(t){case"keypress":if(io(n)===0)break e;case"keydown":case"keyup":w=uy;break;case"focusin":b="focus",w=Bl;break;case"focusout":b="blur",w=Bl;break;case"beforeblur":case"afterblur":w=Bl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Sd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Zx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=fy;break;case Of:case $f:case Ff:w=ty;break;case Hf:w=py;break;case"scroll":w=Kx;break;case"wheel":w=xy;break;case"copy":case"cut":case"paste":w=ry;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Cd}var j=(e&4)!==0,S=!j&&t==="scroll",y=j?p!==null?p+"Capture":null:p;j=[];for(var g=u,x;g!==null;){x=g;var v=x.stateNode;if(x.tag===5&&v!==null&&(x=v,y!==null&&(v=Hs(g,y),v!=null&&j.push(Gs(g,v,x)))),S)break;g=g.return}0<j.length&&(p=new w(p,b,null,n,h),f.push({event:p,listeners:j}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",p&&n!==Ea&&(b=n.relatedTarget||n.fromElement)&&(zn(b)||b[Gt]))break e;if((w||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,w?(b=n.relatedTarget||n.toElement,w=u,b=b?zn(b):null,b!==null&&(S=Gn(b),b!==S||b.tag!==5&&b.tag!==6)&&(b=null)):(w=null,b=u),w!==b)){if(j=Sd,v="onMouseLeave",y="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(j=Cd,v="onPointerLeave",y="onPointerEnter",g="pointer"),S=w==null?p:wr(w),x=b==null?p:wr(b),p=new j(v,g+"leave",w,n,h),p.target=S,p.relatedTarget=x,v=null,zn(h)===u&&(j=new j(y,g+"enter",b,n,h),j.target=x,j.relatedTarget=S,v=j),S=v,w&&b)t:{for(j=w,y=b,g=0,x=j;x;x=fr(x))g++;for(x=0,v=y;v;v=fr(v))x++;for(;0<g-x;)j=fr(j),g--;for(;0<x-g;)y=fr(y),x--;for(;g--;){if(j===y||y!==null&&j===y.alternate)break t;j=fr(j),y=fr(y)}j=null}else j=null;w!==null&&Rd(f,p,w,j,!1),b!==null&&S!==null&&Rd(f,S,b,j,!0)}}e:{if(p=u?wr(u):window,w=p.nodeName&&p.nodeName.toLowerCase(),w==="select"||w==="input"&&p.type==="file")var N=Sy;else if(Ed(p))if(zf)N=My;else{N=Cy;var T=Ny}else(w=p.nodeName)&&w.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=Ty);if(N&&(N=N(t,u))){_f(f,N,n,h);break e}T&&T(t,p,u),t==="focusout"&&(T=p._wrapperState)&&T.controlled&&p.type==="number"&&Sa(p,"number",p.value)}switch(T=u?wr(u):window,t){case"focusin":(Ed(T)||T.contentEditable==="true")&&(yr=T,Da=u,zs=null);break;case"focusout":zs=Da=yr=null;break;case"mousedown":Ra=!0;break;case"contextmenu":case"mouseup":case"dragend":Ra=!1,Id(f,n,h);break;case"selectionchange":if(Ly)break;case"keydown":case"keyup":Id(f,n,h)}var P;if(Ac)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else xr?Pf(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Ef&&n.locale!=="ko"&&(xr||E!=="onCompositionStart"?E==="onCompositionEnd"&&xr&&(P=Mf()):(an=h,_c="value"in an?an.value:an.textContent,xr=!0)),T=No(u,E),0<T.length&&(E=new Nd(E,t,null,n,h),f.push({event:E,listeners:T}),P?E.data=P:(P=Lf(n),P!==null&&(E.data=P)))),(P=vy?wy(t,n):by(t,n))&&(u=No(u,"onBeforeInput"),0<u.length&&(h=new Nd("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=P))}Wf(f,e)})}function Gs(t,e,n){return{instance:t,listener:e,currentTarget:n}}function No(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Hs(t,n),i!=null&&r.unshift(Gs(t,i,s)),i=Hs(t,e),i!=null&&r.push(Gs(t,i,s))),t=t.return}return r}function fr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Rd(t,e,n,r,s){for(var i=e._reactName,l=[];n!==null&&n!==r;){var a=n,c=a.alternate,u=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&u!==null&&(a=u,s?(c=Hs(n,i),c!=null&&l.unshift(Gs(n,c,a))):s||(c=Hs(n,i),c!=null&&l.push(Gs(n,c,a)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var Ay=/\r\n?/g,Dy=/\u0000|\uFFFD/g;function Od(t){return(typeof t=="string"?t:""+t).replace(Ay,`
`).replace(Dy,"")}function Bi(t,e,n){if(e=Od(e),Od(t)!==e&&n)throw Error(L(425))}function Co(){}var Oa=null,$a=null;function Fa(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ha=typeof setTimeout=="function"?setTimeout:void 0,Ry=typeof clearTimeout=="function"?clearTimeout:void 0,$d=typeof Promise=="function"?Promise:void 0,Oy=typeof queueMicrotask=="function"?queueMicrotask:typeof $d<"u"?function(t){return $d.resolve(null).then(t).catch($y)}:Ha;function $y(t){setTimeout(function(){throw t})}function Kl(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ys(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ys(e)}function fn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Br=Math.random().toString(36).slice(2),_t="__reactFiber$"+Br,qs="__reactProps$"+Br,Gt="__reactContainer$"+Br,Ba="__reactEvents$"+Br,Fy="__reactListeners$"+Br,Hy="__reactHandles$"+Br;function zn(t){var e=t[_t];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Gt]||n[_t]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Fd(t);t!==null;){if(n=t[_t])return n;t=Fd(t)}return e}t=n,n=t.parentNode}return null}function oi(t){return t=t[_t]||t[Gt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function Go(t){return t[qs]||null}var Wa=[],br=-1;function bn(t){return{current:t}}function de(t){0>br||(t.current=Wa[br],Wa[br]=null,br--)}function ae(t,e){br++,Wa[br]=t.current,t.current=e}var vn={},Re=bn(vn),Ze=bn(!1),$n=vn;function Ir(t,e){var n=t.type.contextTypes;if(!n)return vn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Je(t){return t=t.childContextTypes,t!=null}function To(){de(Ze),de(Re)}function Hd(t,e,n){if(Re.current!==vn)throw Error(L(168));ae(Re,e),ae(Ze,n)}function Uf(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(L(108,Nx(t)||"Unknown",s));return pe({},n,r)}function Mo(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||vn,$n=Re.current,ae(Re,t),ae(Ze,Ze.current),!0}function Bd(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=Uf(t,e,$n),r.__reactInternalMemoizedMergedChildContext=t,de(Ze),de(Re),ae(Re,t)):de(Ze),ae(Ze,n)}var Wt=null,qo=!1,Ql=!1;function Xf(t){Wt===null?Wt=[t]:Wt.push(t)}function By(t){qo=!0,Xf(t)}function kn(){if(!Ql&&Wt!==null){Ql=!0;var t=0,e=oe;try{var n=Wt;for(oe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Wt=null,qo=!1}catch(s){throw Wt!==null&&(Wt=Wt.slice(t+1)),xf(Mc,kn),s}finally{oe=e,Ql=!1}}return null}var kr=[],jr=0,Eo=null,Po=0,ft=[],mt=0,Fn=null,Yt=1,Ut="";function Pn(t,e){kr[jr++]=Po,kr[jr++]=Eo,Eo=t,Po=e}function Vf(t,e,n){ft[mt++]=Yt,ft[mt++]=Ut,ft[mt++]=Fn,Fn=t;var r=Yt;t=Ut;var s=32-St(r)-1;r&=~(1<<s),n+=1;var i=32-St(e)+s;if(30<i){var l=s-s%5;i=(r&(1<<l)-1).toString(32),r>>=l,s-=l,Yt=1<<32-St(e)+s|n<<s|r,Ut=i+t}else Yt=1<<i|n<<s|r,Ut=t}function Rc(t){t.return!==null&&(Pn(t,1),Vf(t,1,0))}function Oc(t){for(;t===Eo;)Eo=kr[--jr],kr[jr]=null,Po=kr[--jr],kr[jr]=null;for(;t===Fn;)Fn=ft[--mt],ft[mt]=null,Ut=ft[--mt],ft[mt]=null,Yt=ft[--mt],ft[mt]=null}var at=null,lt=null,he=!1,jt=null;function Gf(t,e){var n=pt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Wd(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,at=t,lt=fn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,at=t,lt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Fn!==null?{id:Yt,overflow:Ut}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,at=t,lt=null,!0):!1;default:return!1}}function Ya(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ua(t){if(he){var e=lt;if(e){var n=e;if(!Wd(t,e)){if(Ya(t))throw Error(L(418));e=fn(n.nextSibling);var r=at;e&&Wd(t,e)?Gf(r,n):(t.flags=t.flags&-4097|2,he=!1,at=t)}}else{if(Ya(t))throw Error(L(418));t.flags=t.flags&-4097|2,he=!1,at=t}}}function Yd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;at=t}function Wi(t){if(t!==at)return!1;if(!he)return Yd(t),he=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Fa(t.type,t.memoizedProps)),e&&(e=lt)){if(Ya(t))throw qf(),Error(L(418));for(;e;)Gf(t,e),e=fn(e.nextSibling)}if(Yd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){lt=fn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}lt=null}}else lt=at?fn(t.stateNode.nextSibling):null;return!0}function qf(){for(var t=lt;t;)t=fn(t.nextSibling)}function Ar(){lt=at=null,he=!1}function $c(t){jt===null?jt=[t]:jt.push(t)}var Wy=Qt.ReactCurrentBatchConfig;function fs(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(l){var a=s.refs;l===null?delete a[i]:a[i]=l},e._stringRef=i,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function Yi(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ud(t){var e=t._init;return e(t._payload)}function Kf(t){function e(y,g){if(t){var x=y.deletions;x===null?(y.deletions=[g],y.flags|=16):x.push(g)}}function n(y,g){if(!t)return null;for(;g!==null;)e(y,g),g=g.sibling;return null}function r(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function s(y,g){return y=xn(y,g),y.index=0,y.sibling=null,y}function i(y,g,x){return y.index=x,t?(x=y.alternate,x!==null?(x=x.index,x<g?(y.flags|=2,g):x):(y.flags|=2,g)):(y.flags|=1048576,g)}function l(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,g,x,v){return g===null||g.tag!==6?(g=sa(x,y.mode,v),g.return=y,g):(g=s(g,x),g.return=y,g)}function c(y,g,x,v){var N=x.type;return N===gr?h(y,g,x.props.children,v,x.key):g!==null&&(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===rn&&Ud(N)===g.type)?(v=s(g,x.props),v.ref=fs(y,g,x),v.return=y,v):(v=fo(x.type,x.key,x.props,null,y.mode,v),v.ref=fs(y,g,x),v.return=y,v)}function u(y,g,x,v){return g===null||g.tag!==4||g.stateNode.containerInfo!==x.containerInfo||g.stateNode.implementation!==x.implementation?(g=ia(x,y.mode,v),g.return=y,g):(g=s(g,x.children||[]),g.return=y,g)}function h(y,g,x,v,N){return g===null||g.tag!==7?(g=On(x,y.mode,v,N),g.return=y,g):(g=s(g,x),g.return=y,g)}function f(y,g,x){if(typeof g=="string"&&g!==""||typeof g=="number")return g=sa(""+g,y.mode,x),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case zi:return x=fo(g.type,g.key,g.props,null,y.mode,x),x.ref=fs(y,null,g),x.return=y,x;case pr:return g=ia(g,y.mode,x),g.return=y,g;case rn:var v=g._init;return f(y,v(g._payload),x)}if(Cs(g)||as(g))return g=On(g,y.mode,x,null),g.return=y,g;Yi(y,g)}return null}function p(y,g,x,v){var N=g!==null?g.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return N!==null?null:a(y,g,""+x,v);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case zi:return x.key===N?c(y,g,x,v):null;case pr:return x.key===N?u(y,g,x,v):null;case rn:return N=x._init,p(y,g,N(x._payload),v)}if(Cs(x)||as(x))return N!==null?null:h(y,g,x,v,null);Yi(y,x)}return null}function w(y,g,x,v,N){if(typeof v=="string"&&v!==""||typeof v=="number")return y=y.get(x)||null,a(g,y,""+v,N);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case zi:return y=y.get(v.key===null?x:v.key)||null,c(g,y,v,N);case pr:return y=y.get(v.key===null?x:v.key)||null,u(g,y,v,N);case rn:var T=v._init;return w(y,g,x,T(v._payload),N)}if(Cs(v)||as(v))return y=y.get(x)||null,h(g,y,v,N,null);Yi(g,v)}return null}function b(y,g,x,v){for(var N=null,T=null,P=g,E=g=0,O=null;P!==null&&E<x.length;E++){P.index>E?(O=P,P=null):O=P.sibling;var A=p(y,P,x[E],v);if(A===null){P===null&&(P=O);break}t&&P&&A.alternate===null&&e(y,P),g=i(A,g,E),T===null?N=A:T.sibling=A,T=A,P=O}if(E===x.length)return n(y,P),he&&Pn(y,E),N;if(P===null){for(;E<x.length;E++)P=f(y,x[E],v),P!==null&&(g=i(P,g,E),T===null?N=P:T.sibling=P,T=P);return he&&Pn(y,E),N}for(P=r(y,P);E<x.length;E++)O=w(P,y,E,x[E],v),O!==null&&(t&&O.alternate!==null&&P.delete(O.key===null?E:O.key),g=i(O,g,E),T===null?N=O:T.sibling=O,T=O);return t&&P.forEach(function(X){return e(y,X)}),he&&Pn(y,E),N}function j(y,g,x,v){var N=as(x);if(typeof N!="function")throw Error(L(150));if(x=N.call(x),x==null)throw Error(L(151));for(var T=N=null,P=g,E=g=0,O=null,A=x.next();P!==null&&!A.done;E++,A=x.next()){P.index>E?(O=P,P=null):O=P.sibling;var X=p(y,P,A.value,v);if(X===null){P===null&&(P=O);break}t&&P&&X.alternate===null&&e(y,P),g=i(X,g,E),T===null?N=X:T.sibling=X,T=X,P=O}if(A.done)return n(y,P),he&&Pn(y,E),N;if(P===null){for(;!A.done;E++,A=x.next())A=f(y,A.value,v),A!==null&&(g=i(A,g,E),T===null?N=A:T.sibling=A,T=A);return he&&Pn(y,E),N}for(P=r(y,P);!A.done;E++,A=x.next())A=w(P,y,E,A.value,v),A!==null&&(t&&A.alternate!==null&&P.delete(A.key===null?E:A.key),g=i(A,g,E),T===null?N=A:T.sibling=A,T=A);return t&&P.forEach(function(V){return e(y,V)}),he&&Pn(y,E),N}function S(y,g,x,v){if(typeof x=="object"&&x!==null&&x.type===gr&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case zi:e:{for(var N=x.key,T=g;T!==null;){if(T.key===N){if(N=x.type,N===gr){if(T.tag===7){n(y,T.sibling),g=s(T,x.props.children),g.return=y,y=g;break e}}else if(T.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===rn&&Ud(N)===T.type){n(y,T.sibling),g=s(T,x.props),g.ref=fs(y,T,x),g.return=y,y=g;break e}n(y,T);break}else e(y,T);T=T.sibling}x.type===gr?(g=On(x.props.children,y.mode,v,x.key),g.return=y,y=g):(v=fo(x.type,x.key,x.props,null,y.mode,v),v.ref=fs(y,g,x),v.return=y,y=v)}return l(y);case pr:e:{for(T=x.key;g!==null;){if(g.key===T)if(g.tag===4&&g.stateNode.containerInfo===x.containerInfo&&g.stateNode.implementation===x.implementation){n(y,g.sibling),g=s(g,x.children||[]),g.return=y,y=g;break e}else{n(y,g);break}else e(y,g);g=g.sibling}g=ia(x,y.mode,v),g.return=y,y=g}return l(y);case rn:return T=x._init,S(y,g,T(x._payload),v)}if(Cs(x))return b(y,g,x,v);if(as(x))return j(y,g,x,v);Yi(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,g!==null&&g.tag===6?(n(y,g.sibling),g=s(g,x),g.return=y,y=g):(n(y,g),g=sa(x,y.mode,v),g.return=y,y=g),l(y)):n(y,g)}return S}var Dr=Kf(!0),Qf=Kf(!1),Lo=bn(null),_o=null,Sr=null,Fc=null;function Hc(){Fc=Sr=_o=null}function Bc(t){var e=Lo.current;de(Lo),t._currentValue=e}function Xa(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Lr(t,e){_o=t,Fc=Sr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qe=!0),t.firstContext=null)}function xt(t){var e=t._currentValue;if(Fc!==t)if(t={context:t,memoizedValue:e,next:null},Sr===null){if(_o===null)throw Error(L(308));Sr=t,_o.dependencies={lanes:0,firstContext:t}}else Sr=Sr.next=t;return e}var In=null;function Wc(t){In===null?In=[t]:In.push(t)}function Zf(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Wc(e)):(n.next=s.next,s.next=n),e.interleaved=n,qt(t,r)}function qt(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var sn=!1;function Yc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jf(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function mn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ee&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,qt(t,n)}return s=r.interleaved,s===null?(e.next=e,Wc(r)):(e.next=s.next,s.next=e),r.interleaved=e,qt(t,n)}function oo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ec(t,n)}}function Xd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function zo(t,e,n,r){var s=t.updateQueue;sn=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,u=c.next;c.next=null,l===null?i=u:l.next=u,l=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==l&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;l=0,h=u=c=null,a=i;do{var p=a.lane,w=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,j=a;switch(p=e,w=n,j.tag){case 1:if(b=j.payload,typeof b=="function"){f=b.call(w,f,p);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=j.payload,p=typeof b=="function"?b.call(w,f,p):b,p==null)break e;f=pe({},f,p);break e;case 2:sn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else w={eventTime:w,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=w,c=f):h=h.next=w,l|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do l|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Bn|=l,t.lanes=l,t.memoizedState=f}}function Vd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(L(191,s));s.call(r)}}}var li={},It=bn(li),Ks=bn(li),Qs=bn(li);function An(t){if(t===li)throw Error(L(174));return t}function Uc(t,e){switch(ae(Qs,e),ae(Ks,t),ae(It,li),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ca(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ca(e,t)}de(It),ae(It,e)}function Rr(){de(It),de(Ks),de(Qs)}function em(t){An(Qs.current);var e=An(It.current),n=Ca(e,t.type);e!==n&&(ae(Ks,t),ae(It,n))}function Xc(t){Ks.current===t&&(de(It),de(Ks))}var fe=bn(0);function Io(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zl=[];function Vc(){for(var t=0;t<Zl.length;t++)Zl[t]._workInProgressVersionPrimary=null;Zl.length=0}var lo=Qt.ReactCurrentDispatcher,Jl=Qt.ReactCurrentBatchConfig,Hn=0,me=null,Se=null,Te=null,Ao=!1,Is=!1,Zs=0,Yy=0;function Ie(){throw Error(L(321))}function Gc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ct(t[n],e[n]))return!1;return!0}function qc(t,e,n,r,s,i){if(Hn=i,me=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lo.current=t===null||t.memoizedState===null?Gy:qy,t=n(r,s),Is){i=0;do{if(Is=!1,Zs=0,25<=i)throw Error(L(301));i+=1,Te=Se=null,e.updateQueue=null,lo.current=Ky,t=n(r,s)}while(Is)}if(lo.current=Do,e=Se!==null&&Se.next!==null,Hn=0,Te=Se=me=null,Ao=!1,e)throw Error(L(300));return t}function Kc(){var t=Zs!==0;return Zs=0,t}function Lt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Te===null?me.memoizedState=Te=t:Te=Te.next=t,Te}function yt(){if(Se===null){var t=me.alternate;t=t!==null?t.memoizedState:null}else t=Se.next;var e=Te===null?me.memoizedState:Te.next;if(e!==null)Te=e,Se=t;else{if(t===null)throw Error(L(310));Se=t,t={memoizedState:Se.memoizedState,baseState:Se.baseState,baseQueue:Se.baseQueue,queue:Se.queue,next:null},Te===null?me.memoizedState=Te=t:Te=Te.next=t}return Te}function Js(t,e){return typeof e=="function"?e(t):e}function ea(t){var e=yt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=Se,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=l=null,c=null,u=i;do{var h=u.lane;if((Hn&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=f,l=r):c=c.next=f,me.lanes|=h,Bn|=h}u=u.next}while(u!==null&&u!==i);c===null?l=r:c.next=a,Ct(r,e.memoizedState)||(Qe=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,me.lanes|=i,Bn|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ta(t){var e=yt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var l=s=s.next;do i=t(i,l.action),l=l.next;while(l!==s);Ct(i,e.memoizedState)||(Qe=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function tm(){}function nm(t,e){var n=me,r=yt(),s=e(),i=!Ct(r.memoizedState,s);if(i&&(r.memoizedState=s,Qe=!0),r=r.queue,Qc(im.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Te!==null&&Te.memoizedState.tag&1){if(n.flags|=2048,ei(9,sm.bind(null,n,r,s,e),void 0,null),Me===null)throw Error(L(349));Hn&30||rm(n,e,s)}return s}function rm(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=me.updateQueue,e===null?(e={lastEffect:null,stores:null},me.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function sm(t,e,n,r){e.value=n,e.getSnapshot=r,om(e)&&lm(t)}function im(t,e,n){return n(function(){om(e)&&lm(t)})}function om(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ct(t,n)}catch{return!0}}function lm(t){var e=qt(t,1);e!==null&&Nt(e,t,1,-1)}function Gd(t){var e=Lt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:t},e.queue=t,t=t.dispatch=Vy.bind(null,me,t),[e.memoizedState,t]}function ei(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=me.updateQueue,e===null?(e={lastEffect:null,stores:null},me.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function am(){return yt().memoizedState}function ao(t,e,n,r){var s=Lt();me.flags|=t,s.memoizedState=ei(1|e,n,void 0,r===void 0?null:r)}function Ko(t,e,n,r){var s=yt();r=r===void 0?null:r;var i=void 0;if(Se!==null){var l=Se.memoizedState;if(i=l.destroy,r!==null&&Gc(r,l.deps)){s.memoizedState=ei(e,n,i,r);return}}me.flags|=t,s.memoizedState=ei(1|e,n,i,r)}function qd(t,e){return ao(8390656,8,t,e)}function Qc(t,e){return Ko(2048,8,t,e)}function cm(t,e){return Ko(4,2,t,e)}function um(t,e){return Ko(4,4,t,e)}function dm(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function hm(t,e,n){return n=n!=null?n.concat([t]):null,Ko(4,4,dm.bind(null,e,t),n)}function Zc(){}function fm(t,e){var n=yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Gc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function mm(t,e){var n=yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Gc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function pm(t,e,n){return Hn&21?(Ct(n,e)||(n=wf(),me.lanes|=n,Bn|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qe=!0),t.memoizedState=n)}function Uy(t,e){var n=oe;oe=n!==0&&4>n?n:4,t(!0);var r=Jl.transition;Jl.transition={};try{t(!1),e()}finally{oe=n,Jl.transition=r}}function gm(){return yt().memoizedState}function Xy(t,e,n){var r=gn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xm(t))ym(e,n);else if(n=Zf(t,e,n,r),n!==null){var s=Be();Nt(n,t,r,s),vm(n,e,r)}}function Vy(t,e,n){var r=gn(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xm(t))ym(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var l=e.lastRenderedState,a=i(l,n);if(s.hasEagerState=!0,s.eagerState=a,Ct(a,l)){var c=e.interleaved;c===null?(s.next=s,Wc(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=Zf(t,e,s,r),n!==null&&(s=Be(),Nt(n,t,r,s),vm(n,e,r))}}function xm(t){var e=t.alternate;return t===me||e!==null&&e===me}function ym(t,e){Is=Ao=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function vm(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ec(t,n)}}var Do={readContext:xt,useCallback:Ie,useContext:Ie,useEffect:Ie,useImperativeHandle:Ie,useInsertionEffect:Ie,useLayoutEffect:Ie,useMemo:Ie,useReducer:Ie,useRef:Ie,useState:Ie,useDebugValue:Ie,useDeferredValue:Ie,useTransition:Ie,useMutableSource:Ie,useSyncExternalStore:Ie,useId:Ie,unstable_isNewReconciler:!1},Gy={readContext:xt,useCallback:function(t,e){return Lt().memoizedState=[t,e===void 0?null:e],t},useContext:xt,useEffect:qd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ao(4194308,4,dm.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ao(4194308,4,t,e)},useInsertionEffect:function(t,e){return ao(4,2,t,e)},useMemo:function(t,e){var n=Lt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Lt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Xy.bind(null,me,t),[r.memoizedState,t]},useRef:function(t){var e=Lt();return t={current:t},e.memoizedState=t},useState:Gd,useDebugValue:Zc,useDeferredValue:function(t){return Lt().memoizedState=t},useTransition:function(){var t=Gd(!1),e=t[0];return t=Uy.bind(null,t[1]),Lt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=me,s=Lt();if(he){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),Me===null)throw Error(L(349));Hn&30||rm(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,qd(im.bind(null,r,i,t),[t]),r.flags|=2048,ei(9,sm.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Lt(),e=Me.identifierPrefix;if(he){var n=Ut,r=Yt;n=(r&~(1<<32-St(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Zs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Yy++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},qy={readContext:xt,useCallback:fm,useContext:xt,useEffect:Qc,useImperativeHandle:hm,useInsertionEffect:cm,useLayoutEffect:um,useMemo:mm,useReducer:ea,useRef:am,useState:function(){return ea(Js)},useDebugValue:Zc,useDeferredValue:function(t){var e=yt();return pm(e,Se.memoizedState,t)},useTransition:function(){var t=ea(Js)[0],e=yt().memoizedState;return[t,e]},useMutableSource:tm,useSyncExternalStore:nm,useId:gm,unstable_isNewReconciler:!1},Ky={readContext:xt,useCallback:fm,useContext:xt,useEffect:Qc,useImperativeHandle:hm,useInsertionEffect:cm,useLayoutEffect:um,useMemo:mm,useReducer:ta,useRef:am,useState:function(){return ta(Js)},useDebugValue:Zc,useDeferredValue:function(t){var e=yt();return Se===null?e.memoizedState=t:pm(e,Se.memoizedState,t)},useTransition:function(){var t=ta(Js)[0],e=yt().memoizedState;return[t,e]},useMutableSource:tm,useSyncExternalStore:nm,useId:gm,unstable_isNewReconciler:!1};function bt(t,e){if(t&&t.defaultProps){e=pe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Va(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:pe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Qo={isMounted:function(t){return(t=t._reactInternals)?Gn(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Be(),s=gn(t),i=Xt(r,s);i.payload=e,n!=null&&(i.callback=n),e=mn(t,i,s),e!==null&&(Nt(e,t,s,r),oo(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Be(),s=gn(t),i=Xt(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=mn(t,i,s),e!==null&&(Nt(e,t,s,r),oo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Be(),r=gn(t),s=Xt(n,r);s.tag=2,e!=null&&(s.callback=e),e=mn(t,s,r),e!==null&&(Nt(e,t,r,n),oo(e,t,r))}};function Kd(t,e,n,r,s,i,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,l):e.prototype&&e.prototype.isPureReactComponent?!Xs(n,r)||!Xs(s,i):!0}function wm(t,e,n){var r=!1,s=vn,i=e.contextType;return typeof i=="object"&&i!==null?i=xt(i):(s=Je(e)?$n:Re.current,r=e.contextTypes,i=(r=r!=null)?Ir(t,s):vn),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qo,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Qd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Qo.enqueueReplaceState(e,e.state,null)}function Ga(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Yc(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=xt(i):(i=Je(e)?$n:Re.current,s.context=Ir(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Va(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Qo.enqueueReplaceState(s,s.state,null),zo(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Or(t,e){try{var n="",r=e;do n+=Sx(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function na(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qa(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Qy=typeof WeakMap=="function"?WeakMap:Map;function bm(t,e,n){n=Xt(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Oo||(Oo=!0,ic=r),qa(t,e)},n}function km(t,e,n){n=Xt(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){qa(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qa(t,e),typeof r!="function"&&(pn===null?pn=new Set([this]):pn.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function Zd(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Qy;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=dv.bind(null,t,e,n),e.then(t,t))}function Jd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function eh(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Xt(-1,1),e.tag=2,mn(n,e,1))),n.lanes|=1),t)}var Zy=Qt.ReactCurrentOwner,Qe=!1;function He(t,e,n,r){e.child=t===null?Qf(e,null,n,r):Dr(e,t.child,n,r)}function th(t,e,n,r,s){n=n.render;var i=e.ref;return Lr(e,s),r=qc(t,e,n,r,i,s),n=Kc(),t!==null&&!Qe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kt(t,e,s)):(he&&n&&Rc(e),e.flags|=1,He(t,e,r,s),e.child)}function nh(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ou(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,jm(t,e,i,r,s)):(t=fo(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:Xs,n(l,r)&&t.ref===e.ref)return Kt(t,e,s)}return e.flags|=1,t=xn(i,r),t.ref=e.ref,t.return=e,e.child=t}function jm(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Xs(i,r)&&t.ref===e.ref)if(Qe=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Qe=!0);else return e.lanes=t.lanes,Kt(t,e,s)}return Ka(t,e,n,r,s)}function Sm(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ae(Cr,it),it|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ae(Cr,it),it|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ae(Cr,it),it|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ae(Cr,it),it|=r;return He(t,e,s,n),e.child}function Nm(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ka(t,e,n,r,s){var i=Je(n)?$n:Re.current;return i=Ir(e,i),Lr(e,s),n=qc(t,e,n,r,i,s),r=Kc(),t!==null&&!Qe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kt(t,e,s)):(he&&r&&Rc(e),e.flags|=1,He(t,e,n,s),e.child)}function rh(t,e,n,r,s){if(Je(n)){var i=!0;Mo(e)}else i=!1;if(Lr(e,s),e.stateNode===null)co(t,e),wm(e,n,r),Ga(e,n,r,s),r=!0;else if(t===null){var l=e.stateNode,a=e.memoizedProps;l.props=a;var c=l.context,u=n.contextType;typeof u=="object"&&u!==null?u=xt(u):(u=Je(n)?$n:Re.current,u=Ir(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(a!==r||c!==u)&&Qd(e,l,r,u),sn=!1;var p=e.memoizedState;l.state=p,zo(e,r,l,s),c=e.memoizedState,a!==r||p!==c||Ze.current||sn?(typeof h=="function"&&(Va(e,n,h,r),c=e.memoizedState),(a=sn||Kd(e,n,a,r,p,c,u))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),l.props=r,l.state=c,l.context=u,r=a):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,Jf(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:bt(e.type,a),l.props=u,f=e.pendingProps,p=l.context,c=n.contextType,typeof c=="object"&&c!==null?c=xt(c):(c=Je(n)?$n:Re.current,c=Ir(e,c));var w=n.getDerivedStateFromProps;(h=typeof w=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(a!==f||p!==c)&&Qd(e,l,r,c),sn=!1,p=e.memoizedState,l.state=p,zo(e,r,l,s);var b=e.memoizedState;a!==f||p!==b||Ze.current||sn?(typeof w=="function"&&(Va(e,n,w,r),b=e.memoizedState),(u=sn||Kd(e,n,u,r,p,b,c)||!1)?(h||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,b,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,b,c)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),l.props=r,l.state=b,l.context=c,r=u):(typeof l.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Qa(t,e,n,r,i,s)}function Qa(t,e,n,r,s,i){Nm(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return s&&Bd(e,n,!1),Kt(t,e,i);r=e.stateNode,Zy.current=e;var a=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=Dr(e,t.child,null,i),e.child=Dr(e,null,a,i)):He(t,e,a,i),e.memoizedState=r.state,s&&Bd(e,n,!0),e.child}function Cm(t){var e=t.stateNode;e.pendingContext?Hd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hd(t,e.context,!1),Uc(t,e.containerInfo)}function sh(t,e,n,r,s){return Ar(),$c(s),e.flags|=256,He(t,e,n,r),e.child}var Za={dehydrated:null,treeContext:null,retryLane:0};function Ja(t){return{baseLanes:t,cachePool:null,transitions:null}}function Tm(t,e,n){var r=e.pendingProps,s=fe.current,i=!1,l=(e.flags&128)!==0,a;if((a=l)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ae(fe,s&1),t===null)return Ua(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,i?(r=e.mode,i=e.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=el(l,r,0,null),t=On(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Ja(n),e.memoizedState=Za,t):Jc(e,l));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Jy(t,e,l,r,a,s,n);if(i){i=r.fallback,l=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=xn(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=xn(a,i):(i=On(i,l,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,l=t.child.memoizedState,l=l===null?Ja(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=t.childLanes&~n,e.memoizedState=Za,r}return i=t.child,t=i.sibling,r=xn(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Jc(t,e){return e=el({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ui(t,e,n,r){return r!==null&&$c(r),Dr(e,t.child,null,n),t=Jc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Jy(t,e,n,r,s,i,l){if(n)return e.flags&256?(e.flags&=-257,r=na(Error(L(422))),Ui(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=el({mode:"visible",children:r.children},s,0,null),i=On(i,s,l,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Dr(e,t.child,null,l),e.child.memoizedState=Ja(l),e.memoizedState=Za,i);if(!(e.mode&1))return Ui(t,e,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(L(419)),r=na(i,r,void 0),Ui(t,e,l,r)}if(a=(l&t.childLanes)!==0,Qe||a){if(r=Me,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,qt(t,s),Nt(r,t,s,-1))}return iu(),r=na(Error(L(421))),Ui(t,e,l,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=hv.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,lt=fn(s.nextSibling),at=e,he=!0,jt=null,t!==null&&(ft[mt++]=Yt,ft[mt++]=Ut,ft[mt++]=Fn,Yt=t.id,Ut=t.overflow,Fn=e),e=Jc(e,r.children),e.flags|=4096,e)}function ih(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Xa(t.return,e,n)}function ra(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Mm(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(He(t,e,r.children,n),r=fe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ih(t,n,e);else if(t.tag===19)ih(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ae(fe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Io(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),ra(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Io(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}ra(e,!0,n,null,i);break;case"together":ra(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function co(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kt(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bn|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=xn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=xn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ev(t,e,n){switch(e.tag){case 3:Cm(e),Ar();break;case 5:em(e);break;case 1:Je(e.type)&&Mo(e);break;case 4:Uc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ae(Lo,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ae(fe,fe.current&1),e.flags|=128,null):n&e.child.childLanes?Tm(t,e,n):(ae(fe,fe.current&1),t=Kt(t,e,n),t!==null?t.sibling:null);ae(fe,fe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Mm(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ae(fe,fe.current),r)break;return null;case 22:case 23:return e.lanes=0,Sm(t,e,n)}return Kt(t,e,n)}var Em,ec,Pm,Lm;Em=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ec=function(){};Pm=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,An(It.current);var i=null;switch(n){case"input":s=ka(t,s),r=ka(t,r),i=[];break;case"select":s=pe({},s,{value:void 0}),r=pe({},r,{value:void 0}),i=[];break;case"textarea":s=Na(t,s),r=Na(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Co)}Ta(n,r);var l;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(l in a)a.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&($s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(l in a)!a.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&a[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&($s.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ue("scroll",t),i||a===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};Lm=function(t,e,n,r){n!==r&&(e.flags|=4)};function ms(t,e){if(!he)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ae(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function tv(t,e,n){var r=e.pendingProps;switch(Oc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ae(e),null;case 1:return Je(e.type)&&To(),Ae(e),null;case 3:return r=e.stateNode,Rr(),de(Ze),de(Re),Vc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wi(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jt!==null&&(ac(jt),jt=null))),ec(t,e),Ae(e),null;case 5:Xc(e);var s=An(Qs.current);if(n=e.type,t!==null&&e.stateNode!=null)Pm(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return Ae(e),null}if(t=An(It.current),Wi(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[_t]=e,r[qs]=i,t=(e.mode&1)!==0,n){case"dialog":ue("cancel",r),ue("close",r);break;case"iframe":case"object":case"embed":ue("load",r);break;case"video":case"audio":for(s=0;s<Ms.length;s++)ue(Ms[s],r);break;case"source":ue("error",r);break;case"img":case"image":case"link":ue("error",r),ue("load",r);break;case"details":ue("toggle",r);break;case"input":md(r,i),ue("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ue("invalid",r);break;case"textarea":gd(r,i),ue("invalid",r)}Ta(n,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var a=i[l];l==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Bi(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Bi(r.textContent,a,t),s=["children",""+a]):$s.hasOwnProperty(l)&&a!=null&&l==="onScroll"&&ue("scroll",r)}switch(n){case"input":Ii(r),pd(r,i,!0);break;case"textarea":Ii(r),xd(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Co)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=sf(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[_t]=e,t[qs]=r,Em(t,e,!1,!1),e.stateNode=t;e:{switch(l=Ma(n,r),n){case"dialog":ue("cancel",t),ue("close",t),s=r;break;case"iframe":case"object":case"embed":ue("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ms.length;s++)ue(Ms[s],t);s=r;break;case"source":ue("error",t),s=r;break;case"img":case"image":case"link":ue("error",t),ue("load",t),s=r;break;case"details":ue("toggle",t),s=r;break;case"input":md(t,r),s=ka(t,r),ue("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=pe({},r,{value:void 0}),ue("invalid",t);break;case"textarea":gd(t,r),s=Na(t,r),ue("invalid",t);break;default:s=r}Ta(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?af(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&of(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Fs(t,c):typeof c=="number"&&Fs(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($s.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ue("scroll",t):c!=null&&jc(t,i,c,l))}switch(n){case"input":Ii(t),pd(t,r,!1);break;case"textarea":Ii(t),xd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+yn(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Tr(t,!!r.multiple,i,!1):r.defaultValue!=null&&Tr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Co)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ae(e),null;case 6:if(t&&e.stateNode!=null)Lm(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=An(Qs.current),An(It.current),Wi(e)){if(r=e.stateNode,n=e.memoizedProps,r[_t]=e,(i=r.nodeValue!==n)&&(t=at,t!==null))switch(t.tag){case 3:Bi(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bi(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[_t]=e,e.stateNode=r}return Ae(e),null;case 13:if(de(fe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(he&&lt!==null&&e.mode&1&&!(e.flags&128))qf(),Ar(),e.flags|=98560,i=!1;else if(i=Wi(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(L(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(L(317));i[_t]=e}else Ar(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ae(e),i=!1}else jt!==null&&(ac(jt),jt=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||fe.current&1?Ne===0&&(Ne=3):iu())),e.updateQueue!==null&&(e.flags|=4),Ae(e),null);case 4:return Rr(),ec(t,e),t===null&&Vs(e.stateNode.containerInfo),Ae(e),null;case 10:return Bc(e.type._context),Ae(e),null;case 17:return Je(e.type)&&To(),Ae(e),null;case 19:if(de(fe),i=e.memoizedState,i===null)return Ae(e),null;if(r=(e.flags&128)!==0,l=i.rendering,l===null)if(r)ms(i,!1);else{if(Ne!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=Io(t),l!==null){for(e.flags|=128,ms(i,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,t=l.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ae(fe,fe.current&1|2),e.child}t=t.sibling}i.tail!==null&&we()>$r&&(e.flags|=128,r=!0,ms(i,!1),e.lanes=4194304)}else{if(!r)if(t=Io(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ms(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!he)return Ae(e),null}else 2*we()-i.renderingStartTime>$r&&n!==1073741824&&(e.flags|=128,r=!0,ms(i,!1),e.lanes=4194304);i.isBackwards?(l.sibling=e.child,e.child=l):(n=i.last,n!==null?n.sibling=l:e.child=l,i.last=l)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=we(),e.sibling=null,n=fe.current,ae(fe,r?n&1|2:n&1),e):(Ae(e),null);case 22:case 23:return su(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?it&1073741824&&(Ae(e),e.subtreeFlags&6&&(e.flags|=8192)):Ae(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function nv(t,e){switch(Oc(e),e.tag){case 1:return Je(e.type)&&To(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Rr(),de(Ze),de(Re),Vc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Xc(e),null;case 13:if(de(fe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Ar()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return de(fe),null;case 4:return Rr(),null;case 10:return Bc(e.type._context),null;case 22:case 23:return su(),null;case 24:return null;default:return null}}var Xi=!1,De=!1,rv=typeof WeakSet=="function"?WeakSet:Set,R=null;function Nr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){xe(t,e,r)}else n.current=null}function tc(t,e,n){try{n()}catch(r){xe(t,e,r)}}var oh=!1;function sv(t,e){if(Oa=jo,t=Df(),Dc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,a=-1,c=-1,u=0,h=0,f=t,p=null;t:for(;;){for(var w;f!==n||s!==0&&f.nodeType!==3||(a=l+s),f!==i||r!==0&&f.nodeType!==3||(c=l+r),f.nodeType===3&&(l+=f.nodeValue.length),(w=f.firstChild)!==null;)p=f,f=w;for(;;){if(f===t)break t;if(p===n&&++u===s&&(a=l),p===i&&++h===r&&(c=l),(w=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=w}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for($a={focusedElem:t,selectionRange:n},jo=!1,R=e;R!==null;)if(e=R,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,R=t;else for(;R!==null;){e=R;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var j=b.memoizedProps,S=b.memoizedState,y=e.stateNode,g=y.getSnapshotBeforeUpdate(e.elementType===e.type?j:bt(e.type,j),S);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(v){xe(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,R=t;break}R=e.return}return b=oh,oh=!1,b}function As(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&tc(e,n,i)}s=s.next}while(s!==r)}}function Zo(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function nc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _m(t){var e=t.alternate;e!==null&&(t.alternate=null,_m(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_t],delete e[qs],delete e[Ba],delete e[Fy],delete e[Hy])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function zm(t){return t.tag===5||t.tag===3||t.tag===4}function lh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zm(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function rc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Co));else if(r!==4&&(t=t.child,t!==null))for(rc(t,e,n),t=t.sibling;t!==null;)rc(t,e,n),t=t.sibling}function sc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(sc(t,e,n),t=t.sibling;t!==null;)sc(t,e,n),t=t.sibling}var Le=null,kt=!1;function tn(t,e,n){for(n=n.child;n!==null;)Im(t,e,n),n=n.sibling}function Im(t,e,n){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(Yo,n)}catch{}switch(n.tag){case 5:De||Nr(n,e);case 6:var r=Le,s=kt;Le=null,tn(t,e,n),Le=r,kt=s,Le!==null&&(kt?(t=Le,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Le.removeChild(n.stateNode));break;case 18:Le!==null&&(kt?(t=Le,n=n.stateNode,t.nodeType===8?Kl(t.parentNode,n):t.nodeType===1&&Kl(t,n),Ys(t)):Kl(Le,n.stateNode));break;case 4:r=Le,s=kt,Le=n.stateNode.containerInfo,kt=!0,tn(t,e,n),Le=r,kt=s;break;case 0:case 11:case 14:case 15:if(!De&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&tc(n,e,l),s=s.next}while(s!==r)}tn(t,e,n);break;case 1:if(!De&&(Nr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){xe(n,e,a)}tn(t,e,n);break;case 21:tn(t,e,n);break;case 22:n.mode&1?(De=(r=De)||n.memoizedState!==null,tn(t,e,n),De=r):tn(t,e,n);break;default:tn(t,e,n)}}function ah(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new rv),e.forEach(function(r){var s=fv.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function vt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,l=e,a=l;e:for(;a!==null;){switch(a.tag){case 5:Le=a.stateNode,kt=!1;break e;case 3:Le=a.stateNode.containerInfo,kt=!0;break e;case 4:Le=a.stateNode.containerInfo,kt=!0;break e}a=a.return}if(Le===null)throw Error(L(160));Im(i,l,s),Le=null,kt=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){xe(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Am(e,t),e=e.sibling}function Am(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vt(e,t),Pt(t),r&4){try{As(3,t,t.return),Zo(3,t)}catch(j){xe(t,t.return,j)}try{As(5,t,t.return)}catch(j){xe(t,t.return,j)}}break;case 1:vt(e,t),Pt(t),r&512&&n!==null&&Nr(n,n.return);break;case 5:if(vt(e,t),Pt(t),r&512&&n!==null&&Nr(n,n.return),t.flags&32){var s=t.stateNode;try{Fs(s,"")}catch(j){xe(t,t.return,j)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,l=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&nf(s,i),Ma(a,l);var u=Ma(a,i);for(l=0;l<c.length;l+=2){var h=c[l],f=c[l+1];h==="style"?af(s,f):h==="dangerouslySetInnerHTML"?of(s,f):h==="children"?Fs(s,f):jc(s,h,f,u)}switch(a){case"input":ja(s,i);break;case"textarea":rf(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?Tr(s,!!i.multiple,w,!1):p!==!!i.multiple&&(i.defaultValue!=null?Tr(s,!!i.multiple,i.defaultValue,!0):Tr(s,!!i.multiple,i.multiple?[]:"",!1))}s[qs]=i}catch(j){xe(t,t.return,j)}}break;case 6:if(vt(e,t),Pt(t),r&4){if(t.stateNode===null)throw Error(L(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(j){xe(t,t.return,j)}}break;case 3:if(vt(e,t),Pt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ys(e.containerInfo)}catch(j){xe(t,t.return,j)}break;case 4:vt(e,t),Pt(t);break;case 13:vt(e,t),Pt(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(nu=we())),r&4&&ah(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(De=(u=De)||h,vt(e,t),De=u):vt(e,t),Pt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(R=t,h=t.child;h!==null;){for(f=R=h;R!==null;){switch(p=R,w=p.child,p.tag){case 0:case 11:case 14:case 15:As(4,p,p.return);break;case 1:Nr(p,p.return);var b=p.stateNode;if(typeof b.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(j){xe(r,n,j)}}break;case 5:Nr(p,p.return);break;case 22:if(p.memoizedState!==null){uh(f);continue}}w!==null?(w.return=p,R=w):uh(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,c=f.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=lf("display",l))}catch(j){xe(t,t.return,j)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(j){xe(t,t.return,j)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:vt(e,t),Pt(t),r&4&&ah(t);break;case 21:break;default:vt(e,t),Pt(t)}}function Pt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(zm(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Fs(s,""),r.flags&=-33);var i=lh(t);sc(t,i,s);break;case 3:case 4:var l=r.stateNode.containerInfo,a=lh(t);rc(t,a,l);break;default:throw Error(L(161))}}catch(c){xe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function iv(t,e,n){R=t,Dm(t)}function Dm(t,e,n){for(var r=(t.mode&1)!==0;R!==null;){var s=R,i=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||Xi;if(!l){var a=s.alternate,c=a!==null&&a.memoizedState!==null||De;a=Xi;var u=De;if(Xi=l,(De=c)&&!u)for(R=s;R!==null;)l=R,c=l.child,l.tag===22&&l.memoizedState!==null?dh(s):c!==null?(c.return=l,R=c):dh(s);for(;i!==null;)R=i,Dm(i),i=i.sibling;R=s,Xi=a,De=u}ch(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,R=i):ch(t)}}function ch(t){for(;R!==null;){var e=R;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:De||Zo(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!De)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:bt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Vd(e,i,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Vd(e,l,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Ys(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}De||e.flags&512&&nc(e)}catch(p){xe(e,e.return,p)}}if(e===t){R=null;break}if(n=e.sibling,n!==null){n.return=e.return,R=n;break}R=e.return}}function uh(t){for(;R!==null;){var e=R;if(e===t){R=null;break}var n=e.sibling;if(n!==null){n.return=e.return,R=n;break}R=e.return}}function dh(t){for(;R!==null;){var e=R;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Zo(4,e)}catch(c){xe(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){xe(e,s,c)}}var i=e.return;try{nc(e)}catch(c){xe(e,i,c)}break;case 5:var l=e.return;try{nc(e)}catch(c){xe(e,l,c)}}}catch(c){xe(e,e.return,c)}if(e===t){R=null;break}var a=e.sibling;if(a!==null){a.return=e.return,R=a;break}R=e.return}}var ov=Math.ceil,Ro=Qt.ReactCurrentDispatcher,eu=Qt.ReactCurrentOwner,gt=Qt.ReactCurrentBatchConfig,ee=0,Me=null,ke=null,_e=0,it=0,Cr=bn(0),Ne=0,ti=null,Bn=0,Jo=0,tu=0,Ds=null,Ke=null,nu=0,$r=1/0,Bt=null,Oo=!1,ic=null,pn=null,Vi=!1,cn=null,$o=0,Rs=0,oc=null,uo=-1,ho=0;function Be(){return ee&6?we():uo!==-1?uo:uo=we()}function gn(t){return t.mode&1?ee&2&&_e!==0?_e&-_e:Wy.transition!==null?(ho===0&&(ho=wf()),ho):(t=oe,t!==0||(t=window.event,t=t===void 0?16:Tf(t.type)),t):1}function Nt(t,e,n,r){if(50<Rs)throw Rs=0,oc=null,Error(L(185));si(t,n,r),(!(ee&2)||t!==Me)&&(t===Me&&(!(ee&2)&&(Jo|=n),Ne===4&&ln(t,_e)),et(t,r),n===1&&ee===0&&!(e.mode&1)&&($r=we()+500,qo&&kn()))}function et(t,e){var n=t.callbackNode;Wx(t,e);var r=ko(t,t===Me?_e:0);if(r===0)n!==null&&wd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&wd(n),e===1)t.tag===0?By(hh.bind(null,t)):Xf(hh.bind(null,t)),Oy(function(){!(ee&6)&&kn()}),n=null;else{switch(bf(r)){case 1:n=Mc;break;case 4:n=yf;break;case 16:n=bo;break;case 536870912:n=vf;break;default:n=bo}n=Ym(n,Rm.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Rm(t,e){if(uo=-1,ho=0,ee&6)throw Error(L(327));var n=t.callbackNode;if(_r()&&t.callbackNode!==n)return null;var r=ko(t,t===Me?_e:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Fo(t,r);else{e=r;var s=ee;ee|=2;var i=$m();(Me!==t||_e!==e)&&(Bt=null,$r=we()+500,Rn(t,e));do try{cv();break}catch(a){Om(t,a)}while(!0);Hc(),Ro.current=i,ee=s,ke!==null?e=0:(Me=null,_e=0,e=Ne)}if(e!==0){if(e===2&&(s=za(t),s!==0&&(r=s,e=lc(t,s))),e===1)throw n=ti,Rn(t,0),ln(t,r),et(t,we()),n;if(e===6)ln(t,r);else{if(s=t.current.alternate,!(r&30)&&!lv(s)&&(e=Fo(t,r),e===2&&(i=za(t),i!==0&&(r=i,e=lc(t,i))),e===1))throw n=ti,Rn(t,0),ln(t,r),et(t,we()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:Ln(t,Ke,Bt);break;case 3:if(ln(t,r),(r&130023424)===r&&(e=nu+500-we(),10<e)){if(ko(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Be(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ha(Ln.bind(null,t,Ke,Bt),e);break}Ln(t,Ke,Bt);break;case 4:if(ln(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var l=31-St(r);i=1<<l,l=e[l],l>s&&(s=l),r&=~i}if(r=s,r=we()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ov(r/1960))-r,10<r){t.timeoutHandle=Ha(Ln.bind(null,t,Ke,Bt),r);break}Ln(t,Ke,Bt);break;case 5:Ln(t,Ke,Bt);break;default:throw Error(L(329))}}}return et(t,we()),t.callbackNode===n?Rm.bind(null,t):null}function lc(t,e){var n=Ds;return t.current.memoizedState.isDehydrated&&(Rn(t,e).flags|=256),t=Fo(t,e),t!==2&&(e=Ke,Ke=n,e!==null&&ac(e)),t}function ac(t){Ke===null?Ke=t:Ke.push.apply(Ke,t)}function lv(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ct(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ln(t,e){for(e&=~tu,e&=~Jo,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-St(e),r=1<<n;t[n]=-1,e&=~r}}function hh(t){if(ee&6)throw Error(L(327));_r();var e=ko(t,0);if(!(e&1))return et(t,we()),null;var n=Fo(t,e);if(t.tag!==0&&n===2){var r=za(t);r!==0&&(e=r,n=lc(t,r))}if(n===1)throw n=ti,Rn(t,0),ln(t,e),et(t,we()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ln(t,Ke,Bt),et(t,we()),null}function ru(t,e){var n=ee;ee|=1;try{return t(e)}finally{ee=n,ee===0&&($r=we()+500,qo&&kn())}}function Wn(t){cn!==null&&cn.tag===0&&!(ee&6)&&_r();var e=ee;ee|=1;var n=gt.transition,r=oe;try{if(gt.transition=null,oe=1,t)return t()}finally{oe=r,gt.transition=n,ee=e,!(ee&6)&&kn()}}function su(){it=Cr.current,de(Cr)}function Rn(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ry(n)),ke!==null)for(n=ke.return;n!==null;){var r=n;switch(Oc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&To();break;case 3:Rr(),de(Ze),de(Re),Vc();break;case 5:Xc(r);break;case 4:Rr();break;case 13:de(fe);break;case 19:de(fe);break;case 10:Bc(r.type._context);break;case 22:case 23:su()}n=n.return}if(Me=t,ke=t=xn(t.current,null),_e=it=e,Ne=0,ti=null,tu=Jo=Bn=0,Ke=Ds=null,In!==null){for(e=0;e<In.length;e++)if(n=In[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=s,r.next=l}n.pending=r}In=null}return t}function Om(t,e){do{var n=ke;try{if(Hc(),lo.current=Do,Ao){for(var r=me.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ao=!1}if(Hn=0,Te=Se=me=null,Is=!1,Zs=0,eu.current=null,n===null||n.return===null){Ne=1,ti=e,ke=null;break}e:{var i=t,l=n.return,a=n,c=e;if(e=_e,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var w=Jd(l);if(w!==null){w.flags&=-257,eh(w,l,a,i,e),w.mode&1&&Zd(i,u,e),e=w,c=u;var b=e.updateQueue;if(b===null){var j=new Set;j.add(c),e.updateQueue=j}else b.add(c);break e}else{if(!(e&1)){Zd(i,u,e),iu();break e}c=Error(L(426))}}else if(he&&a.mode&1){var S=Jd(l);if(S!==null){!(S.flags&65536)&&(S.flags|=256),eh(S,l,a,i,e),$c(Or(c,a));break e}}i=c=Or(c,a),Ne!==4&&(Ne=2),Ds===null?Ds=[i]:Ds.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=bm(i,c,e);Xd(i,y);break e;case 1:a=c;var g=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(pn===null||!pn.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var v=km(i,a,e);Xd(i,v);break e}}i=i.return}while(i!==null)}Hm(n)}catch(N){e=N,ke===n&&n!==null&&(ke=n=n.return);continue}break}while(!0)}function $m(){var t=Ro.current;return Ro.current=Do,t===null?Do:t}function iu(){(Ne===0||Ne===3||Ne===2)&&(Ne=4),Me===null||!(Bn&268435455)&&!(Jo&268435455)||ln(Me,_e)}function Fo(t,e){var n=ee;ee|=2;var r=$m();(Me!==t||_e!==e)&&(Bt=null,Rn(t,e));do try{av();break}catch(s){Om(t,s)}while(!0);if(Hc(),ee=n,Ro.current=r,ke!==null)throw Error(L(261));return Me=null,_e=0,Ne}function av(){for(;ke!==null;)Fm(ke)}function cv(){for(;ke!==null&&!Ix();)Fm(ke)}function Fm(t){var e=Wm(t.alternate,t,it);t.memoizedProps=t.pendingProps,e===null?Hm(t):ke=e,eu.current=null}function Hm(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=nv(n,e),n!==null){n.flags&=32767,ke=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ne=6,ke=null;return}}else if(n=tv(n,e,it),n!==null){ke=n;return}if(e=e.sibling,e!==null){ke=e;return}ke=e=t}while(e!==null);Ne===0&&(Ne=5)}function Ln(t,e,n){var r=oe,s=gt.transition;try{gt.transition=null,oe=1,uv(t,e,n,r)}finally{gt.transition=s,oe=r}return null}function uv(t,e,n,r){do _r();while(cn!==null);if(ee&6)throw Error(L(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Yx(t,i),t===Me&&(ke=Me=null,_e=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vi||(Vi=!0,Ym(bo,function(){return _r(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gt.transition,gt.transition=null;var l=oe;oe=1;var a=ee;ee|=4,eu.current=null,sv(t,n),Am(n,t),Py($a),jo=!!Oa,$a=Oa=null,t.current=n,iv(n),Ax(),ee=a,oe=l,gt.transition=i}else t.current=n;if(Vi&&(Vi=!1,cn=t,$o=s),i=t.pendingLanes,i===0&&(pn=null),Ox(n.stateNode),et(t,we()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Oo)throw Oo=!1,t=ic,ic=null,t;return $o&1&&t.tag!==0&&_r(),i=t.pendingLanes,i&1?t===oc?Rs++:(Rs=0,oc=t):Rs=0,kn(),null}function _r(){if(cn!==null){var t=bf($o),e=gt.transition,n=oe;try{if(gt.transition=null,oe=16>t?16:t,cn===null)var r=!1;else{if(t=cn,cn=null,$o=0,ee&6)throw Error(L(331));var s=ee;for(ee|=4,R=t.current;R!==null;){var i=R,l=i.child;if(R.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(R=u;R!==null;){var h=R;switch(h.tag){case 0:case 11:case 15:As(8,h,i)}var f=h.child;if(f!==null)f.return=h,R=f;else for(;R!==null;){h=R;var p=h.sibling,w=h.return;if(_m(h),h===u){R=null;break}if(p!==null){p.return=w,R=p;break}R=w}}}var b=i.alternate;if(b!==null){var j=b.child;if(j!==null){b.child=null;do{var S=j.sibling;j.sibling=null,j=S}while(j!==null)}}R=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,R=l;else e:for(;R!==null;){if(i=R,i.flags&2048)switch(i.tag){case 0:case 11:case 15:As(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,R=y;break e}R=i.return}}var g=t.current;for(R=g;R!==null;){l=R;var x=l.child;if(l.subtreeFlags&2064&&x!==null)x.return=l,R=x;else e:for(l=g;R!==null;){if(a=R,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Zo(9,a)}}catch(N){xe(a,a.return,N)}if(a===l){R=null;break e}var v=a.sibling;if(v!==null){v.return=a.return,R=v;break e}R=a.return}}if(ee=s,kn(),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(Yo,t)}catch{}r=!0}return r}finally{oe=n,gt.transition=e}}return!1}function fh(t,e,n){e=Or(n,e),e=bm(t,e,1),t=mn(t,e,1),e=Be(),t!==null&&(si(t,1,e),et(t,e))}function xe(t,e,n){if(t.tag===3)fh(t,t,n);else for(;e!==null;){if(e.tag===3){fh(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(pn===null||!pn.has(r))){t=Or(n,t),t=km(e,t,1),e=mn(e,t,1),t=Be(),e!==null&&(si(e,1,t),et(e,t));break}}e=e.return}}function dv(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Be(),t.pingedLanes|=t.suspendedLanes&n,Me===t&&(_e&n)===n&&(Ne===4||Ne===3&&(_e&130023424)===_e&&500>we()-nu?Rn(t,0):tu|=n),et(t,e)}function Bm(t,e){e===0&&(t.mode&1?(e=Ri,Ri<<=1,!(Ri&130023424)&&(Ri=4194304)):e=1);var n=Be();t=qt(t,e),t!==null&&(si(t,e,n),et(t,n))}function hv(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Bm(t,n)}function fv(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),Bm(t,n)}var Wm;Wm=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ze.current)Qe=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Qe=!1,ev(t,e,n);Qe=!!(t.flags&131072)}else Qe=!1,he&&e.flags&1048576&&Vf(e,Po,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;co(t,e),t=e.pendingProps;var s=Ir(e,Re.current);Lr(e,n),s=qc(null,e,r,t,s,n);var i=Kc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Je(r)?(i=!0,Mo(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Yc(e),s.updater=Qo,e.stateNode=s,s._reactInternals=e,Ga(e,r,t,n),e=Qa(null,e,r,!0,i,n)):(e.tag=0,he&&i&&Rc(e),He(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(co(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=pv(r),t=bt(r,t),s){case 0:e=Ka(null,e,r,t,n);break e;case 1:e=rh(null,e,r,t,n);break e;case 11:e=th(null,e,r,t,n);break e;case 14:e=nh(null,e,r,bt(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bt(r,s),Ka(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bt(r,s),rh(t,e,r,s,n);case 3:e:{if(Cm(e),t===null)throw Error(L(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Jf(t,e),zo(e,r,null,n);var l=e.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Or(Error(L(423)),e),e=sh(t,e,r,n,s);break e}else if(r!==s){s=Or(Error(L(424)),e),e=sh(t,e,r,n,s);break e}else for(lt=fn(e.stateNode.containerInfo.firstChild),at=e,he=!0,jt=null,n=Qf(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ar(),r===s){e=Kt(t,e,n);break e}He(t,e,r,n)}e=e.child}return e;case 5:return em(e),t===null&&Ua(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,l=s.children,Fa(r,s)?l=null:i!==null&&Fa(r,i)&&(e.flags|=32),Nm(t,e),He(t,e,l,n),e.child;case 6:return t===null&&Ua(e),null;case 13:return Tm(t,e,n);case 4:return Uc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Dr(e,null,r,n):He(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bt(r,s),th(t,e,r,s,n);case 7:return He(t,e,e.pendingProps,n),e.child;case 8:return He(t,e,e.pendingProps.children,n),e.child;case 12:return He(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,l=s.value,ae(Lo,r._currentValue),r._currentValue=l,i!==null)if(Ct(i.value,l)){if(i.children===s.children&&!Ze.current){e=Kt(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){l=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Xt(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Xa(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)l=i.type===e.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(L(341));l.lanes|=n,a=l.alternate,a!==null&&(a.lanes|=n),Xa(l,n,e),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===e){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}He(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Lr(e,n),s=xt(s),r=r(s),e.flags|=1,He(t,e,r,n),e.child;case 14:return r=e.type,s=bt(r,e.pendingProps),s=bt(r.type,s),nh(t,e,r,s,n);case 15:return jm(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:bt(r,s),co(t,e),e.tag=1,Je(r)?(t=!0,Mo(e)):t=!1,Lr(e,n),wm(e,r,s),Ga(e,r,s,n),Qa(null,e,r,!0,t,n);case 19:return Mm(t,e,n);case 22:return Sm(t,e,n)}throw Error(L(156,e.tag))};function Ym(t,e){return xf(t,e)}function mv(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pt(t,e,n,r){return new mv(t,e,n,r)}function ou(t){return t=t.prototype,!(!t||!t.isReactComponent)}function pv(t){if(typeof t=="function")return ou(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Nc)return 11;if(t===Cc)return 14}return 2}function xn(t,e){var n=t.alternate;return n===null?(n=pt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function fo(t,e,n,r,s,i){var l=2;if(r=t,typeof t=="function")ou(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case gr:return On(n.children,s,i,e);case Sc:l=8,s|=8;break;case ya:return t=pt(12,n,e,s|2),t.elementType=ya,t.lanes=i,t;case va:return t=pt(13,n,e,s),t.elementType=va,t.lanes=i,t;case wa:return t=pt(19,n,e,s),t.elementType=wa,t.lanes=i,t;case Jh:return el(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Qh:l=10;break e;case Zh:l=9;break e;case Nc:l=11;break e;case Cc:l=14;break e;case rn:l=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=pt(l,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function On(t,e,n,r){return t=pt(7,t,r,e),t.lanes=n,t}function el(t,e,n,r){return t=pt(22,t,r,e),t.elementType=Jh,t.lanes=n,t.stateNode={isHidden:!1},t}function sa(t,e,n){return t=pt(6,t,null,e),t.lanes=n,t}function ia(t,e,n){return e=pt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function gv(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$l(0),this.expirationTimes=$l(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$l(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function lu(t,e,n,r,s,i,l,a,c){return t=new gv(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=pt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yc(i),t}function xv(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Um(t){if(!t)return vn;t=t._reactInternals;e:{if(Gn(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Je(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(Je(n))return Uf(t,n,e)}return e}function Xm(t,e,n,r,s,i,l,a,c){return t=lu(n,r,!0,t,s,i,l,a,c),t.context=Um(null),n=t.current,r=Be(),s=gn(n),i=Xt(r,s),i.callback=e??null,mn(n,i,s),t.current.lanes=s,si(t,s,r),et(t,r),t}function tl(t,e,n,r){var s=e.current,i=Be(),l=gn(s);return n=Um(n),e.context===null?e.context=n:e.pendingContext=n,e=Xt(i,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=mn(s,e,l),t!==null&&(Nt(t,s,l,i),oo(t,s,l)),l}function Ho(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function mh(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function au(t,e){mh(t,e),(t=t.alternate)&&mh(t,e)}function yv(){return null}var Vm=typeof reportError=="function"?reportError:function(t){console.error(t)};function cu(t){this._internalRoot=t}nl.prototype.render=cu.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));tl(t,e,null,null)};nl.prototype.unmount=cu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Wn(function(){tl(null,t,null,null)}),e[Gt]=null}};function nl(t){this._internalRoot=t}nl.prototype.unstable_scheduleHydration=function(t){if(t){var e=Sf();t={blockedOn:null,target:t,priority:e};for(var n=0;n<on.length&&e!==0&&e<on[n].priority;n++);on.splice(n,0,t),n===0&&Cf(t)}};function uu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function rl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ph(){}function vv(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Ho(l);i.call(u)}}var l=Xm(e,r,t,0,null,!1,!1,"",ph);return t._reactRootContainer=l,t[Gt]=l.current,Vs(t.nodeType===8?t.parentNode:t),Wn(),l}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=Ho(c);a.call(u)}}var c=lu(t,0,!1,null,null,!1,!1,"",ph);return t._reactRootContainer=c,t[Gt]=c.current,Vs(t.nodeType===8?t.parentNode:t),Wn(function(){tl(e,c,n,r)}),c}function sl(t,e,n,r,s){var i=n._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var a=s;s=function(){var c=Ho(l);a.call(c)}}tl(e,l,t,s)}else l=vv(n,e,t,s,r);return Ho(l)}kf=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ts(e.pendingLanes);n!==0&&(Ec(e,n|1),et(e,we()),!(ee&6)&&($r=we()+500,kn()))}break;case 13:Wn(function(){var r=qt(t,1);if(r!==null){var s=Be();Nt(r,t,1,s)}}),au(t,1)}};Pc=function(t){if(t.tag===13){var e=qt(t,134217728);if(e!==null){var n=Be();Nt(e,t,134217728,n)}au(t,134217728)}};jf=function(t){if(t.tag===13){var e=gn(t),n=qt(t,e);if(n!==null){var r=Be();Nt(n,t,e,r)}au(t,e)}};Sf=function(){return oe};Nf=function(t,e){var n=oe;try{return oe=t,e()}finally{oe=n}};Pa=function(t,e,n){switch(e){case"input":if(ja(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Go(r);if(!s)throw Error(L(90));tf(r),ja(r,s)}}}break;case"textarea":rf(t,n);break;case"select":e=n.value,e!=null&&Tr(t,!!n.multiple,e,!1)}};df=ru;hf=Wn;var wv={usingClientEntryPoint:!1,Events:[oi,wr,Go,cf,uf,ru]},ps={findFiberByHostInstance:zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bv={bundleType:ps.bundleType,version:ps.version,rendererPackageName:ps.rendererPackageName,rendererConfig:ps.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qt.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=pf(t),t===null?null:t.stateNode},findFiberByHostInstance:ps.findFiberByHostInstance||yv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gi.isDisabled&&Gi.supportsFiber)try{Yo=Gi.inject(bv),zt=Gi}catch{}}ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wv;ut.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uu(e))throw Error(L(200));return xv(t,e,null,n)};ut.createRoot=function(t,e){if(!uu(t))throw Error(L(299));var n=!1,r="",s=Vm;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=lu(t,1,!1,null,null,n,!1,r,s),t[Gt]=e.current,Vs(t.nodeType===8?t.parentNode:t),new cu(e)};ut.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=pf(e),t=t===null?null:t.stateNode,t};ut.flushSync=function(t){return Wn(t)};ut.hydrate=function(t,e,n){if(!rl(e))throw Error(L(200));return sl(null,t,e,!0,n)};ut.hydrateRoot=function(t,e,n){if(!uu(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",l=Vm;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=Xm(e,null,t,1,n??null,s,!1,i,l),t[Gt]=e.current,Vs(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new nl(e)};ut.render=function(t,e,n){if(!rl(e))throw Error(L(200));return sl(null,t,e,!1,n)};ut.unmountComponentAtNode=function(t){if(!rl(t))throw Error(L(40));return t._reactRootContainer?(Wn(function(){sl(null,null,t,!1,function(){t._reactRootContainer=null,t[Gt]=null})}),!0):!1};ut.unstable_batchedUpdates=ru;ut.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!rl(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return sl(t,e,n,!1,r)};ut.version="18.3.1-next-f1338f8080-20240426";function Gm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Gm)}catch(t){console.error(t)}}Gm(),Vh.exports=ut;var Yn=Vh.exports;const kv=Ah(Yn);var gh=Yn;ga.createRoot=gh.createRoot,ga.hydrateRoot=gh.hydrateRoot;function xh(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function qm(...t){return e=>{let n=!1;const r=t.map(s=>{const i=xh(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():xh(t[s],null)}}}}function Un(...t){return m.useCallback(qm(...t),t)}function Bo(t){const e=Sv(t),n=m.forwardRef((r,s)=>{const{children:i,...l}=r,a=m.Children.toArray(i),c=a.find(Cv);if(c){const u=c.props.children,h=a.map(f=>f===c?m.Children.count(u)>1?m.Children.only(null):m.isValidElement(u)?u.props.children:null:f);return o.jsx(e,{...l,ref:s,children:m.isValidElement(u)?m.cloneElement(u,void 0,h):null})}return o.jsx(e,{...l,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var jv=Bo("Slot");function Sv(t){const e=m.forwardRef((n,r)=>{const{children:s,...i}=n;if(m.isValidElement(s)){const l=Mv(s),a=Tv(i,s.props);return s.type!==m.Fragment&&(a.ref=r?qm(r,l):l),m.cloneElement(s,a)}return m.Children.count(s)>1?m.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Nv=Symbol("radix.slottable");function Cv(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Nv}function Tv(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const c=i(...a);return s(...a),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Mv(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Km(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=Km(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Qm(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=Km(t))&&(r&&(r+=" "),r+=e);return r}const yh=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,vh=Qm,Zm=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return vh(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,l=Object.keys(s).map(u=>{const h=n==null?void 0:n[u],f=i==null?void 0:i[u];if(h===null)return null;const p=yh(h)||yh(f);return s[u][p]}),a=n&&Object.entries(n).reduce((u,h)=>{let[f,p]=h;return p===void 0||(u[f]=p),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,h)=>{let{class:f,className:p,...w}=h;return Object.entries(w).every(b=>{let[j,S]=b;return Array.isArray(S)?S.includes({...i,...a}[j]):{...i,...a}[j]===S})?[...u,f,p]:u},[]);return vh(t,l,c,n==null?void 0:n.class,n==null?void 0:n.className)};function Ev(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=Jm(e))&&(r&&(r+=" "),r+=n);return r}function Jm(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=Jm(t[r]))&&(n&&(n+=" "),n+=e);return n}var du="-";function Pv(t){var e=_v(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(a){var c=a.split(du);return c[0]===""&&c.length!==1&&c.shift(),ep(c,e)||Lv(a)}function l(a,c){var u=n[a]||[];return c&&s[a]?[].concat(u,s[a]):u}return{getClassGroupId:i,getConflictingClassGroupIds:l}}function ep(t,e){var l;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?ep(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join(du);return(l=e.validators.find(function(a){var c=a.validator;return c(i)}))==null?void 0:l.classGroupId}}var wh=/^\[(.+)\]$/;function Lv(t){if(wh.test(t)){var e=wh.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function _v(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=Iv(Object.entries(t.classGroups),n);return s.forEach(function(i){var l=i[0],a=i[1];cc(a,r,l,e)}),r}function cc(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:bh(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(zv(s)){cc(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(l){var a=l[0],c=l[1];cc(c,bh(e,a),n,r)})})}function bh(t,e){var n=t;return e.split(du).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function zv(t){return t.isThemeGetter}function Iv(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(l){return typeof l=="string"?e+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(function(a){var c=a[0],u=a[1];return[e+c,u]})):l});return[r,i]}):t}function Av(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,l){n.set(i,l),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(l){var a=n.get(l);if(a!==void 0)return a;if((a=r.get(l))!==void 0)return s(l,a),a},set:function(l,a){n.has(l)?n.set(l,a):s(l,a)}}}var tp="!";function Dv(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(l){for(var a=[],c=0,u=0,h,f=0;f<l.length;f++){var p=l[f];if(c===0){if(p===r&&(n||l.slice(f,f+s)===e)){a.push(l.slice(u,f)),u=f+s;continue}if(p==="/"){h=f;continue}}p==="["?c++:p==="]"&&c--}var w=a.length===0?l:l.substring(u),b=w.startsWith(tp),j=b?w.substring(1):w,S=h&&h>u?h-u:void 0;return{modifiers:a,hasImportantModifier:b,baseClassName:j,maybePostfixModifierPosition:S}}}function Rv(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function Ov(t){return{cache:Av(t.cacheSize),splitModifiers:Dv(t),...Pv(t)}}var $v=/\s+/;function Fv(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split($v).map(function(l){var a=n(l),c=a.modifiers,u=a.hasImportantModifier,h=a.baseClassName,f=a.maybePostfixModifierPosition,p=r(f?h.substring(0,f):h),w=!!f;if(!p){if(!f)return{isTailwindClass:!1,originalClassName:l};if(p=r(h),!p)return{isTailwindClass:!1,originalClassName:l};w=!1}var b=Rv(c).join(":"),j=u?b+tp:b;return{isTailwindClass:!0,modifierId:j,classGroupId:p,originalClassName:l,hasPostfixModifier:w}}).reverse().filter(function(l){if(!l.isTailwindClass)return!0;var a=l.modifierId,c=l.classGroupId,u=l.hasPostfixModifier,h=a+c;return i.has(h)?!1:(i.add(h),s(c,u).forEach(function(f){return i.add(a+f)}),!0)}).reverse().map(function(l){return l.originalClassName}).join(" ")}function Hv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,l=a;function a(u){var h=e[0],f=e.slice(1),p=f.reduce(function(w,b){return b(w)},h());return r=Ov(p),s=r.cache.get,i=r.cache.set,l=c,c(u)}function c(u){var h=s(u);if(h)return h;var f=Fv(u,r);return i(u,f),f}return function(){return l(Ev.apply(null,arguments))}}function ce(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var np=/^\[(?:([a-z-]+):)?(.+)\]$/i,Bv=/^\d+\/\d+$/,Wv=new Set(["px","full","screen"]),Yv=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Uv=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Xv=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function wt(t){return Dn(t)||Wv.has(t)||Bv.test(t)||uc(t)}function uc(t){return qn(t,"length",Zv)}function Vv(t){return qn(t,"size",rp)}function Gv(t){return qn(t,"position",rp)}function qv(t){return qn(t,"url",Jv)}function qi(t){return qn(t,"number",Dn)}function Dn(t){return!Number.isNaN(Number(t))}function Kv(t){return t.endsWith("%")&&Dn(t.slice(0,-1))}function gs(t){return kh(t)||qn(t,"number",kh)}function Z(t){return np.test(t)}function xs(){return!0}function nn(t){return Yv.test(t)}function Qv(t){return qn(t,"",e0)}function qn(t,e,n){var r=np.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function Zv(t){return Uv.test(t)}function rp(){return!1}function Jv(t){return t.startsWith("url(")}function kh(t){return Number.isInteger(Number(t))}function e0(t){return Xv.test(t)}function t0(){var t=ce("colors"),e=ce("spacing"),n=ce("blur"),r=ce("brightness"),s=ce("borderColor"),i=ce("borderRadius"),l=ce("borderSpacing"),a=ce("borderWidth"),c=ce("contrast"),u=ce("grayscale"),h=ce("hueRotate"),f=ce("invert"),p=ce("gap"),w=ce("gradientColorStops"),b=ce("gradientColorStopPositions"),j=ce("inset"),S=ce("margin"),y=ce("opacity"),g=ce("padding"),x=ce("saturate"),v=ce("scale"),N=ce("sepia"),T=ce("skew"),P=ce("space"),E=ce("translate"),O=function(){return["auto","contain","none"]},A=function(){return["auto","hidden","clip","visible","scroll"]},X=function(){return["auto",Z,e]},V=function(){return[Z,e]},te=function(){return["",wt]},U=function(){return["auto",Dn,Z]},re=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},ye=function(){return["solid","dashed","dotted","double","none"]},Ue=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},_=function(){return["start","end","center","between","around","evenly","stretch"]},B=function(){return["","0",Z]},Y=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},J=function(){return[Dn,qi]},ne=function(){return[Dn,Z]};return{cacheSize:500,theme:{colors:[xs],spacing:[wt],blur:["none","",nn,Z],brightness:J(),borderColor:[t],borderRadius:["none","","full",nn,Z],borderSpacing:V(),borderWidth:te(),contrast:J(),grayscale:B(),hueRotate:ne(),invert:B(),gap:V(),gradientColorStops:[t],gradientColorStopPositions:[Kv,uc],inset:X(),margin:X(),opacity:J(),padding:V(),saturate:J(),scale:J(),sepia:B(),skew:ne(),space:V(),translate:V()},classGroups:{aspect:[{aspect:["auto","square","video",Z]}],container:["container"],columns:[{columns:[nn]}],"break-after":[{"break-after":Y()}],"break-before":[{"break-before":Y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(re(),[Z])}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[j]}],"inset-x":[{"inset-x":[j]}],"inset-y":[{"inset-y":[j]}],start:[{start:[j]}],end:[{end:[j]}],top:[{top:[j]}],right:[{right:[j]}],bottom:[{bottom:[j]}],left:[{left:[j]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",gs]}],basis:[{basis:X()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Z]}],grow:[{grow:B()}],shrink:[{shrink:B()}],order:[{order:["first","last","none",gs]}],"grid-cols":[{"grid-cols":[xs]}],"col-start-end":[{col:["auto",{span:["full",gs]},Z]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[xs]}],"row-start-end":[{row:["auto",{span:[gs]},Z]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Z]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Z]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal"].concat(_())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(_(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(_(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Z,e]}],"min-w":[{"min-w":["min","max","fit",Z,wt]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[nn]},nn,Z]}],h:[{h:[Z,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Z,wt]}],"max-h":[{"max-h":[Z,e,"min","max","fit"]}],"font-size":[{text:["base",nn,uc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",qi]}],"font-family":[{font:[xs]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Z]}],"line-clamp":[{"line-clamp":["none",Dn,qi]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Z,wt]}],"list-image":[{"list-image":["none",Z]}],"list-style-type":[{list:["none","disc","decimal",Z]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(ye(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",wt]}],"underline-offset":[{"underline-offset":["auto",Z,wt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:V()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Z]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Z]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(re(),[Gv])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Vv]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},qv]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[].concat(ye(),["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:ye()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(ye())}],"outline-offset":[{"outline-offset":[Z,wt]}],"outline-w":[{outline:[wt]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:te()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[wt]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",nn,Qv]}],"shadow-color":[{shadow:[xs]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":Ue()}],"bg-blend":[{"bg-blend":Ue()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",nn,Z]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[f]}],saturate:[{saturate:[x]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Z]}],duration:[{duration:ne()}],ease:[{ease:["linear","in","out","in-out",Z]}],delay:[{delay:ne()}],animate:[{animate:["none","spin","ping","pulse","bounce",Z]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[v]}],"scale-x":[{"scale-x":[v]}],"scale-y":[{"scale-y":[v]}],rotate:[{rotate:[gs,Z]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Z]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Z]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":V()}],"scroll-mx":[{"scroll-mx":V()}],"scroll-my":[{"scroll-my":V()}],"scroll-ms":[{"scroll-ms":V()}],"scroll-me":[{"scroll-me":V()}],"scroll-mt":[{"scroll-mt":V()}],"scroll-mr":[{"scroll-mr":V()}],"scroll-mb":[{"scroll-mb":V()}],"scroll-ml":[{"scroll-ml":V()}],"scroll-p":[{"scroll-p":V()}],"scroll-px":[{"scroll-px":V()}],"scroll-py":[{"scroll-py":V()}],"scroll-ps":[{"scroll-ps":V()}],"scroll-pe":[{"scroll-pe":V()}],"scroll-pt":[{"scroll-pt":V()}],"scroll-pr":[{"scroll-pr":V()}],"scroll-pb":[{"scroll-pb":V()}],"scroll-pl":[{"scroll-pl":V()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Z]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[wt,qi]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var n0=Hv(t0);function tt(...t){return n0(Qm(t))}const r0=Zm("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),z=m.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const l=r?jv:"button";return o.jsx(l,{className:tt(r0({variant:e,size:n,className:t})),ref:i,...s})});z.displayName="Button";function s0({className:t,variant:e="default",...n}){const r={default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border border-input text-foreground"};return o.jsx("div",{className:tt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",r[e],t),...n})}const K=({content:t,side:e="top",className:n="",children:r,offsetY:s=8})=>{const i=`tooltip-${ge.useId()}`,l=ge.isValidElement(r)?ge.cloneElement(r,{"aria-describedby":i}):o.jsx("span",{tabIndex:0,"aria-describedby":i,className:"inline-flex",children:r}),a=ge.useRef(null),c=ge.useRef(null),u=ge.useRef(null),[h,f]=ge.useState(!1),[p,w]=ge.useState(null),[b,j]=ge.useState(!1),S=ge.useCallback(()=>{let v=s;if(a.current)try{const N=a.current.dataset;if(N&&N.tooltipOffset){const T=parseInt(N.tooltipOffset,10);Number.isNaN(T)||(v=T)}}catch{}return v},[s]),y=ge.useCallback(()=>{if(!a.current)return;const v=a.current.getBoundingClientRect(),N=S(),T=v.left+v.width/2,P=40;let E=v.top;e==="top"?E=v.top-P-N:e==="bottom"||e==="auto"?E=v.bottom+N:E=v.top+v.height/2,w({left:T,top:E})},[e,S]);ge.useEffect(()=>(window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)),[y]);const g=()=>{requestAnimationFrame(()=>y()),f(!0),j(!0)},x=()=>{f(!1),window.setTimeout(()=>j(!1),220)};return ge.useEffect(()=>{if(!h||!u.current||!a.current)return;const v=u.current.getBoundingClientRect(),N=a.current.getBoundingClientRect(),T=S(),P=v.width/2;let E=N.left+N.width/2;const O=8+P,A=window.innerWidth-8-P;E<O&&(E=O),E>A&&(E=A);let X=N.top-v.height-T;(e==="bottom"||e==="auto")&&(X=N.bottom+T),X=Math.max(8,Math.min(window.innerHeight-v.height-8,X)),w({left:E,top:X})},[h,e,S]),o.jsxs(o.Fragment,{children:[o.jsx("span",{ref:a,onMouseEnter:g,onFocus:g,onMouseLeave:x,onBlur:x,className:`relative inline-flex ${n}`,children:l}),typeof document<"u"&&p&&b&&Yn.createPortal(o.jsxs("div",{ref:u,id:i,role:"tooltip",className:`custom-tooltip ${h?"visible":"fade-out"}`,style:{left:p.left,top:p.top,transform:"translateX(-50%)"},children:[o.jsx("span",{ref:c,className:"inline-block text-xs px-3 py-1.5 rounded-md shadow-md max-w-[18rem] break-words",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t}),o.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 mt-[-6px] w-2 h-2 rotate-45 bg-black","aria-hidden":!0})]}),document.body)]})},F=m.forwardRef(({className:t,type:e,...n},r)=>o.jsx("input",{type:e,className:tt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));F.displayName="Input";function ys({open:t,onOpenChange:e,children:n}){return t?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[o.jsx("div",{className:"fixed inset-0 bg-black/80",onClick:()=>e(!1)}),o.jsx("div",{className:"relative z-50",children:n})]}):null}function vs({className:t,children:e,...n}){return o.jsx("div",{className:tt("bg-background border border-border rounded-lg p-6 w-full max-w-lg mx-auto shadow-lg",t),...n,children:e})}function ws({className:t,children:e,...n}){return o.jsx("div",{className:tt("flex flex-col space-y-1.5 text-center sm:text-left",t),...n,children:e})}function bs({className:t,children:e,...n}){return o.jsx("h3",{className:tt("text-lg font-semibold leading-none tracking-tight",t),...n,children:e})}function ks({className:t,children:e,...n}){return o.jsx("p",{className:tt("text-sm text-muted-foreground",t),...n,children:e})}function js({className:t,children:e,...n}){return o.jsx("div",{className:tt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n,children:e})}/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o0=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),jh=t=>{const e=o0(t);return e.charAt(0).toUpperCase()+e.slice(1)},sp=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),l0=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var a0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=m.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:l,...a},c)=>m.createElement("svg",{ref:c,...a0,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:sp("lucide",s),...!i&&!l0(a)&&{"aria-hidden":"true"},...a},[...l.map(([u,h])=>m.createElement(u,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=(t,e)=>{const n=m.forwardRef(({className:r,...s},i)=>m.createElement(c0,{ref:i,iconNode:e,className:sp(`lucide-${i0(jh(t))}`,`lucide-${t}`,r),...s}));return n.displayName=jh(t),n};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=[["circle",{cx:"9",cy:"9",r:"7",key:"p2h5vp"}],["circle",{cx:"15",cy:"15",r:"7",key:"19ennj"}]],d0=W("blend",u0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],f0=W("box",h0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],p0=W("check",m0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],x0=W("chevron-left",g0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],v0=W("chevron-right",y0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oa=W("circle-question-mark",w0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ss=W("circle",b0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],j0=W("clock",k0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],N0=W("download",S0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],la=W("eraser",C0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],M0=W("eye-off",T0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],P0=W("eye",E0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],_0=W("folder-open",L0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],mo=W("folder",z0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],dc=W("grid-3x3",I0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],D0=W("image",A0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Sh=W("link-2",R0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]],$0=W("locate",O0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F0=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Nh=W("map-pin",F0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],aa=W("map",H0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],W0=W("menu",B0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=[["path",{d:"M5 12h14",key:"1ays0h"}]],hc=W("minus",Y0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],X0=W("moon",U0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],G0=W("mouse-pointer-2",V0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"7",key:"11ol66"}],["path",{d:"M12 6v4",key:"16clxf"}]],Ki=W("mouse",q0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Q0=W("mouse-pointer",K0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],J0=W("move",Z0);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=[["path",{d:"m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z",key:"irua1i"}],["path",{d:"m5 2 5 5",key:"1lls2c"}],["path",{d:"M2 13h15",key:"1hkzvu"}],["path",{d:"M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z",key:"xk76lq"}]],ca=W("paint-bucket",ew);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v4",key:"qmzblu"}],["path",{d:"M17 2a1 1 0 0 1 1 1v9H6V3a1 1 0 0 1 1-1z",key:"ycvu00"}],["path",{d:"M6 12a1 1 0 0 0-1 1v1a2 2 0 0 0 2 2h2a1 1 0 0 1 1 1v2.9a2 2 0 1 0 4 0V17a1 1 0 0 1 1-1h2a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1",key:"iw4wnp"}]],Qi=W("paintbrush-vertical",tw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ch=W("pen",nw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=[["path",{d:"m12 9-8.414 8.414A2 2 0 0 0 3 18.828v1.344a2 2 0 0 1-.586 1.414A2 2 0 0 1 3.828 21h1.344a2 2 0 0 0 1.414-.586L15 12",key:"1y3wsu"}],["path",{d:"m18 9 .4.4a1 1 0 1 1-3 3l-3.8-3.8a1 1 0 1 1 3-3l.4.4 3.4-3.4a1 1 0 1 1 3 3z",key:"110lr1"}],["path",{d:"m2 22 .414-.414",key:"jhxm08"}]],Th=W("pipette",rw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],po=W("plus",sw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],ow=W("redo-2",iw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lw=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],aw=W("rotate-ccw",lw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Mh=W("save",cw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uw=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],Eh=W("scan",uw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],hw=W("scissors",dw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ph=W("settings",fw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mw=[["path",{d:"M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z",key:"1bo67w"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}],["circle",{cx:"17.5",cy:"17.5",r:"3.5",key:"w3z12y"}]],pw=W("shapes",mw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ua=W("shield",gw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],_n=W("square",xw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=[["path",{d:"M14 13V8.5C14 7 15 7 15 5a3 3 0 0 0-6 0c0 2 1 2 1 3.5V13",key:"i9gjdv"}],["path",{d:"M20 15.5a2.5 2.5 0 0 0-2.5-2.5h-11A2.5 2.5 0 0 0 4 15.5V17a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1z",key:"1vzg3v"}],["path",{d:"M5 22h14",key:"ehvnwv"}]],vw=W("stamp",yw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],bw=W("sun",ww);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],mr=W("target",kw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Sw=W("trash-2",jw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Cw=W("undo-2",Nw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tw=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Zi=W("upload",Tw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ew=W("users",Mw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],da=W("wand-sparkles",Pw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fe=W("x",Lw);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],zw=W("zoom-in",_w);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Aw=W("zoom-out",Iw);class ha{constructor(e){this.showMinimap=!0,this.isDarkMode=!1,this.debugMode=!1,this.resizeObserver=null,this.boundResizeHandler=null,this.boundMouseDown=null,this.boundMouseMove=null,this.boundMouseUp=null,this.boundMouseLeave=null,this.boundWheel=null,this.boundContextMenu=null,this.mapWidth=20,this.mapHeight=15,this.tileSizeX=64,this.tileSizeY=32,this.orientation="isometric",this.tileContentThreshold=10,this.objectSeparationSensitivity=.5,this.detectedTileData=new Map,this.layerTilesets=new Map,this.layerTileData=new Map,this.layerActiveGid=new Map,this.tilesets=[],this.tilesetImage=null,this.tilesetFileName=null,this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.tileLayers=[],this.activeLayerId=null,this.nextLayerId=1,this.collisionData=[],this.objects=[],this.selectedObject=null,this.nextObjectId=1,this.selectedObjectId=null,this.isDraggingActor=!1,this.draggingActorId=null,this.heroX=0,this.heroY=0,this.isDraggingHero=!1,this.heroLastClickTime=0,this.tool="tiles",this.currentTool="brush",this.currentSelectionTool="rectangular",this.currentShapeTool="rectangle",this.currentStampMode="select",this.activeGid=0,this.isMouseDown=!1,this.selection={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,tiles:[]},this.isSelecting=!1,this.shapeDrawing={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,preview:[]},this.isDrawingShape=!1,this.hoverX=-1,this.hoverY=-1,this.zoom=1,this.panX=0,this.panY=0,this.isPanning=!1,this.lastPanX=0,this.lastPanY=0,this.spacePressed=!1,this.history=[],this.historyIndex=-1,this.maxHistorySize=50,this.isApplyingHistory=!1,this.hasUnsavedChanges=!1,this.autoSaveTimeout=null,this.lastSaveTimestamp=0,this.autoSaveCallback=null,this.saveStatusCallback=null,this.activeGidCallback=null,this.AUTO_SAVE_DELAY=8e3,this.IMMEDIATE_SAVE_DELAY=2e3,this.autoSaveEnabled=!0,this.sidebarTransitioning=!1,this.lastMiniMapPos=null,this.eyedropperCallback=null,this.objectsChangedCallback=null,this.stamps=new Map,this.activeStamp=null,this.stampPreview={x:0,y:0,visible:!1},this.stampCallback=null,this.heroEditCallback=null,this.mapCanvas=e,this.initializeCanvas(),this.initializeState(),this.bindEvents(),this.createDefaultLayers(),this.saveState(),this.draw()}getTileCount(){return this.tileCount}setTileContentThreshold(e){this.tileContentThreshold=Math.max(0,Math.min(255,e))}getTileContentThreshold(){return this.tileContentThreshold}refreshTilePalette(e=!1){this.tilesetImage&&this.createTilePalette(e)}getDetectedTileInfo(){const e=[];return this.detectedTileData.forEach((n,r)=>{e.push({gid:r,width:n.width,height:n.height,sourceX:n.sourceX,sourceY:n.sourceY})}),e.sort((n,r)=>n.gid-r.gid)}getDetectedTilesForLayer(e){const n=this.layerTileData.get(e);return n?Array.from(n.entries()):[]}getCurrentLayerActiveGid(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);return e&&this.layerActiveGid.get(e.type)||0}setCurrentLayerActiveGid(e){const n=this.tileLayers.find(r=>r.id===this.activeLayerId);if(n&&(this.layerActiveGid.set(n.type,e),this.activeGid=e,this.activeGidCallback))try{this.activeGidCallback(this.activeGid)}catch(r){console.warn("activeGidCallback error",r)}}mergeBrushes(e){if(e.length<2)return;const n=e.map(f=>this.detectedTileData.get(f)).filter(f=>f!==void 0);if(n.length!==e.length)throw new Error("Some selected brushes not found");let r=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const f of n)r=Math.min(r,f.sourceX),s=Math.min(s,f.sourceY),i=Math.max(i,f.sourceX+f.width),l=Math.max(l,f.sourceY+f.height);const a={sourceX:r,sourceY:s,width:i-r,height:l-s},c=Array.from(this.detectedTileData.entries()),u=c.findIndex(([f])=>e.includes(f)),h=c.filter(([f])=>!e.includes(f));h.splice(u,0,[e[0],a]),this.detectedTileData.clear(),h.forEach(([f,p],w)=>{this.detectedTileData.set(w,p)}),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Merged ${e.length} brushes into new brush at position ${u}`)}separateBrush(e){console.log(`separateBrush called with brushId: ${e}`);const n=this.detectedTileData.get(e);if(!n)throw console.error(`Brush ${e} not found`),new Error(`Brush ${e} not found`);console.log(`Separating brush ${e} with data:`,n);const r=Array.from(this.detectedTileData.entries()),s=r.findIndex(([a])=>a===e),i=r.filter(([a])=>a!==e),l=[];if(this.tilesetImage){const a=document.createElement("canvas");a.width=n.width,a.height=n.height;const c=a.getContext("2d");if(c){c.drawImage(this.tilesetImage,n.sourceX,n.sourceY,n.width,n.height,0,0,n.width,n.height);const h=c.getImageData(0,0,n.width,n.height).data;console.log(`Analyzing brush area: ${n.width}x${n.height}`);const f=this.findVerticalGaps(h,n.width,n.height);if(console.log("Found vertical gaps:",f),f.length>0){let p=0;for(const w of f){if(w>p){const b=w-p,j=this.findObjectBoundsInRegion(h,n.width,n.height,p,0,b,n.height);j&&j.width>0&&j.height>0&&l.push({sourceX:n.sourceX+j.x,sourceY:n.sourceY+j.y,width:j.width,height:j.height})}p=w+1}if(p<n.width){const w=n.width-p,b=this.findObjectBoundsInRegion(h,n.width,n.height,p,0,w,n.height);b&&b.width>0&&b.height>0&&l.push({sourceX:n.sourceX+b.x,sourceY:n.sourceY+b.y,width:b.width,height:b.height})}}else{const p=new Array(n.width*n.height).fill(!1);for(let w=0;w<n.height;w++)for(let b=0;b<n.width;b++){const j=w*n.width+b;if(p[j]||this.isPixelTransparent(h,b,w,n.width))continue;console.log(`Starting flood fill at pixel (${b}, ${w})`);const S=this.floodFillObjectDataInRegion(h,n.width,n.height,b,w,p);S&&this.isValidObjectSize(S.bounds)?(console.log("Found valid connected component:",S),l.push({sourceX:n.sourceX+S.bounds.x,sourceY:n.sourceY+S.bounds.y,width:S.bounds.width,height:S.bounds.height})):S&&console.log("Found invalid connected component (too small):",S)}}}}if(console.log(`Found ${l.length} new brushes from separation:`,l),l.length<=1){console.log(`No separation needed - only found ${l.length} component(s)`);return}l.forEach((a,c)=>{i.splice(s+c,0,[s+c,a])}),this.detectedTileData.clear(),i.forEach(([a,c],u)=>{this.detectedTileData.set(u,c)}),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Separated brush ${e} into ${l.length} new brushes`)}removeBrush(e){if(console.log(`removeBrush called with brushId: ${e}`),console.log("detectedTileData keys before removal:",Array.from(this.detectedTileData.keys())),!this.detectedTileData.has(e))throw console.error(`Brush ${e} not found in detectedTileData`),new Error(`Brush ${e} not found`);const n=Array.from(this.detectedTileData.entries());console.log("brushArray before filtering:",n.map(([s,i])=>s));const r=n.filter(([s])=>s!==e);console.log("filteredArray after filtering:",r.map(([s,i])=>s)),this.detectedTileData.clear(),r.forEach(([s,i],l)=>{this.detectedTileData.set(l,i)}),console.log("detectedTileData keys after rebuild:",Array.from(this.detectedTileData.keys())),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Removed brush ${e}`)}reorderBrush(e,n){const r=Array.from(this.detectedTileData.entries());if(e<0||e>=r.length||n<0||n>=r.length)throw new Error("Invalid brush indices for reordering");const[s]=r.splice(e,1);r.splice(n,0,s),this.detectedTileData.clear(),r.forEach(([i,l],a)=>{this.detectedTileData.set(a,l)}),this.createTilePalette(!0),this.markAsChanged(!0),console.log(`Reordered brush from index ${e} to ${n}`)}findVerticalGaps(e,n,r){const s=[];for(let i=1;i<n-1;i++){let l=!1;for(let a=0;a<r;a++)if(!this.isPixelTransparent(e,i,a,n)){l=!0;break}if(!l){let a=!1,c=!1;for(let u=0;u<r;u++)if(!this.isPixelTransparent(e,i-1,u,n)){a=!0;break}for(let u=0;u<r;u++)if(!this.isPixelTransparent(e,i+1,u,n)){c=!0;break}a&&c&&s.push(i)}}return console.log(`Detected ${s.length} vertical gaps at columns:`,s),s}findObjectBoundsInRegion(e,n,r,s,i,l,a){let c=s+l,u=s,h=i+a,f=i,p=!1;for(let w=i;w<i+a&&w<r;w++)for(let b=s;b<s+l&&b<n;b++)this.isPixelTransparent(e,b,w,n)||(p=!0,c=Math.min(c,b),u=Math.max(u,b),h=Math.min(h,w),f=Math.max(f,w));return p?{x:c,y:h,width:u-c+1,height:f-h+1}:null}floodFillObjectDataInRegion(e,n,r,s,i,l){const a=[{x:s,y:i}];let c=s,u=s,h=i,f=i,p=0;const w=[];for(;a.length>0;){const x=a.pop(),{x:v,y:N}=x;if(v<0||v>=n||N<0||N>=r)continue;const T=N*n+v;l[T]||this.isPixelTransparent(e,v,N,n)||(l[T]=!0,p++,w.push({x:v,y:N}),c=Math.min(c,v),u=Math.max(u,v),h=Math.min(h,N),f=Math.max(f,N),a.push({x:v+1,y:N}),a.push({x:v-1,y:N}),a.push({x:v,y:N+1}),a.push({x:v,y:N-1}))}if(p===0)return null;const b=1,j=Math.max(0,c-b),S=Math.max(0,h-b),y=Math.min(n-1,u+b),g=Math.min(r-1,f+b);return{bounds:{x:j,y:S,width:y-j+1,height:g-S+1},pixels:w}}updateActiveGid(e){if(this.activeGid=e,this.activeGidCallback)try{this.activeGidCallback(this.activeGid)}catch(n){console.warn("activeGidCallback error",n)}}setActiveGidCallback(e){if(this.activeGidCallback=e,e)try{e(this.activeGid)}catch(n){console.warn("setActiveGidCallback initial callback error",n)}}initializeCanvas(){const e=this.mapCanvas.getContext("2d");if(!e)throw new Error("Unable to get canvas context");this.ctx=e,this.ctx.imageSmoothingEnabled=!1,this.cleanupCanvasObservers(),this.resizeCanvas(),this.boundResizeHandler=()=>this.resizeCanvas(),window.addEventListener("resize",this.boundResizeHandler),window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>this.resizeCanvas()),this.mapCanvas.parentElement&&this.resizeObserver.observe(this.mapCanvas.parentElement))}cleanupCanvasObservers(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.boundResizeHandler&&(window.removeEventListener("resize",this.boundResizeHandler),this.boundResizeHandler=null)}cleanupCanvasEvents(){this.boundMouseDown&&(this.mapCanvas.removeEventListener("mousedown",this.boundMouseDown),this.boundMouseDown=null),this.boundMouseMove&&(this.mapCanvas.removeEventListener("mousemove",this.boundMouseMove),this.boundMouseMove=null),this.boundMouseUp&&(this.mapCanvas.removeEventListener("mouseup",this.boundMouseUp),this.boundMouseUp=null),this.boundMouseLeave&&(this.mapCanvas.removeEventListener("mouseleave",this.boundMouseLeave),this.boundMouseLeave=null),this.boundWheel&&(this.mapCanvas.removeEventListener("wheel",this.boundWheel),this.boundWheel=null),this.boundContextMenu&&(this.mapCanvas.removeEventListener("contextmenu",this.boundContextMenu),this.boundContextMenu=null)}resizeCanvas(){const e=this.mapCanvas.parentElement;e&&requestAnimationFrame(()=>{const n=e.getBoundingClientRect(),r=Math.max(1,Math.floor(n.width)),s=Math.max(1,Math.floor(n.height));(this.mapCanvas.width!==r||this.mapCanvas.height!==s)&&(this.mapCanvas.width=r,this.mapCanvas.height=s,this.draw())})}initializeState(){this.collisionData=new Array(this.mapWidth*this.mapHeight).fill(0)}bindEvents(){this.cleanupCanvasEvents(),this.boundMouseDown=this.handleMouseDown.bind(this),this.boundMouseMove=this.handleMouseMove.bind(this),this.boundMouseUp=this.handleMouseUp.bind(this),this.boundMouseLeave=this.handleMouseLeave.bind(this),this.boundWheel=this.handleWheel.bind(this),this.boundContextMenu=e=>e.preventDefault(),this.mapCanvas.addEventListener("mousedown",this.boundMouseDown),this.mapCanvas.addEventListener("mousemove",this.boundMouseMove),this.mapCanvas.addEventListener("mouseup",this.boundMouseUp),this.mapCanvas.addEventListener("mouseleave",this.boundMouseLeave),this.mapCanvas.addEventListener("contextmenu",this.boundContextMenu),this.mapCanvas.addEventListener("wheel",this.boundWheel),document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",this.handleKeyUp.bind(this)),this.mapCanvas.tabIndex=0}createDefaultLayers(){this.tileLayers=[{id:1,name:"NPC Layer",type:"npc",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:2,name:"Enemy Layer",type:"enemy",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:3,name:"Event Layer",type:"event",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:4,name:"Collision Layer",type:"collision",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:5,name:"Object Layer",type:"object",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1},{id:6,name:"Background Layer",type:"background",data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1}],this.activeLayerId=6,this.nextLayerId=7,this.sortLayersByPriority()}getDraggableActorAt(e,n){return e<0||n<0?null:this.objects.find(r=>r.x===e&&r.y===n&&this.actorUsesPlaceholder(r))||null}handleActorDrag(e,n){if(!this.isDraggingActor||this.draggingActorId===null||e<0||n<0||e>=this.mapWidth||n>=this.mapHeight)return;const r=this.objects.find(s=>s.id===this.draggingActorId);r&&(r.x===e&&r.y===n||(this.updateMapObject(r.id,{x:e,y:n}),this.draw()))}handleMouseDown(e){const n=this.mapCanvas.getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top;if(this.spacePressed)this.isPanning=!0,this.lastPanX=r,this.lastPanY=s,this.mapCanvas.style.cursor="grabbing";else{this.isMouseDown=!0;const i=this.screenToTile(r,s);if(i){if(this.isHeroAtPosition(i.x,i.y)){this.handleHeroClick(i.x,i.y,e);return}const l=this.getDraggableActorAt(i.x,i.y);if(l){this.isDraggingActor=!0,this.draggingActorId=l.id,this.selectedObject=l,this.selectedObjectId=l.id;return}this.tool==="tiles"?this.handleTileClick(i.x,i.y,e.button===2):this.tool==="selection"?this.handleSelectionStart(i.x,i.y,e.button===2):this.tool==="shape"?this.handleShapeStart(i.x,i.y,e.button===2):this.tool==="eyedropper"?this.handleEyedropper(i.x,i.y)&&(this.isMouseDown=!1):this.tool==="stamp"&&this.handleStampClick(i.x,i.y,e.button===2)}}}handleMouseMove(e){const n=this.mapCanvas.getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top;if(this.isPanning&&this.spacePressed){const i=r-this.lastPanX,l=s-this.lastPanY;this.setPan(i,l),this.lastPanX=r,this.lastPanY=s}else{const i=this.screenToTile(r,s);i&&(this.hoverX=i.x,this.hoverY=i.y,this.updateCursorForHover(),this.tool==="stamp"&&this.currentStampMode==="place"&&this.activeStamp&&(this.stampPreview.x=i.x,this.stampPreview.y=i.y,this.stampPreview.visible=!0),this.isMouseDown&&!this.spacePressed&&(this.isDraggingHero?this.setHeroPosition(i.x,i.y):this.isDraggingActor?this.handleActorDrag(i.x,i.y):this.tool==="tiles"?this.handleTileClick(i.x,i.y,!1):this.isSelecting?this.handleSelectionDrag(i.x,i.y):this.isDrawingShape&&this.handleShapeDrag(i.x,i.y)))}this.draw()}handleMouseUp(){this.isSelecting?this.handleSelectionEnd():this.isDrawingShape&&this.handleShapeEnd(),this.isDraggingHero&&(this.isDraggingHero=!1),this.isDraggingActor&&(this.isDraggingActor=!1,this.draggingActorId=null),this.isMouseDown=!1,this.isPanning=!1}handleMouseLeave(){this.hideObjectTooltip(),this.hoverX=-1,this.hoverY=-1,this.isDraggingActor=!1,this.draggingActorId=null,this.draw()}handleHeroClick(e,n,r){const s=Date.now();s-this.heroLastClickTime<300?this.openHeroEditDialog():this.isDraggingHero=!0,this.heroLastClickTime=s}openHeroEditDialog(){this.heroEditCallback?this.heroEditCallback(this.heroX,this.heroY,this.mapWidth,this.mapHeight,(e,n)=>{this.setHeroPosition(e,n)}):alert(`Hero position: (${this.heroX}, ${this.heroY}). Set up hero edit dialog in React component.`)}handleWheel(e){e.preventDefault();const n=e.deltaY>0?.9:1.1;this.setZoom(this.zoom*n)}handleKeyDown(e){if(e.code==="Space"&&(e.preventDefault(),this.spacePressed=!0,this.mapCanvas.style.cursor="grab"),e.ctrlKey||e.metaKey)switch(e.code){case"KeyZ":e.preventDefault(),e.shiftKey?this.redo():this.undo();break;case"KeyY":e.preventDefault(),this.redo();break;case"KeyA":e.preventDefault(),this.selectAll();break}switch(e.code){case"Delete":case"Backspace":e.preventDefault(),this.deleteSelection();break;case"Escape":e.preventDefault(),this.clearSelection(),this.isDrawingShape&&(this.shapeDrawing.active=!1,this.isDrawingShape=!1,this.shapeDrawing.preview=[],this.draw());break}}handleKeyUp(e){e.code==="Space"&&(e.preventDefault(),this.spacePressed=!1,this.mapCanvas.style.cursor="crosshair")}screenToTile(e,n){const r=this.screenToWorld(e,n);return this.raycastToTile(r.x,r.y)}handleStampClick(e,n,r){if(r){this.stampPreview.visible=!1,this.draw();return}this.currentStampMode==="create"?this.handleSelectionStart(e,n,r):this.currentStampMode==="place"&&this.activeStamp&&this.placeStamp(e,n)}handleTileClick(e,n,r){if(this.activeLayerId!==null){const s=this.tileLayers.find(i=>i.id===this.activeLayerId);if(s){const i=n*this.mapWidth+e,l=s.data[i];let a;const c=this.getCurrentLayerActiveGid();if(r)a=0;else switch(this.currentTool){case"brush":if(c===0)return;a=c;break;case"eraser":a=0;break;case"bucket":if(c===0)return;l!==c&&(this.saveState(),this.bucketFill(s,e,n,c),this.markAsChanged(),this.draw());return;default:if(c===0)return;a=c;break}l!==a&&(this.saveState(),console.log(`Painting on layer: ${s.name} (ID: ${s.id}, Type: ${s.type})`),console.log(`Position: (${e}, ${n}), Index: ${i}`),console.log(`Current value: ${l}, New value: ${a}`),console.log(`Active GID for this layer: ${c}`),s.data[i]=a,(s.type==="event"||s.type==="enemy"||s.type==="npc"||s.type==="object")&&(a>0?this.createObjectFromTile(e,n,s.type,a):this.removeObjectAtPosition(e,n)),this.markAsChanged(),this.draw())}}}handleSelectionStart(e,n,r){if(r){this.clearSelection();return}const s=this.tileLayers.find(i=>i.id===this.activeLayerId);s&&(this.selection.startX=e,this.selection.startY=n,this.selection.endX=e,this.selection.endY=n,this.currentSelectionTool==="magic-wand"?(this.selectMagicWand(s,e,n),this.draw()):this.currentSelectionTool==="same-tile"?(this.selectSameTile(s,e,n),this.draw()):this.isSelecting=!0)}handleSelectionDrag(e,n){this.isSelecting&&(this.selection.endX=e,this.selection.endY=n,this.draw())}handleSelectionEnd(){if(!this.isSelecting)return;const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&(this.currentSelectionTool==="rectangular"?this.selectRectangular(e,this.selection.startX,this.selection.startY,this.selection.endX,this.selection.endY):this.currentSelectionTool==="circular"&&this.selectCircular(e,this.selection.startX,this.selection.startY,this.selection.endX,this.selection.endY),this.isSelecting=!1,this.draw())}handleShapeStart(e,n,r){if(r){this.shapeDrawing.active=!1,this.isDrawingShape=!1,this.draw();return}this.shapeDrawing.active=!0,this.shapeDrawing.startX=e,this.shapeDrawing.startY=n,this.shapeDrawing.endX=e,this.shapeDrawing.endY=n,this.shapeDrawing.preview=[],this.isDrawingShape=!0}handleShapeDrag(e,n){if(this.isDrawingShape){switch(this.shapeDrawing.endX=e,this.shapeDrawing.endY=n,this.currentShapeTool){case"rectangle":this.shapeDrawing.preview=this.drawRectangleShape(this.shapeDrawing.startX,this.shapeDrawing.startY,this.shapeDrawing.endX,this.shapeDrawing.endY);break;case"circle":this.shapeDrawing.preview=this.drawCircleShape(this.shapeDrawing.startX,this.shapeDrawing.startY,this.shapeDrawing.endX,this.shapeDrawing.endY);break;case"line":this.shapeDrawing.preview=this.drawLineShape(this.shapeDrawing.startX,this.shapeDrawing.startY,this.shapeDrawing.endX,this.shapeDrawing.endY);break}this.draw()}}handleShapeEnd(){if(!this.isDrawingShape)return;const e=this.tileLayers.find(r=>r.id===this.activeLayerId);if(!e)return;const n=this.getCurrentLayerActiveGid();this.shapeDrawing.preview.length>0&&n>0&&(this.saveState(),this.shapeDrawing.preview.forEach(r=>{const s=r.y*this.mapWidth+r.x;e.data[s]=n}),this.markAsChanged()),this.shapeDrawing.active=!1,this.isDrawingShape=!1,this.shapeDrawing.preview=[],this.draw()}handleEyedropper(e,n){const r=this.tileLayers.find(s=>s.id===this.activeLayerId);if(!r)return null;if(e>=0&&e<this.mapWidth&&n>=0&&n<this.mapHeight){const s=n*this.mapWidth+e,i=r.data[s];if(i>0)return this.setCurrentLayerActiveGid(i),this.updateTilePaletteSelection(),this.tool="tiles",this.currentTool="brush",this.mapCanvas.style.cursor="crosshair",this.eyedropperCallback&&this.eyedropperCallback(),i}return null}updateTilePaletteSelection(){const e=document.getElementById("activeGid");e&&(e.textContent=this.activeGid.toString()),document.querySelectorAll(".tile-palette .tile").forEach((r,s)=>{const i=r;s===this.activeGid-1?(i.classList.add("selected"),i.scrollIntoView({behavior:"smooth",block:"nearest"})):i.classList.remove("selected")})}draw(){this.ctx.clearRect(0,0,this.mapCanvas.width,this.mapCanvas.height),this.ctx.save(),this.drawGrid(),this.drawTiles(),this.hoverX>=0&&this.hoverY>=0&&this.drawHover(),this.drawSelection(),this.drawHeroPosition(),this.drawActorPlaceholders(),this.drawShapePreview(),this.ctx.restore(),this.drawMiniMap(),this.drawStampPreview(),this.drawDebugInfo()}mapToScreen(e,n){const r=(e-n)*(this.tileSizeX/2),s=(e+n)*(this.tileSizeY/2),i=this.mapCanvas.width/2+this.panX,l=100+this.panY;return{x:(r+i)*this.zoom,y:(s+l)*this.zoom}}screenToMap(e,n){const r=e/this.zoom,s=n/this.zoom,i=this.mapCanvas.width/2+this.panX,l=100+this.panY,a=r-i,c=s-l,u=a-this.tileSizeX/2,h=c-this.tileSizeY/2,f=this.tileSizeX/2,p=this.tileSizeY/2,w=(u/f+h/p)/2,b=(h/p-u/f)/2;return{x:Math.floor(w),y:Math.floor(b)}}screenToWorld(e,n){const r=e/this.zoom,s=n/this.zoom,i=this.mapCanvas.width/2+this.panX,l=100+this.panY;return{x:r-i,y:s-l}}raycastToTile(e,n){const r=[],s=this.worldToScreen(e,n);for(let i=0;i<this.mapHeight;i++)for(let l=0;l<this.mapWidth;l++)if(this.isPointInTileDiamond(e,n,l,i)){const a=this.mapToScreen(l,i),c=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));r.push({x:l,y:i,distance:c})}return r.length>0?(r.sort((i,l)=>i.distance-l.distance),{x:r[0].x,y:r[0].y}):null}isPointInTileDiamond(e,n,r,s){const i=this.mapToScreen(r,s),l=this.worldToScreen(e,n),a=l.x-i.x,c=l.y-i.y,u=this.tileSizeX/2*this.zoom,h=this.tileSizeY/2*this.zoom,f=.9,p=Math.abs(a/u),w=Math.abs(c/h);return p+w<=f}tileToWorld(e,n){return{x:(e-n)*(this.tileSizeX/2),y:(e+n)*(this.tileSizeY/2)}}worldToScreen(e,n){const r=this.mapCanvas.width/2+this.panX,s=100+this.panY;return{x:(e+r)*this.zoom,y:(n+s)*this.zoom}}drawDebugInfo(){if(this.debugMode){this.ctx.strokeStyle="rgba(255, 0, 0, 0.5)",this.ctx.lineWidth=1;for(let e=0;e<this.mapHeight;e++)for(let n=0;n<this.mapWidth;n++){const r=this.mapToScreen(n,e),s=this.tileSizeX/2*this.zoom,i=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.strokeStyle="rgba(0, 255, 0, 0.5)",this.ctx.lineWidth=1;const l=this.tileSizeX*this.zoom,a=this.tileSizeY*this.zoom,c=r.y+i,u=r.x-l/2,h=c-a;this.ctx.strokeRect(u,h,l,a),this.ctx.strokeStyle="rgba(255, 0, 0, 0.5)",this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.font="10px Arial",this.ctx.textAlign="center",this.ctx.fillText(`${n},${e}`,r.x,r.y)}}}toggleDebugMode(){this.debugMode=!this.debugMode,this.draw()}getDebugMode(){return this.debugMode}setZoom(e){this.zoom=Math.max(.1,Math.min(5,e)),this.draw()}getZoom(){return this.zoom}zoomIn(){this.setZoom(this.zoom*1.2)}zoomOut(){this.setZoom(this.zoom/1.2)}resetZoom(){this.zoom=1,this.panX=0,this.panY=0,this.draw()}toggleMinimap(){this.showMinimap=!this.showMinimap,this.draw()}setSidebarTransitioning(e){this.sidebarTransitioning=!!e,this.sidebarTransitioning||(this.lastMiniMapPos=null)}setPan(e,n){this.panX+=e,this.panY+=n,this.draw()}resizeCanvasToContainer(){this.resizeCanvas()}drawGrid(){this.ctx.strokeStyle=this.isDarkMode?"#666":"#999",this.ctx.lineWidth=Math.max(1,Math.min(3,2/this.zoom)),this.ctx.globalAlpha=.8;for(let e=0;e<this.mapHeight;e++)for(let n=0;n<this.mapWidth;n++){const r=this.mapToScreen(n,e),s=this.tileSizeX/2*this.zoom,i=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke()}this.ctx.globalAlpha=1}drawTiles(){const e=[...this.tileLayers].reverse();for(const n of e){if(!n.visible)continue;const r=this.layerTilesets.get(n.type);if(!r||!r.image)continue;this.ctx.globalAlpha=n.transparency||1;const s=this.layerTileData.get(n.type)||new Map;for(let i=0;i<this.mapHeight;i++)for(let l=0;l<this.mapWidth;l++){const a=i*this.mapWidth+l,c=n.data[a];c>0&&this.drawTileFromLayer(l,i,c,r,s)}}this.ctx.globalAlpha=1}drawTileFromLayer(e,n,r,s,i){if(!s.image||r<=0)return;const l=i.get(r);let a,c,u,h;if(l)a=l.sourceX,c=l.sourceY,u=l.width,h=l.height;else{const g=r-1;a=g%s.columns*this.tileSizeX,c=Math.floor(g/s.columns)*this.tileSizeY,u=this.tileSizeX,h=this.tileSizeY}const f=this.mapToScreen(e,n),p=u*this.zoom,w=h*this.zoom,b=this.tileSizeY/2*this.zoom,j=f.y+b,S=f.x-p/2,y=j-w;this.ctx.drawImage(s.image,a,c,u,h,S,y,p,w)}drawTile(e,n,r){if(!this.tilesetImage||r<=0)return;const s=this.detectedTileData.get(r);let i,l,a,c;if(s)i=s.sourceX,l=s.sourceY,a=s.width,c=s.height;else{const S=r-1;i=S%this.tilesetColumns*this.tileSizeX,l=Math.floor(S/this.tilesetColumns)*this.tileSizeY,a=this.tileSizeX,c=this.tileSizeY}const u=this.mapToScreen(e,n),h=a*this.zoom,f=c*this.zoom,p=this.tileSizeY/2*this.zoom,w=u.y+p,b=u.x-h/2,j=w-f;this.ctx.drawImage(this.tilesetImage,i,l,a,c,b,j,h,f)}drawHover(){const e=this.mapToScreen(this.hoverX,this.hoverY),n=this.tileSizeX/2*this.zoom,r=this.tileSizeY/2*this.zoom,s=this.getActiveLayer();s&&["enemy","npc","object","event","background"].includes(s.type)&&this.getObjectsAtPosition(this.hoverX,this.hoverY).length>0?(this.ctx.save(),[{color:"rgba(255, 107, 0, 0.1)",width:8},{color:"rgba(255, 107, 0, 0.2)",width:6},{color:"rgba(255, 107, 0, 0.3)",width:4},{color:"rgba(255, 107, 0, 0.5)",width:2}].forEach(c=>{this.ctx.strokeStyle=c.color,this.ctx.lineWidth=Math.max(1,Math.min(c.width,c.width/this.zoom)),this.ctx.shadowColor="#ff6b00",this.ctx.shadowBlur=Math.max(2,Math.min(10,c.width/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.strokeStyle="#ff6b00",this.ctx.lineWidth=Math.max(1,Math.min(3,3/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()):(this.ctx.strokeStyle="#007acc",this.ctx.lineWidth=Math.max(1,Math.min(3,2/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke())}drawSelection(){this.isSelecting&&(this.currentSelectionTool==="rectangular"||this.currentSelectionTool==="circular")&&(this.ctx.strokeStyle="#ff6b00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.setLineDash([5,5]),this.currentSelectionTool==="rectangular"?this.drawRectangularSelectionPreview():this.currentSelectionTool==="circular"&&this.drawCircularSelectionPreview(),this.ctx.setLineDash([])),this.selection.active&&this.selection.tiles.length>0&&(this.ctx.strokeStyle="#00ff00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.selection.tiles.forEach(e=>{const n=this.mapToScreen(e.x,e.y),r=this.tileSizeX/2*this.zoom,s=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(n.x,n.y-s),this.ctx.lineTo(n.x+r,n.y),this.ctx.lineTo(n.x,n.y+s),this.ctx.lineTo(n.x-r,n.y),this.ctx.closePath(),this.ctx.stroke()}))}drawRectangularSelectionPreview(){const e=Math.min(this.selection.startX,this.selection.endX),n=Math.max(this.selection.startX,this.selection.endX),r=Math.min(this.selection.startY,this.selection.endY),s=Math.max(this.selection.startY,this.selection.endY);for(let i=r;i<=s;i++)for(let l=e;l<=n;l++)if(l>=0&&l<this.mapWidth&&i>=0&&i<this.mapHeight){const a=this.mapToScreen(l,i),c=this.tileSizeX/2*this.zoom,u=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(a.x,a.y-u),this.ctx.lineTo(a.x+c,a.y),this.ctx.lineTo(a.x,a.y+u),this.ctx.lineTo(a.x-c,a.y),this.ctx.closePath(),this.ctx.stroke()}}drawCircularSelectionPreview(){const e=Math.sqrt(Math.pow(this.selection.endX-this.selection.startX,2)+Math.pow(this.selection.endY-this.selection.startY,2));for(let n=0;n<this.mapHeight;n++)for(let r=0;r<this.mapWidth;r++)if(Math.sqrt(Math.pow(r-this.selection.startX,2)+Math.pow(n-this.selection.startY,2))<=e){const i=this.mapToScreen(r,n),l=this.tileSizeX/2*this.zoom,a=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y-a),this.ctx.lineTo(i.x+l,i.y),this.ctx.lineTo(i.x,i.y+a),this.ctx.lineTo(i.x-l,i.y),this.ctx.closePath(),this.ctx.stroke()}}drawShapePreview(){!this.isDrawingShape||this.shapeDrawing.preview.length===0||(this.ctx.strokeStyle="#0099ff",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.setLineDash([3,3]),this.shapeDrawing.preview.forEach(e=>{const n=this.mapToScreen(e.x,e.y),r=this.tileSizeX/2*this.zoom,s=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(n.x,n.y-s),this.ctx.lineTo(n.x+r,n.y),this.ctx.lineTo(n.x,n.y+s),this.ctx.lineTo(n.x-r,n.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.setLineDash([]))}drawHeroPosition(){const e=this.mapToScreen(this.heroX,this.heroY),n=this.tileSizeX/2*this.zoom,r=this.tileSizeY/2*this.zoom;this.ctx.save(),this.hoverX===this.heroX&&this.hoverY===this.heroY&&[{color:"rgba(255, 107, 0, 0.1)",width:8},{color:"rgba(255, 107, 0, 0.2)",width:6},{color:"rgba(255, 107, 0, 0.3)",width:4},{color:"rgba(255, 107, 0, 0.5)",width:2}].forEach(l=>{this.ctx.strokeStyle=l.color,this.ctx.lineWidth=Math.max(1,Math.min(l.width,l.width/this.zoom)),this.ctx.shadowColor="#ff6b00",this.ctx.shadowBlur=Math.max(2,Math.min(10,l.width/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.fillStyle="#ff6b00",this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.fill(),this.ctx.strokeStyle="#ff8c00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-r),this.ctx.lineTo(e.x+n,e.y),this.ctx.lineTo(e.x,e.y+r),this.ctx.lineTo(e.x-n,e.y),this.ctx.closePath(),this.ctx.stroke(),this.drawHeroIcon(e.x,e.y),this.ctx.restore()}drawHeroIcon(e,n){const s=Math.max(12,Math.min(20,16*this.zoom))/2;this.ctx.save(),this.ctx.fillStyle="#ffffff",this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1.5,this.ctx.beginPath(),this.ctx.arc(e,n-s*.6,s*.25,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.roundRect(e-s*.3,n-s*.2,s*.6,s*.8,s*.15),this.ctx.fill(),this.ctx.restore()}getActorLayerType(e){return e.type==="npc"||e.category==="npc"?"npc":e.type==="enemy"||e.category==="enemy"||e.category==="creature"||e.type==="creature"?e.category==="npc"?"npc":"enemy":null}getActorLayerByType(e){return this.tileLayers.find(n=>n.type===e)||null}actorUsesPlaceholder(e){const n=this.getActorLayerType(e);if(!n)return!1;const r=this.getActorLayerByType(n);if(!r)return!1;const s=e.y*this.mapWidth+e.x;return s<0||s>=r.data.length?!1:r.data[s]===0}drawActorPlaceholders(){for(const e of this.objects){if(!this.actorUsesPlaceholder(e))continue;const n=this.getActorLayerType(e);n&&this.drawActorPlaceholder(e,n)}}drawActorPlaceholder(e,n){const r=this.mapToScreen(e.x,e.y),s=this.tileSizeX/2*this.zoom,i=this.tileSizeY/2*this.zoom;this.ctx.save();const l=this.hoverX===e.x&&this.hoverY===e.y,a=this.isDraggingActor&&this.draggingActorId===e.id;(l||a)&&[{color:"rgba(255, 107, 0, 0.1)",width:8},{color:"rgba(255, 107, 0, 0.2)",width:6},{color:"rgba(255, 107, 0, 0.3)",width:4},{color:"rgba(255, 107, 0, 0.5)",width:2}].forEach(u=>{this.ctx.strokeStyle=u.color,this.ctx.lineWidth=Math.max(1,Math.min(u.width,u.width/this.zoom)),this.ctx.shadowColor="#ff6b00",this.ctx.shadowBlur=Math.max(2,Math.min(10,u.width/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke()}),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.fillStyle="#ff6b00",this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.fill(),this.ctx.strokeStyle="#ff8c00",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y-i),this.ctx.lineTo(r.x+s,r.y),this.ctx.lineTo(r.x,r.y+i),this.ctx.lineTo(r.x-s,r.y),this.ctx.closePath(),this.ctx.stroke(),this.drawActorIcon(r.x,r.y,n),this.ctx.restore()}drawActorIcon(e,n,r){const s=Math.max(10,Math.min(18,14*this.zoom)),i=r==="npc"?"N":"E";this.ctx.save(),this.ctx.fillStyle="#ffffff",this.ctx.font=`bold ${s}px "Segoe UI", sans-serif`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(i,e,n),this.ctx.restore()}drawStampPreview(){if(!(!this.stampPreview.visible||!this.activeStamp)){this.ctx.strokeStyle="#00ff00",this.ctx.fillStyle="rgba(0, 255, 0, 0.2)",this.ctx.lineWidth=Math.max(1,Math.min(2,2/this.zoom)),this.ctx.setLineDash([3,3]);for(let e=0;e<this.activeStamp.height;e++)for(let n=0;n<this.activeStamp.width;n++){const r=this.stampPreview.x+n,s=this.stampPreview.y+e;if(r>=0&&r<this.mapWidth&&s>=0&&s<this.mapHeight){const i=this.mapToScreen(r,s),l=this.tileSizeX/2*this.zoom,a=this.tileSizeY/2*this.zoom;this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y-a),this.ctx.lineTo(i.x+l,i.y),this.ctx.lineTo(i.x,i.y+a),this.ctx.lineTo(i.x-l,i.y),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()}}this.ctx.setLineDash([])}}drawMiniMap(){if(!this.showMinimap)return;const e=150,n=120,r=10,s=this.mapCanvas.getBoundingClientRect(),i=window.innerWidth-e-r,l=window.innerHeight-n-r;let a=Math.floor(i-s.left),c=Math.floor(l-s.top);a=Math.max(0,Math.min(this.mapCanvas.width-e,a)),c=Math.max(0,Math.min(this.mapCanvas.height-n,c)),this.lastMiniMapPos={x:a,y:c},this.ctx.save();const u=5,h=a-u,f=c-u,p=e+u*2,w=n+u*2,b=Math.min(12,Math.floor(Math.min(p,w)/6)),j=Math.min(8,Math.floor(Math.min(e,n)/8)),S=(E,O,A,X,V)=>{const te=Math.max(0,Math.min(V,Math.min(A,X)/2));this.ctx.beginPath(),this.ctx.moveTo(E+te,O),this.ctx.lineTo(E+A-te,O),this.ctx.quadraticCurveTo(E+A,O,E+A,O+te),this.ctx.lineTo(E+A,O+X-te),this.ctx.quadraticCurveTo(E+A,O+X,E+A-te,O+X),this.ctx.lineTo(E+te,O+X),this.ctx.quadraticCurveTo(E,O+X,E,O+X-te),this.ctx.lineTo(E,O+te),this.ctx.quadraticCurveTo(E,O,E+te,O),this.ctx.closePath()};this.ctx.fillStyle=this.isDarkMode?"rgba(42, 42, 42, 0.9)":"rgba(0, 0, 0, 0.7)",S(h,f,p,w,b),this.ctx.fill(),this.ctx.fillStyle=this.isDarkMode?"#2a2a2a":"#f0f0f0",S(a,c,e,n,j),this.ctx.fill(),this.ctx.strokeStyle=this.isDarkMode?"#999":"#333",this.ctx.lineWidth=1,S(a,c,e,n,j),this.ctx.stroke();const y=Math.floor(e/this.mapWidth)||1,g=Math.floor(n/this.mapHeight)||1,x=Math.max(1,Math.min(y,g)),v=this.mapWidth*x,N=this.mapHeight*x,T=a+Math.floor((e-v)/2),P=c+Math.floor((n-N)/2);this.ctx.imageSmoothingEnabled=!1;for(let E=0;E<this.tileLayers.length;E++){const O=this.tileLayers[E];if(O.visible)for(let A=0;A<this.mapHeight;A++)for(let X=0;X<this.mapWidth;X++){const V=A*this.mapWidth+X,te=O.data[V];if(te>0){const U=T+X*x,re=P+A*x,ye=te*137.5%360;this.ctx.fillStyle=`hsl(${ye}, 55%, ${E===0?"45%":"60%"})`,this.ctx.fillRect(U,re,x,x)}}}if(x>=3){this.ctx.strokeStyle=this.isDarkMode?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.05)",this.ctx.lineWidth=.5;for(let E=0;E<this.mapHeight;E++)for(let O=0;O<this.mapWidth;O++){const A=T+O*x+.25,X=P+E*x+.25;this.ctx.strokeRect(A,X,x-.5,x-.5)}}this.ctx.restore()}handleFileUpload(e,n){if(n==="tileset"){const r=new FileReader;r.onload=s=>{var l;const i=new Image;i.onload=()=>{this.tilesetImage=i,this.tilesetFileName=e.name,this.tilesetColumns=Math.floor(i.width/this.tileSizeX),this.tilesetRows=Math.floor(i.height/this.tileSizeY),this.tileCount=this.tilesetColumns*this.tilesetRows,this.createTilePalette(),this.draw()},i.src=(l=s.target)==null?void 0:l.result},r.readAsDataURL(e)}else if(n==="layerTileset"){const r=this.tileLayers.find(s=>s.id===this.activeLayerId);r&&this.setLayerTileset(r.type,e)}}createTilePalette(e=!1){const n=document.getElementById("tilesContainer");if(!n||!this.tilesetImage)return;n.innerHTML="";let r;if(e&&this.detectedTileData.size>0)r=Array.from(this.detectedTileData.entries()).map(([l,a])=>({index:l,sourceX:a.sourceX,sourceY:a.sourceY,width:a.width,height:a.height}));else{this.detectedTileData.clear(),r=this.detectVariableSizedTiles().map(c=>(this.detectedTileData.set(c.index,{sourceX:c.sourceX,sourceY:c.sourceY,width:c.width,height:c.height}),c));const a=this.tileLayers.find(c=>c.id===this.activeLayerId);if(a){const c=new Map;for(const[u,h]of this.detectedTileData.entries())c.set(u,h);this.layerTileData.set(a.type,c),console.log(`Stored ${c.size} newly detected tiles for layer type: ${a.type}`)}}let s=0;const i=()=>document.getElementById("brushToolState")||document.querySelector("[data-brush-tool]");for(const l of r){const a=document.createElement("canvas");a.width=l.width,a.height=l.height,a.width=l.width,a.height=l.height,a.className="palette-tile",a.style.setProperty("--tile-width",`${l.width}px`),a.style.setProperty("--tile-height",`${l.height}px`);const c=a.getContext("2d");c&&c.drawImage(this.tilesetImage,l.sourceX,l.sourceY,l.width,l.height,0,0,l.width,l.height);const u=document.createElement("div");u.className="brush-wrapper",u.style.position="relative",u.style.display="inline-block",u.style.margin="2px";const h=document.createElement("div");h.className="selection-number",h.style.position="absolute",h.style.top="2px",h.style.left="2px",h.style.background="red",h.style.color="white",h.style.borderRadius="50%",h.style.width="16px",h.style.height="16px",h.style.fontSize="10px",h.style.display="none",h.style.alignItems="center",h.style.justifyContent="center",h.style.fontWeight="bold",h.style.zIndex="10";const f=document.createElement("div");f.className="remove-overlay",f.style.position="absolute",f.style.top="0",f.style.left="0",f.style.right="0",f.style.bottom="0",f.style.background="rgba(255, 0, 0, 0.7)",f.style.display="none",f.style.alignItems="center",f.style.justifyContent="center",f.style.fontSize="24px",f.style.color="white",f.style.cursor="pointer",f.style.zIndex="10",f.textContent="✕";const p=document.createElement("div");p.className="separate-icon",p.style.position="absolute",p.style.top="50%",p.style.left="50%",p.style.transform="translate(-50%, -50%)",p.style.display="none",p.style.alignItems="center",p.style.justifyContent="center",p.style.background="none",p.style.color="white",p.style.zIndex="2",p.style.pointerEvents="none",p.style.width="24px",p.style.height="24px",p.innerHTML=`
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="6" cy="6" r="3"></circle>
          <circle cx="6" cy="18" r="3"></circle>
          <line x1="20" y1="4" x2="8.12" y2="15.88"></line>
          <line x1="14.47" y1="14.48" x2="20" y2="20"></line>
          <line x1="8.12" y1="8.12" x2="12" y2="12"></line>
        </svg>
      `;const w=document.createElement("div");w.className="merge-icon",w.style.position="absolute",w.style.top="50%",w.style.left="50%",w.style.transform="translate(-50%, -50%)",w.style.display="none",w.style.alignItems="center",w.style.justifyContent="center",w.style.background="none",w.style.color="white",w.style.zIndex="2",w.style.pointerEvents="none",w.style.width="24px",w.style.height="24px",w.innerHTML=`
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m8 6 4-4 4 4"></path>
          <path d="M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22"></path>
          <path d="m20 22-6.828-6.828A4 4 0 0 1 12 12.3"></path>
        </svg>
      `,f.addEventListener("click",y=>{y.preventDefault(),y.stopPropagation(),console.log(`Remove overlay clicked for tile index: ${l.index}`),this.handleBrushRemove(l.index)}),a.addEventListener("click",y=>{y.preventDefault();const g=i(),x=(g==null?void 0:g.getAttribute("data-brush-tool"))||"none";console.log(`Tile clicked! Index: ${l.index}, Current brush tool: ${x}`),x==="merge"?(console.log("Handling merge tool selection"),this.handleBrushMerge(l.index,u)):x==="separate"?(console.log("Handling separate tool"),this.handleBrushSeparate(l.index)):x==="remove"?(console.log("Handling remove tool"),this.handleBrushRemove(l.index)):(console.log("Normal tile selection"),this.setCurrentLayerActiveGid(l.index),this.updateActiveTile())}),u.draggable=!1,u.addEventListener("dragstart",y=>{const g=i();((g==null?void 0:g.getAttribute("data-brush-tool"))||"none")==="move"?(u.style.opacity="0.5",y.dataTransfer.effectAllowed="move",y.dataTransfer.setData("text/plain",l.index.toString()),this.dispatchBrushEvent("dragstart",l.index)):y.preventDefault()}),u.addEventListener("dragend",y=>{u.style.opacity="1",this.dispatchBrushEvent("dragend",l.index)}),u.addEventListener("dragover",y=>{const g=i();((g==null?void 0:g.getAttribute("data-brush-tool"))||"none")==="move"&&(y.preventDefault(),y.dataTransfer.dropEffect="move",u.style.borderTop="3px solid #007acc")}),u.addEventListener("dragleave",y=>{u.style.borderTop=""}),u.addEventListener("drop",y=>{y.preventDefault(),u.style.borderTop="";const g=i();if(((g==null?void 0:g.getAttribute("data-brush-tool"))||"none")==="move"){const v=parseInt(y.dataTransfer.getData("text/plain")),N=l.index;v!==N&&this.dispatchBrushEvent("drop",{from:v,to:N})}});const b=()=>{const y=i(),g=(y==null?void 0:y.getAttribute("data-brush-tool"))||"none";u.classList.remove("separate-mode","merge-mode","merge-selected-first","merge-selected-second"),u.draggable=!1,u.style.cursor="",u.title="",u.setAttribute("data-tile-index",l.index.toString()),g==="move"?(u.draggable=!0,u.style.cursor="move",u.title="Drag to reorder"):g==="separate"?(u.classList.add("separate-mode"),u.style.cursor="pointer",u.title="Click to separate"):g==="merge"&&(u.classList.add("merge-mode"),u.style.cursor="pointer",u.title="Click to merge (max 2 brushes)")};b();const j=new MutationObserver(()=>{b()}),S=i();S&&j.observe(S,{attributes:!0,attributeFilter:["data-brush-tool"]}),u.addEventListener("mouseenter",()=>{const y=document.querySelector("[data-brush-tool]");((y==null?void 0:y.getAttribute("data-brush-tool"))||"none")==="remove"&&(f.style.display="flex")}),u.addEventListener("mouseleave",()=>{f.style.display="none"}),a.setAttribute("data-tile-index",l.index.toString()),a.setAttribute("data-tile-width",l.width.toString()),a.setAttribute("data-tile-height",l.height.toString()),a.setAttribute("data-source-x",l.sourceX.toString()),a.setAttribute("data-source-y",l.sourceY.toString()),u.appendChild(a),u.appendChild(h),u.appendChild(f),u.appendChild(p),u.appendChild(w),n.appendChild(u),s++}console.log(`Created ${s} variable-sized tiles from tileset`)}handleBrushMerge(e,n){const r=document.querySelector(".merge-selected-first"),s=document.querySelector(".merge-selected-second");if(n.classList.contains("merge-selected-first")||n.classList.contains("merge-selected-second")){n.classList.remove("merge-selected-first","merge-selected-second");return}if(!r)n.classList.add("merge-selected-first");else if(!s)n.classList.add("merge-selected-second"),setTimeout(()=>{const i=parseInt(r.getAttribute("data-tile-index")||"0");this.performMerge(i,e),r.classList.remove("merge-selected-first"),n.classList.remove("merge-selected-second")},300);else return}performMerge(e,n){console.log(`Merging tiles ${e} and ${n}`);try{this.mergeBrushes([e,n]),console.log(`Successfully merged brushes ${e} and ${n}`)}catch(r){console.error("Failed to merge brushes:",r)}}handleBrushSeparate(e){this.dispatchBrushEvent("separate",e)}handleBrushRemove(e){console.log(`handleBrushRemove called with tileIndex: ${e}`),this.dispatchBrushEvent("remove",e)}dispatchBrushEvent(e,n){const r=new CustomEvent("brushAction",{detail:typeof n=="number"?{action:e,tileIndex:n}:{action:e,...n}});document.dispatchEvent(r)}detectVariableSizedTiles(){if(!this.tilesetImage)return[];const e=[],n=document.createElement("canvas");n.width=this.tilesetImage.width,n.height=this.tilesetImage.height;const r=n.getContext("2d");if(!r)return[];r.drawImage(this.tilesetImage,0,0);const i=r.getImageData(0,0,this.tilesetImage.width,this.tilesetImage.height).data,l=new Array(this.tilesetImage.width*this.tilesetImage.height).fill(!1);let a=1;const c=[];for(let u=0;u<this.tilesetImage.height;u++)for(let h=0;h<this.tilesetImage.width;h++){const f=u*this.tilesetImage.width+h;if(l[f]||this.isPixelTransparent(i,h,u,this.tilesetImage.width))continue;const p=this.floodFillObjectData(i,this.tilesetImage.width,this.tilesetImage.height,h,u,l);p&&this.isValidObjectSize(p.bounds)&&c.push(p)}for(const u of c){const h=this.intelligentObjectSplit(u);for(const f of h)e.push({index:a++,sourceX:f.x,sourceY:f.y,width:f.width,height:f.height})}return e}isPixelTransparent(e,n,r,s){const i=(r*s+n)*4+3;return e[i]<=this.tileContentThreshold}floodFillObjectData(e,n,r,s,i,l){const a=[{x:s,y:i}];let c=s,u=s,h=i,f=i,p=0;const w=[];for(;a.length>0;){const x=a.pop(),{x:v,y:N}=x;if(v<0||v>=n||N<0||N>=r)continue;const T=N*n+v;l[T]||this.isPixelTransparent(e,v,N,n)||(l[T]=!0,p++,w.push({x:v,y:N}),c=Math.min(c,v),u=Math.max(u,v),h=Math.min(h,N),f=Math.max(f,N),a.push({x:v+1,y:N}),a.push({x:v-1,y:N}),a.push({x:v,y:N+1}),a.push({x:v,y:N-1}),a.push({x:v+1,y:N+1}),a.push({x:v+1,y:N-1}),a.push({x:v-1,y:N+1}),a.push({x:v-1,y:N-1}))}if(p===0)return null;const b=1,j=Math.max(0,c-b),S=Math.max(0,h-b),y=Math.min(n-1,u+b),g=Math.min(r-1,f+b);return{bounds:{x:j,y:S,width:y-j+1,height:g-S+1},pixels:w}}intelligentObjectSplit(e){const{bounds:n,pixels:r}=e,{width:s,height:i}=n,l=r.length,a=s*i,c=l/a,u=Math.max(this.tileSizeX,this.tileSizeY),h=this.shouldSplitDirection(r,n,"horizontal",u),f=this.shouldSplitDirection(r,n,"vertical",u),p=this.isFloorPattern(n,r),w=this.isVerticalWall(n,r),b=this.isHorizontalWall(n,r);return console.log(`Object analysis: ${s}x${i}, density: ${c.toFixed(2)}, floor: ${p}, vWall: ${w}, hWall: ${b}`),p?(console.log("Detected floor/ground pattern - splitting into individual tiles"),this.splitObjectByGrid(e,"horizontal")):w?(console.log("Detected vertical wall/structure - keeping as single tile"),[n]):b?(console.log("Detected horizontal wall - keeping as single tile"),[n]):h&&s>this.tileSizeX*1.5?(console.log("Splitting horizontal arrangement into individual objects"),this.splitObjectByGrid(e,"horizontal")):f&&i>this.tileSizeY*1.5&&!this.isLikelySingleVerticalObject(n,r)?(console.log("Splitting vertical arrangement into individual objects"),this.splitObjectByGrid(e,"vertical")):c<.4&&a>u*u*2?(console.log("Splitting sparse large object"),this.splitObjectByDensity(e)):(s>this.tileSizeX*1.8||i>this.tileSizeY*1.8)&&!w&&!b&&c<.8?(console.log("Splitting large non-wall object into tile-sized pieces"),this.splitObjectByGrid(e,s>i?"horizontal":"vertical")):(console.log("Keeping as single object"),[n])}isVerticalWall(e,n){const{width:r,height:s}=e,i=s/r,l=n.length/(r*s);if(i<1.5||l<.5)return!1;const a=this.hasConsistentVerticalWidth(n,e),c=this.hasVerticalContinuity(n,e),u=s>this.tileSizeY*1.5&&r<=this.tileSizeX*1.2;return a&&c||u&&l>.6}isHorizontalWall(e,n){const{width:r,height:s}=e,i=r/s,l=n.length/(r*s);if(i<2||l<.6||s<this.tileSizeY*.7)return!1;const a=this.hasConsistentHorizontalHeight(n,e),c=this.hasHorizontalContinuity(n,e);return a&&c}isLikelySingleVerticalObject(e,n){const{width:r,height:s}=e;return n.length/(r*s)>.7?!0:this.hasVerticalContinuity(n,e)}hasConsistentVerticalWidth(e,n){const{y:r,height:s}=n,i=Math.max(1,Math.floor(s/5)),l=[];for(let h=0;h<5;h++){const f=r+h*i,p=Math.min(f+i,r+s);let w=Number.MAX_SAFE_INTEGER,b=Number.MIN_SAFE_INTEGER,j=!1;for(const S of e)S.y>=f&&S.y<p&&(w=Math.min(w,S.x),b=Math.max(b,S.x),j=!0);j&&l.push(b-w+1)}if(l.length<2)return!1;const a=l.reduce((h,f)=>h+f,0)/l.length,c=l.reduce((h,f)=>h+Math.pow(f-a,2),0)/l.length,u=Math.sqrt(c);return a>0&&u/a<.3}hasConsistentHorizontalHeight(e,n){const{x:r,width:s}=n,i=Math.max(1,Math.floor(s/5)),l=[];for(let h=0;h<5;h++){const f=r+h*i,p=Math.min(f+i,r+s);let w=Number.MAX_SAFE_INTEGER,b=Number.MIN_SAFE_INTEGER,j=!1;for(const S of e)S.x>=f&&S.x<p&&(w=Math.min(w,S.y),b=Math.max(b,S.y),j=!0);j&&l.push(b-w+1)}if(l.length<2)return!1;const a=l.reduce((h,f)=>h+f,0)/l.length,c=l.reduce((h,f)=>h+Math.pow(f-a,2),0)/l.length,u=Math.sqrt(c);return a>0&&u/a<.3}hasVerticalContinuity(e,n){const{y:r,height:s}=n,i=Math.max(1,Math.floor(s/10));let l=0,a=0;for(let c=r;c<r+s;c+=i){const u=Math.min(c+i,r+s);let h=!1;for(const f of e)if(f.y>=c&&f.y<u){h=!0;break}h&&l++,a++}return a>0&&l/a>=.7}hasHorizontalContinuity(e,n){const{x:r,width:s}=n,i=Math.max(1,Math.floor(s/10));let l=0,a=0;for(let c=r;c<r+s;c+=i){const u=Math.min(c+i,r+s);let h=!1;for(const f of e)if(f.x>=c&&f.x<u){h=!0;break}h&&l++,a++}return a>0&&l/a>=.7}isFloorPattern(e,n){const{width:r,height:s}=e,i=s<=this.tileSizeY*.6,l=r>this.tileSizeX*1.3,a=this.hasRepeatingHorizontalPattern(n,e),c=this.hasDiamondLikeShape(n,e);return i&&l||a&&l||c&&l}hasRepeatingHorizontalPattern(e,n){const{x:r,width:s}=n,i=this.tileSizeX,l=Math.floor(s/i);if(l<2)return!1;const a=[];for(let f=0;f<l;f++){const p=r+f*i,w=p+i;let b=0;for(const j of e)j.x>=p&&j.x<w&&b++;a.push(b)}const c=a.reduce((f,p)=>f+p,0)/a.length,u=a.reduce((f,p)=>f+Math.pow(p-c,2),0)/a.length,h=Math.sqrt(u);return c>0&&h/c<.5}hasDiamondLikeShape(e,n){const{y:r,height:s}=n,i=[];for(let f=0;f<s;f++){let p=0;for(const w of e)w.y===r+f&&p++;i.push(p)}if(i.length<3)return!1;const l=Math.floor(i.length*.2),a=Math.floor(i.length*.3),c=Math.floor(i.length*.7),u=(i.slice(0,l).reduce((f,p)=>f+p,0)+i.slice(-l).reduce((f,p)=>f+p,0))/(l*2||1);return i.slice(a,c).reduce((f,p)=>f+p,0)/(c-a||1)>u*1.2}shouldSplitDirection(e,n,r,s){const{x:i,y:l,width:a,height:c}=n;if(r==="horizontal"){const u=[],h=Math.max(1,Math.floor(a/(a/s)));for(let b=0;b<a;b+=h){let j=0;for(const S of e)S.x>=i+b&&S.x<i+b+h&&j++;u.push(j)}let f=0,p=0;const w=u.reduce((b,j)=>b+j,0)/u.length;for(let b=0;b<u.length;b++)u[b]<w*.3?f++:u[b]>w*.7&&p++;return p>=2&&f>=1}else{const u=[],h=Math.max(1,Math.floor(c/(c/s)));for(let b=0;b<c;b+=h){let j=0;for(const S of e)S.y>=l+b&&S.y<l+b+h&&j++;u.push(j)}let f=0,p=0;const w=u.reduce((b,j)=>b+j,0)/u.length;for(let b=0;b<u.length;b++)u[b]<w*.3?f++:u[b]>w*.7&&p++;return p>=2&&f>=1}}splitObjectByGrid(e,n){const{bounds:r}=e,s=[];if(n==="horizontal"){const i=this.tileSizeX;for(let l=r.x;l<r.x+r.width;l+=i){const a=this.findContentInRegion(e.pixels,{x:l,y:r.y,width:Math.min(i,r.x+r.width-l),height:r.height});a&&s.push(a)}}else{const i=this.tileSizeY;for(let l=r.y;l<r.y+r.height;l+=i){const a=this.findContentInRegion(e.pixels,{x:r.x,y:l,width:r.width,height:Math.min(i,r.y+r.height-l)});a&&s.push(a)}}return s.length>0?s:[r]}splitObjectByDensity(e){const{bounds:n}=e,r=Math.min(this.tileSizeX,this.tileSizeY),s=[];for(let i=n.y;i<n.y+n.height;i+=r)for(let l=n.x;l<n.x+n.width;l+=r){const a=this.findContentInRegion(e.pixels,{x:l,y:i,width:Math.min(r,n.x+n.width-l),height:Math.min(r,n.y+n.height-i)});a&&s.push(a)}return s.length>0?s:[n]}findContentInRegion(e,n){let r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,a=!1;for(const u of e)u.x>=n.x&&u.x<n.x+n.width&&u.y>=n.y&&u.y<n.y+n.height&&(r=Math.min(r,u.x),s=Math.max(s,u.x),i=Math.min(i,u.y),l=Math.max(l,u.y),a=!0);if(!a)return null;const c=1;return{x:Math.max(0,r-c),y:Math.max(0,i-c),width:s-r+1+c*2,height:l-i+1+c*2}}isValidObjectSize(e){var s,i;const r=Math.max(((s=this.tilesetImage)==null?void 0:s.width)||512,((i=this.tilesetImage)==null?void 0:i.height)||512);return e.width>=8&&e.height>=8&&e.width<=r&&e.height<=r&&e.width*e.height>=8*8}setObjectSeparationSensitivity(e){this.objectSeparationSensitivity=Math.max(0,Math.min(1,e))}getObjectSeparationSensitivity(){return this.objectSeparationSensitivity}tileHasContent(e){try{const r=e.getImageData(0,0,this.tileSizeX,this.tileSizeY).data;for(let s=3;s<r.length;s+=4)if(r[s]>this.tileContentThreshold)return!0;return!1}catch(n){return console.warn("Could not analyze tile content, assuming tile has content:",n),!0}}updateActiveTile(){const e=document.getElementById("activeGid");if(e&&(e.textContent=this.activeGid.toString()),document.querySelectorAll(".palette-tile").forEach(r=>r.classList.remove("selected")),this.activeGid>0){const r=document.querySelector(`.palette-tile[data-tile-index="${this.activeGid}"]`);r&&r.classList.add("selected")}}resizeMap(e,n){this.mapWidth=e,this.mapHeight=n;for(const r of this.tileLayers){const s=new Array(e*n).fill(0);for(let i=0;i<Math.min(n,this.mapHeight);i++)for(let l=0;l<Math.min(e,this.mapWidth);l++){const a=i*this.mapWidth+l,c=i*e+l;a<r.data.length&&(s[c]=r.data[a])}r.data=s}this.draw(),this.markAsChanged(!0)}addLayer(e,n){if(this.tileLayers.find(i=>i.type===n))return!1;this.saveState();const s={id:this.nextLayerId++,name:e,type:n,data:new Array(this.mapWidth*this.mapHeight).fill(0),visible:!0,transparency:1};return this.tileLayers.push(s),this.sortLayersByPriority(),this.activeLayerId=s.id,this.draw(),this.markAsChanged(!0),!0}sortLayersByPriority(){const e={npc:1,enemy:2,event:3,collision:4,object:5,background:6};this.tileLayers.sort((n,r)=>e[n.type]-e[r.type])}deleteLayer(e){if(this.tileLayers.length<=1)return!1;const n=this.tileLayers.findIndex(r=>r.id===e);return n!==-1?(this.saveState(),this.tileLayers.splice(n,1),this.activeLayerId===e&&(this.activeLayerId=this.tileLayers.length>0?this.tileLayers[0].id:null),this.draw(),this.markAsChanged(!0),!0):!1}setActiveLayer(e){this.activeLayerId=e;const n=this.tileLayers.find(r=>r.id===e);n&&this.updateCurrentTileset(n.type),this.draw()}toggleLayerVisibility(e){const n=this.tileLayers.find(r=>r.id===e);n&&(n.visible=!n.visible,this.draw())}setLayerTransparency(e,n){const r=this.tileLayers.find(s=>s.id===e);r&&(r.transparency=Math.max(0,Math.min(1,n)),this.draw())}setMapSize(e,n){this.mapWidth=e,this.mapHeight=n,this.collisionData=new Array(e*n).fill(0),this.tileLayers.forEach(r=>{const s=r.data;r.data=new Array(e*n).fill(0);for(let i=0;i<Math.min(n,15);i++)for(let l=0;l<Math.min(e,20);l++){const a=i*20+l,c=i*e+l;a<s.length&&(r.data[c]=s[a])}}),this.draw()}renameLayer(e,n){const r=this.tileLayers.find(s=>s.id===e);r&&(r.name=n)}changeLayerType(e,n,r){const s=this.tileLayers.find(i=>i.id===e);return s?(s.type=n,s.name=r,this.sortLayersByPriority(),!0):!1}setLayerType(e,n){const r=this.tileLayers.find(s=>s.id===e);r&&(r.type=n,this.sortLayersByPriority())}getLayers(){return this.tileLayers}getActiveLayerId(){return this.activeLayerId}getHoverCoordinates(){return this.hoverX>=0&&this.hoverY>=0?{x:this.hoverX,y:this.hoverY}:null}getActiveLayer(){return this.activeLayerId!==null&&this.tileLayers.find(e=>e.id===this.activeLayerId)||null}setCurrentTool(e){this.currentTool=e,this.tool="tiles"}getCurrentTool(){return this.currentTool}setCurrentSelectionTool(e){this.currentSelectionTool=e,this.tool="selection"}getCurrentSelectionTool(){return this.currentSelectionTool}setCurrentShapeTool(e){this.currentShapeTool=e,this.tool="shape"}getCurrentShapeTool(){return this.currentShapeTool}setEyedropperTool(){this.tool="eyedropper",this.mapCanvas.style.cursor="crosshair"}isEyedropperActive(){return this.tool==="eyedropper"}setEyedropperCallback(e){this.eyedropperCallback=e}setObjectsChangedCallback(e){this.objectsChangedCallback=e,e&&e(this.getMapObjects())}setStampTool(){this.tool="stamp",this.mapCanvas.style.cursor="crosshair",this.stampPreview.visible=!1}isStampActive(){return this.tool==="stamp"}setCurrentStampMode(e){this.currentStampMode=e,this.stampPreview.visible=e==="place"&&this.activeStamp!==null,this.draw()}getCurrentStampMode(){return this.currentStampMode}createStampFromSelection(e){if(!this.selection.active||this.selection.tiles.length===0)return!1;let n=1/0,r=1/0,s=-1/0,i=-1/0;for(const f of this.selection.tiles)n=Math.min(n,f.x),r=Math.min(r,f.y),s=Math.max(s,f.x),i=Math.max(i,f.y);const l=s-n+1,a=i-r+1,c=[],u=this.activeLayerId||0;for(const f of this.selection.tiles)f.gid>0&&c.push({tileId:f.gid,layerId:u,x:f.x-n,y:f.y-r});const h={id:Date.now().toString(),name:e,width:l,height:a,tiles:c};return this.stamps.set(h.id,h),this.clearSelection(),this.stampCallback&&this.stampCallback(Array.from(this.stamps.values())),!0}setActiveStamp(e){e&&this.stamps.has(e)?(this.activeStamp=this.stamps.get(e),this.currentStampMode="place",this.stampPreview.visible=!0):(this.activeStamp=null,this.stampPreview.visible=!1),this.draw()}getStamps(){return Array.from(this.stamps.values())}deleteStamp(e){return this.stamps.has(e)?(this.stamps.delete(e),this.activeStamp&&this.activeStamp.id===e&&(this.activeStamp=null,this.stampPreview.visible=!1),this.stampCallback&&this.stampCallback(Array.from(this.stamps.values())),this.draw(),!0):!1}setStampCallback(e){this.stampCallback=e}setHeroEditCallback(e){this.heroEditCallback=e}placeStamp(e,n){if(this.activeStamp&&!(e<0||n<0||e+this.activeStamp.width>this.mapWidth||n+this.activeStamp.height>this.mapHeight)){for(const r of this.activeStamp.tiles){const s=e+r.x,l=(n+r.y)*this.mapWidth+s;let a=this.tileLayers.find(c=>c.id===r.layerId);!a&&this.activeLayerId!==null&&(a=this.tileLayers.find(c=>c.id===this.activeLayerId)),a&&(a.data[l]=r.tileId)}this.saveState(),this.draw()}}clearSelection(){this.selection.active=!1,this.selection.tiles=[],this.draw()}hasActiveSelection(){return this.selection.active&&this.selection.tiles.length>0}getSelection(){return[...this.selection.tiles]}selectAll(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);if(e){this.selection.tiles=[];for(let n=0;n<this.mapHeight;n++)for(let r=0;r<this.mapWidth;r++){const s=n*this.mapWidth+r,i=e.data[s];this.selection.tiles.push({x:r,y:n,gid:i})}this.selection.active=!0,this.draw()}}deleteSelection(){if(!this.selection.active||this.selection.tiles.length===0)return;const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&(this.saveState(),this.selection.tiles.forEach(n=>{const r=n.y*this.mapWidth+n.x;e.data[r]=0}),this.clearSelection(),this.markAsChanged(),this.draw())}fillSelection(){if(!this.selection.active||this.selection.tiles.length===0||this.activeGid===0)return;const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&(this.saveState(),this.selection.tiles.forEach(n=>{const r=n.y*this.mapWidth+n.x;e.data[r]=this.activeGid}),this.markAsChanged(),this.draw())}bucketFill(e,n,r,s){const i=e.data[r*this.mapWidth+n];if(i===s)return;const l=[{x:n,y:r}],a=new Set;for(;l.length>0;){const{x:c,y:u}=l.pop(),h=u*this.mapWidth+c;c<0||c>=this.mapWidth||u<0||u>=this.mapHeight||a.has(h)||e.data[h]===i&&(a.add(h),e.data[h]=s,l.push({x:c+1,y:u}),l.push({x:c-1,y:u}),l.push({x:c,y:u+1}),l.push({x:c,y:u-1}))}}selectRectangular(e,n,r,s,i){this.selection.tiles=[];const l=Math.min(n,s),a=Math.max(n,s),c=Math.min(r,i),u=Math.max(r,i);for(let h=c;h<=u;h++)for(let f=l;f<=a;f++)if(f>=0&&f<this.mapWidth&&h>=0&&h<this.mapHeight){const p=h*this.mapWidth+f,w=e.data[p];this.selection.tiles.push({x:f,y:h,gid:w})}this.selection.active=!0}selectMagicWand(e,n,r){const s=e.data[r*this.mapWidth+n];this.selection.tiles=[];const i=[{x:n,y:r}],l=new Set;for(;i.length>0;){const{x:a,y:c}=i.pop(),u=c*this.mapWidth+a;a<0||a>=this.mapWidth||c<0||c>=this.mapHeight||l.has(u)||e.data[u]===s&&(l.add(u),this.selection.tiles.push({x:a,y:c,gid:s}),i.push({x:a+1,y:c}),i.push({x:a-1,y:c}),i.push({x:a,y:c+1}),i.push({x:a,y:c-1}))}this.selection.active=!0}selectSameTile(e,n,r){const s=e.data[r*this.mapWidth+n];this.selection.tiles=[];for(let i=0;i<this.mapHeight;i++)for(let l=0;l<this.mapWidth;l++){const a=i*this.mapWidth+l;e.data[a]===s&&this.selection.tiles.push({x:l,y:i,gid:s})}this.selection.active=!0}selectCircular(e,n,r,s,i){this.selection.tiles=[];const l=Math.sqrt(Math.pow(s-n,2)+Math.pow(i-r,2));for(let a=0;a<this.mapHeight;a++)for(let c=0;c<this.mapWidth;c++)if(Math.sqrt(Math.pow(c-n,2)+Math.pow(a-r,2))<=l){const h=a*this.mapWidth+c,f=e.data[h];this.selection.tiles.push({x:c,y:a,gid:f})}this.selection.active=!0}drawRectangleShape(e,n,r,s){const i=[],l=Math.min(e,r),a=Math.max(e,r),c=Math.min(n,s),u=Math.max(n,s);for(let h=l;h<=a;h++)for(let f=c;f<=u;f++)(h===l||h===a||f===c||f===u)&&h>=0&&h<this.mapWidth&&f>=0&&f<this.mapHeight&&i.push({x:h,y:f});return i}drawCircleShape(e,n,r,s){const i=[],l=Math.sqrt(Math.pow(r-e,2)+Math.pow(s-n,2));for(let a=0;a<360;a+=1){const c=a*Math.PI/180,u=Math.round(e+l*Math.cos(c)),h=Math.round(n+l*Math.sin(c));u>=0&&u<this.mapWidth&&h>=0&&h<this.mapHeight&&(i.some(f=>f.x===u&&f.y===h)||i.push({x:u,y:h}))}return i}drawLineShape(e,n,r,s){const i=[],l=Math.abs(r-e),a=Math.abs(s-n),c=e<r?1:-1,u=n<s?1:-1;let h=l-a,f=e,p=n,w=!1;for(;!w;){if(f>=0&&f<this.mapWidth&&p>=0&&p<this.mapHeight&&i.push({x:f,y:p}),f===r&&p===s){w=!0;continue}const b=2*h;b>-a&&(h-=a,f+=c),b<l&&(h+=l,p+=u)}return i}setLayerTileset(e,n){const r=new Image;r.onload=()=>{const s=Math.floor(r.width/this.tileSizeX),i=Math.floor(r.height/this.tileSizeY),l=s*i;this.layerTilesets.set(e,{image:r,fileName:n.name,columns:s,rows:i,count:l});const a=this.tileLayers.find(c=>c.id===this.activeLayerId);a&&a.type===e&&this.updateCurrentTileset(e)},r.src=URL.createObjectURL(n)}getCurrentLayerType(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);return e?e.type:null}hasLayerTileset(e){return this.layerTilesets.has(e)}updateCurrentTileset(e){const n=this.layerTilesets.get(e);if(n){this.tilesetImage=n.image,this.tilesetFileName=n.fileName,this.tilesetColumns=n.columns,this.tilesetRows=n.rows,this.tileCount=n.count;const r=this.layerTileData.get(e);if(this.detectedTileData.clear(),r)for(const[i,l]of r.entries())this.detectedTileData.set(i,l);const s=this.layerActiveGid.get(e)||0;this.updateActiveGid(s),this.createTilePalette()}else this.tilesetImage=null,this.tilesetFileName=null,this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.detectedTileData.clear(),this.updateActiveGid(0),this.clearTilePalette()}clearTilePalette(){const e=document.getElementById("tilesContainer");e&&(e.innerHTML="")}clearLayer(){if(this.activeLayerId!==null){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);e&&e.data.fill(0)}this.draw()}removeLayerTileset(){const e=this.tileLayers.find(n=>n.id===this.activeLayerId);if(e){const n=e.type;this.layerTilesets.delete(n),this.layerTileData.delete(n),this.tilesetImage=null,this.tilesetFileName=null,this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.detectedTileData.clear(),this.activeGid=0,this.clearTilePalette(),this.draw()}}exportFlareMap(){if(!this.tilesetImage||!this.tilesetFileName){alert("Please load a tileset first before exporting.");return}const e=this.generateFlareMapTxt(),n=this.generateFlareTilesetDef();this.downloadFile(e,"map.txt","text/plain"),this.downloadFile(n,"tileset.txt","text/plain"),console.log("Flare-compatible map exported successfully!"),console.log("📁 Files exported:"),console.log("  • map.txt (place in maps/ folder)"),console.log("  • tileset.txt (place in tilesetdefs/ folder)"),console.log("🎮 Format: Fully compatible with Flare Engine"),this.logGlobalTilesetMapping()}logGlobalTilesetMapping(){console.log("🗺️ Global Tileset Mapping:");const e=[];let n=1;this.tilesetFileName&&(e.push({fileName:this.tilesetFileName,count:this.tileCount,layerType:"main",offset:n}),n+=this.tileCount);const r=new Set;this.tilesetFileName&&r.add(this.tilesetFileName);for(const[s,i]of this.layerTilesets.entries())i.fileName&&!r.has(i.fileName)&&(e.push({fileName:i.fileName,count:i.count,layerType:s,offset:n}),n+=i.count,r.add(i.fileName));for(const s of e){const i=s.offset+s.count-1;console.log(`  ${s.fileName} (${s.layerType}): IDs ${s.offset}-${i} (${s.count} tiles)`)}}autoSaveExport(){if(!this.tilesetImage||!this.tilesetFileName||!this.tileLayers.some(n=>n.data.some(r=>r!==0)))return!1;try{return this.saveToLocalStorage(),!0}catch(n){return console.warn("Auto-save failed:",n),!1}}generateFlareMapTxt(){var u;const e=[];e.push("[header]"),e.push(`width=${this.mapWidth}`),e.push(`height=${this.mapHeight}`),e.push(`tilewidth=${this.tileSizeX}`),e.push(`tileheight=${this.tileSizeY}`),e.push("orientation=isometric"),e.push(`hero_pos=${this.heroX},${this.heroY}`),e.push("music=music/default_theme.ogg"),e.push("tileset=tilesetdefs/tileset.txt"),e.push(`title=${((u=this.tilesetFileName)==null?void 0:u.replace(/\.[^/.]+$/,""))||"Untitled Map"}`),e.push("");const n=[];let r=1;this.tilesetFileName&&(n.push({fileName:this.tilesetFileName,count:this.tileCount,layerType:"main",offset:r}),r+=this.tileCount);const s=new Set;this.tilesetFileName&&s.add(this.tilesetFileName);for(const[h,f]of this.layerTilesets.entries())f.fileName&&!s.has(f.fileName)&&(n.push({fileName:f.fileName,count:f.count,layerType:h,offset:r}),r+=f.count,s.add(f.fileName));const i=new Map;for(const h of n)i.set(h.fileName,h.offset);e.push("[tilesets]");for(const h of n)e.push(`tileset=../images/tilesets/${h.fileName},${this.tileSizeX},${this.tileSizeY},0,0`);e.push("");const l=["background","object","collision"];for(const h of l){const f=this.tileLayers.find(b=>b.type===h&&b.visible);if(!f)continue;e.push("[layer]"),e.push(`type=${f.type}`),e.push("data=");const p=this.layerTilesets.get(h),w=p!=null&&p.fileName&&i.get(p.fileName)||0;for(let b=0;b<this.mapHeight;b++){const j=[];for(let S=0;S<this.mapWidth;S++){const y=b*this.mapWidth+S,g=f.data[y];let x=0;g>0&&(x=w+(g-1)),j.push(x.toString())}e.push(j.join(","))}e.push("")}const a=this.objects.filter(h=>h.type==="event");for(const h of a){e.push("[event]"),e.push(`# ${h.name}`),e.push("type=event"),e.push(`location=${h.x},${h.y},${h.width},${h.height}`),h.activate&&e.push(`activate=${h.activate}`),h.hotspot&&e.push(`hotspot=${h.hotspot}`),h.intermap&&e.push(`intermap=${h.intermap}`),h.loot&&e.push(`loot=${h.loot}`),h.soundfx&&e.push(`soundfx=${h.soundfx}`),h.mapmod&&e.push(`mapmod=${h.mapmod}`),h.repeat!==void 0&&e.push(`repeat=${h.repeat}`),h.tooltip&&e.push(`tooltip=${h.tooltip}`);for(const[f,p]of Object.entries(h.properties))e.push(`${f}=${p}`);e.push("")}const c=this.objects.filter(h=>h.type==="enemy");for(const h of c){e.push("[enemy]"),e.push("type=enemy"),e.push(`location=${h.x},${h.y},${h.width},${h.height}`),h.category&&e.push(`category=${h.category}`),h.level&&e.push(`level=${h.level}`),h.number&&e.push(`number=${h.number}`),h.wander_radius!==void 0&&e.push(`wander_radius=${h.wander_radius}`);for(const[f,p]of Object.entries(h.properties))e.push(`${f}=${p}`);e.push("")}return e.join(`
`)}generateFlareTilesetDef(){const e=[];if(!this.tilesetFileName&&this.layerTilesets.size===0)return`# No tilesets found - please load tilesets before exporting
`;const n=[];let r=1;this.tilesetFileName&&(n.push({fileName:this.tilesetFileName,count:this.tileCount,layerType:"main",offset:r,tileset:{columns:this.tilesetColumns,rows:this.tilesetRows,count:this.tileCount}}),r+=this.tileCount);const s=new Set;this.tilesetFileName&&s.add(this.tilesetFileName);for(const[i,l]of this.layerTilesets.entries())l.fileName&&!s.has(l.fileName)&&(n.push({fileName:l.fileName,count:l.count,layerType:i,offset:r,tileset:l}),r+=l.count,s.add(l.fileName));for(const i of n)e.push(`img=../images/tilesets/${i.fileName}`);e.push("");for(const i of n){const l=i.tileset;for(let a=0;a<i.count;a++){const c=i.offset+a,u=a%l.columns*this.tileSizeX,h=Math.floor(a/l.columns)*this.tileSizeY,f=this.tileSizeX,p=this.tileSizeY,w=Math.floor(this.tileSizeX/2),b=Math.floor(this.tileSizeY/2);e.push(`tile=${c},${u},${h},${f},${p},${w},${b}`)}}return e.join(`
`)}downloadFile(e,n,r){const s=new Blob([e],{type:r}),i=URL.createObjectURL(s),l=document.createElement("a");l.href=i,l.download=n,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)}saveState(){if(this.isApplyingHistory)return;const e={layers:this.tileLayers.map(n=>({...n,data:[...n.data]})),objects:this.objects.map(n=>({...n}))};this.history=this.history.slice(0,this.historyIndex+1),this.history.push(e),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex--),this.markAsChanged(!1)}deepCopyLayers(e){return e.map(n=>({...n,data:[...n.data]}))}deepCopyObjects(e){return e.map(n=>({...n}))}undo(){this.historyIndex>0&&(this.historyIndex--,this.applyHistoryState())}redo(){this.historyIndex<this.history.length-1&&(this.historyIndex++,this.applyHistoryState())}applyHistoryState(){if(this.historyIndex>=0&&this.historyIndex<this.history.length){this.isApplyingHistory=!0;const e=this.history[this.historyIndex];this.tileLayers=this.deepCopyLayers(e.layers),this.objects=this.deepCopyObjects(e.objects),this.notifyObjectsChanged(),this.draw(),this.isApplyingHistory=!1}}setAutoSaveCallback(e){this.autoSaveCallback=e}setSaveStatusCallback(e){this.saveStatusCallback=e}setAutoSaveEnabled(e){this.autoSaveEnabled=e,!e&&this.autoSaveTimeout&&(clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=null)}setDarkMode(e){this.isDarkMode=e,this.draw()}markAsChanged(e=!1){if(!this.autoSaveEnabled)return;this.hasUnsavedChanges=!0,this.updateSaveStatus("unsaved"),this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout);const n=e?this.IMMEDIATE_SAVE_DELAY:this.AUTO_SAVE_DELAY;this.autoSaveTimeout=window.setTimeout(()=>{this.performAutoSave()},n)}async performAutoSave(){if(this.hasUnsavedChanges)try{this.updateSaveStatus("saving"),this.autoSaveExport()?(this.autoSaveCallback&&await this.autoSaveCallback(),this.hasUnsavedChanges=!1,this.lastSaveTimestamp=Date.now(),this.updateSaveStatus("saved")):this.updateSaveStatus("saved"),this.autoSaveTimeout=null}catch(e){console.error("Auto-save failed:",e),this.updateSaveStatus("error"),this.autoSaveTimeout=window.setTimeout(()=>{this.performAutoSave()},15e3)}}saveToLocalStorage(){try{const e={timestamp:Date.now(),mapWidth:this.mapWidth,mapHeight:this.mapHeight,layers:this.tileLayers,objects:this.objects,heroX:this.heroX,heroY:this.heroY,tilesetFileName:this.tilesetFileName,tilesetImage:this.tilesetImage?this.canvasToDataURL(this.tilesetImage):null,tileSizeX:this.tileSizeX,tileSizeY:this.tileSizeY,detectedTileData:Array.from(this.detectedTileData.entries()),tileContentThreshold:this.tileContentThreshold,objectSeparationSensitivity:this.objectSeparationSensitivity};localStorage.setItem("tilemap_autosave_backup",JSON.stringify(e))}catch(e){console.warn("Failed to save to localStorage:",e)}}canvasToDataURL(e){const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");return r?(r.drawImage(e,0,0),n.toDataURL("image/png")):""}generateMinimapDataUrl(){try{const r=Math.max(1,Math.floor(Math.min(160/Math.max(1,this.mapWidth),120/Math.max(1,this.mapHeight)))),s=this.mapWidth*r,i=this.mapHeight*r,l=document.createElement("canvas");l.width=s,l.height=i;const a=l.getContext("2d");if(!a)return"";a.imageSmoothingEnabled=!1,a.fillStyle="#ffffff",a.fillRect(0,0,s,i);for(let c=0;c<this.tileLayers.length;c++){const u=this.tileLayers[c];if(u.visible)for(let h=0;h<this.mapHeight;h++)for(let f=0;f<this.mapWidth;f++){const p=h*this.mapWidth+f,w=u.data[p];if(w>0){const b=w*137.5%360;a.fillStyle=`hsl(${b},55%,${c===0?"45%":"60%"})`,a.fillRect(f*r,h*r,r,r)}}}return l.toDataURL("image/png")}catch(e){return console.warn("generateMinimapDataUrl failed",e),""}}loadFromLocalStorage(){try{const e=localStorage.getItem("tilemap_autosave_backup");if(!e)return!1;const n=JSON.parse(e);if(Date.now()-n.timestamp>24*60*60*1e3)return!1;this.mapWidth=n.mapWidth,this.mapHeight=n.mapHeight,this.tileLayers=n.layers;const s=this.normalizeLoadedObjects(n.objects);if(this.objects=s,this.nextObjectId=this.calculateNextObjectId(s),this.notifyObjectsChanged(),this.tilesetFileName=n.tilesetFileName,n.heroX!==void 0&&n.heroY!==void 0?(this.heroX=Math.max(0,Math.min(n.heroX,this.mapWidth-1)),this.heroY=Math.max(0,Math.min(n.heroY,this.mapHeight-1))):(this.heroX=0,this.heroY=0),n.tileContentThreshold!==void 0&&(this.tileContentThreshold=n.tileContentThreshold),n.objectSeparationSensitivity!==void 0&&(this.objectSeparationSensitivity=n.objectSeparationSensitivity),n.detectedTileData){this.detectedTileData.clear();for(const[i,l]of n.detectedTileData)this.detectedTileData.set(i,l)}if(n.tilesetImage){const i=new Image;i.onload=()=>{this.tilesetImage=i,this.tilesetColumns=Math.floor(i.width/this.tileSizeX),this.tilesetRows=Math.floor(i.height/this.tileSizeY),this.tileCount=this.tilesetColumns*this.tilesetRows,n.detectedTileData&&n.detectedTileData.length>0?this.createTilePalette(!0):this.createTilePalette(),this.updateActiveTile(),this.draw()},i.src=n.tilesetImage}return this.draw(),!0}catch(e){return console.error("Failed to load from localStorage:",e),!1}}clearLocalStorageBackup(){localStorage.removeItem("tilemap_autosave_backup")}async saveProjectData(e){var n,r;try{console.log("=== SAVE PROJECT DATA DEBUG ==="),console.log("Project path:",e),console.log("Number of layer tilesets:",this.layerTilesets.size);const s={},i=[];console.log("=== SAVING LAYER TILESETS ===");for(const[a,c]of this.layerTilesets.entries())if(c.image&&c.fileName){console.log(`Saving tileset for layer ${a}: ${c.fileName}`);const u=this.canvasToDataURL(c.image);s[c.fileName]=u,i.push({layerType:a,fileName:c.fileName,name:c.fileName.replace(/\.[^/.]+$/,""),columns:c.columns,rows:c.rows,count:c.count,detectedTiles:this.getDetectedTilesForLayer(a)}),console.log(`Saved tileset: ${c.fileName} (${u.length} bytes)`)}else console.log(`No tileset image for layer ${a}`);if(this.layerTilesets.size===0&&this.tilesetImage&&this.tilesetFileName){console.log("Saving legacy tileset:",this.tilesetFileName);const a=this.canvasToDataURL(this.tilesetImage);s[this.tilesetFileName]=a,i.push({fileName:this.tilesetFileName,name:this.tilesetFileName.replace(/\.[^/.]+$/,""),detectedTiles:Array.from(this.detectedTileData.entries())})}const l={name:((n=this.tilesetFileName)==null?void 0:n.replace(/\.[^/.]+$/,""))||"Untitled Map",width:this.mapWidth,height:this.mapHeight,tileSize:64,layers:this.tileLayers,objects:this.objects,heroX:this.heroX,heroY:this.heroY,tilesets:i,tilesetImages:s,minimap:this.generateMinimapDataUrl(),version:"1.0",tileContentThreshold:this.tileContentThreshold,objectSeparationSensitivity:this.objectSeparationSensitivity};if(console.log("Project data prepared:",{name:l.name,tilesetCount:Object.keys(l.tilesetImages).length,layerCount:l.layers.length,layerTilesetCount:i.length}),(r=window.electronAPI)!=null&&r.saveMapProject){console.log("Saving via Electron API...");const a=await window.electronAPI.saveMapProject(e,l);return console.log("Electron save result:",a),a}else return console.log("Falling back to localStorage save..."),this.saveToLocalStorage(),!0}catch(s){return console.error("Error saving project data:",s),!1}}updateSaveStatus(e){this.saveStatusCallback&&this.saveStatusCallback(e)}getUnsavedChanges(){return this.hasUnsavedChanges}getLastSaveTime(){return this.lastSaveTimestamp}forceSave(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.performAutoSave()}notifyObjectsChanged(){this.objectsChangedCallback&&this.objectsChangedCallback(this.getMapObjects())}calculateNextObjectId(e){return e.length?e.reduce((n,r)=>Math.max(n,typeof r.id=="number"?r.id:0),0)+1:1}normalizeLoadedObjects(e){return Array.isArray(e)?e.map((n,r)=>{const s={...n,id:typeof n.id=="number"&&!Number.isNaN(n.id)?n.id:r+1,width:typeof n.width=="number"&&n.width>0?n.width:1,height:typeof n.height=="number"&&n.height>0?n.height:1,properties:n.properties||{}};return s.category==="npc"||s.type==="npc"?(s.category="npc",s.type="npc",s.wander_radius=0):(s.category==="enemy"||s.category==="creature"||s.type==="enemy")&&(s.type="enemy",s.category=s.category||"enemy"),s}):[]}addMapObject(e,n,r,s=1,i=1){const l={id:this.nextObjectId++,name:`${e}_${this.nextObjectId-1}`,type:e,x:n,y:r,width:s,height:i,properties:{}};return e==="event"?(l.activate="on_trigger",l.hotspot="location",l.tooltip="Event"):e==="enemy"&&(l.category="enemy",l.level=1,l.number=1,l.wander_radius=4),this.objects.push(l),this.saveState(),this.notifyObjectsChanged(),l}removeMapObject(e){var r;const n=this.objects.findIndex(s=>s.id===e);return n>=0?(this.objects.splice(n,1),((r=this.selectedObject)==null?void 0:r.id)===e&&(this.selectedObject=null),this.saveState(),this.notifyObjectsChanged(),!0):!1}updateMapObject(e,n){const r=this.objects.find(s=>s.id===e);return r?(Object.assign(r,n),this.saveState(),this.notifyObjectsChanged(),!0):!1}getMapObjects(){return[...this.objects]}getObjectsAtPosition(e,n){return this.objects.filter(r=>r.x===e&&r.y===n)}isHeroAtPosition(e,n){return this.heroX===e&&this.heroY===n}setHeroPosition(e,n){this.heroX=Math.max(0,Math.min(e,this.mapWidth-1)),this.heroY=Math.max(0,Math.min(n,this.mapHeight-1)),this.saveState(),this.draw()}getHeroPosition(){return{x:this.heroX,y:this.heroY}}updateCursorForHover(){if(this.isHeroAtPosition(this.hoverX,this.hoverY)){this.mapCanvas.style.cursor="move",this.showHeroTooltip();return}const e=this.getDraggableActorAt(this.hoverX,this.hoverY);if(e){const s=this.getActorLayerType(e);if(s){this.mapCanvas.style.cursor="move",this.showActorTooltip(e,s);return}}const n=this.getActiveLayer();if(n&&["enemy","npc","object","event","background"].includes(n.type)){const s=this.getObjectsAtPosition(this.hoverX,this.hoverY);if(s.length>0){this.mapCanvas.style.cursor="pointer",this.showObjectTooltip(s[0]);return}}this.spacePressed?this.mapCanvas.style.cursor=this.isPanning?"grabbing":"grab":this.mapCanvas.style.cursor="crosshair",this.hideObjectTooltip()}showObjectTooltip(e){let n=document.getElementById("object-tooltip");n||(n=document.createElement("div"),n.id="object-tooltip",n.style.position="absolute",n.style.background="rgba(0, 0, 0, 0.35)",n.style.color="white",n.style.padding="4px 6px",n.style.borderRadius="3px",n.style.fontSize="11px",n.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',n.style.lineHeight="1.2",n.style.pointerEvents="none",n.style.zIndex="1000",n.style.border="1px solid rgba(255, 107, 0, 0.8)",n.style.boxShadow="0 1px 4px rgba(0,0,0,0.3)",n.style.backdropFilter="blur(2px)",document.body.appendChild(n));const r=`
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
        <rect x="5" y="2" width="14" height="20" rx="7"/>
        <path d="M12 6v4"/>
      </svg>
    `,s=e.type==="enemy"?e.category||"enemy":e.type;n.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 2px; color: #ff6b00; font-size: 10px;">
        ${r}Double click to edit
      </div>
      <div style="font-weight: bold; margin-bottom: 1px;">${e.name||"Unnamed"}</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Type: ${s}</div>
    `;const i=this.mapCanvas.getBoundingClientRect(),l=this.mapToScreen(this.hoverX,this.hoverY);n.style.left=`${i.left+l.x+20}px`,n.style.top=`${i.top+l.y-10}px`,n.style.display="block"}showActorTooltip(e,n){let r=document.getElementById("object-tooltip");r||(r=document.createElement("div"),r.id="object-tooltip",r.style.position="absolute",r.style.background="rgba(0, 0, 0, 0.35)",r.style.color="white",r.style.padding="4px 6px",r.style.borderRadius="3px",r.style.fontSize="11px",r.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',r.style.lineHeight="1.2",r.style.pointerEvents="none",r.style.zIndex="1000",r.style.border="1px solid rgba(255, 107, 0, 0.8)",r.style.boxShadow="0 1px 4px rgba(0,0,0,0.3)",r.style.backdropFilter="blur(2px)",document.body.appendChild(r));const s=`
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
        <rect x="5" y="2" width="14" height="20" rx="7"/>
        <path d="M12 6v4"/>
      </svg>
    `,i=n==="npc"?"NPC":"Enemy",l=e.name||i;r.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 2px; color: #ff6b00; font-size: 10px;">
        ${s}Drag to move
      </div>
      <div style="font-weight: bold; margin-bottom: 1px;">${l}</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Type: ${i}</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Double click to edit</div>
    `;const a=this.mapCanvas.getBoundingClientRect(),c=this.mapToScreen(this.hoverX,this.hoverY);r.style.left=`${a.left+c.x+20}px`,r.style.top=`${a.top+c.y-10}px`,r.style.display="block"}hideObjectTooltip(){const e=document.getElementById("object-tooltip");e&&(e.style.display="none")}showHeroTooltip(){let e=document.getElementById("object-tooltip");e||(e=document.createElement("div"),e.id="object-tooltip",e.style.position="absolute",e.style.background="rgba(0, 0, 0, 0.35)",e.style.color="white",e.style.padding="4px 6px",e.style.borderRadius="3px",e.style.fontSize="11px",e.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',e.style.lineHeight="1.2",e.style.pointerEvents="none",e.style.zIndex="1000",e.style.border="1px solid rgba(255, 107, 0, 0.8)",e.style.boxShadow="0 1px 4px rgba(0,0,0,0.3)",e.style.backdropFilter="blur(2px)",document.body.appendChild(e));const n=`
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
        <rect x="5" y="2" width="14" height="20" rx="7"/>
        <path d="M12 6v4"/>
      </svg>
    `;e.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 2px; color: #ff6b00; font-size: 10px;">
        ${n}Double click to edit or drag to move
      </div>
      <div style="font-weight: bold; margin-bottom: 1px;">Hero Position</div>
      <div style="font-size: 10px; color: rgba(255,255,255,0.9);">Position: (${this.heroX}, ${this.heroY})</div>
    `;const r=this.mapCanvas.getBoundingClientRect(),s=this.mapToScreen(this.hoverX,this.hoverY);e.style.left=`${r.left+s.x+20}px`,e.style.top=`${r.top+s.y-10}px`,e.style.display="block"}createObjectFromTile(e,n,r,s){console.log(`Creating object from tile at (${e}, ${n}) for layer type: ${r}`);const i=this.objects.find(u=>u.x===e&&u.y===n);if(i){console.log(`Found existing object at (${e}, ${n}), updating instead of creating new one`);const u={name:`${r}_${e}_${n}`,type:r==="npc"?"npc":r};this.updateMapObject(i.id,u);return}let l;if(r==="event")l="event";else if(r==="enemy"||r==="npc"||r==="object")l="enemy";else{console.log(`Unsupported layer type: ${r}`);return}console.log(`Creating new ${l} object at (${e}, ${n})`);const a=this.addMapObject(l,e,n,1,1);console.log(`Created object with ID: ${a.id}`);const c={name:`${r}_${e}_${n}`,category:l==="event"?"block":r==="npc"?"npc":r==="object"?"object":"creature"};r==="npc"?c.type="npc":r==="enemy"&&(c.type="enemy"),l==="enemy"?(c.level=1,c.number=1,c.wander_radius=r==="npc"||r==="object"?0:4):(c.activate="on_trigger",c.hotspot="0,0,1,1"),this.updateMapObject(a.id,c)}removeObjectAtPosition(e,n){const r=this.objects.find(s=>s.x===e&&s.y===n);r&&this.removeMapObject(r.id)}selectObject(e){const n=this.objects.find(r=>r.id===e);return this.selectedObject=n||null,this.selectedObject}getSelectedObject(){return this.selectedObject}resetForNewProject(){this.clearLocalStorageBackup(),this.tilesetImage=null,this.tilesetFileName=null,this.tilesetColumns=0,this.tilesetRows=0,this.tileCount=0,this.detectedTileData.clear(),this.clearTilePalette(),this.tileLayers=[],this.activeLayerId=null,this.nextLayerId=1,this.objects=[],this.nextObjectId=1,this.selectedObjectId=null,this.notifyObjectsChanged(),this.heroX=0,this.heroY=0,this.isDraggingHero=!1,this.layerTilesets.clear(),this.tilesets=[],this.collisionData=[],this.selection={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,tiles:[]},this.isSelecting=!1,this.shapeDrawing={active:!1,startX:-1,startY:-1,endX:-1,endY:-1,preview:[]},this.isDrawingShape=!1,this.stamps.clear(),this.activeStamp=null,this.stampPreview={x:0,y:0,visible:!1},this.hasUnsavedChanges=!1,this.lastSaveTimestamp=0,this.autoSaveTimeout&&(clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=null),this.createDefaultLayers(),this.history=[],this.historyIndex=-1,this.saveState(),this.ctx.clearRect(0,0,this.mapCanvas.width,this.mapCanvas.height),this.draw()}loadProjectData(e){try{if(console.log("=== LOADING PROJECT DATA IN EDITOR ==="),console.log("Project data:",{hasLayers:!!(e.layers&&e.layers.length>0),layerCount:e.layers?e.layers.length:0,hasObjects:!!(e.objects&&e.objects.length>0),objectCount:e.objects?e.objects.length:0,width:e.width,height:e.height,hasTilesets:!!(e.tilesets&&e.tilesets.length>0),tilesetCount:e.tilesets?e.tilesets.length:0}),e.tileContentThreshold!==void 0&&(this.tileContentThreshold=e.tileContentThreshold),e.objectSeparationSensitivity!==void 0&&(this.objectSeparationSensitivity=e.objectSeparationSensitivity),this.layerTilesets.clear(),e.tilesets&&Array.isArray(e.tilesets)){console.log("Loading tilesets:",e.tilesets.length);let r=0;const s=e.tilesets.length;for(const i of e.tilesets)if(i.fileName&&e.tilesetImages&&e.tilesetImages[i.fileName]){const l=e.tilesetImages[i.fileName],a=new Image;a.onload=()=>{console.log(`Tileset ${i.fileName} loaded for layer: ${i.layerType||"legacy"}`);const c={image:a,fileName:i.fileName,columns:i.columns||Math.floor(a.width/this.tileSizeX),rows:i.rows||Math.floor(a.height/this.tileSizeY),count:i.count||(i.columns||Math.floor(a.width/this.tileSizeX))*(i.rows||Math.floor(a.height/this.tileSizeY))};if(i.layerType)this.layerTilesets.set(i.layerType,c),console.log(`Set tileset for layer type ${i.layerType}`);else{this.tilesetImage=a,this.tilesetFileName=i.fileName,this.tilesetColumns=c.columns,this.tilesetRows=c.rows,this.tileCount=c.count;const u=this.tileLayers.find(h=>h.id===this.activeLayerId);u&&!this.layerTilesets.has(u.type)&&(this.layerTilesets.set(u.type,c),console.log(`Assigned legacy tileset to active layer: ${u.type}`))}if(i.detectedTiles&&Array.isArray(i.detectedTiles))if(console.log(`Restoring ${i.detectedTiles.length} detected tiles for ${i.layerType||"legacy"}`),i.layerType){const u=new Map;for(const[h,f]of i.detectedTiles)u.set(h,f);this.layerTileData.set(i.layerType,u),console.log(`Stored ${u.size} tiles for layer type: ${i.layerType}`)}else{this.detectedTileData.clear();for(const[h,f]of i.detectedTiles)this.detectedTileData.set(h,f);const u=this.tileLayers.find(h=>h.id===this.activeLayerId);if(u){const h=new Map;for(const[f,p]of i.detectedTiles)h.set(f,p);this.layerTileData.set(u.type,h)}}if(r++,r===s){console.log("All tilesets loaded, updating UI for active layer");const u=this.tileLayers.find(h=>h.id===this.activeLayerId);u&&this.updateCurrentTileset(u.type)}},a.src=l}else if(r++,r===s){console.log("All tilesets processed, updating UI for active layer");const l=this.tileLayers.find(a=>a.id===this.activeLayerId);l&&this.updateCurrentTileset(l.type)}}if(e.detectedTileData&&Array.isArray(e.detectedTileData)){this.detectedTileData.clear();for(const[r,s]of e.detectedTileData)this.detectedTileData.set(r,s)}e.layers&&e.layers.length>0?(console.log("Loading layers:",e.layers.length),this.tileLayers=[...e.layers],this.tileLayers.length>0&&(!this.activeLayerId||!this.tileLayers.find(r=>r.id===this.activeLayerId))&&(this.activeLayerId=this.tileLayers[0].id,console.log("Set active layer to:",this.activeLayerId))):(console.log("No layers found in project data, creating default layers"),this.createDefaultLayers());const n=this.normalizeLoadedObjects(e.objects);console.log("Loading objects:",n.length),this.objects=n,this.nextObjectId=this.calculateNextObjectId(n),this.notifyObjectsChanged(),e.width&&e.height&&(console.log("Setting map dimensions:",e.width,"x",e.height),this.mapWidth=e.width,this.mapHeight=e.height),e.heroX!==void 0&&e.heroY!==void 0?(console.log("Loading hero position:",e.heroX,",",e.heroY),this.heroX=Math.max(0,Math.min(e.heroX,this.mapWidth-1)),this.heroY=Math.max(0,Math.min(e.heroY,this.mapHeight-1))):(console.log("No hero position found, defaulting to (0,0)"),this.heroX=0,this.heroY=0),console.log("Project data loaded successfully"),this.draw()}catch(n){console.error("Error loading project data:",n)}}async loadTilesetFromDataURL(e,n){return new Promise((r,s)=>{console.log("Loading tileset from dataURL:",n,"Length:",e.length);const i=new Image;i.onload=()=>{console.log("Tileset image loaded successfully:",i.width,"x",i.height),this.tilesetImage=i,this.tilesetFileName=n,this.tilesetColumns=Math.floor(i.width/this.tileSizeX),this.tilesetRows=Math.floor(i.height/this.tileSizeY),this.tileCount=this.tilesetColumns*this.tilesetRows,console.log("Tileset properties:",{columns:this.tilesetColumns,rows:this.tilesetRows,tileCount:this.tileCount});const l=this.tileLayers.find(c=>c.id===this.activeLayerId);if(l){console.log("Setting tileset for active layer type:",l.type),this.layerTilesets.set(l.type,{image:i,fileName:n,columns:this.tilesetColumns,rows:this.tilesetRows,count:this.tileCount});const c=this.layerTileData.has(l.type);if(console.log(`Layer ${l.type} has existing tile data:`,c),!c)this.detectedTileData.clear();else{const u=this.layerTileData.get(l.type);if(this.detectedTileData.clear(),u)for(const[h,f]of u.entries())this.detectedTileData.set(h,f)}}else console.log("No active layer found, storing as global tileset");const a=l?this.layerTileData.has(l.type):!1;this.createTilePalette(a),console.log("Tile detection completed, detected tiles:",this.detectedTileData.size),this.draw(),console.log("Tileset loaded and palette created"),r()},i.onerror=l=>{console.error("Failed to load tileset image:",l),s(new Error("Failed to load tileset from data URL"))},i.src=e})}debugLayerData(){console.log("=== LAYER DATA DEBUG ===");for(const e of this.tileLayers){const n=e.data.filter(s=>s>0).length,r=this.layerTilesets.get(e.type);console.log(`Layer ${e.name} (${e.type}): ${n} painted tiles, has tileset: ${!!(r!=null&&r.image)}`)}}redraw(){this.draw()}getMapWidth(){return this.mapWidth}getMapHeight(){return this.mapHeight}updateCanvas(e){console.log("TileMapEditor: Updating canvas reference and rebinding events"),this.cleanupCanvasObservers(),this.cleanupCanvasEvents(),this.mapCanvas=e,this.initializeCanvas(),this.bindEvents(),this.refreshTilePalette(!0),this.draw(),console.log("TileMapEditor: Canvas update complete - events rebound")}}const Dw=1,Rw=1e6;let fa=0;function Ow(){return fa=(fa+1)%Number.MAX_SAFE_INTEGER,fa.toString()}const ma=new Map,Lh=t=>{if(ma.has(t))return;const e=setTimeout(()=>{ma.delete(t),Os({type:"REMOVE_TOAST",toastId:t})},Rw);ma.set(t,e)},$w=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,Dw)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?Lh(n):t.toasts.forEach(r=>{Lh(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},go=[];let xo={toasts:[]};function Os(t){xo=$w(xo,t),go.forEach(e=>{e(xo)})}function Fw({...t}){const e=Ow(),n=s=>Os({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>Os({type:"DISMISS_TOAST",toastId:e});return Os({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:n}}function ip(){const[t,e]=m.useState(xo);return m.useEffect(()=>(go.push(e),()=>{const n=go.indexOf(e);n>-1&&go.splice(n,1)}),[t]),{...t,toast:Fw,dismiss:n=>Os({type:"DISMISS_TOAST",toastId:n})}}function ot(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function op(t,e=[]){let n=[];function r(i,l){const a=m.createContext(l),c=n.length;n=[...n,l];const u=f=>{var y;const{scope:p,children:w,...b}=f,j=((y=p==null?void 0:p[t])==null?void 0:y[c])||a,S=m.useMemo(()=>b,Object.values(b));return o.jsx(j.Provider,{value:S,children:w})};u.displayName=i+"Provider";function h(f,p){var j;const w=((j=p==null?void 0:p[t])==null?void 0:j[c])||a,b=m.useContext(w);if(b)return b;if(l!==void 0)return l;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[u,h]}const s=()=>{const i=n.map(l=>m.createContext(l));return function(a){const c=(a==null?void 0:a[t])||i;return m.useMemo(()=>({[`__scope${t}`]:{...a,[t]:c}}),[a,c])}};return s.scopeName=t,[r,Hw(s,...e)]}function Hw(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const l=r.reduce((a,{useScope:c,scopeName:u})=>{const f=c(i)[`__scope${u}`];return{...a,...f}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return n.scopeName=e.scopeName,n}function Bw(t){const e=t+"CollectionProvider",[n,r]=op(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),l=j=>{const{scope:S,children:y}=j,g=ge.useRef(null),x=ge.useRef(new Map).current;return o.jsx(s,{scope:S,itemMap:x,collectionRef:g,children:y})};l.displayName=e;const a=t+"CollectionSlot",c=Bo(a),u=ge.forwardRef((j,S)=>{const{scope:y,children:g}=j,x=i(a,y),v=Un(S,x.collectionRef);return o.jsx(c,{ref:v,children:g})});u.displayName=a;const h=t+"CollectionItemSlot",f="data-radix-collection-item",p=Bo(h),w=ge.forwardRef((j,S)=>{const{scope:y,children:g,...x}=j,v=ge.useRef(null),N=Un(S,v),T=i(h,y);return ge.useEffect(()=>(T.itemMap.set(v,{ref:v,...x}),()=>void T.itemMap.delete(v))),o.jsx(p,{[f]:"",ref:N,children:g})});w.displayName=h;function b(j){const S=i(t+"CollectionConsumer",j);return ge.useCallback(()=>{const g=S.collectionRef.current;if(!g)return[];const x=Array.from(g.querySelectorAll(`[${f}]`));return Array.from(S.itemMap.values()).sort((T,P)=>x.indexOf(T.ref.current)-x.indexOf(P.ref.current))},[S.collectionRef,S.itemMap])}return[{Provider:l,Slot:u,ItemSlot:w},b,r]}var Ww=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],At=Ww.reduce((t,e)=>{const n=Bo(`Primitive.${e}`),r=m.forwardRef((s,i)=>{const{asChild:l,...a}=s,c=l?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(c,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function lp(t,e){t&&Yn.flushSync(()=>t.dispatchEvent(e))}function Xn(t){const e=m.useRef(t);return m.useEffect(()=>{e.current=t}),m.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Yw(t,e=globalThis==null?void 0:globalThis.document){const n=Xn(t);m.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Uw="DismissableLayer",fc="dismissableLayer.update",Xw="dismissableLayer.pointerDownOutside",Vw="dismissableLayer.focusOutside",_h,ap=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),cp=m.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:l,onDismiss:a,...c}=t,u=m.useContext(ap),[h,f]=m.useState(null),p=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,w]=m.useState({}),b=Un(e,P=>f(P)),j=Array.from(u.layers),[S]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=j.indexOf(S),g=h?j.indexOf(h):-1,x=u.layersWithOutsidePointerEventsDisabled.size>0,v=g>=y,N=qw(P=>{const E=P.target,O=[...u.branches].some(A=>A.contains(E));!v||O||(s==null||s(P),l==null||l(P),P.defaultPrevented||a==null||a())},p),T=Kw(P=>{const E=P.target;[...u.branches].some(A=>A.contains(E))||(i==null||i(P),l==null||l(P),P.defaultPrevented||a==null||a())},p);return Yw(P=>{g===u.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&a&&(P.preventDefault(),a()))},p),m.useEffect(()=>{if(h)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(_h=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),zh(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=_h)}},[h,p,n,u]),m.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),zh())},[h,u]),m.useEffect(()=>{const P=()=>w({});return document.addEventListener(fc,P),()=>document.removeEventListener(fc,P)},[]),o.jsx(At.div,{...c,ref:b,style:{pointerEvents:x?v?"auto":"none":void 0,...t.style},onFocusCapture:ot(t.onFocusCapture,T.onFocusCapture),onBlurCapture:ot(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:ot(t.onPointerDownCapture,N.onPointerDownCapture)})});cp.displayName=Uw;var Gw="DismissableLayerBranch",up=m.forwardRef((t,e)=>{const n=m.useContext(ap),r=m.useRef(null),s=Un(e,r);return m.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),o.jsx(At.div,{...t,ref:s})});up.displayName=Gw;function qw(t,e=globalThis==null?void 0:globalThis.document){const n=Xn(t),r=m.useRef(!1),s=m.useRef(()=>{});return m.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let c=function(){dp(Xw,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Kw(t,e=globalThis==null?void 0:globalThis.document){const n=Xn(t),r=m.useRef(!1);return m.useEffect(()=>{const s=i=>{i.target&&!r.current&&dp(Vw,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function zh(){const t=new CustomEvent(fc);document.dispatchEvent(t)}function dp(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?lp(s,i):s.dispatchEvent(i)}var Qw=cp,Zw=up,ni=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},Jw="Portal",hp=m.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=m.useState(!1);ni(()=>i(!0),[]);const l=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return l?kv.createPortal(o.jsx(At.div,{...r,ref:e}),l):null});hp.displayName=Jw;function e1(t,e){return m.useReducer((n,r)=>e[n][r]??n,t)}var fp=t=>{const{present:e,children:n}=t,r=t1(e),s=typeof n=="function"?n({present:r.isPresent}):m.Children.only(n),i=Un(r.ref,n1(s));return typeof n=="function"||r.isPresent?m.cloneElement(s,{ref:i}):null};fp.displayName="Presence";function t1(t){const[e,n]=m.useState(),r=m.useRef(null),s=m.useRef(t),i=m.useRef("none"),l=t?"mounted":"unmounted",[a,c]=e1(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const u=Ji(r.current);i.current=a==="mounted"?u:"none"},[a]),ni(()=>{const u=r.current,h=s.current;if(h!==t){const p=i.current,w=Ji(u);t?c("MOUNT"):w==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(h&&p!==w?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),ni(()=>{if(e){let u;const h=e.ownerDocument.defaultView??window,f=w=>{const j=Ji(r.current).includes(CSS.escape(w.animationName));if(w.target===e&&j&&(c("ANIMATION_END"),!s.current)){const S=e.style.animationFillMode;e.style.animationFillMode="forwards",u=h.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=S)})}},p=w=>{w.target===e&&(i.current=Ji(r.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{h.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:m.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function Ji(t){return(t==null?void 0:t.animationName)||"none"}function n1(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var r1=dx[" useInsertionEffect ".trim().toString()]||ni;function s1({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,l]=i1({defaultProp:e,onChange:n}),a=t!==void 0,c=a?t:s;{const h=m.useRef(t!==void 0);m.useEffect(()=>{const f=h.current;f!==a&&console.warn(`${r} is changing from ${f?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=a},[a,r])}const u=m.useCallback(h=>{var f;if(a){const p=o1(h)?h(t):h;p!==t&&((f=l.current)==null||f.call(l,p))}else i(h)},[a,t,i,l]);return[c,u]}function i1({defaultProp:t,onChange:e}){const[n,r]=m.useState(t),s=m.useRef(n),i=m.useRef(e);return r1(()=>{i.current=e},[e]),m.useEffect(()=>{var l;s.current!==n&&((l=i.current)==null||l.call(i,n),s.current=n)},[n,s]),[n,r,i]}function o1(t){return typeof t=="function"}var l1=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),a1="VisuallyHidden",hu=m.forwardRef((t,e)=>o.jsx(At.span,{...t,ref:e,style:{...l1,...t.style}}));hu.displayName=a1;var fu="ToastProvider",[mu,c1,u1]=Bw("Toast"),[mp,F1]=op("Toast",[u1]),[d1,il]=mp(fu),pp=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:l}=t,[a,c]=m.useState(null),[u,h]=m.useState(0),f=m.useRef(!1),p=m.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${fu}\`. Expected non-empty \`string\`.`),o.jsx(mu.Provider,{scope:e,children:o.jsx(d1,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:a,onViewportChange:c,onToastAdd:m.useCallback(()=>h(w=>w+1),[]),onToastRemove:m.useCallback(()=>h(w=>w-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:p,children:l})})};pp.displayName=fu;var gp="ToastViewport",h1=["F8"],mc="toast.viewportPause",pc="toast.viewportResume",xp=m.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=h1,label:s="Notifications ({hotkey})",...i}=t,l=il(gp,n),a=c1(n),c=m.useRef(null),u=m.useRef(null),h=m.useRef(null),f=m.useRef(null),p=Un(e,f,l.onViewportChange),w=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),b=l.toastCount>0;m.useEffect(()=>{const S=y=>{var x;r.length!==0&&r.every(v=>y[v]||y.code===v)&&((x=f.current)==null||x.focus())};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[r]),m.useEffect(()=>{const S=c.current,y=f.current;if(b&&S&&y){const g=()=>{if(!l.isClosePausedRef.current){const T=new CustomEvent(mc);y.dispatchEvent(T),l.isClosePausedRef.current=!0}},x=()=>{if(l.isClosePausedRef.current){const T=new CustomEvent(pc);y.dispatchEvent(T),l.isClosePausedRef.current=!1}},v=T=>{!S.contains(T.relatedTarget)&&x()},N=()=>{S.contains(document.activeElement)||x()};return S.addEventListener("focusin",g),S.addEventListener("focusout",v),S.addEventListener("pointermove",g),S.addEventListener("pointerleave",N),window.addEventListener("blur",g),window.addEventListener("focus",x),()=>{S.removeEventListener("focusin",g),S.removeEventListener("focusout",v),S.removeEventListener("pointermove",g),S.removeEventListener("pointerleave",N),window.removeEventListener("blur",g),window.removeEventListener("focus",x)}}},[b,l.isClosePausedRef]);const j=m.useCallback(({tabbingDirection:S})=>{const g=a().map(x=>{const v=x.ref.current,N=[v,...N1(v)];return S==="forwards"?N:N.reverse()});return(S==="forwards"?g.reverse():g).flat()},[a]);return m.useEffect(()=>{const S=f.current;if(S){const y=g=>{var N,T,P;const x=g.altKey||g.ctrlKey||g.metaKey;if(g.key==="Tab"&&!x){const E=document.activeElement,O=g.shiftKey;if(g.target===S&&O){(N=u.current)==null||N.focus();return}const V=j({tabbingDirection:O?"backwards":"forwards"}),te=V.findIndex(U=>U===E);pa(V.slice(te+1))?g.preventDefault():O?(T=u.current)==null||T.focus():(P=h.current)==null||P.focus()}};return S.addEventListener("keydown",y),()=>S.removeEventListener("keydown",y)}},[a,j]),o.jsxs(Zw,{ref:c,role:"region","aria-label":s.replace("{hotkey}",w),tabIndex:-1,style:{pointerEvents:b?void 0:"none"},children:[b&&o.jsx(gc,{ref:u,onFocusFromOutsideViewport:()=>{const S=j({tabbingDirection:"forwards"});pa(S)}}),o.jsx(mu.Slot,{scope:n,children:o.jsx(At.ol,{tabIndex:-1,...i,ref:p})}),b&&o.jsx(gc,{ref:h,onFocusFromOutsideViewport:()=>{const S=j({tabbingDirection:"backwards"});pa(S)}})]})});xp.displayName=gp;var yp="ToastFocusProxy",gc=m.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=il(yp,n);return o.jsx(hu,{tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:l=>{var u;const a=l.relatedTarget;!((u=i.viewport)!=null&&u.contains(a))&&r()}})});gc.displayName=yp;var ai="Toast",f1="toast.swipeStart",m1="toast.swipeMove",p1="toast.swipeCancel",g1="toast.swipeEnd",vp=m.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...l}=t,[a,c]=s1({prop:r,defaultProp:s??!0,onChange:i,caller:ai});return o.jsx(fp,{present:n||a,children:o.jsx(v1,{open:a,...l,ref:e,onClose:()=>c(!1),onPause:Xn(t.onPause),onResume:Xn(t.onResume),onSwipeStart:ot(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ot(t.onSwipeMove,u=>{const{x:h,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:ot(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ot(t.onSwipeEnd,u=>{const{x:h,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});vp.displayName=ai;var[x1,y1]=mp(ai,{onClose(){}}),v1=m.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:l,onEscapeKeyDown:a,onPause:c,onResume:u,onSwipeStart:h,onSwipeMove:f,onSwipeCancel:p,onSwipeEnd:w,...b}=t,j=il(ai,n),[S,y]=m.useState(null),g=Un(e,U=>y(U)),x=m.useRef(null),v=m.useRef(null),N=s||j.duration,T=m.useRef(0),P=m.useRef(N),E=m.useRef(0),{onToastAdd:O,onToastRemove:A}=j,X=Xn(()=>{var re;(S==null?void 0:S.contains(document.activeElement))&&((re=j.viewport)==null||re.focus()),l()}),V=m.useCallback(U=>{!U||U===1/0||(window.clearTimeout(E.current),T.current=new Date().getTime(),E.current=window.setTimeout(X,U))},[X]);m.useEffect(()=>{const U=j.viewport;if(U){const re=()=>{V(P.current),u==null||u()},ye=()=>{const Ue=new Date().getTime()-T.current;P.current=P.current-Ue,window.clearTimeout(E.current),c==null||c()};return U.addEventListener(mc,ye),U.addEventListener(pc,re),()=>{U.removeEventListener(mc,ye),U.removeEventListener(pc,re)}}},[j.viewport,N,c,u,V]),m.useEffect(()=>{i&&!j.isClosePausedRef.current&&V(N)},[i,N,j.isClosePausedRef,V]),m.useEffect(()=>(O(),()=>A()),[O,A]);const te=m.useMemo(()=>S?Cp(S):null,[S]);return j.viewport?o.jsxs(o.Fragment,{children:[te&&o.jsx(w1,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:te}),o.jsx(x1,{scope:n,onClose:X,children:Yn.createPortal(o.jsx(mu.ItemSlot,{scope:n,children:o.jsx(Qw,{asChild:!0,onEscapeKeyDown:ot(a,()=>{j.isFocusedToastEscapeKeyDownRef.current||X(),j.isFocusedToastEscapeKeyDownRef.current=!1}),children:o.jsx(At.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":j.swipeDirection,...b,ref:g,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ot(t.onKeyDown,U=>{U.key==="Escape"&&(a==null||a(U.nativeEvent),U.nativeEvent.defaultPrevented||(j.isFocusedToastEscapeKeyDownRef.current=!0,X()))}),onPointerDown:ot(t.onPointerDown,U=>{U.button===0&&(x.current={x:U.clientX,y:U.clientY})}),onPointerMove:ot(t.onPointerMove,U=>{if(!x.current)return;const re=U.clientX-x.current.x,ye=U.clientY-x.current.y,Ue=!!v.current,_=["left","right"].includes(j.swipeDirection),B=["left","up"].includes(j.swipeDirection)?Math.min:Math.max,Y=_?B(0,re):0,J=_?0:B(0,ye),ne=U.pointerType==="touch"?10:2,le={x:Y,y:J},ht={originalEvent:U,delta:le};Ue?(v.current=le,eo(m1,f,ht,{discrete:!1})):Ih(le,j.swipeDirection,ne)?(v.current=le,eo(f1,h,ht,{discrete:!1}),U.target.setPointerCapture(U.pointerId)):(Math.abs(re)>ne||Math.abs(ye)>ne)&&(x.current=null)}),onPointerUp:ot(t.onPointerUp,U=>{const re=v.current,ye=U.target;if(ye.hasPointerCapture(U.pointerId)&&ye.releasePointerCapture(U.pointerId),v.current=null,x.current=null,re){const Ue=U.currentTarget,_={originalEvent:U,delta:re};Ih(re,j.swipeDirection,j.swipeThreshold)?eo(g1,w,_,{discrete:!0}):eo(p1,p,_,{discrete:!0}),Ue.addEventListener("click",B=>B.preventDefault(),{once:!0})}})})})}),j.viewport)})]}):null}),w1=t=>{const{__scopeToast:e,children:n,...r}=t,s=il(ai,e),[i,l]=m.useState(!1),[a,c]=m.useState(!1);return j1(()=>l(!0)),m.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),a?null:o.jsx(hp,{asChild:!0,children:o.jsx(hu,{...r,children:i&&o.jsxs(o.Fragment,{children:[s.label," ",n]})})})},b1="ToastTitle",wp=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return o.jsx(At.div,{...r,ref:e})});wp.displayName=b1;var k1="ToastDescription",bp=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return o.jsx(At.div,{...r,ref:e})});bp.displayName=k1;var kp="ToastAction",jp=m.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?o.jsx(Np,{altText:n,asChild:!0,children:o.jsx(pu,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${kp}\`. Expected non-empty \`string\`.`),null)});jp.displayName=kp;var Sp="ToastClose",pu=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=y1(Sp,n);return o.jsx(Np,{asChild:!0,children:o.jsx(At.button,{type:"button",...r,ref:e,onClick:ot(t.onClick,s.onClose)})})});pu.displayName=Sp;var Np=m.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return o.jsx(At.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function Cp(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),S1(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const l=r.dataset.radixToastAnnounceAlt;l&&e.push(l)}else e.push(...Cp(r))}}),e}function eo(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?lp(s,i):s.dispatchEvent(i)}var Ih=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function j1(t=()=>{}){const e=Xn(t);ni(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function S1(t){return t.nodeType===t.ELEMENT_NODE}function N1(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function pa(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var C1=pp,Tp=xp,Mp=vp,Ep=wp,Pp=bp,Lp=jp,_p=pu;const T1=C1,zp=m.forwardRef(({className:t,...e},n)=>o.jsx(Tp,{ref:n,className:tt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));zp.displayName=Tp.displayName;const M1=Zm("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ip=m.forwardRef(({className:t,variant:e,...n},r)=>o.jsx(Mp,{ref:r,className:tt(M1({variant:e}),t),...n}));Ip.displayName=Mp.displayName;const E1=m.forwardRef(({className:t,...e},n)=>o.jsx(Lp,{ref:n,className:tt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));E1.displayName=Lp.displayName;const Ap=m.forwardRef(({className:t,...e},n)=>o.jsx(_p,{ref:n,className:tt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:o.jsx(Fe,{className:"h-4 w-4"})}));Ap.displayName=_p.displayName;const Dp=m.forwardRef(({className:t,...e},n)=>o.jsx(Ep,{ref:n,className:tt("text-sm font-semibold",t),...e}));Dp.displayName=Ep.displayName;const Rp=m.forwardRef(({className:t,...e},n)=>o.jsx(Pp,{ref:n,className:tt("text-sm opacity-90",t),...e}));Rp.displayName=Pp.displayName;function P1(){const{toasts:t}=ip();return o.jsxs(T1,{children:[t.map(function({id:e,title:n,description:r,action:s,...i}){return o.jsxs(Ip,{...i,children:[o.jsxs("div",{className:"grid gap-1",children:[n&&o.jsx(Dp,{children:n}),r&&o.jsx(Rp,{children:r})]}),s,o.jsx(Ap,{})]},e)}),o.jsx(zp,{})]})}var L1={};const _1=({onCreateNewMap:t,onOpenMap:e,isDarkMode:n})=>{const[r,s]=m.useState(!1),[i,l]=m.useState([]),[a,c]=m.useState({}),[u,h]=m.useState({name:"ProjectName",width:20,height:15,tileSize:64,location:"",isStartingMap:!1});m.useEffect(()=>{(async()=>{const v=localStorage.getItem("recentMaps");if(!v)return;let N=JSON.parse(v);const T=window.electronAPI;if(T&&typeof T.checkProjectExists=="function")try{const E=(await Promise.all(N.map(async O=>{try{return await T.checkProjectExists(O.path)?O:null}catch{return O}}))).filter(Boolean);N=E,E.length!==JSON.parse(v).length&&localStorage.setItem("recentMaps",JSON.stringify(E))}catch(P){console.warn("Prune recent maps failed:",P)}l(N)})()},[]),m.useEffect(()=>{if(!i||i.length===0)return;const x=async v=>{const N=v;if(N.thumbnailDataUrl){c(T=>({...T,[v.id]:N.thumbnailDataUrl}));return}try{const T=window.electronAPI;if(T&&typeof T.getProjectThumbnail=="function"){const P=await T.getProjectThumbnail(v.path);if(P){c(E=>({...E,[v.id]:P}));return}}if(!(T&&typeof T.getProjectThumbnail=="function")){c(P=>({...P,[v.id]:null}));return}}catch(T){console.error("Failed to load thumbnail for",v.path,T)}c(T=>({...T,[v.id]:null}))};return i.forEach(v=>{x(v)}),()=>{Object.values(a).forEach(v=>{v&&v.startsWith("blob:")&&URL.revokeObjectURL(v)})}},[i]);const f=x=>{localStorage.setItem("recentMaps",JSON.stringify(x)),l(x)},p=async()=>{var x;try{if((x=window.electronAPI)!=null&&x.selectDirectory){const v=await window.electronAPI.selectDirectory();v&&h({...u,location:v})}else if("showDirectoryPicker"in window){const v=await window.showDirectoryPicker();h({...u,location:v.name})}else{const v="C:\\Users\\"+(navigator.userAgent.includes("Windows")&&L1.USERNAME||"User")+"\\Documents\\TileMaps";h({...u,location:v})}}catch(v){console.error("Error selecting directory:",v)}},w=async()=>{var v;if(!u.location){alert("Please select a location for your map project");return}const x=u.name.trim().toLowerCase();if(i.some(N=>N.name.trim().toLowerCase()===x)){alert("There can't be maps that have the same name. Please type another name.");return}try{const N=`${u.location}\\${u.name}`;if((v=window.electronAPI)!=null&&v.createMapProject){if(await window.electronAPI.createMapProject(u)){const E=[{id:Date.now().toString(),name:u.name,lastModified:"Just now",path:N},...i.slice(0,9)];f(E),t(u,N)}}else console.log("Creating map project:",u),t(u)}catch(N){console.error("Error creating map project:",N),alert("Error creating map project. Please try again.")}},b=x=>{e(x.path)},j=async()=>{var x;try{if((x=window.electronAPI)!=null&&x.selectDirectory){const v=await window.electronAPI.selectDirectory();v&&e(v)}else alert("Open Map Project functionality requires the desktop app")}catch(v){console.error("Error opening map project:",v)}},S=()=>{var x;(x=window.electronAPI)!=null&&x.minimize?window.electronAPI.minimize():console.log("Minimize clicked - Electron API not available")},y=()=>{var x;(x=window.electronAPI)!=null&&x.maximize?window.electronAPI.maximize():console.log("Maximize clicked - Electron API not available")},g=()=>{var x;(x=window.electronAPI)!=null&&x.close?window.electronAPI.close():console.log("Close clicked - Electron API not available")};return r?o.jsxs("div",{className:`min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-neutral-900 dark:to-neutral-800 flex flex-col ${n?"dark":""}`,children:[o.jsxs("div",{className:"bg-gray-100 dark:bg-neutral-900 text-orange-600 dark:text-orange-400 flex justify-between items-center px-4 py-1 select-none drag-region border-b border-gray-200 dark:border-neutral-700",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("img",{src:"/flare-ico.png",alt:"Flarism Logo",className:"w-6 h-6"}),o.jsx("span",{className:"text-sm font-semibold",children:"Flarism"})]}),o.jsxs("div",{className:"flex no-drag",children:[o.jsx(K,{content:"Minimize",children:o.jsx("button",{onClick:S,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:o.jsx(hc,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Maximize",children:o.jsx("button",{onClick:y,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:o.jsx(_n,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Close",children:o.jsx("button",{onClick:g,className:"text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:o.jsx(Fe,{className:"w-4 h-4"})})})]})]}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xl p-8 w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"inline-flex items-center justify-center",children:o.jsx("img",{src:"/flare-logo.png",alt:"Flare Logo",className:"w-40 h-40 object-contain"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Create a New Flare Project"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Name"}),o.jsx(F,{value:u.name,onChange:x=>h({...u,name:x.target.value}),placeholder:"Enter map name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Location"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(F,{value:u.location,onChange:x=>h({...u,location:x.target.value}),placeholder:"Select folder for your project",readOnly:!0}),o.jsx(z,{type:"button",variant:"outline",onClick:p,children:o.jsx(mo,{className:"w-4 h-4"})})]})]})]}),o.jsxs("div",{className:"flex gap-3 mt-6",children:[o.jsx(z,{variant:"outline",onClick:()=>s(!1),className:"flex-1",children:"Back"}),o.jsx(z,{onClick:w,className:"flex-1",children:"Confirm"})]})]})})]}):o.jsxs("div",{className:`h-screen overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100 dark:from-neutral-900 dark:to-neutral-800 flex flex-col ${n?"dark":""}`,children:[o.jsxs("div",{className:"bg-gray-100 dark:bg-neutral-900 text-orange-600 dark:text-orange-400 flex justify-between items-center px-4 py-1 select-none drag-region border-b border-gray-200 dark:border-neutral-700",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("img",{src:"/flare-ico.png",alt:"Flarism Logo",className:"w-4 h-6"}),o.jsx("span",{className:"text-sm font-semibold",children:"Flarism"})]}),o.jsxs("div",{className:"flex no-drag",children:[o.jsx(K,{content:"Minimize",children:o.jsx("button",{onClick:S,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:o.jsx(hc,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Maximize",children:o.jsx("button",{onClick:y,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:o.jsx(_n,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Close",children:o.jsx("button",{onClick:g,className:"text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-200 dark:hover:bg-neutral-700 px-3 py-1 text-sm rounded transition-colors",children:o.jsx(Fe,{className:"w-4 h-4"})})})]})]}),o.jsxs("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[o.jsxs("div",{className:"w-80 bg-white dark:bg-neutral-900 border-r border-slate-200 dark:border-neutral-700 p-6 flex flex-col h-full",children:[o.jsx("div",{className:"mb-4 flex items-center justify-between",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Projects"})}),o.jsxs("div",{className:"flex-1 min-h-0 h-full",children:[o.jsx("div",{className:"space-y-2 overflow-y-auto minimal-scroll px-1 py-1 h-full",children:i.map(x=>o.jsx("div",{className:"p-3 rounded-lg border border-slate-200 dark:border-neutral-700 hover:bg-slate-50 dark:hover:bg-neutral-800 cursor-pointer transition-colors",onClick:()=>b(x),children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-20 h-20 bg-orange-100 dark:bg-orange-900 rounded overflow-hidden flex items-center justify-center",children:a[x.id]?o.jsx("img",{src:a[x.id]||"",alt:`${x.name} thumbnail`,className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center",children:o.jsx(dc,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:x.name}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:x.lastModified})]})]})},x.id))}),i.length===0&&o.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:[o.jsx(dc,{className:"w-20 h-20 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),o.jsx("p",{children:"No recent project"}),o.jsx("p",{className:"text-sm",children:"Create your first projet to get started"})]})]})]}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsxs("div",{className:"mb-3",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-50 h-20",children:o.jsx("img",{src:"/flare-logo.png",alt:"Flare Logo",className:"w-100 h-100 object-contain"})}),o.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-lg",children:"Flarism is an unofficial, community-made editor inspired by the Flare engine. It is not affiliated with the official Flare developers."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs(z,{onClick:()=>s(!0),className:"w-full h-12 text-lg",size:"lg",children:[o.jsx(po,{className:"w-5 h-5 mr-2"}),"Create New Projet"]}),o.jsxs(z,{variant:"outline",onClick:j,className:"w-full h-12 text-lg",size:"lg",children:[o.jsx(_0,{className:"w-5 h-5 mr-2"}),"Open Existing Project"]})]})]})})]})]})},z1={xp:{type:"int",min:0},xp_scaling:{type:"filename"},defeat_status:{type:"string"},convert_status:{type:"string"},first_defeat_loot:{type:"int",min:1},animations:{type:"filename"},loot:{type:"list"},loot_count:{type:"intPair",min:0},threat_range:{type:"floatPair",min:0},flee_range:{type:"float",min:0},chance_pursue:{type:"float",min:0},chance_flee:{type:"float",min:0},waypoint_pause:{type:"duration"},turn_delay:{type:"duration"},combat_style:{type:"predefined",options:["default","aggressive","passive"]},power:{type:"list"},passive_powers:{type:"list"},quest_loot:{type:"list"},flee_duration:{type:"duration"},flee_cooldown:{type:"duration"},humanoid:{type:"bool"},lifeform:{type:"bool"},flying:{type:"bool"},intangible:{type:"bool"}},Op=new Set(["N","NE","E","SE","S","SW","W","NW"]),I1=new Set(["true","false","1","0"]);function A1(t,e,n){switch(n.type){case"int":{const r=Number.parseInt(e,10);return Number.isNaN(r)?`${t} must be an integer.`:n.min!==void 0&&r<n.min?`${t} must be greater than or equal to ${n.min}.`:n.max!==void 0&&r>n.max?`${t} must be less than or equal to ${n.max}.`:null}case"float":{const r=Number.parseFloat(e);return Number.isNaN(r)?`${t} must be a number.`:n.min!==void 0&&r<n.min?`${t} must be greater than or equal to ${n.min}.`:n.max!==void 0&&r>n.max?`${t} must be less than or equal to ${n.max}.`:null}case"bool":return I1.has(e.toLowerCase())?null:`${t} must be true or false.`;case"filename":return e?null:`${t} cannot be empty.`;case"duration":return/^\d+(ms|s)?$/i.test(e)?null:`${t} must be a duration such as 200ms or 2s.`;case"intPair":{const r=e.split(",").map(s=>s.trim()).filter(Boolean);if(r.length===0||r.length>2)return`${t} must contain one or two comma-separated integers.`;for(const s of r){if(!/^-?\d+$/.test(s))return`${t} must contain valid integers.`;const i=Number.parseInt(s,10);if(n.min!==void 0&&i<n.min)return`${t} values must be greater than or equal to ${n.min}.`;if(n.max!==void 0&&i>n.max)return`${t} values must be less than or equal to ${n.max}.`}return null}case"floatPair":{const r=e.split(",").map(s=>s.trim()).filter(Boolean);if(r.length===0||r.length>2)return`${t} must contain one or two comma-separated numbers.`;for(const s of r){const i=Number.parseFloat(s);if(Number.isNaN(i))return`${t} must contain valid numbers.`;if(n.min!==void 0&&i<n.min)return`${t} values must be greater than or equal to ${n.min}.`;if(n.max!==void 0&&i>n.max)return`${t} values must be less than or equal to ${n.max}.`}return null}case"direction":{const r=e.toUpperCase();if(Op.has(r))return null;const s=Number.parseInt(e,10);return!Number.isNaN(s)&&s>=0&&s<=7?null:`${t} must be a direction (N, NE, ... , NW) or a number between 0 and 7.`}case"point":{const r=e.split(",").map(s=>s.trim());return r.length!==2||!r.every(s=>/^-?\d+$/.test(s))?`${t} must be two comma-separated integers.`:null}case"predefined":return n.options&&!n.options.includes(e)?`${t} must be one of: ${n.options.join(", ")}.`:null;case"list":case"string":default:return null}}const D1={};function R1(t){const e=t.type==="enemy"?z1:t.type==="npc"?D1:{},n={},r=[],s=t.properties||{};for(const[i,l]of Object.entries(s)){const c=(l??"").toString().trim(),u=e[i];if(u){const h=A1(i,c,u);h&&r.push(h),u.type==="bool"?n[i]=c.toLowerCase():u.type==="direction"&&Op.has(c.toUpperCase())?n[i]=c.toUpperCase():n[i]=c}else n[i]=c}return{errors:r,sanitized:n}}function O1(){const[t,e]=m.useState(!0),[n,r]=m.useState(null),s=m.useRef(null),[i,l]=m.useState(0),[a,c]=m.useState(0),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[w,b]=m.useState(20),[j,S]=m.useState(15),[y,g]=m.useState("Untitled Map"),[x,v]=m.useState(null),[N,T]=m.useState([]),[P,E]=m.useState(!1),[O,A]=m.useState("(none)"),[X,V]=m.useState(!0),[te,U]=m.useState(!0),[re,ye]=m.useState(!1),[Ue,_]=m.useState(!1),[B,Y]=m.useState([]),[J,ne]=m.useState(null),[le,ht]=m.useState(!1),[Wr,Xe]=m.useState(!1),[Kn,gu]=m.useState(!1),[$p,xu]=m.useState(!1),[ci,yu]=m.useState("engine"),[vu,Fp]=m.useState(!0),[ui,Yr]=m.useState(!0),di=m.useRef(null),ol=m.useRef(null),[jn,Ur]=m.useState(!0),hi=m.useRef(null),wu=m.useRef(null),[fi,bu]=m.useState(!0),ll=m.useRef(null),Hp=m.useRef(null),[Zt,mi]=m.useState(null),Tt=m.useCallback(()=>{di.current!==null&&(window.clearTimeout(di.current),di.current=null)},[]),Qn=m.useCallback(()=>{Tt(),di.current=window.setTimeout(()=>{Yr(!1)},500)},[Tt]),pi=m.useCallback(()=>{Yr(!0),Qn()},[Qn]),Bp=m.useCallback(()=>{Tt(),Yr(!0)},[Tt]),Wp=m.useCallback(()=>{var k;const d=typeof document<"u"?document.activeElement:null;d&&((k=ol.current)!=null&&k.contains(d))||Qn()},[Qn,ol]),Yp=m.useCallback(()=>{Tt(),Yr(!0)},[Tt]),Up=m.useCallback(d=>{const k=d.relatedTarget;d.currentTarget.contains(k)||Qn()},[Qn]),Mt=m.useCallback(()=>{hi.current!==null&&(window.clearTimeout(hi.current),hi.current=null)},[]),Zn=m.useCallback(()=>{Mt(),hi.current=window.setTimeout(()=>{Ur(!1)},500)},[Mt]),Jn=m.useCallback(()=>{Ur(!0),Zn()},[Zn]),Xp=m.useCallback(()=>{Mt(),Ur(!0)},[Mt]),Vp=m.useCallback(()=>{var k;const d=typeof document<"u"?document.activeElement:null;d&&((k=wu.current)!=null&&k.contains(d))||Zn()},[Zn]),Gp=m.useCallback(()=>{Mt(),Ur(!0)},[Mt]),qp=m.useCallback(d=>{const k=d.relatedTarget;d.currentTarget.contains(k)||Zn()},[Zn]),er=m.useCallback(()=>{ll.current!==null&&(window.clearTimeout(ll.current),ll.current=null)},[]),ku=m.useCallback(()=>{er()},[er]),Xr=m.useCallback(()=>{bu(!0),ku()},[ku]),Kp=m.useCallback(d=>{Hp.current=d},[]),Qp=m.useCallback(d=>{xl.current=d,wu.current=d},[]),Sn=m.useCallback(d=>{Zp(d),Jn()},[Jn]),gi=m.useCallback(d=>{cl(k=>k===d?"none":d),Xr()},[Xr]),tr=m.useMemo(()=>{var d;return typeof window<"u"&&!!((d=window.electronAPI)!=null&&d.selectTilesetFile)},[]),[ve,Zp]=m.useState("brush"),[Jp,xi]=m.useState(!1),[eg,yi]=m.useState(!1),[tg,vi]=m.useState(!1),[Nn,Vr]=m.useState("brush"),[Cn,wi]=m.useState("rectangular"),[nr,al]=m.useState("rectangle"),[Ve,cl]=m.useState("none"),[ng,Gr]=m.useState(!1),[bi,ul]=m.useState(null),[ju,dl]=m.useState([]),[qr,hl]=m.useState(null),[rr,Kr]=m.useState("select"),[$1,fl]=m.useState(!1),[Qr,Su]=m.useState(""),[rg,ki]=m.useState(!1),[sr,Zr]=m.useState(null),[Et,Jr]=m.useState("Untitled Map"),[ir,ji]=m.useState(!1),[Ge,sg]=m.useState(()=>{const d=localStorage.getItem("isDarkMode");return d?JSON.parse(d):!1}),[or,ig]=m.useState(()=>{const d=localStorage.getItem("showSidebarToggle");return d?JSON.parse(d):!0});m.useEffect(()=>{try{localStorage.setItem("showSidebarToggle",JSON.stringify(or))}catch{}},[or]);const[Si,Nu]=m.useState("saved"),[es,og]=m.useState(!0),[lg,Cu]=m.useState(0),[ml,Tu]=m.useState(!1),[lr,Mu]=m.useState(!1),[be,Eu]=m.useState(null),[Pu,Lu]=m.useState(!1),[_u,zu]=m.useState(!1),[ag,Tn]=m.useState(0),[cg,Iu]=m.useState(!1),[ar,Au]=m.useState(!1),[cr,ts]=m.useState(null),Mn=m.useRef(null),[ug,Ni]=m.useState(!1),[q,Oe]=m.useState(null),[Du,ns]=m.useState([]),[pl,rs]=m.useState([]),[se,gl]=m.useState(null),[Ru,Jt]=m.useState(null),[dg,Ci]=m.useState(!1),[je,ss]=m.useState(null),Dt=m.useRef(null),Rt=m.useRef(null),Ot=m.useRef(null),xl=m.useRef(null),[nt,yl]=m.useState(null),[hg,vl]=m.useState(0),[wl,bl]=m.useState(!1),{toast:rt}=ip(),[Ou,kl]=m.useState([]),[ur,en]=m.useState(!1),jl=m.useRef(null),[Sl,$u]=m.useState(null),Nl=m.useRef(null),Fu=m.useRef(null),[Cl,Hu]=m.useState(null),[Ti,Mi]=m.useState(!1);m.useEffect(()=>{if(!ur)return;const d=()=>{const k=jl.current;if(!k)return $u(null);const C=k.getBoundingClientRect();$u({left:C.left,top:C.top-8})};return d(),window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}},[ur]),m.useEffect(()=>{if(!Ti)return;const d=()=>{const k=Nl.current;if(!k)return Hu(null);const C=k.getBoundingClientRect();Hu({left:C.right+8,top:C.top})};return d(),window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}},[Ti]),m.useEffect(()=>{if(!ur)return;const d=C=>{C.key==="Escape"&&(en(!1),Mi(!1))},k=C=>{const M=Nl.current,I=Fu.current,$=jl.current,G=C.target;M&&(M.contains(G)||I&&I.contains(G)||$&&$.contains(G)||(en(!1),Mi(!1)))};return window.addEventListener("keydown",d),window.addEventListener("mousedown",k),()=>{window.removeEventListener("keydown",d),window.removeEventListener("mousedown",k)}},[ur]);const Ee=m.useCallback(()=>{rs(n?n.getMapObjects():[])},[n]);m.useEffect(()=>()=>{},[rt]),m.useEffect(()=>{Ge?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),n&&n.setDarkMode(Ge),localStorage.setItem("isDarkMode",JSON.stringify(Ge))},[Ge,n]),m.useEffect(()=>{if(!n)return;const d=k=>{A(k>0?k.toString():"(none)")};return n.setActiveGidCallback(d),()=>{n.setActiveGidCallback(null)}},[n]);const dr=m.useCallback(d=>{d.setAutoSaveCallback(async()=>{try{window.electronAPI&&be&&await d.saveProjectData(be)}catch(k){console.warn("Auto-save to disk failed:",k)}Cu(Date.now())}),d.setSaveStatusCallback(k=>{Nu(k),Mu(k==="unsaved"||k==="error")}),d.setAutoSaveEnabled(es),d.setEyedropperCallback(()=>{Sn("brush"),Vr("brush")}),d.setStampCallback(k=>{dl(k)}),d.setObjectsChangedCallback(k=>{rs(k)}),d.setHeroEditCallback((k,C,M,I,$)=>{ss({currentX:k,currentY:C,mapWidth:M,mapHeight:I,onConfirm:$}),Ci(!0)})},[es,be,Sn]);m.useEffect(()=>()=>{Tt()},[Tt]),m.useEffect(()=>{!t&&u&&pi()},[t,u,pi]),m.useEffect(()=>{(t||!u)&&(Yr(!0),Tt())},[t,u,Tt]),m.useEffect(()=>()=>{er()},[er]),m.useEffect(()=>{!t&&u&&Xr()},[t,u,Xr]),m.useEffect(()=>{(t||!u)&&(bu(!0),er())},[t,u,er]),m.useEffect(()=>()=>{Mt()},[Mt]),m.useEffect(()=>{!t&&u&&Jn()},[t,u,Jn]),m.useEffect(()=>{(t||!u)&&(Ur(!0),Mt())},[t,u,Mt]),m.useEffect(()=>{if(s.current&&!t&&!n&&!Pu&&!Zt){const d=new ha(s.current);d.setDarkMode(Ge),dr(d),d.resetForNewProject(),u&&i>0&&a>0?d.setMapSize(i,a):d.setMapSize(0,0),r(d)}},[t,n,dr,Pu,Ge,Zt,u,i,a]),m.useEffect(()=>{if(!n)return;const d=()=>{const M=n.getHoverCoordinates();yl(M)};let k;const C=()=>{d(),k=requestAnimationFrame(C)};return C(),()=>{k&&cancelAnimationFrame(k)}},[n]),m.useEffect(()=>{if(n&&ve==="brush"){const k={brush:"brush",bucket:"bucket",eraser:"eraser"}[Nn]||"brush";n.setCurrentTool(k)}else if(n&&ve==="selection"){const k={rectangular:"rectangular","magic-wand":"magic-wand","same-tile":"same-tile",circular:"circular"}[Cn]||"rectangular";n.setCurrentSelectionTool(k)}else if(n&&ve==="shape"){const k={rectangle:"rectangle",circle:"circle",line:"line"}[nr]||"rectangle";n.setCurrentShapeTool(k)}else n&&ve==="eyedropper"?n.setEyedropperTool():n&&ve==="stamp"&&n.setStampTool()},[n,ve,Nn,Cn,nr]),m.useEffect(()=>{!n||ve!=="stamp"||n.setCurrentStampMode(rr)},[n,ve,rr]),m.useEffect(()=>{!n||ve!=="stamp"||n.setActiveStamp(qr)},[n,ve,qr]),m.useEffect(()=>{if(!n)return;const k=setInterval(()=>{const C=n.getSelection(),M=n.hasActiveSelection();vl(C.length),bl(M)},100);return()=>clearInterval(k)},[n]);const st=m.useCallback(()=>{if(n){const d=n.getLayers();Y([...d]);const k=n.getActiveLayerId();ne(k),Ee()}},[n,Ee]);m.useEffect(()=>{n&&st()},[n,st]),m.useEffect(()=>{Ee()},[Ee]),m.useEffect(()=>{const d=k=>{le&&ht(!1)};return le&&document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[le]);const $e=m.useCallback((d,k)=>{if(xl.current){const C=xl.current.getBoundingClientRect();let M=window.innerWidth/2;if(s&&s.current){const $=s.current.getBoundingClientRect();M=$.left+$.width/2}const I=Math.max(8,C.top-60);ts({content:d,x:M,y:I,visible:!0,fadeOut:!1})}else{const C=k.getBoundingClientRect(),M=C.left+C.width/2,I=C.top-10;ts({content:d,x:M,y:I,visible:!0,fadeOut:!1})}Mn.current&&clearTimeout(Mn.current),Mn.current=setTimeout(()=>{ts(C=>C?{...C,fadeOut:!0}:null),setTimeout(()=>{ts(null)},300)},1e3)},[]),qe=m.useCallback(()=>{Mn.current&&clearTimeout(Mn.current),ts(null)},[]);m.useEffect(()=>()=>{Mn.current&&clearTimeout(Mn.current),Dt.current&&clearTimeout(Dt.current),Rt.current&&clearTimeout(Rt.current),Ot.current&&clearTimeout(Ot.current)},[]);const Bu=m.useCallback(()=>{Dt.current&&clearTimeout(Dt.current),Rt.current&&clearTimeout(Rt.current),Ot.current&&clearTimeout(Ot.current),yi(!1),vi(!1),fl(!1),xi(!0)},[]),Wu=m.useCallback(()=>{Dt.current=setTimeout(()=>{xi(!1)},1e3)},[]),Yu=m.useCallback(()=>{Dt.current&&clearTimeout(Dt.current),Rt.current&&clearTimeout(Rt.current),Ot.current&&clearTimeout(Ot.current),xi(!1),vi(!1),fl(!1),yi(!0)},[]),Uu=m.useCallback(()=>{Rt.current=setTimeout(()=>{yi(!1)},1e3)},[]),Xu=m.useCallback(()=>{Dt.current&&clearTimeout(Dt.current),Rt.current&&clearTimeout(Rt.current),Ot.current&&clearTimeout(Ot.current),xi(!1),yi(!1),vi(!0)},[]),Vu=m.useCallback(()=>{Ot.current=setTimeout(()=>{vi(!1)},1e3)},[]),Gu=m.useCallback(()=>{if(!n||!Qr.trim())return;n.createStampFromSelection(Qr.trim())&&(Su(""),fl(!1),Kr("select"))},[n,Qr]),fg=m.useCallback(d=>{hl(d),Kr("place")},[]),mg=m.useCallback(d=>{n&&(n.deleteStamp(d),qr===d&&(hl(null),Kr("select")))},[n,qr]),pg=()=>{switch(Nn){case"bucket":return o.jsx(ca,{className:"w-4 h-4"});case"eraser":return o.jsx(la,{className:"w-4 h-4"});default:return o.jsx(Qi,{className:"w-4 h-4"})}},gg=()=>{switch(Cn){case"magic-wand":return o.jsx(da,{className:"w-4 h-4"});case"same-tile":return o.jsx(mr,{className:"w-4 h-4"});case"circular":return o.jsx(Ss,{className:"w-4 h-4"});default:return o.jsx(Q0,{className:"w-4 h-4"})}},xg=()=>{switch(nr){case"circle":return o.jsx(Ss,{className:"w-4 h-4"});case"line":return o.jsx(Ch,{className:"w-4 h-4"});default:return o.jsx(pw,{className:"w-4 h-4"})}},qu=m.useCallback(d=>{ul(d),Gr(!0)},[]),yg=m.useCallback(()=>{if(!(!n||bi===null)){try{n.separateBrush(bi),console.log(`Separated brush with ID: ${bi}`)}catch(d){console.error("Failed to separate brush:",d)}Gr(!1),ul(null),cl("none")}},[n,bi]),Ku=m.useCallback(d=>{n&&(console.log(`handleRemoveBrush called with brushId: ${d}`),Zr({type:"removeBrush",payload:d}))},[n]),Qu=m.useCallback((d,k)=>{if(n)try{const C=n.getDetectedTileInfo(),M=C.findIndex($=>$.gid===d),I=C.findIndex($=>$.gid===k);M!==-1&&I!==-1&&(n.reorderBrush(M,I),console.log(`Reordered brush ${d} to position of ${k}`))}catch(C){console.error("Failed to reorder brush:",C)}},[n]),Tl=m.useCallback(d=>{if(!n)return;ns([]);const k=n.getMapObjects().find(C=>C.id===d);k&&(Oe(k),Ni(!0))},[n]),Zu=m.useCallback(d=>{n&&(n.updateMapObject(d.id,d),Oe(null),Ni(!1),Ee(),ns([]))},[n,Ee]),vg=m.useCallback(d=>{const k=(nt==null?void 0:nt.x)??0,C=(nt==null?void 0:nt.y)??0;gl({type:d,name:"",x:k.toString(),y:C.toString(),tilesetPath:""}),Jt(null)},[nt]),hr=m.useCallback((d,k)=>{gl(C=>C&&{...C,[d]:k}),Jt(null)},[]),Ju=m.useCallback(async()=>{var d;if(!(typeof window>"u"||!((d=window.electronAPI)!=null&&d.selectTilesetFile)))try{const k=await window.electronAPI.selectTilesetFile();k&&hr("tilesetPath",k)}catch(k){console.error("Failed to select tileset file for actor:",k)}},[hr]),Ei=m.useCallback(()=>{gl(null),Jt(null)},[]),wg=m.useCallback(d=>{n&&(n.removeMapObject(d),Ee())},[n,Ee]),bg=m.useCallback(()=>{if(!n||!se)return;const d=parseInt(se.x,10),k=parseInt(se.y,10);if(!se.name.trim()){Jt("Name is required.");return}if(Number.isNaN(d)||Number.isNaN(k)){Jt("Position must be whole numbers.");return}if(d<0||d>=n.getMapWidth()||k<0||k>=n.getMapHeight()){Jt("Position is outside of the map bounds.");return}if(!se.tilesetPath.trim()){Jt("Tileset location is required.");return}const C=se.tilesetPath.trim(),M=se.name.trim();if(n.getObjectsAtPosition(d,k).find(G=>G.type===se.type)){Jt(`There is already a ${se.type==="npc"?"NPC":"enemy"} at that position.`);return}const $=n.addMapObject("enemy",d,k,1,1);n.updateMapObject($.id,{name:M,x:d,y:k,type:se.type,category:se.type==="npc"?"npc":"enemy",wander_radius:se.type==="npc"?0:$.wander_radius,properties:{...$.properties||{},tilesetPath:C}}),Ee(),Ei()},[se,n,Ei,Ee]),ed=m.useCallback(()=>{Ni(!1),Oe(null),ns([])},[]),kg=m.useCallback(()=>{if(!q)return;const{errors:d,sanitized:k}=R1(q);if(d.length>0){ns(d);return}ns([]),Zu({...q,properties:k})},[q,Zu]),D=m.useCallback((d,k)=>{Oe(C=>{if(!C)return C;const M={...C.properties||{}};return k===null||k===""?delete M[d]:M[d]=k,{...C,properties:M}})},[]),Ml=m.useCallback((d,k)=>{Oe(C=>{if(!C)return C;const M={...C.properties||{}};return M[d]=k?"true":"false",{...C,properties:M}})},[]),H=m.useCallback((d,k="")=>!q||!q.properties?k:q.properties[d]??k,[q]),td=m.useCallback(async()=>{var d;if(!(typeof window>"u"||!((d=window.electronAPI)!=null&&d.selectTilesetFile)))try{const k=await window.electronAPI.selectTilesetFile();k&&D("tilesetPath",k)}catch(k){console.error("Failed to select tileset for editing object:",k)}},[D]),jg=m.useCallback((d,k)=>{je!=null&&je.onConfirm&&je.onConfirm(d,k),Ci(!1),ss(null)},[je]),Sg=m.useCallback(()=>{Ci(!1),ss(null)},[]);m.useEffect(()=>{if(!n||!s.current)return;const d=C=>{console.log("Double-click detected on canvas");const M=n.getActiveLayer();if(console.log("Active layer:",M),!M){console.log("No active layer found");return}if(!["enemy","npc","object","event","background"].includes(M.type)){console.log(`Layer type '${M.type}' is not interactive, skipping double-click`);return}const $=n.getHoverCoordinates();if(console.log("Hover coordinates:",$),$){const G=n.getMapObjects(),ie=n.getObjectsAtPosition($.x,$.y);console.log("All objects:",G.length),console.log("Objects at hover position:",ie);const Pe=G.find($t=>$t.x===$.x&&$t.y===$.y);console.log("Object at position (find method):",Pe),Pe?(console.log(`Opening edit dialog for object ID: ${Pe.id}`),Tl(Pe.id)):console.log("No object found at hover position")}},k=s.current;return k.addEventListener("dblclick",d),()=>{k.removeEventListener("dblclick",d)}},[n,Tl]),m.useEffect(()=>{console.log(`Brush tool changed to: ${Ve}`);const d=document.querySelector("[data-brush-tool]");if(d)d.setAttribute("data-brush-tool",Ve),console.log(`Updated existing data-brush-tool attribute to: ${Ve}`);else{const k=document.createElement("div");k.setAttribute("data-brush-tool",Ve),k.style.display="none",document.body.appendChild(k),console.log(`Created new data-brush-tool element with value: ${Ve}`)}},[Ve]),m.useEffect(()=>{const d=k=>{const{action:C,tileIndex:M}=k.detail;switch(C){case"separate":qu(M);break;case"remove":Ku(M);break;case"drop":k.detail.from&&k.detail.to&&Qu(k.detail.from,k.detail.to);break}};return document.addEventListener("brushAction",d),()=>{document.removeEventListener("brushAction",d)}},[qu,Ku,Qu]);const Ng=m.useCallback(async(d,k)=>{try{console.log("=== LOAD PROJECT DATA DEBUG ==="),console.log("Map config received:",{name:k.name,tilesets:k.tilesets?k.tilesets.length:0,tilesetImages:k.tilesetImages?Object.keys(k.tilesetImages).length:0,layers:k.layers?k.layers.length:0}),console.log("Map config full structure:",k),console.log("Creating layers from config...");const C=k.layers||[];console.log("Layers from config:",C);for(const M of C)if(console.log("Processing layer:",M),d.addLayer(M.name,M.type)){console.log(`Created layer: ${M.type} - ${M.name}`);const $=d.getLayers().find(G=>G.type===M.type);$&&M.data&&Array.isArray(M.data)&&(console.log(`Setting data for layer ${$.id} with ${M.data.length} tiles`),$.data=M.data)}else console.log(`Failed to create layer: ${M.type} - ${M.name}`);return console.log("=== CALLING EDITOR loadProjectData ==="),d.loadProjectData(k),console.log("Project data loading completed"),!0}catch(C){return console.error("Error loading project data:",C),!1}},[]);m.useEffect(()=>{Zt&&s.current&&!t&&(console.log("Canvas available and map config pending, creating editor..."),(async()=>{var k;try{console.log("Creating new editor with pending config...");const C=new ha(s.current);console.log("Clearing local storage backup..."),C.clearLocalStorageBackup(),console.log("Setting map size..."),C.setMapSize(Zt.width,Zt.height),console.log("Loading project data...");const M=await Ng(C,Zt);if(console.log("Project data loading result:",M),console.log("=== EDITOR STATE AFTER loadProjectData ==="),console.log("Tile count after loadProjectData:",C.getTileCount()),console.log("Active layer after loadProjectData:",C.getActiveLayerId()),console.log("Layers after loadProjectData:",C.getLayers().map(I=>({id:I.id,name:I.name,type:I.type}))),(k=window.electronAPI)!=null&&k.discoverTilesetImages&&be){console.log("Calling discoverTilesetImages for path:",be);const I=await window.electronAPI.discoverTilesetImages(be),$=(I==null?void 0:I.tilesetImages)||{},G=Object.keys($),ie=Zt,Pe=ie.tilesets&&Array.isArray(ie.tilesets)&&ie.tilesets.some($t=>$t.layerType);if(console.log("Has per-layer tilesets in project:",Pe),console.log("Available discovered images:",G),!Pe&&G.length>0){console.log("No per-layer tilesets found, using fallback assignment");const $t=Ft=>(Ft||"").toLowerCase().replace(/\.[^/.]+$/,"").replace(/[^a-z0-9]+/g," ").trim(),sd=C.getActiveLayerId(),Vg=C.getLayers();let id=!1;for(const Ft of Vg){const od=[$t(Ft.type),$t(Ft.name)];let Ht=null;for(const ls of G){const zl=$t(ls);if(od.includes(zl)){Ht=ls;break}}if(!Ht){const ls=G.find(zl=>{const Gg=$t(zl);return od.some(ld=>ld&&Gg.includes(ld))});ls&&(Ht=ls)}!Ht&&G.length===1&&(Ht=G[0]),Ht?(console.log(`Assigning tileset '${Ht}' to layer ${Ft.id} (${Ft.type})`),C.setActiveLayer(Ft.id),await C.loadTilesetFromDataURL($[Ht],Ht),id=!0):console.log(`No matching tileset found for layer ${Ft.id} (${Ft.type})`)}sd!==null&&C.setActiveLayer(sd),id&&C.forceSave()}else console.log("Per-layer tilesets already loaded, skipping fallback assignment")}console.log("Setting up autosave and updating UI..."),C.setDarkMode(Ge),dr(C),r(C),h(!0),p(!1),setTimeout(()=>{st();const I=C.getActiveLayerId(),$=C.getLayers().find(G=>G.id===I);console.log("Final UI update - checking active layer:",I,$==null?void 0:$.type),C.redraw()},150),mi(null)}catch(C){console.error("Failed to create editor with pending config:",C),mi(null)}})())},[Zt,t,be,dr,st]);const Cg=(d,k)=>{var M;const C=(M=d.target.files)==null?void 0:M[0];C&&(n!=null&&n.handleFileUpload)&&n.handleFileUpload(C,k)},Tg=d=>{n&&(n.setActiveLayer(d),ne(d))},Mg=d=>{if(n){n.toggleLayerVisibility(d);const k=n.getLayers();Y([...k])}},Eg=(d,k)=>{if(n){const C=B.find(M=>M.id===d);if(C){const M=C.transparency||0,I=Math.max(0,Math.min(1,M+k));n.setLayerTransparency(d,I),st()}}},Pg=()=>{n!=null&&n.resizeMap&&n.resizeMap(i,a)},Lg=()=>{n!=null&&n.zoomIn&&n.zoomIn()},_g=()=>{n!=null&&n.zoomOut&&n.zoomOut()},zg=()=>{n!=null&&n.resetZoom&&n.resetZoom()},Ig=m.useCallback(d=>{const k=d.trim().toLowerCase();if(!k)return!1;const C=new Set;N.forEach(M=>{M&&C.add(M)}),Et.trim()&&C.add(Et.trim().toLowerCase());try{const M=localStorage.getItem("recentMaps");if(M){const I=JSON.parse(M);Array.isArray(I)&&I.forEach($=>{if($&&typeof $.name=="string"){const G=$.name.trim().toLowerCase();G&&C.add(G)}})}}catch(M){console.warn("Failed to read recent map names for duplicate check:",M)}return C.has(k)},[Et,N]),El=m.useCallback(()=>{b(i>0?i:20),S(a>0?a:15),g(Et||"Untitled Map"),E(ir),v(null),p(!0)},[i,a,Et,ir]),Ag=async()=>{if(ar)return;const d=Math.max(1,Math.floor(w)||0),k=Math.max(1,Math.floor(j)||0),C=y.trim(),M=C||"Untitled Map";if(Ig(M)){v("There can't be maps that have the same name. Please type another name.");return}v(null),Au(!0);try{if(!await is({silent:!0})){v("Failed to export the current map. Please resolve any errors and try again.");return}T(G=>{const ie=Et.trim().toLowerCase();return!ie||G.includes(ie)?G:[...G,ie]}),Y([]),ne(null),dl([]),hl(null),rs([]),yl(null),cl("none"),Gr(!1),ul(null),Nu("saved"),Mu(!1);let $=n;!$&&s.current&&($=new ha(s.current),$.setDarkMode(Ge),dr($)),$&&($.resetForNewProject(),$.setMapSize(d,k),$.setDarkMode(Ge),n||r($),st(),Ee()),l(d),c(k),h(!0),pi(),Jn(),Jr(M),ji(P),bl(!1),vl(0),v(null),p(!1)}finally{Au(!1)}},Pl=m.useCallback(()=>{n!=null&&n.undo&&(n.undo(),st(),Ee())},[n,st,Ee]),Ll=m.useCallback(()=>{n!=null&&n.redo&&(n.redo(),st(),Ee())},[n,st,Ee]),is=m.useCallback(async({silent:d=!1}={})=>{var I;if(!n||!be)return rt({title:"Export Failed",description:"No project loaded or editor not initialized.",variant:"destructive"}),!1;d||(zu(!0),Tn(0));const k=(()=>{const $=Et.replace(/[<>:"/|?*]/g,"_").trim().replace(/\s+/g,"_").replace(/_{2,}/g,"_");return $||"Untitled_Map"})(),M=["# this file is automatically loaded when a New Game starts.","# it's a dummy map to send the player to the actual starting point.","","[header]","width=1","height=1","hero_pos=0,0","","[event]","type=event","location=0,0,1,1","activate=on_load",`intermap=${ir?`maps/${k}.txt`:"maps/test11.txt"}`,""].join(`
`);try{d||Tn(25);const $=n.generateFlareMapTxt();d||Tn(50);const G=n.generateFlareTilesetDef();if(d||Tn(75),(I=window.electronAPI)!=null&&I.saveExportFiles){if(!await window.electronAPI.saveExportFiles(be,Et,$,G,{spawn:{enabled:!0,content:M,filename:"spawn.txt"}}))throw new Error("Failed to save export files");d||(Tn(100),setTimeout(()=>{Iu(!0)},1500))}else n.exportFlareMap(),console.warn("Spawn file creation skipped: Electron API unavailable."),d||Tn(100);return!0}catch($){return console.error("Export failed:",$),rt({title:"Export Failed",description:"An error occurred while exporting the map.",variant:"destructive"}),!1}finally{d||setTimeout(()=>{zu(!1),Tn(0)},1e3)}},[n,be,Et,ir,rt]),Dg=m.useCallback(async()=>{await is()},[is]),En=m.useCallback(async()=>{if(n){Tu(!0);try{if(window.electronAPI&&be){const d=await n.saveProjectData(be);await new Promise(k=>setTimeout(k,300)),d&&Cu(Date.now())}else n.forceSave(),await new Promise(d=>setTimeout(d,500))}catch(d){console.error("Save error:",d)}finally{Tu(!1)}}},[n,be]),Rg=m.useCallback(async()=>{var d;if(!be||!((d=window.electronAPI)!=null&&d.listMaps)){kl([]);return}try{const k=await window.electronAPI.listMaps(be);kl(k||[])}catch(k){console.warn("Failed to list maps:",k),kl([])}},[be]),Og=m.useCallback(async d=>{if(be)try{if(!await is({silent:!0})){rt({title:"Export failed",description:"Failed to export current map before opening a new one.",variant:"destructive"});return}await En();const C=await window.electronAPI.readMapFile(be,d);if(!C){rt({title:"Open failed",description:`Failed to read map file ${d}`,variant:"destructive"});return}n&&typeof n.loadFlareMapTxt=="function"?(n.loadFlareMapTxt(C),st(),Ee(),h(!0),Jr(d.replace(/\.txt$/i,"")),rt({title:"Map opened",description:`Opened ${d}`})):rt({title:"Map loaded (raw)",description:"Map content loaded but no parser available in the editor. Implement loadFlareMapTxt to parse it."})}catch(k){console.error("Open map error:",k),rt({title:"Open failed",description:"An unexpected error occurred while opening the map.",variant:"destructive"})}},[be,is,En,n,st,Ee,rt]),$g=()=>{n!=null&&n.toggleMinimap&&n.toggleMinimap(),V(!X)},Fg=(d,k)=>{var I;localStorage.removeItem("tilemap_autosave_backup"),Eu(k??null);const C=(I=d.name)!=null&&I.trim()?d.name.trim():"Untitled Map",M=!!d.isStartingMap;Jr(C),ji(M),g(C),E(M),l(0),c(0),b(d.width),S(d.height),h(!1),Y([]),ne(null),dl([]),rs([]),yl(null),bl(!1),vl(0),mi(null),r(null),v(null),p(!1),e(!1)},Pi=m.useCallback(async d=>{var k,C;console.log("=== HANDLE OPEN MAP CALLED ===",d),console.log("Project path details:",{path:d,timestamp:new Date().toISOString()});try{if(Lu(!0),Eu(d),(k=window.electronAPI)!=null&&k.openMapProject){console.log("Calling electronAPI.openMapProject...");const M=await window.electronAPI.openMapProject(d);if(console.log("=== RAW MAP CONFIG RECEIVED ==="),console.log("Full mapConfig object:",JSON.stringify(M,null,2)),M){console.log("=== MAP CONFIG ANALYSIS ==="),console.log("Map dimensions:",{width:M.width,height:M.height}),console.log("Map name:",M.name);const I=(C=M.name)!=null&&C.trim()?M.name.trim():"Untitled Map",$=!!M.isStartingMap;Jr(I),g(I),ji($),E($);const G=M;console.log("Tilesets count:",G.tilesets?G.tilesets.length:0),console.log("Tileset images count:",G.tilesetImages?Object.keys(G.tilesetImages).length:0),console.log("Layers count:",G.layers?G.layers.length:0),G.tilesets&&(console.log("=== TILESETS DETAILS ==="),G.tilesets.forEach((ie,Pe)=>{console.log(`Tileset ${Pe}:`,{fileName:ie.fileName,tileWidth:ie.tileWidth,tileHeight:ie.tileHeight,spacing:ie.spacing,margin:ie.margin,tileCount:ie.tileCount})})),G.layers&&(console.log("=== LAYERS DETAILS ==="),G.layers.forEach((ie,Pe)=>{console.log(`Layer ${Pe}:`,{id:ie.id,name:ie.name,type:ie.type,visible:ie.visible,opacity:ie.opacity,dataLength:ie.data?ie.data.length:0})})),G.tilesetImages&&(console.log("=== TILESET IMAGES DETAILS ==="),Object.entries(G.tilesetImages).forEach(([ie,Pe])=>{console.log(`Image ${ie}:`,{dataType:typeof Pe,dataLength:Pe?Pe.length:0,isDataURL:typeof Pe=="string"&&Pe.startsWith("data:")})})),console.log("Setting map dimensions and clearing editor..."),l(M.width),c(M.height),h(!0),pi(),Jn(),e(!1),p(!1),console.log("Clearing existing editor..."),n?(console.log("Found existing editor, clearing it"),r(null)):console.log("No existing editor to clear"),console.log("Storing map config for deferred editor creation"),mi(M)}}else console.log("Opening map project:",d)}catch(M){console.error("Error opening map project:",M)}finally{Lu(!1)}},[n,dr,st]);m.useEffect(()=>{window.electronAPI&&(window.electronAPI.onMenuSaveMap(async()=>{await En()}),window.electronAPI.onMenuOpenMap(async()=>{const d=await window.electronAPI.selectDirectory();d&&await Pi(d)}),window.electronAPI.onMenuNewMap(()=>{e(!0),h(!1),r(null),l(0),c(0),p(!1)}),window.electronAPI.onMenuUndo(()=>{Pl()}),window.electronAPI.onMenuRedo(()=>{Ll()}))},[En,Pi,Pl,Ll]),m.useEffect(()=>{window.electronAPI&&(window.electronAPI.onBeforeClose(async()=>{await window.electronAPI.confirmClose(lr)}),window.electronAPI.onSaveAndClose(async()=>{try{await En(),window.electronAPI.closeAfterSave()}catch(d){console.error("Failed to save before close:",d),window.electronAPI.closeAfterSave()}}))},[lr,En]),m.useEffect(()=>{const d=k=>{if(lr)return k.preventDefault(),k.returnValue="",""};return window.addEventListener("beforeunload",d),()=>{window.removeEventListener("beforeunload",d)}},[lr]);const Hg=()=>{var d;(d=window.electronAPI)!=null&&d.minimize?window.electronAPI.minimize():console.log("Minimize clicked - Electron API not available")},Bg=()=>{var d;(d=window.electronAPI)!=null&&d.maximize?window.electronAPI.maximize():console.log("Maximize clicked - Electron API not available")},Wg=()=>{var d;(d=window.electronAPI)!=null&&d.close?window.electronAPI.close():console.log("Close clicked - Electron API not available")},Yg=()=>{n&&n.fillSelection()},Ug=()=>{n&&n.clearSelection()},Xg=()=>{n&&n.deleteSelection()},Ce=m.useMemo(()=>B.find(d=>d.id===J)??null,[B,J]),os=(Ce==null?void 0:Ce.type)==="npc",Li=(Ce==null?void 0:Ce.type)==="enemy",nd=m.useMemo(()=>os?pl.filter(d=>d.type==="npc"):Li?pl.filter(d=>d.type==="enemy"):[],[pl,os,Li]),[_l,rd]=m.useState("map");return o.jsx(o.Fragment,{children:t?o.jsx(_1,{onCreateNewMap:Fg,onOpenMap:Pi,isDarkMode:Ge}):o.jsxs("div",{className:"h-screen bg-background text-foreground flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"bg-gray-100 dark:bg-neutral-900 text-orange-600 dark:text-orange-400 flex justify-between items-center px-4 py-1 select-none drag-region border-b border-gray-200 dark:border-neutral-700",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("img",{src:"/flare-ico.png",alt:"Flarism Logo",className:"w-4 h-6"}),o.jsx("span",{className:"text-sm font-semibold text-orange-600 dark:text-orange-400",children:"Flarism"})]}),o.jsx("div",{className:"text-sm font-medium"}),o.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[Si==="saving"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),o.jsx("span",{className:"text-orange-600",children:"Saving..."})]}),Si==="saved"&&lg>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),o.jsx("span",{className:"text-green-600",children:"Saved"})]}),Si==="error"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),o.jsx("span",{className:"text-red-600",children:"Save Error"})]}),Si==="unsaved"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),o.jsx("span",{className:"text-yellow-600",children:"Unsaved"})]})]})]}),o.jsxs("div",{className:"flex no-drag",children:[o.jsx(K,{content:"Minimize",children:o.jsx("button",{onClick:Hg,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded transition-colors",children:o.jsx(hc,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Maximize",children:o.jsx("button",{onClick:Bg,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded transition-colors",children:o.jsx(_n,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Close",children:o.jsx("button",{onClick:Wg,className:"text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 hover:bg-gray-200 dark:hover:bg-gray-700 p-1 rounded transition-colors",children:o.jsx(Fe,{className:"w-4 h-4"})})})]})]}),or&&o.jsx("button",{onClick:()=>{if(_(!0),n&&typeof n.setSidebarTransitioning=="function")try{n.setSidebarTransitioning(!0)}catch{}ye(d=>!d),window.setTimeout(()=>{if(_(!1),n&&typeof n.setSidebarTransitioning=="function")try{n.setSidebarTransitioning(!1)}catch{}},380)},"aria-label":re?"Show sidebar":"Hide sidebar",style:{left:re?0:224},className:"no-drag no-press-shift press-fill-effect fixed top-1/2 transform -translate-y-1/2 z-50 bg-white/90 dark:bg-neutral-900/90 border border-border rounded-l-md p-1 shadow-md hover:bg-white dark:hover:bg-neutral-800",children:re?o.jsx(v0,{className:"w-4 h-4"}):o.jsx(x0,{className:"w-4 h-4"})}),o.jsxs("main",{className:"flex flex-1 min-h-0",children:[o.jsxs("aside",{className:"relative border-r border-border bg-muted/30 p-2 overflow-visible flex flex-col transition-all duration-200 ease-in-out app-sidebar "+(re?"sidebar-collapsed":""),"aria-hidden":re,children:[o.jsx("div",{className:"sidebar-inner",children:o.jsxs("section",{className:"flex flex-col flex-1",children:[(()=>{const d=(Ce==null?void 0:Ce.type)==="event";return os||Li||d?o.jsx(o.Fragment,{children:(os||Li)&&o.jsx("div",{className:"flex-1 min-h-0",children:nd.length===0?o.jsx("div",{className:"h-full border border-dashed border-border rounded-md flex items-center justify-center text-sm text-muted-foreground px-4 text-center",children:os?"No NPCs added yet. Use the Add control to place your first NPC.":"No enemies added yet. Use the Add control to place an enemy."}):o.jsx("div",{className:"space-y-2 overflow-y-auto pr-1",children:nd.map(k=>{var C;return o.jsx("div",{className:"border border-border rounded-md px-3 py-2 bg-background/50 hover:bg-background transition-colors cursor-pointer",onClick:()=>Tl(k.id),children:o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsxs("div",{className:"font-medium text-foreground",title:k.name||`${k.type==="npc"?"NPC":"Enemy"} #${k.id}`,children:[o.jsx("span",{className:re?"sr-only":"",children:k.name||`${k.type==="npc"?"NPC":"Enemy"} #${k.id}`}),!k.name&&re&&o.jsxs("span",{className:"text-xs text-muted-foreground",children:["#",k.id]})]}),o.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[o.jsx(Nh,{className:"w-3 h-3"}),o.jsxs("span",{className:re?"sr-only":"",children:["(",k.x,", ",k.y,")"]})]}),((C=k.properties)==null?void 0:C.tilesetPath)&&o.jsx("div",{className:"text-xs text-muted-foreground break-all",children:k.properties.tilesetPath})]}),o.jsx(K,{content:"Remove",children:o.jsx(z,{variant:"ghost",size:"sm",className:"w-6 h-6 p-0 text-red-500 hover:text-red-600",onClick:M=>{M.stopPropagation(),wg(k.id)},children:o.jsx(Fe,{className:"w-3 h-3"})})})]})},k.id)})})})}):null})(),o.jsx("div",{id:"tilesetMeta",className:"text-sm text-muted-foreground mb-2"}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:o.jsxs("div",{className:"relative flex-1 min-h-0 overflow-auto h-full",children:[o.jsx("div",{id:"tilesContainer",className:"tile-palette h-full"}),o.jsx("div",{"data-brush-tool":Ve,className:"hidden"})]})}),o.jsxs("div",{className:"flex items-center mb-3 mt-2 sticky top-2 z-10 bg-transparent",children:[o.jsx("div",{className:"text-xs text-muted-foreground"}),o.jsx("div",{className:"w-full flex justify-center",children:o.jsxs("div",{ref:Kp,className:"flex items-center transition-all duration-300 ease-in-out gap-1 transform -translate-x-1",children:[o.jsx("div",{className:"flex-shrink-0",children:(()=>{const d=(Ce==null?void 0:Ce.type)==="npc",k=(Ce==null?void 0:Ce.type)==="enemy",C=(Ce==null?void 0:Ce.type)==="event",I=d||k||C?`Add ${C?"Event":d?"NPC":"Enemy"}`:"Import a PNG tileset for the active layer";return d||k||C?o.jsx(K,{content:I,side:"bottom",children:o.jsx(z,{variant:"default",size:"sm","aria-label":I,className:"relative z-20 text-xs px-1 py-1 h-6 shadow-sm bg-orange-500 hover:bg-orange-600 text-white border-orange-500",onClick:$=>{$.stopPropagation(),$.preventDefault(),d||k?vg(d?"npc":"enemy"):rt({title:"Not implemented",description:"Create Event will be implemented later."})},role:"button",children:o.jsx(Zi,{className:"w-3 h-3 text-white"})})}):o.jsx(K,{content:I,side:"bottom",children:o.jsxs(z,{variant:"default",size:"sm","aria-label":I,className:"relative text-xs px-1 py-1 h-6 shadow-sm bg-orange-500 hover:bg-orange-600 text-white border-orange-500",children:[o.jsx(Zi,{className:"w-3 h-3 text-white"}),o.jsx("input",{type:"file",accept:"image/png",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:$=>{Cg($,"layerTileset")}})]})})})()}),o.jsx("div",{className:"flex-shrink-0 overflow-visible transition-all duration-300 ease-out opacity-100 scale-100 max-w-[2.5rem] w-auto",children:o.jsx(K,{content:"Move/Reorder brushes",children:o.jsx(z,{variant:Ve==="move"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>gi("move"),children:o.jsx(Eh,{className:"w-3 h-3"})})})}),o.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${fi||Ve==="merge"?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:o.jsx(K,{content:"Merge brushes",children:o.jsx(z,{variant:Ve==="merge"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>gi("merge"),children:o.jsx(Sh,{className:"w-3 h-3"})})})}),o.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${fi||Ve==="separate"?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:o.jsx(K,{content:"Separate brushes",children:o.jsx(z,{variant:Ve==="separate"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>gi("separate"),children:o.jsx(hw,{className:"w-3 h-3"})})})}),o.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${fi||Ve==="remove"?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:o.jsx(K,{content:"Remove brushes",children:o.jsx(z,{variant:Ve==="remove"?"default":"outline",size:"sm",className:"text-xs px-1 py-1 h-6 shadow-sm",onClick:()=>gi("remove"),children:o.jsx(Sw,{className:"w-3 h-3"})})})}),o.jsx("div",{className:`flex-shrink-0 overflow-hidden transition-all duration-300 ease-out ${fi?"opacity-100 scale-100 max-w-[2.5rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:o.jsx(K,{content:"Remove tileset for current layer",children:o.jsx(z,{variant:"outline",size:"sm",className:"text-xs px-1 py-1 h-6 border-red-500 hover:border-red-600 hover:bg-red-50 shadow-sm",onClick:()=>{Xr(),Zr({type:"removeTileset"})},children:o.jsx(Fe,{className:"w-3 h-3 text-red-500"})})})})]})})]})]})}),o.jsx("section",{className:"mb-4 flex-shrink-0",onMouseEnter:()=>gu(!0),onMouseLeave:()=>gu(!1),tabIndex:0,children:o.jsx("div",{className:"mb-2",children:o.jsx("div",{className:"h-48 overflow-hidden",children:o.jsx("div",{className:"space-y-0.5 h-full overflow-y-auto",children:B.map(d=>{const k=J===d.id,C=Kn||k;return o.jsx("div",{className:`block w-max px-2 py-1 rounded transition-all text-xs transform-gpu ${k?"bg-orange-50 dark:bg-orange-900/20 border-orange-400":"bg-transparent border-transparent"}`,style:{opacity:C?1:.65,transform:C?"scaleY(1) translateY(0)":"scaleY(0.98) translateY(0)",transformOrigin:"top",pointerEvents:C?"auto":"none",transition:"transform 400ms cubic-bezier(.2,.9,.2,1), opacity 400ms ease, box-shadow 300ms ease",boxShadow:k?"0 6px 12px rgba(15,23,42,0.06)":"none",zIndex:k?30:10},children:o.jsx("div",{className:"cursor-pointer",onClick:()=>Tg(d.id),children:o.jsxs("div",{className:`flex items-center gap-2 ${k?"opacity-100":"opacity-80"}`,children:[o.jsx(K,{content:d.visible?"Hide layer":"Show layer",children:o.jsx(z,{variant:"ghost",size:"sm",onClick:M=>{M.stopPropagation(),Mg(d.id)},className:"w-4 h-4 p-0 hover:bg-gray-200 dark:hover:bg-gray-700",children:d.visible?o.jsx(P0,{className:"w-2.5 h-2.5"}):o.jsx(M0,{className:"w-2.5 h-2.5 text-gray-400 dark:text-gray-500"})})}),o.jsx(z,{variant:"ghost",size:"sm",className:"w-4 h-4 p-0 hover:bg-gray-200 dark:hover:bg-gray-700",onMouseEnter:M=>{const I=Math.round((d.transparency||0)*100);$e(o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Ki,{className:"w-3 h-3"}),"Transparency (",I,"%)"]}),M.currentTarget)},onMouseLeave:qe,onWheel:M=>{M.preventDefault();const I=M.deltaY>0?.1:-.1;Eg(d.id,I);const $=d.transparency||0,G=Math.max(0,Math.min(1,$+I)),ie=Math.round(G*100);$e(o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Ki,{className:"w-3 h-3"}),"Transparency (",ie,"%)"]}),M.currentTarget)},children:o.jsx(d0,{className:"w-2.5 h-2.5"})}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(K,{content:d.name,children:o.jsx("span",{className:"text-xs font-medium truncate flex items-center gap-2",children:(()=>{switch((d.type||"").toLowerCase()){case"background":case"bg":return o.jsx(D0,{className:"w-4 h-4"});case"collision":case"collision layer":return o.jsx(dc,{className:"w-4 h-4"});case"objects":case"object":return o.jsx(f0,{className:"w-4 h-4"});case"npc":return o.jsx(Ew,{className:"w-4 h-4"});case"enemy":return o.jsx($0,{className:"w-4 h-4"});case"event":return o.jsx(j0,{className:"w-4 h-4"});default:return o.jsx(aa,{className:"w-4 h-4"})}})()})}),o.jsx("span",{className:re?"sr-only text-xs font-medium":"text-xs font-medium truncate",title:d.name,children:d.name})]})]})})},d.id)})})})})}),o.jsxs("section",{className:"flex-shrink-0",children:[o.jsx("div",{className:"w-full h-1.5 mb-2",children:_u?o.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-full overflow-hidden",children:o.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 h-full transition-all duration-1000 ease-out rounded-full",style:{width:`${ag}%`}})}):o.jsx("div",{className:"w-full h-full"})}),o.jsxs("div",{className:"flex gap-2 justify-center",children:[o.jsxs("div",{children:[o.jsx(z,{ref:jl,size:"sm",className:"w-7 h-7 p-0 shadow-sm",onClick:async()=>{ur||await Rg(),en(d=>!d)},disabled:_u||ar,children:o.jsx(W0,{className:"w-3 h-3"})}),ur&&Sl&&Yn.createPortal(o.jsx("div",{ref:Nl,style:{left:Sl.left,top:Sl.top,position:"absolute",transform:"translateY(-100%)"},className:"w-56 bg-background border border-border rounded shadow-lg z-[9999]",children:o.jsx("div",{className:"max-h-60 overflow-y-auto",children:be?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",children:[o.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center justify-between gap-2",onClick:()=>Mi(d=>!d),children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(mo,{className:"w-3 h-3"}),o.jsx("span",{children:"Open map"})]}),o.jsx("svg",{className:`w-3 h-3 transition-transform ${Ti?"transform rotate-90":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Ti&&Cl&&Yn.createPortal(o.jsx("div",{ref:Fu,style:{left:Cl.left,top:Cl.top,position:"absolute"},className:"w-48 bg-background border border-border rounded shadow-md z-[10000] max-h-60 overflow-y-auto",children:Ou.length===0?o.jsx("div",{className:"p-2 text-xs text-muted-foreground",children:"No maps found"}):Ou.map(d=>o.jsx("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs",onClick:()=>{en(!1),Mi(!1),Og(d)},children:d},d))}),document.body)]}),o.jsx("div",{className:"border-t border-border"}),o.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:async()=>{en(!1),await Dg()},children:[o.jsx(N0,{className:"w-3 h-3"}),o.jsx("span",{children:"Export map"})]}),o.jsx("div",{className:"border-t border-border"}),o.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:()=>{en(!1),El()},children:[o.jsx(po,{className:"w-3 h-3"}),o.jsx("span",{children:"Create new map"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:async()=>{var d;if(en(!1),(d=window.electronAPI)!=null&&d.selectDirectory)try{const k=await window.electronAPI.selectDirectory();k&&await Pi(k)}catch(k){console.error("Failed to select directory:",k),rt({title:"Open failed",description:"Unable to open project directory.",variant:"destructive"})}else rt({title:"Open unavailable",description:"Open project requires the desktop app.",variant:"destructive"})},children:[o.jsx(mo,{className:"w-3 h-3"}),o.jsx("span",{children:"Open project..."})]}),o.jsx("div",{className:"border-t border-border"}),o.jsx("div",{className:"p-2 text-xs",children:"No project is currently open. Open a project to list maps and enable Export."}),o.jsx("div",{className:"border-t border-border"}),o.jsxs("button",{className:"w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-neutral-800 text-xs flex items-center gap-2",onClick:()=>{en(!1),El()},children:[o.jsx(po,{className:"w-3 h-3"}),o.jsx("span",{children:"Create new map"})]})]})})}),document.body)]}),o.jsx(K,{content:lr?"Save changes":"All changes saved",children:o.jsx(z,{onClick:En,className:`w-7 h-7 p-0 shadow-sm transition-colors ${ml?"bg-blue-500 hover:bg-blue-600":lr?"bg-orange-500 hover:bg-orange-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,disabled:ml||ar,size:"sm",children:ml?o.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):o.jsx(Mh,{className:"w-3 h-3"})})}),o.jsx(K,{content:"Map Settings",children:o.jsx(z,{onClick:()=>Xe(!0),className:"w-7 h-7 p-0 shadow-sm",variant:"outline",size:"sm",children:o.jsx(Ph,{className:"w-3 h-3"})})})]})]})]}),Wr&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Settings"}),o.jsx(z,{variant:"ghost",size:"sm",onClick:()=>Xe(!1),className:"w-8 h-8 p-0",children:o.jsx(Fe,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"flex border-b mb-4",children:[o.jsx("button",{className:`flex-1 py-2 text-sm font-medium border-b-2 transition-colors ${_l==="map"?"border-orange-500 text-orange-600":"border-transparent text-gray-500"}`,onClick:()=>rd("map"),children:"Current Map Settings"}),o.jsx("button",{className:`flex-1 py-2 text-sm font-medium border-b-2 transition-colors ${_l==="other"?"border-orange-500 text-orange-600":"border-transparent text-gray-500"}`,onClick:()=>rd("other"),children:"Other Options"})]}),_l==="map"?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Map Name"}),o.jsx(F,{type:"text",value:Et,onChange:d=>Jr(d.target.value),placeholder:"Enter map name",className:"w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Map Width"}),o.jsx(F,{type:"number",value:i,onChange:d=>l(Number(d.target.value)),min:"1",max:"100",className:"w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Map Height"}),o.jsx(F,{type:"number",value:a,onChange:d=>c(Number(d.target.value)),min:"1",max:"100",className:"w-full"})]}),o.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border px-3 py-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{htmlFor:"starting-map-checkbox",className:"text-sm font-medium text-muted-foreground",children:"Starting Map"}),o.jsx(K,{content:"If this map is the map that players will start the game then mark this option",children:o.jsx(oa,{className:"h-4 w-4 text-muted-foreground","aria-hidden":!0})})]}),o.jsx("input",{id:"starting-map-checkbox",type:"checkbox",className:"h-4 w-4 rounded border border-border accent-orange-500",checked:ir,onChange:d=>ji(d.target.checked),"aria-checked":ir,"aria-label":"Set this map as the starting map"})]}),o.jsxs("div",{className:"flex gap-2 mt-6",children:[o.jsx(z,{variant:"outline",onClick:()=>Xe(!1),className:"flex-1",children:"Cancel"}),o.jsx(z,{onClick:()=>{Pg(),Xe(!1)},className:"flex-1",children:"Apply Changes"})]})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Theme (Experimental)"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Light Mode"}),o.jsxs("button",{onClick:()=>sg(!Ge),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${Ge?"bg-orange-600":"bg-gray-200"}`,children:[o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${Ge?"translate-x-6":"translate-x-1"}`}),o.jsx("span",{className:"sr-only",children:"Toggle dark mode"})]}),o.jsxs("span",{className:"text-sm flex items-center gap-1",children:[Ge?o.jsx(X0,{className:"w-4 h-4"}):o.jsx(bw,{className:"w-4 h-4"}),"Dark Mode"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Debug Mode"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Disabled"}),o.jsxs("button",{onClick:()=>{n&&n.toggleDebugMode()},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${n!=null&&n.getDebugMode()?"bg-orange-600":"bg-gray-200"}`,children:[o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n!=null&&n.getDebugMode()?"translate-x-6":"translate-x-1"}`}),o.jsx("span",{className:"sr-only",children:"Toggle debug mode"})]}),o.jsxs("span",{className:"text-sm flex items-center gap-1",children:[o.jsx(mr,{className:"w-4 h-4"}),"Debug Tiles"]})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shows tile boundaries and coordinates for debugging"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Auto-Save"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Disabled"}),o.jsxs("button",{onClick:()=>{const d=!es;og(d),n&&n.setAutoSaveEnabled(d)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${es?"bg-orange-600":"bg-gray-200"}`,children:[o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${es?"translate-x-6":"translate-x-1"}`}),o.jsx("span",{className:"sr-only",children:"Toggle auto-save"})]}),o.jsx("span",{className:"text-sm",children:"Enabled"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Automatically saves your work every 8 seconds"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Active GID Indicator"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Show"}),o.jsxs("button",{onClick:()=>{U(!te)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${te?"bg-orange-600":"bg-gray-200"}`,children:[o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${te?"translate-x-6":"translate-x-1"}`}),o.jsx("span",{className:"sr-only",children:"Toggle Active GID Indicator"})]}),o.jsx("span",{className:"text-sm",children:te?"Shown":"Hidden"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Toggle whether the Active GID badge is visible next to the hover coordinates."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sidebar Collapse Button"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:"Show toggle"}),o.jsxs("button",{onClick:()=>ig(d=>!d),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${or?"bg-orange-600":"bg-gray-200"}`,children:[o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${or?"translate-x-6":"translate-x-1"}`}),o.jsx("span",{className:"sr-only",children:"Toggle sidebar collapse button"})]}),o.jsx("span",{className:"text-sm",children:or?"Shown":"Hidden"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Show or hide the left-edge sidebar collapse/expand toggle."})]}),o.jsxs("div",{className:"flex gap-2 mt-6",children:[o.jsx(z,{variant:"outline",onClick:()=>Xe(!1),className:"flex-1",children:"Close"}),o.jsxs(z,{onClick:()=>{xu(!0),Xe(!1)},className:"flex-1 flex items-center justify-center gap-2",children:[o.jsx(oa,{className:"w-4 h-4"}),o.jsx("span",{children:"Help & Docs"})]})]})]})]})}),rg&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-80",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Clear Layer"}),o.jsx(z,{variant:"ghost",size:"sm",onClick:()=>ki(!1),className:"w-8 h-8 p-0",children:o.jsx(Fe,{className:"w-4 h-4"})})]}),o.jsx("div",{className:"text-sm text-foreground mb-4",children:"Are you sure you want to clear all tiles from the current layer? This action cannot be undone."}),o.jsxs("div",{className:"flex gap-2 justify-end",children:[o.jsx(z,{variant:"outline",onClick:()=>ki(!1),children:"Cancel"}),o.jsx(z,{onClick:()=>{n&&n.clearLayer(),Vr("brush"),ki(!1)},children:"Clear"})]})]})}),sr&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-80",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Confirm"}),o.jsx(z,{variant:"ghost",size:"sm",onClick:()=>Zr(null),className:"w-8 h-8 p-0",children:o.jsx(Fe,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"text-sm text-foreground mb-4",children:[sr.type==="removeBrush"&&"Are you sure you want to remove this brush?",sr.type==="removeTileset"&&"Are you sure you want to remove the tileset for this layer? This will clear the tileset but keep any placed tiles."]}),o.jsxs("div",{className:"flex gap-2 justify-end",children:[o.jsx(z,{variant:"outline",onClick:()=>Zr(null),children:"Cancel"}),o.jsx(z,{onClick:()=>{try{if(sr.type==="removeBrush"){const d=sr.payload;n&&n.removeBrush(d)}else sr.type==="removeTileset"&&n&&n.removeLayerTileset()}catch(d){console.error("Confirm action failed:",d)}finally{Zr(null)}},children:"Confirm"})]})]})}),$p&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-background border border-border rounded-lg p-0 w-[800px] max-h-[80vh] overflow-y-auto help-modal relative",children:[o.jsxs("div",{className:"sticky top-0 z-20 bg-background/95 backdrop-blur-sm border-b border-border py-3 px-4 rounded-t-lg",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Help & Documentation"}),o.jsx(z,{variant:"ghost",size:"sm",onClick:()=>xu(!1),className:"w-8 h-8 p-0 rounded-full","aria-label":"Close Help",children:o.jsx(Fe,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"flex space-x-1 mt-3 bg-gray-100 dark:bg-neutral-800 rounded-lg p-1",children:[o.jsxs("button",{onClick:()=>yu("engine"),className:`px-3 py-2 rounded-md text-sm font-medium transition-all ${ci==="engine"?"bg-white dark:bg-neutral-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[o.jsx(mr,{className:"w-4 h-4 inline mr-2"}),"Engine"]}),o.jsxs("button",{onClick:()=>yu("collisions"),className:`px-3 py-2 rounded-md text-sm font-medium transition-all ${ci==="collisions"?"bg-white dark:bg-neutral-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[o.jsx(ua,{className:"w-4 h-4 inline mr-2"}),"Collisions"]})]})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[ci==="engine"&&o.jsxs(o.Fragment,{children:[o.jsxs("section",{children:[o.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[o.jsx(mr,{className:"w-5 h-5 text-orange-500"}),"Getting Started"]}),o.jsxs("div",{className:"space-y-2 text-gray-700 dark:text-gray-400",children:[o.jsx("p",{children:"Welcome to the Isometric Tile Map Editor! This tool allows you to create beautiful isometric tile-based maps."}),o.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4 text-gray-700 dark:text-gray-400",children:[o.jsx("li",{children:"Start by creating a new map or loading an existing one"}),o.jsx("li",{children:"Import tilesets to begin designing"}),o.jsx("li",{children:"Use layers to organize different elements of your map"}),o.jsx("li",{children:"Export your finished map for use in your projects"})]})]})]}),o.jsxs("section",{children:[o.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[o.jsx(aa,{className:"w-5 h-5 text-orange-500"}),"Map Management"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:"Layers help organize your map content. Each layer can have its own tileset and transparency."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Mh,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Save/Export"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Save your map as JSON or export as PNG image"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Zi,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Load Map"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Load previously saved JSON map files"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Ph,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Map Settings"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Configure map dimensions, tile size, and other properties"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Sh,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Lock/Unlock"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Prevent accidental edits to completed layers"})]})]})]})]})]}),o.jsxs("section",{children:[o.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[o.jsx(Qi,{className:"w-5 h-5 text-orange-500"}),"Drawing Tools"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Qi,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Brush Tool"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Paint individual tiles by clicking"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(ca,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Bucket Fill"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Fill connected areas with the same tile"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(la,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Eraser"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Remove tiles from the map"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Th,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Eyedropper"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Select a tile from the map to use as brush"})]})]})]})]}),o.jsxs("section",{children:[o.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[o.jsx(_n,{className:"w-5 h-5 text-orange-500"}),"Tileset Management"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:"Each layer can have its own tileset. Import PNG images to use as tilesets."}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Zi,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Import Tileset"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Click the upload button for each layer to import a tileset image"})]})]}),o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Fe,{className:"w-4 h-4 mt-1 text-orange-500"}),o.jsxs("div",{children:[o.jsx("h5",{className:"font-medium text-gray-800 dark:text-gray-100",children:"Remove Tileset"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Use the red X button to remove a tileset from a layer"})]})]})]})]})]}),o.jsxs("section",{children:[o.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2",children:[o.jsx(mr,{className:"w-5 h-5 text-orange-500"}),"Keyboard Shortcuts"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 bg-gray-50 dark:bg-neutral-900 p-4 rounded-lg",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Ctrl+Z"}),o.jsx("span",{className:"text-sm text-gray-400",children:"Undo"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Ctrl+Y"}),o.jsx("span",{className:"text-sm text-gray-400",children:"Redo"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Ctrl+S"}),o.jsx("span",{className:"text-sm text-gray-400",children:"Save Map"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Mouse Wheel"}),o.jsx("span",{className:"text-sm text-gray-400",children:"Zoom"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Middle Click + Drag"}),o.jsx("span",{className:"text-sm text-gray-400",children:"Pan"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-200 dark:bg-neutral-800 px-2 py-1 rounded",children:"Hover + Wheel"}),o.jsx("span",{className:"text-sm text-gray-400",children:"Layer Transparency"})]})]})]})]}),o.jsxs("section",{children:[o.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2",children:[o.jsx(da,{className:"w-5 h-5 text-orange-500"}),"Tips & Best Practices"]}),o.jsx("div",{className:"space-y-2 text-gray-700 dark:text-gray-400",children:o.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-4 text-gray-700 dark:text-gray-400",children:[o.jsx("li",{children:"Use separate layers for different map elements (background, objects, decorations)"}),o.jsx("li",{children:"Name your layers descriptively for better organization"}),o.jsx("li",{children:"Lock completed layers to prevent accidental changes"}),o.jsx("li",{children:"Adjust layer transparency to see underlying elements while editing"}),o.jsx("li",{children:"Use the eyedropper tool to quickly select tiles from existing map areas"}),o.jsx("li",{children:"Save frequently to avoid losing work"}),o.jsx("li",{children:"Test your map export to ensure it looks correct in your target application"})]})})]})]}),ci==="collisions"&&o.jsx(o.Fragment,{children:o.jsxs("section",{children:[o.jsxs("h4",{className:"text-xl font-semibold mb-3 flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[o.jsx(ua,{className:"w-5 h-5 text-orange-500"}),"Summary of Collision Values for Flare"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:"Collision values in Flare Engine determine how entities interact with map tiles. Each value has specific behavior that affects movement and visibility."}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse border border-gray-300 dark:border-gray-600",children:[o.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:o.jsxs("tr",{children:[o.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left font-semibold text-gray-800 dark:text-gray-100",children:"Value"}),o.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left font-semibold text-gray-800 dark:text-gray-100",children:"Type"}),o.jsx("th",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 text-left font-semibold text-gray-800 dark:text-gray-100",children:"Behavior"})]})}),o.jsxs("tbody",{className:"text-gray-700 dark:text-gray-300",children:[o.jsxs("tr",{children:[o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-red-50 dark:bg-red-900/20",children:"1"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-red-600 dark:text-red-400",children:"Red Block"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Impassable wall, visible on minimap"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-red-50 dark:bg-red-900/20",children:"2"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-red-600 dark:text-red-400",children:"Dithered Red"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Still blocks entities, minimap shows dithered tile"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-blue-50 dark:bg-blue-900/20",children:"3"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-blue-600 dark:text-blue-400",children:"Pit (Blue)"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Ground entities blocked; air can pass"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-mono bg-blue-50 dark:bg-blue-900/20",children:"4"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2 font-medium text-blue-600 dark:text-blue-400",children:"Dithered Pit"}),o.jsx("td",{className:"border border-gray-300 dark:border-gray-600 px-4 py-2",children:"Same as 3, but minimap shows dithered"})]})]})]})}),o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[o.jsxs("h5",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2 flex items-center gap-2",children:[o.jsx(ua,{className:"w-4 h-4"}),"Usage Guidelines"]}),o.jsxs("ul",{className:"text-blue-700 dark:text-blue-300 text-sm space-y-1 list-disc list-inside",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Value 1 (Red Block):"})," Use for walls, buildings, and solid obstacles that should be clearly visible on the minimap"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Value 2 (Dithered Red):"})," Use for partial barriers or decorative walls that still block movement"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Value 3 (Pit):"})," Use for water, lava, or ground hazards that flying entities can cross"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Value 4 (Dithered Pit):"})," Use for shallow water or transitional pit areas"]})]})]}),o.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-lg border border-amber-200 dark:border-amber-800",children:[o.jsx("h5",{className:"font-medium text-amber-800 dark:text-amber-200 mb-2",children:"⚠️ Important Notes"}),o.jsxs("ul",{className:"text-amber-700 dark:text-amber-300 text-sm space-y-1 list-disc list-inside",children:[o.jsxs("li",{children:["Collision values are set in the ",o.jsx("strong",{children:"Collision Layer"})," of your map"]}),o.jsx("li",{children:"Each tile position can only have one collision value"}),o.jsx("li",{children:"Collision affects AI pathfinding and player movement"}),o.jsx("li",{children:"Minimap visualization helps players understand map layout"})]})]})]})]})}),o.jsx("div",{className:"pt-4 border-t border-gray-200 text-center",children:o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Flarism | GUI for Flare Engine by ism."})})]})]})}),o.jsxs("section",{className:"flex-1 min-w-0 flex flex-col relative",children:[o.jsx("div",{ref:ol,className:"absolute top-2 right-2 z-10",onMouseEnter:Bp,onMouseLeave:Wp,onFocus:Yp,onBlur:Up,tabIndex:ui?-1:0,"aria-label":"Map controls",children:o.jsxs("div",{className:`flex items-center bg-white/90 dark:bg-neutral-900/90 border border-border rounded-full shadow-lg transition-all duration-300 ease-in-out ${ui?"px-2 py-1":"px-1 py-1"}`,children:[o.jsxs("div",{className:`flex items-center gap-1 overflow-hidden transition-all duration-300 ease-out ${ui?"opacity-100 scale-100 max-w-[420px]":"opacity-0 scale-95 max-w-0 pointer-events-none"}`,children:[o.jsx(K,{content:"Undo (Ctrl+Z)",side:"bottom",children:o.jsx(z,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Pl,children:o.jsx(Cw,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Redo (Ctrl+Y)",side:"bottom",children:o.jsx(z,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Ll,children:o.jsx(ow,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Zoom In",side:"bottom",children:o.jsx(z,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:Lg,children:o.jsx(zw,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Zoom Out",side:"bottom",children:o.jsx(z,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:_g,children:o.jsx(Aw,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Reset View",side:"bottom",children:o.jsx(z,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:zg,children:o.jsx(aw,{className:"w-4 h-4"})})}),o.jsx(K,{content:"Toggle Minimap",side:"bottom",children:o.jsx(z,{size:"sm",variant:"outline",className:"w-8 h-8 p-0 rounded-full",onClick:$g,children:o.jsx(aa,{className:"w-4 h-4"})})})]}),o.jsx("div",{className:`flex items-center justify-center w-8 h-8 transition-all duration-300 ease-out ${ui?"opacity-50 scale-90":"opacity-100 scale-100"}`,"aria-hidden":!0,children:o.jsx(Eh,{className:"w-4 h-4 text-muted-foreground"})})]})}),o.jsxs("div",{className:"bg-gray-100 flex-1 min-h-0 flex items-center justify-center overflow-hidden relative",children:[o.jsxs("div",{className:`absolute top-4 left-4 z-20 p-3 bg-white/90 dark:bg-neutral-900/90 backdrop-blur-sm rounded-lg border border-border shadow-lg transition-opacity duration-300 ${vu?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,"aria-hidden":!vu,children:[o.jsx(z,{variant:"ghost",size:"sm",className:"absolute top-1 right-1 w-6 h-6 p-0",onClick:()=>Fp(!1),children:o.jsx(Fe,{className:"w-3 h-3"})}),o.jsxs("div",{className:"space-y-2 pr-6",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[o.jsx(G0,{className:"w-4 h-4"}),o.jsx("span",{children:"Left Click to Paint"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[o.jsx(Ki,{className:"w-4 h-4"}),o.jsx("span",{children:"Right Click to Delete"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[o.jsx(J0,{className:"w-4 h-4"}),o.jsx("span",{children:"Spacebar + Mouse to Pan"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300",children:[o.jsxs("div",{className:"relative",children:[o.jsx(Ki,{className:"w-4 h-4"}),o.jsx(Ss,{className:"w-2 h-2 absolute top-1 left-1.5 opacity-60"})]}),o.jsx("span",{children:"Mouse Wheel to Zoom In-Out"})]})]})]}),o.jsx("canvas",{ref:s,id:"mapCanvas",className:`tile-canvas w-full h-full max-w-full max-h-full canvas-fade ${Ue?"during-sidebar-transition":""}`}),o.jsx("div",{className:`absolute inset-0 flex items-center justify-center transition-opacity duration-200 ${u?"opacity-0 pointer-events-none":"opacity-100 pointer-events-auto bg-background/80 backdrop-blur-sm"}`,"aria-hidden":u,children:o.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 rounded-full border-2 border-orange-500/80 bg-background/95 shadow-lg backdrop-blur-sm transition-opacity duration-200 ${u?"opacity-0":"opacity-100"}`,children:[o.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Create a map"}),o.jsx(z,{size:"sm",variant:"default",className:"w-9 h-9 p-0 rounded-full bg-orange-500 text-white shadow-sm transition-all duration-150 hover:bg-orange-600 hover:shadow-md hover:-translate-y-0.5 focus-visible:ring-2 focus-visible:ring-orange-500 focus-visible:ring-offset-2",onClick:El,disabled:ar,children:o.jsx(po,{className:"w-4 h-4"})})]})}),o.jsxs("div",{className:`absolute bottom-4 left-4 z-10 p-2 rounded-md text-xs font-mono flex items-center gap-2 transition-opacity duration-200 ${nt?"opacity-100 pointer-events-auto bg-white/90 dark:bg-neutral-900/90 border border-gray-200 dark:border-neutral-600 text-gray-800 dark:text-white shadow-sm":"opacity-0 pointer-events-none"}`,"aria-hidden":!nt,children:[o.jsx(Nh,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),o.jsx("span",{children:nt?`${nt.x}, ${nt.y}`:""}),o.jsx("div",{className:`ml-2 transition-opacity duration-200 ${nt&&te?"opacity-100":"opacity-0 pointer-events-none"}`,children:o.jsx(K,{content:"Active GID number of selected tilebrush",children:o.jsx(s0,{variant:"secondary",className:"text-xs px-2 py-1 bg-black/80 text-white border-gray-600 hover:bg-black/90",children:o.jsx("span",{id:"activeGid",children:O})})})})]}),o.jsxs("div",{className:`absolute bottom-4 left-32 z-10 p-2 rounded-md text-xs flex items-center gap-3 transition-opacity duration-200 ${wl?"opacity-100 pointer-events-auto bg-orange-600/90 border border-orange-500 text-white":"opacity-0 pointer-events-none"}`,children:[o.jsxs("div",{className:"flex items-center gap-2 font-mono",children:[o.jsx(_n,{className:"w-4 h-4 text-orange-200"}),o.jsx("span",{children:wl?`${hg} tiles selected`:""})]}),o.jsxs("div",{className:`flex items-center gap-1 ${wl?"":"pointer-events-none"}`,children:[o.jsx(K,{content:"Fill selection with active tile",children:o.jsx(z,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs text-white hover:bg-orange-500/50",onClick:Yg,children:"Fill"})}),o.jsx(K,{content:"Delete selected tiles (DEL)",children:o.jsx(z,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs text-white hover:bg-orange-500/50",onClick:Xg,children:"Delete"})}),o.jsx(K,{content:"Clear selection (ESC)",children:o.jsx(z,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs text-white hover:bg-orange-500/50",onClick:Ug,children:"Clear"})})]})]}),o.jsx("div",{ref:Qp,className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-30",onMouseEnter:Xp,onMouseLeave:Vp,onFocus:Gp,onBlur:qp,tabIndex:jn?-1:0,"aria-label":"Tool selection",children:o.jsxs("div",{className:`flex items-center bg-white/90 dark:bg-neutral-900/90 border border-border rounded-full shadow-md transition-all duration-300 ease-in-out ${jn?"gap-1 px-2 py-1":"gap-0 px-1 py-1"}`,children:[o.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${jn||ve==="brush"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[o.jsx(z,{variant:ve==="brush"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>Sn("brush"),onMouseEnter:d=>{Bu(),$e("Brush Tool",d.currentTarget)},onMouseLeave:()=>{Wu(),qe()},children:pg()}),Jp&&o.jsxs("div",{className:"absolute bottom-full left-0 mb-1 bg-white dark:bg-neutral-900 border border-border rounded shadow-lg p-1 flex gap-1 min-w-max z-50",onMouseEnter:Bu,onMouseLeave:Wu,children:[o.jsx(z,{variant:Nn==="brush"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>Vr("brush"),onMouseEnter:d=>$e("Brush Tool",d.currentTarget),onMouseLeave:qe,children:o.jsx(Qi,{className:"w-3 h-3"})}),o.jsx(z,{variant:Nn==="bucket"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>Vr("bucket"),onMouseEnter:d=>$e("Bucket Fill",d.currentTarget),onMouseLeave:qe,children:o.jsx(ca,{className:"w-3 h-3"})}),o.jsx(z,{variant:Nn==="eraser"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>Vr("eraser"),onMouseEnter:d=>$e("Eraser",d.currentTarget),onMouseLeave:qe,children:o.jsx(la,{className:"w-3 h-3"})}),o.jsx(z,{variant:Nn==="clear"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button border-red-500 hover:border-red-600 hover:bg-red-50",onClick:()=>ki(!0),onMouseEnter:d=>$e("Clear Layer",d.currentTarget),onMouseLeave:qe,children:o.jsx(Fe,{className:"w-3 h-3 text-red-500"})})]})]}),o.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${jn||ve==="selection"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[o.jsx(z,{variant:ve==="selection"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>Sn("selection"),onMouseEnter:d=>{Yu(),$e("Selection Tool",d.currentTarget)},onMouseLeave:()=>{Uu(),qe()},children:gg()}),eg&&o.jsxs("div",{className:"absolute bottom-full left-0 mb-1 bg-white dark:bg-neutral-900 border border-border rounded shadow-lg p-1 flex gap-1 min-w-max z-50",onMouseEnter:Yu,onMouseLeave:Uu,children:[o.jsx(z,{variant:Cn==="rectangular"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>wi("rectangular"),onMouseEnter:d=>$e("Rectangular Selection",d.currentTarget),onMouseLeave:qe,children:o.jsx(_n,{className:"w-3 h-3"})}),o.jsx(z,{variant:Cn==="magic-wand"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>wi("magic-wand"),onMouseEnter:d=>$e("Magic Wand",d.currentTarget),onMouseLeave:qe,children:o.jsx(da,{className:"w-3 h-3"})}),o.jsx(z,{variant:Cn==="same-tile"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>wi("same-tile"),onMouseEnter:d=>$e("Select Same Tile",d.currentTarget),onMouseLeave:qe,children:o.jsx(mr,{className:"w-3 h-3"})}),o.jsx(z,{variant:Cn==="circular"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>wi("circular"),onMouseEnter:d=>$e("Circular Select",d.currentTarget),onMouseLeave:qe,children:o.jsx(Ss,{className:"w-3 h-3"})})]})]}),o.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${jn||ve==="shape"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[o.jsx(z,{variant:ve==="shape"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>Sn("shape"),onMouseEnter:d=>{Xu(),$e("Shape Tool",d.currentTarget)},onMouseLeave:()=>{Vu(),qe()},children:xg()}),tg&&o.jsxs("div",{className:"absolute bottom-full left-0 mb-1 bg-white dark:bg-neutral-900 border border-border rounded shadow-lg p-1 flex gap-1 min-w-max z-50",onMouseEnter:Xu,onMouseLeave:Vu,children:[o.jsx(K,{content:"Rectangle Shape",children:o.jsx(z,{variant:nr==="rectangle"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>al("rectangle"),children:o.jsx(_n,{className:"w-3 h-3"})})}),o.jsx(K,{content:"Circle Shape",children:o.jsx(z,{variant:nr==="circle"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>al("circle"),children:o.jsx(Ss,{className:"w-3 h-3"})})}),o.jsx(K,{content:"Line Shape",children:o.jsx(z,{variant:nr==="line"?"default":"ghost",size:"sm",className:"w-6 h-6 p-1 rounded-full sub-tool-button",onClick:()=>al("line"),children:o.jsx(Ch,{className:"w-3 h-3"})})})]})]}),o.jsxs("div",{className:`relative flex-shrink-0 transition-all duration-300 ease-out ${jn||ve==="stamp"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:[o.jsx(z,{variant:ve==="stamp"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>Sn("stamp"),onMouseEnter:d=>$e("Stamp Tool - Group tiles into a stamp and place them together",d.currentTarget),onMouseLeave:qe,children:o.jsx(vw,{className:"w-3 h-3"})}),ve==="stamp"&&o.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg p-2 min-w-[200px] z-10",children:o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("div",{className:"flex gap-1",children:[o.jsx(K,{content:"Select and place existing stamps",children:o.jsx(z,{variant:rr==="select"?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>Kr("select"),children:"Select"})}),o.jsx(K,{content:"Create stamp from selection",children:o.jsx(z,{variant:rr==="create"?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>Kr("create"),children:"Create"})})]}),rr==="create"&&o.jsxs("div",{className:"border-t pt-2",children:[o.jsx("div",{className:"text-xs font-medium mb-1",children:"Create New Stamp"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"text",placeholder:"Stamp name",value:Qr,onChange:d=>Su(d.target.value),className:"flex-1 text-xs px-2 py-1 border rounded",onKeyDown:d=>{d.key==="Enter"&&Gu()}}),o.jsx(z,{size:"sm",className:"text-xs",onClick:Gu,disabled:!Qr.trim(),children:"Create"})]}),o.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"First select tiles, then create stamp"})]}),rr==="select"&&o.jsxs("div",{className:"border-t pt-2 max-h-32 overflow-y-auto",children:[o.jsx("div",{className:"text-xs font-medium mb-1",children:"Available Stamps"}),ju.length===0?o.jsx("div",{className:"text-xs text-gray-500",children:"No stamps created yet"}):o.jsx("div",{className:"flex flex-col gap-1",children:ju.map(d=>o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(K,{content:`${d.name} (${d.width}x${d.height})`,children:o.jsx(z,{variant:qr===d.id?"default":"ghost",size:"sm",className:"flex-1 text-xs justify-start",onClick:()=>fg(d.id),children:d.name})}),o.jsx(K,{content:"Delete stamp",children:o.jsx(z,{variant:"ghost",size:"sm",className:"w-6 h-6 p-0 text-red-500",onClick:()=>mg(d.id),children:o.jsx(Fe,{className:"w-3 h-3"})})})]},d.id))})]})]})})]}),o.jsx("div",{className:`flex-shrink-0 transition-all duration-300 ease-out ${jn||ve==="eyedropper"?"opacity-100 scale-100 max-w-[3rem] w-auto":"opacity-0 scale-90 max-w-0 w-0 pointer-events-none"}`,children:o.jsx(z,{variant:ve==="eyedropper"?"default":"ghost",size:"sm",className:"w-7 h-7 p-1 rounded-full tool-button",onClick:()=>Sn("eyedropper"),onMouseEnter:d=>$e("Eyedropper Tool - Pick a tile from the map to reuse",d.currentTarget),onMouseLeave:qe,children:o.jsx(Th,{className:"w-3 h-3"})})})]})})]})]})]}),o.jsx(P1,{}),o.jsx(ys,{open:ng,onOpenChange:Gr,children:o.jsxs(vs,{children:[o.jsxs(ws,{children:[o.jsx(bs,{children:"Separate Brush"}),o.jsx(ks,{children:"Are you sure you want to separate this brush?"})]}),o.jsxs(js,{children:[o.jsx(z,{variant:"outline",onClick:()=>Gr(!1),children:"Cancel"}),o.jsx(z,{onClick:yg,children:"Separate"})]})]})}),o.jsx(ys,{open:se!==null,onOpenChange:d=>d?void 0:Ei(),children:o.jsxs(vs,{className:"max-w-md",children:[o.jsxs(ws,{children:[o.jsx(bs,{children:(se==null?void 0:se.type)==="npc"?"Add NPC":"Add Enemy"}),o.jsxs(ks,{children:["Define the placement details for this ",(se==null?void 0:se.type)==="npc"?"NPC":"enemy","."]})]}),se&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),o.jsx(F,{value:se.name,onChange:d=>hr("name",d.target.value),placeholder:se.type==="npc"?"Village Elder":"Goblin Scout"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"X Position"}),o.jsx(F,{type:"number",value:se.x,onChange:d=>hr("x",d.target.value),min:0,max:(n==null?void 0:n.getMapWidth())??void 0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Y Position"}),o.jsx(F,{type:"number",value:se.y,onChange:d=>hr("y",d.target.value),min:0,max:(n==null?void 0:n.getMapHeight())??void 0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tileset Location"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(F,{className:"flex-1",value:se.tilesetPath,onChange:d=>hr("tilesetPath",d.target.value),placeholder:"Desktop/mytilesets/npcs/mynpc.png",readOnly:tr,onClick:tr?()=>{Ju()}:void 0}),o.jsx(z,{type:"button",variant:"outline",size:"sm",onClick:()=>{Ju()},disabled:!tr,children:"Browse"})]})]}),Ru&&o.jsx("div",{className:"text-sm text-red-500",children:Ru})]}),o.jsxs(js,{children:[o.jsx(z,{variant:"outline",onClick:Ei,children:"Cancel"}),o.jsx(z,{onClick:bg,children:(se==null?void 0:se.type)==="npc"?"Add NPC":"Add Enemy"})]})]})}),o.jsx(ys,{open:ug,onOpenChange:d=>{d?Ni(!0):ed()},children:o.jsxs(vs,{className:"max-w-5xl w-full h-[90vh] flex flex-col",children:[o.jsxs(ws,{children:[o.jsx(bs,{children:q?`Edit ${q.type}`:"Add Object"}),o.jsxs(ks,{children:["Configure ",(q==null?void 0:q.type)||"object"," properties for Flare engine compatibility."]})]}),Du.length>0&&o.jsxs("div",{className:"mb-3 rounded-md border border-destructive/40 bg-destructive/10 p-3 text-sm text-destructive",children:[o.jsx("p",{className:"font-semibold mb-1",children:"Please fix the following:"}),o.jsx("ul",{className:"ml-4 list-disc space-y-1",children:Du.map((d,k)=>o.jsx("li",{children:d},`${d}-${k}`))})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-2 minimal-scroll",children:q&&o.jsxs("div",{className:"space-y-4 pb-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),o.jsx(F,{value:q.name||"",onChange:d=>Oe({...q,name:d.target.value}),placeholder:"Object name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),o.jsx(F,{value:q.category||"",onChange:d=>Oe({...q,category:d.target.value}),placeholder:q.type==="enemy"?"creature":"block"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"X Position"}),o.jsx(F,{type:"number",value:q.x,onChange:d=>Oe({...q,x:Number(d.target.value)})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Y Position"}),o.jsx(F,{type:"number",value:q.y,onChange:d=>Oe({...q,y:Number(d.target.value)})})]})]}),(q.type==="npc"||q.type==="enemy")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tileset Location"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(F,{className:"flex-1",value:H("tilesetPath",""),onChange:d=>D("tilesetPath",d.target.value),placeholder:"Desktop/mytilesets/npcs/mynpc.png",readOnly:tr,onClick:tr?()=>{td()}:void 0}),o.jsx(z,{type:"button",variant:"outline",size:"sm",onClick:()=>{td()},disabled:!tr,children:"Browse"})]})]}),q.type==="enemy"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Level"}),o.jsx(F,{type:"number",value:q.level||1,onChange:d=>Oe({...q,level:Number(d.target.value)}),min:"1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Number"}),o.jsx(F,{type:"number",value:q.number||1,onChange:d=>Oe({...q,number:Number(d.target.value)}),min:"1"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Wander Radius"}),o.jsx(F,{type:"number",value:q.wander_radius||4,onChange:d=>Oe({...q,wander_radius:Number(d.target.value)}),min:"0"})]}),o.jsxs("div",{className:"space-y-3 border border-border rounded-md p-3 bg-muted/20",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold",children:"Enemy Specifications"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure Flare StatBlock-compatible values."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"XP"}),o.jsx(F,{type:"number",value:H("xp",""),onChange:d=>D("xp",d.target.value),min:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"XP Scaling Table"}),o.jsx(F,{value:H("xp_scaling",""),onChange:d=>D("xp_scaling",d.target.value),placeholder:"tables/xp_scaling.txt"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Defeat Status"}),o.jsx(F,{value:H("defeat_status",""),onChange:d=>D("defeat_status",d.target.value),placeholder:"campaign_status_id"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Convert Status"}),o.jsx(F,{value:H("convert_status",""),onChange:d=>D("convert_status",d.target.value),placeholder:"campaign_status_id"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"First Defeat Loot"}),o.jsx(F,{value:H("first_defeat_loot",""),onChange:d=>D("first_defeat_loot",d.target.value),placeholder:"items/id.txt"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Animations Definition"}),o.jsx(F,{value:H("animations",""),onChange:d=>D("animations",d.target.value),placeholder:"animations/enemies/foo.txt"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loot Entries (one per line)"}),o.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("loot",""),onChange:d=>D("loot",d.target.value),placeholder:"item_id, chance"})]}),(()=>{const d=H("loot_count",""),[k="",C=""]=d.split(",").map(M=>M.trim());return o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loot Count Min"}),o.jsx(F,{type:"number",value:k,min:"0",onChange:M=>{const I=M.target.value;I?D("loot_count",C?`${I},${C}`:I):D("loot_count","")}})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loot Count Max"}),o.jsx(F,{type:"number",value:C,min:"0",onChange:M=>{const I=M.target.value;k?D("loot_count",I?`${k},${I}`:k):D("loot_count","")}})]})]})})(),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Threat Range (engage, stop)"}),(()=>{const d=H("threat_range",""),[k="",C=""]=d.split(",").map(M=>M.trim());return o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsx(F,{type:"number",value:k,onChange:M=>{const I=M.target.value;I?D("threat_range",C?`${I},${C}`:I):D("threat_range",C?`0,${C}`:"")}}),o.jsx(F,{type:"number",value:C,onChange:M=>{const I=M.target.value;k?D("threat_range",I?`${k},${I}`:k):D("threat_range","")}})]})})()]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Flee Range"}),o.jsx(F,{type:"number",value:H("flee_range",""),onChange:d=>D("flee_range",d.target.value)})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chance Pursue (%)"}),o.jsx(F,{type:"number",value:H("chance_pursue",""),onChange:d=>D("chance_pursue",d.target.value),min:"0",max:"100",step:"0.1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chance Flee (%)"}),o.jsx(F,{type:"number",value:H("chance_flee",""),onChange:d=>D("chance_flee",d.target.value),min:"0",max:"100",step:"0.1"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Waypoint Pause"}),o.jsx(F,{value:H("waypoint_pause",""),onChange:d=>D("waypoint_pause",d.target.value),placeholder:"250ms"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Turn Delay"}),o.jsx(F,{value:H("turn_delay",""),onChange:d=>D("turn_delay",d.target.value),placeholder:"100ms"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Combat Style"}),o.jsxs("select",{className:"w-full rounded-md border border-border bg-background px-2 py-1 text-sm",value:H("combat_style",""),onChange:d=>D("combat_style",d.target.value),children:[o.jsx("option",{value:"",children:"Default"}),o.jsx("option",{value:"default",children:"default"}),o.jsx("option",{value:"aggressive",children:"aggressive"}),o.jsx("option",{value:"passive",children:"passive"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Triggered Powers (state,power,chance per line)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("power",""),onChange:d=>D("power",d.target.value),placeholder:"melee,power/melee_slash,25"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Passive Powers (one power id per line)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("passive_powers",""),onChange:d=>D("passive_powers",d.target.value),placeholder:"power_id"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Quest Loot (one per line: status,not_status,item_id)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("quest_loot",""),onChange:d=>D("quest_loot",d.target.value),placeholder:"status_required,status_block,item_id"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Flee Duration"}),o.jsx(F,{value:H("flee_duration",""),onChange:d=>D("flee_duration",d.target.value),placeholder:"1.5s"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Flee Cooldown"}),o.jsx(F,{value:H("flee_cooldown",""),onChange:d=>D("flee_cooldown",d.target.value),placeholder:"5s"})]})]}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{key:"humanoid",label:"Humanoid"},{key:"lifeform",label:"Lifeform"},{key:"flying",label:"Flying"},{key:"intangible",label:"Intangible"},{key:"facing",label:"Facing"},{key:"suppress_hp",label:"Hide HP Bar"}].map(d=>o.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[o.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:H(d.key,"false")==="true",onChange:k=>Ml(d.key,k.target.checked)}),d.label]},d.key))})]})]}),q.type==="npc"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-3 border border-border rounded-md p-3 bg-muted/20",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold",children:"Dialog"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure dialog tree content and metadata."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Dialog ID"}),o.jsx(F,{value:H("dialog.id",""),onChange:d=>D("dialog.id",d.target.value),placeholder:"villager_intro"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Topic"}),o.jsx(F,{value:H("dialog.topic",""),onChange:d=>D("dialog.topic",d.target.value),placeholder:"Greetings"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Group"}),o.jsx(F,{value:H("dialog.group",""),onChange:d=>D("dialog.group",d.target.value),placeholder:"main_story"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Voice File(s)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.voice",""),onChange:d=>D("dialog.voice",d.target.value),placeholder:"voice/npcs/intro.ogg"})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lines (Him)"}),o.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.him",""),onChange:d=>D("dialog.him",d.target.value),placeholder:"Hello there!"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lines (Her)"}),o.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.her",""),onChange:d=>D("dialog.her",d.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lines (You)"}),o.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.you",""),onChange:d=>D("dialog.you",d.target.value),placeholder:"What brings you here?"})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait (Him)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.portrait_him",""),onChange:d=>D("dialog.portrait_him",d.target.value),placeholder:"portraits/npcs/villager.png"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait (Her)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.portrait_her",""),onChange:d=>D("dialog.portrait_her",d.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait (You)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.portrait_you",""),onChange:d=>D("dialog.portrait_you",d.target.value)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Response IDs (one per line, must precede dialog text)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("dialog.response",""),onChange:d=>D("dialog.response",d.target.value)})]}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{key:"dialog.allow_movement",label:"Allow Movement",defaultValue:"false"},{key:"dialog.take_a_party",label:"Take/Release Party",defaultValue:"false"},{key:"dialog.response_only",label:"Response Only",defaultValue:"false"}].map(d=>o.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[o.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:H(d.key,d.defaultValue||"false")==="true",onChange:k=>Ml(d.key,k.target.checked)}),d.label]},d.key))})]}),o.jsxs("div",{className:"space-y-3 border border-border rounded-md p-3 bg-muted/20",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold",children:"NPC Details"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure appearance, behavior, and requirements."})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"NPC Name"}),o.jsx(F,{value:H("npc.name",q.name||""),onChange:d=>D("npc.name",d.target.value),placeholder:"Villager"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Portrait"}),o.jsx(F,{value:H("npc.portrait",""),onChange:d=>D("npc.portrait",d.target.value),placeholder:"portraits/npcs/villager.png"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Definition File"}),o.jsx(F,{value:H("npc.filename",""),onChange:d=>D("npc.filename",d.target.value),placeholder:"npcs/villager.txt"})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Direction"}),o.jsx(F,{value:H("npc.direction",""),onChange:d=>D("npc.direction",d.target.value),placeholder:"south"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Waypoints (x,y per line)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.waypoints",""),onChange:d=>D("npc.waypoints",d.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Wander Radius"}),o.jsx(F,{type:"number",value:H("npc.wander_radius",""),onChange:d=>D("npc.wander_radius",d.target.value),min:"0"})]})]}),o.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{key:"npc.show_on_minimap",label:"Show on Minimap",defaultValue:"true"},{key:"npc.talker",label:"Talkable",defaultValue:"true"},{key:"npc.vendor",label:"Vendor",defaultValue:"false"}].map(d=>o.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[o.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:H(d.key,d.defaultValue||"false")==="true",onChange:k=>Ml(d.key,k.target.checked)}),d.label]},d.key))}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Status (one per line)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_status",""),onChange:d=>D("npc.requires_status",d.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Not Status"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_not_status",""),onChange:d=>D("npc.requires_not_status",d.target.value)})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Item (one per line)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_item",""),onChange:d=>D("npc.requires_item",d.target.value),placeholder:"items/potion:2"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Not Item"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.requires_not_item",""),onChange:d=>D("npc.requires_not_item",d.target.value)})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Level ≥"}),o.jsx(F,{type:"number",value:H("npc.requires_level",""),onChange:d=>D("npc.requires_level",d.target.value),min:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Level <"}),o.jsx(F,{type:"number",value:H("npc.requires_not_level",""),onChange:d=>D("npc.requires_not_level",d.target.value),min:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Class"}),o.jsx(F,{value:H("npc.requires_class",""),onChange:d=>D("npc.requires_class",d.target.value),placeholder:"warrior"})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Currency ≥"}),o.jsx(F,{type:"number",value:H("npc.requires_currency",""),onChange:d=>D("npc.requires_currency",d.target.value),min:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Currency <"}),o.jsx(F,{type:"number",value:H("npc.requires_not_currency",""),onChange:d=>D("npc.requires_not_currency",d.target.value),min:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Requires Not Class"}),o.jsx(F,{value:H("npc.requires_not_class",""),onChange:d=>D("npc.requires_not_class",d.target.value)})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("h5",{className:"text-sm font-semibold",children:"Vendor Options"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vendor Requires Status"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.vendor_requires_status",""),onChange:d=>D("npc.vendor_requires_status",d.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vendor Requires Not Status"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.vendor_requires_not_status",""),onChange:d=>D("npc.vendor_requires_not_status",d.target.value)})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Constant Stock (items per line)"}),o.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.constant_stock",""),onChange:d=>D("npc.constant_stock",d.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status Stock (status: items)"}),o.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.status_stock",""),onChange:d=>D("npc.status_stock",d.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Random Stock (loot definitions)"}),o.jsx("textarea",{className:"w-full min-h-[80px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.random_stock",""),onChange:d=>D("npc.random_stock",d.target.value)})]})]}),(()=>{const d=H("npc.random_stock_count",""),[k="",C=""]=d.split(",").map(M=>M.trim());return o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Random Stock Min"}),o.jsx(F,{type:"number",value:k,min:"0",onChange:M=>{const I=M.target.value;I?D("npc.random_stock_count",C?`${I},${C}`:I):D("npc.random_stock_count",C?`0,${C}`:"")}})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Random Stock Max"}),o.jsx(F,{type:"number",value:C,min:"0",onChange:M=>{const I=M.target.value;k?D("npc.random_stock_count",I?`${k},${I}`:k):D("npc.random_stock_count","")}})]})]})})(),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Buy Ratio"}),o.jsx(F,{type:"number",value:H("npc.vendor_ratio_buy",""),onChange:d=>D("npc.vendor_ratio_buy",d.target.value),step:"0.01"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sell Ratio"}),o.jsx(F,{type:"number",value:H("npc.vendor_ratio_sell",""),onChange:d=>D("npc.vendor_ratio_sell",d.target.value),step:"0.01"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sell Ratio (Old)"}),o.jsx(F,{type:"number",value:H("npc.vendor_ratio_sell_old",""),onChange:d=>D("npc.vendor_ratio_sell_old",d.target.value),step:"0.01"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vox Intro (one file per line)"}),o.jsx("textarea",{className:"w-full min-h-[60px] text-sm rounded-md border border-border bg-background px-2 py-1",value:H("npc.vox_intro",""),onChange:d=>D("npc.vox_intro",d.target.value)})]})]})]}),q.type==="event"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Activate"}),o.jsx(F,{value:q.activate||"on_trigger",onChange:d=>Oe({...q,activate:d.target.value}),placeholder:"on_trigger, on_load, etc."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hotspot"}),o.jsx(F,{value:q.hotspot||"0,0,1,1",onChange:d=>Oe({...q,hotspot:d.target.value}),placeholder:"x,y,width,height"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tooltip"}),o.jsx(F,{value:q.tooltip||"",onChange:d=>Oe({...q,tooltip:d.target.value}),placeholder:"Hover text"})]})]})]})}),o.jsxs(js,{className:"mt-4 flex-shrink-0",children:[o.jsx(z,{variant:"outline",onClick:ed,children:"Cancel"}),o.jsx(z,{onClick:kg,children:"Save"})]})]})}),o.jsx(ys,{open:f,onOpenChange:d=>{p(d),d||v(null)},children:o.jsxs(vs,{className:"max-w-md",children:[o.jsxs(ws,{children:[o.jsx(bs,{children:"Create Map"}),o.jsx(ks,{children:"Set the name, dimensions, and starting status for your new map."})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Map Name"}),o.jsx(F,{value:y,onChange:d=>{g(d.target.value),x&&v(null)},placeholder:"Enter map name"}),x&&o.jsx("p",{className:"mt-1 text-xs text-red-500",children:x})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Width (tiles)"}),o.jsx(F,{type:"number",min:1,max:100,value:w,onChange:d=>b(Math.max(1,Number.parseInt(d.target.value,10)||0))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Height (tiles)"}),o.jsx(F,{type:"number",min:1,max:100,value:j,onChange:d=>S(Math.max(1,Number.parseInt(d.target.value,10)||0))})]})]}),o.jsxs("div",{className:"flex items-center justify-between rounded-md border border-border px-3 py-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{htmlFor:"starting-map-checkbox",className:"text-sm font-medium text-muted-foreground",children:"Starting Map"}),o.jsx(K,{content:"If this map is the map that players will start the game then mark this option",children:o.jsx(oa,{className:"h-4 w-4 text-muted-foreground","aria-hidden":!0})})]}),o.jsx("input",{id:"starting-map-checkbox",type:"checkbox",className:"h-4 w-4 rounded border border-border accent-orange-500",checked:P,onChange:d=>E(d.target.checked),"aria-checked":P,"aria-label":"Set this map as the starting map"})]})]}),o.jsxs(js,{children:[o.jsx(z,{variant:"outline",onClick:()=>{p(!1),v(null)},children:"Cancel"}),o.jsx(z,{onClick:Ag,disabled:ar,className:"flex items-center gap-2",children:ar?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Creating..."})]}):o.jsx("span",{children:"Create"})})]})]})}),o.jsx(ys,{open:dg,onOpenChange:Ci,children:o.jsxs(vs,{className:"max-w-md",children:[o.jsxs(ws,{children:[o.jsx(bs,{children:"Edit Hero Position"}),o.jsx(ks,{children:"Set the hero spawn position on the map."})]}),je&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"X Position"}),o.jsx(F,{type:"number",min:0,max:je.mapWidth-1,defaultValue:je.currentX,onChange:d=>{const k=parseInt(d.target.value);isNaN(k)||ss({...je,currentX:k})}}),o.jsxs("span",{className:"text-xs text-gray-500",children:["(0 - ",je.mapWidth-1,")"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Y Position"}),o.jsx(F,{type:"number",min:0,max:je.mapHeight-1,defaultValue:je.currentY,onChange:d=>{const k=parseInt(d.target.value);isNaN(k)||ss({...je,currentY:k})}}),o.jsxs("span",{className:"text-xs text-gray-500",children:["(0 - ",je.mapHeight-1,")"]})]})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Current position: (",je.currentX,", ",je.currentY,")"]})]}),o.jsxs(js,{children:[o.jsx(z,{variant:"outline",onClick:Sg,children:"Cancel"}),o.jsx(z,{onClick:()=>je&&jg(je.currentX,je.currentY),children:"Confirm"})]})]})}),cg&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-black rounded-lg shadow-xl p-6 max-w-md mx-4 relative",children:[o.jsx("button",{onClick:()=>Iu(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-200 transition-colors",children:o.jsx(Fe,{className:"w-5 h-5"})}),o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center",children:o.jsx(p0,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Export Successful"})]}),o.jsxs("p",{className:"text-gray-300 flex items-center gap-2",children:["Map files and tile definitions saved to",o.jsxs("span",{className:"inline-flex items-center gap-1 font-medium text-white",children:[o.jsx(mo,{className:"w-4 h-4"}),"Export"]}),"."]})]})}),cr&&o.jsx("div",{className:`custom-tooltip ${cr.visible?"visible":""} ${cr.fadeOut?"fade-out":""}`,style:{left:cr.x,top:cr.y},children:cr.content})]})})}ga.createRoot(document.getElementById("root")).render(o.jsx(ge.StrictMode,{children:o.jsx(O1,{})}));
